import{J as Ue,r as M,h as V,d as X,K as te,L as ve,A as ge,c as s,b as j,a as e,F,q as W,n as T,w as G,x as se,M as Me,t as y,I as z,y as de,o as t,_ as ie,B as ce,N as _e,e as be,E as ue,p as q,G as fe,g as P,v as xe,l as Q,j as me,k as pe,O as Ie,P as Re,s as ke,H as Ve,Q as He,m as Ae,T as ze}from"./index-CLqSszJg.js";import{g as Be,b as Ne,a as Ee,c as Fe,d as Ke,e as We,V as De}from"./vdoninja-ByZo7au1.js";import{M as Ge}from"./ModeLoadingScreen-CbKeOUTr.js";const le=[{id:"youtube",name:"YouTube Live",icon:"â–¶ï¸",rtmpBaseUrl:"rtmp://a.rtmp.youtube.com/live2/",streamKeyPlaceholder:"xxxx-xxxx-xxxx-xxxx-xxxx",helpUrl:"https://support.google.com/youtube/answer/2907883"},{id:"twitch",name:"Twitch",icon:"ðŸ“º",rtmpBaseUrl:"rtmp://live.twitch.tv/app/",streamKeyPlaceholder:"live_xxxxxxxxxx_xxxxxxxxxxxxxx",helpUrl:"https://help.twitch.tv/s/article/twitch-stream-key-faq"},{id:"facebook",name:"Facebook Live",icon:"ðŸ“˜",rtmpBaseUrl:"rtmps://live-api-s.facebook.com:443/rtmp/",streamKeyPlaceholder:"FB-xxxxxxxxxx-x",helpUrl:"https://www.facebook.com/help/587160588142067"},{id:"restream",name:"Restream",icon:"ðŸ”„",rtmpBaseUrl:"rtmp://live.restream.io/live/",streamKeyPlaceholder:"re_xxxxxx_xxxxxxxxxx",helpUrl:"https://support.restream.io/en/"},{id:"custom",name:"Custom RTMP",icon:"âš™ï¸",rtmpBaseUrl:"",streamKeyPlaceholder:"your-stream-key"}],ye=Ue("streaming",()=>{const I=M([]),p=M(!1),o=M(null),i=M({enabled:!1,host:"",port:8890,streamId:"mixer_program"}),l=V(()=>I.value.find(_=>_.id===o.value)),m=V(()=>I.value.filter(_=>_.enabled)),S=V(()=>le),d=V(()=>{const _=window.location.hostname,H=_==="localhost"||_==="127.0.0.1"?"localhost":_.replace("r58-api","r58-mediamtx");return{rtmp:`rtmp://${H}:1935/mixer_program`,rtsp:`rtsp://${H}:8554/mixer_program`,srt:`srt://${H}:8890?streamid=read:mixer_program`,hls:`https://${_}/hls/mixer_program/index.m3u8`,whep:`${window.location.origin}/api/v1/whep/mixer_program/whep`}});function a(_,h){const H=le.find(c=>c.id===_);if(!H)throw new Error(`Unknown platform: ${_}`);const $={id:`dest-${Date.now()}`,platformId:_,name:h||H.name,streamKey:"",enabled:!1};return I.value.push($),$}function E(_,h){const H=I.value.findIndex($=>$.id===_);H!==-1&&(I.value[H]={...I.value[H],...h})}function b(_){const h=I.value.findIndex(H=>H.id===_);h!==-1&&I.value.splice(h,1),o.value===_&&(o.value=null)}function r(_){o.value=_}function g(_){i.value.enabled=_}function C(_){i.value={...i.value,..._}}function O(){p.value=!0}function R(){p.value=!1}function x(_){const h=le.find(H=>H.id===_.platformId);return h?_.platformId==="custom"?`${_.name}${_.streamKey}`:`${h.rtmpBaseUrl}${_.streamKey}`:""}function u(){const _=window.location.hostname;return`srt://${_==="localhost"||_==="127.0.0.1"?"localhost":_.replace("r58-api","r58-mediamtx")}:${i.value.port}?streamid=read:${i.value.streamId}`}function f(){try{const _=localStorage.getItem("r58-streaming-destinations");if(_){const h=JSON.parse(_);I.value=h.destinations||[],h.srtOutput&&(i.value={...i.value,...h.srtOutput})}}catch(_){console.warn("Failed to load saved streaming destinations:",_)}}function n(){try{localStorage.setItem("r58-streaming-destinations",JSON.stringify({destinations:I.value,srtOutput:i.value}))}catch(_){console.warn("Failed to save streaming destinations:",_)}}return f(),{destinations:I,isStreaming:p,activeDestinationId:o,srtOutput:i,activeDestination:l,enabledDestinations:m,platforms:S,programOutputUrls:d,addDestination:a,updateDestination:E,removeDestination:b,setActiveDestination:r,toggleSrtOutput:g,updateSrtConfig:C,startStreaming:O,stopStreaming:R,buildRtmpUrl:x,getSrtOutputUrl:u,saveDestinations:n,loadSavedDestinations:f}}),Ye={class:"source-panel space-y-4","data-testid":"source-panel"},Je={key:0,class:"px-3 py-2 bg-amber-500/10 border border-amber-500/30 rounded-lg text-xs text-amber-400"},qe={key:1,class:"text-center py-6 text-r58-text-secondary"},Xe={key:2,class:"space-y-2"},Qe={class:"flex items-center gap-3"},Ze={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},et={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},tt={key:2,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},st={key:3,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},nt={class:"flex-1 min-w-0"},ot={key:0,class:"flex items-center gap-1"},rt=["onDblclick"],it={class:"flex items-center gap-2 text-xs text-r58-text-secondary"},at={key:0,class:"text-red-400 font-bold"},lt={key:1,class:"text-amber-400"},dt={class:"flex items-center gap-1 flex-shrink-0"},ct=["onClick"],ut=["onClick","title"],vt={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},mt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pt={key:0,class:"mt-2"},xt={class:"h-1 bg-r58-bg-primary rounded-full overflow-hidden"},je="preke-source-names",gt=X({__name:"SourcePanel",props:{vdoEmbed:{}},setup(I){function p(){try{const $=localStorage.getItem(je);return $?JSON.parse($):{}}catch{return{}}}function o($,c){const k=p();k[$]=c,localStorage.setItem(je,JSON.stringify(k))}const i=M(p()),l=M(null),m=M(""),S=I,d=te(),a=ve(),E=ge(),b={cam0:{name:"HDMI 1",subtitle:"Connected to device"},cam1:{name:"HDMI 2",subtitle:"Connected to device"},cam2:{name:"HDMI 3",subtitle:"Connected to device"},cam3:{name:"HDMI 4",subtitle:"Connected to device"}},r=V(()=>d.sources.map($=>{let c=$.label,k="VDO.ninja";const B=$.id.match(/cam(\d+)/i)||$.id.match(/hdmi[_-]?(\d+)/i);return B?(c=`HDMI ${parseInt(B[1])+1}`,k="Connected to device"):$.type==="guest"?(k="Remote guest",(!$.label||$.label.length>20||$.label.match(/^[a-z0-9]{8,}$/i))&&(c="Guest")):$.type==="screen"&&(k="Screen share"),{...$,label:c,subtitle:k}})),g=V(()=>E.inputs.filter($=>$.hasSignal).map($=>{const c=b[$.id]||{name:$.label,subtitle:"HDMI Input"};return{id:$.id,label:c.name,subtitle:c.subtitle,type:"camera",hasVideo:!0,hasAudio:!0,muted:!1,audioLevel:0}})),C=V(()=>r.value.length>0?r.value:g.value),O=V(()=>r.value.length===0&&g.value.length>0);function R($){const c=a.getScene(d.previewSceneId||"");return(c==null?void 0:c.slots.some(k=>k.sourceId===$))||!1}function x($){return d.liveSourceIds.includes($)}function u($){var c,k;S.vdoEmbed&&((k=(c=S.vdoEmbed).toggleMute)==null||k.call(c,$.id)),d.setSourceMute($.id,!$.muted)}function f($){const c=a.getScene(d.previewSceneId||"");if(!c)return;const k=c.slots.find(B=>!B.sourceId);k&&a.assignSourceToSlot(c.id,k.id,$.id)}function n($){return i.value[$.id]||$.label}function _($){l.value=$.id,m.value=i.value[$.id]||$.label}function h(){l.value&&m.value.trim()&&(o(l.value,m.value.trim()),i.value=p()),l.value=null}function H(){l.value=null,m.value=""}return($,c)=>(t(),s("div",Ye,[O.value?(t(),s("div",Je," Showing HDMI cameras. VDO.ninja sources will appear when connected. ")):j("",!0),C.value.length===0?(t(),s("div",qe,[...c[1]||(c[1]=[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),e("p",{class:"text-sm"},"No sources connected",-1),e("p",{class:"text-xs mt-1 opacity-75"},"Connect HDMI or invite guests",-1)])])):(t(),s("div",Xe,[(t(!0),s(F,null,W(C.value,k=>(t(),s("div",{key:k.id,class:T(["source-card p-3 rounded-lg transition-all",[x(k.id)?"bg-red-500/10 border border-red-500/30":R(k.id)?"bg-amber-500/10 border border-amber-500/30":"bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 border border-transparent"]])},[e("div",Qe,[e("div",{class:T(["w-10 h-10 rounded-lg bg-r58-bg-primary flex items-center justify-center flex-shrink-0",{"ring-2 ring-red-500":x(k.id),"ring-2 ring-amber-500":R(k.id)&&!x(k.id)}])},[k.type==="camera"?(t(),s("svg",Ze,[...c[2]||(c[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])):k.type==="guest"?(t(),s("svg",et,[...c[3]||(c[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])])):k.type==="screen"?(t(),s("svg",tt,[...c[4]||(c[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},null,-1)])])):(t(),s("svg",st,[...c[5]||(c[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"},null,-1)])]))],2),e("div",nt,[l.value===k.id?(t(),s("div",ot,[G(e("input",{"onUpdate:modelValue":c[0]||(c[0]=B=>m.value=B),onKeyup:[Me(h,["enter"]),Me(H,["escape"])],onBlur:h,class:"input text-sm py-0.5 px-1 w-full",autofocus:""},null,544),[[se,m.value]])])):(t(),s("p",{key:1,onDblclick:B=>_(k),class:"font-medium text-sm truncate cursor-pointer hover:text-r58-accent-primary",title:"Double-click to rename"},y(n(k)),41,rt)),e("div",it,[e("span",null,y(k.subtitle),1),x(k.id)?(t(),s("span",at,"LIVE")):R(k.id)?(t(),s("span",lt,"PVW")):j("",!0)])]),e("div",dt,[z(d).previewSceneId&&!R(k.id)?(t(),s("button",{key:0,onClick:B=>f(k),class:"p-1.5 rounded hover:bg-r58-bg-primary transition-colors text-r58-text-secondary hover:text-r58-accent-primary",title:"Add to preview scene"},[...c[6]||(c[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,ct)):j("",!0),k.hasAudio?(t(),s("button",{key:1,onClick:B=>u(k),class:T(["p-1.5 rounded transition-colors",k.muted?"bg-red-500/20 text-red-400":"hover:bg-r58-bg-primary text-r58-text-secondary"]),title:k.muted?"Unmute":"Mute"},[k.muted?(t(),s("svg",vt,[...c[7]||(c[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(t(),s("svg",mt,[...c[8]||(c[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],10,ut)):j("",!0)])]),k.hasAudio?(t(),s("div",pt,[e("div",xt,[e("div",{class:T(["h-full transition-all duration-75 rounded-full",k.muted?"bg-r58-bg-tertiary":k.audioLevel>80?"bg-red-500":k.audioLevel>60?"bg-amber-500":"bg-emerald-500"]),style:de({width:`${k.audioLevel||0}%`})},null,6)])])):j("",!0)],2))),128))]))]))}}),bt=ie(gt,[["__scopeId","data-v-0f8f8e88"]]),ft={class:"preview-program-view h-full flex flex-col","data-testid":"preview-program-view"},yt={class:"flex-1 flex gap-4 min-h-0"},ht={class:"flex-1 flex flex-col min-w-0"},kt={class:"flex items-center justify-between mb-2"},wt={key:0,class:"text-xs text-r58-text-secondary"},_t={key:0,class:"absolute inset-0 flex items-center justify-center"},St={class:"relative w-full h-full bg-r58-bg-secondary"},$t={key:0,class:"truncate px-1"},Ct={key:1,class:"opacity-50"},Mt={key:1,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},It={class:"flex flex-col items-center justify-center gap-3 px-2"},Rt=["disabled"],Et={key:0,class:"animate-pulse"},Dt={key:1},jt=["disabled"],Lt={class:"flex flex-col gap-1 mt-2"},Tt=["value"],Vt=["value"],Pt={class:"flex-1 flex flex-col min-w-0"},Ot={class:"flex items-center justify-between mb-2"},Ut={class:"flex items-center gap-2"},Ht={key:0,class:"px-2 py-0.5 bg-red-600 text-white text-xs font-bold rounded animate-pulse"},At={key:0,class:"text-xs text-r58-text-secondary"},zt={key:0,class:"absolute inset-0"},Bt={class:"relative w-full h-full bg-r58-bg-secondary"},Nt={key:0,class:"truncate px-1"},Ft={key:1,class:"opacity-50"},Kt={key:0,class:"absolute top-2 left-2 flex items-center gap-2"},Wt={key:1,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},Gt=X({__name:"PreviewProgramView",props:{vdoEmbed:{}},emits:["take","cut"],setup(I,{emit:p}){const o=p,i=te(),l=ve(),m=M(i.transition.type),S=M(i.transition.duration),d=V(()=>l.getScene(i.previewSceneId||"")),a=V(()=>l.getScene(i.programSceneId||"")),E=V(()=>i.previewSceneId!==null&&i.previewSceneId!==i.programSceneId&&!i.isTransitioning),b=V(()=>i.isLive);ce([m,S],([R,x])=>{i.setTransition({type:R,duration:x})});function r(){E.value&&(i.take(),o("take"))}function g(){i.previewSceneId&&(i.cut(),o("cut"))}const C=[{value:"cut",label:"CUT"},{value:"fade",label:"FADE"},{value:"wipe-left",label:"WIPE L"},{value:"wipe-right",label:"WIPE R"}],O=[{value:100,label:"0.1s"},{value:300,label:"0.3s"},{value:500,label:"0.5s"},{value:1e3,label:"1.0s"}];return(R,x)=>(t(),s("div",ft,[e("div",yt,[e("div",ht,[e("div",kt,[x[2]||(x[2]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-xs font-bold uppercase tracking-wider text-amber-400"},"PVW"),e("span",{class:"text-xs text-r58-text-secondary"},"Preview")],-1)),d.value?(t(),s("span",wt,y(d.value.name),1)):j("",!0)]),e("div",{class:T(["flex-1 bg-black rounded-lg overflow-hidden border-2 transition-colors relative",d.value?"border-amber-500/50":"border-r58-bg-tertiary"])},[d.value?(t(),s("div",_t,[e("div",St,[(t(!0),s(F,null,W(d.value.slots,u=>{var f;return t(),s("div",{key:u.id,class:"absolute bg-r58-bg-tertiary border border-r58-bg-tertiary/50 flex items-center justify-center text-xs text-r58-text-secondary",style:de({left:`${u.position.x}%`,top:`${u.position.y}%`,width:`${u.position.w}%`,height:`${u.position.h}%`,zIndex:u.zIndex,borderRadius:(f=u.style)!=null&&f.borderRadius?`${u.style.borderRadius}px`:void 0})},[u.sourceId?(t(),s("span",$t,y(u.sourceId),1)):(t(),s("span",Ct,"Empty"))],4)}),128))])])):(t(),s("div",Mt,[...x[3]||(x[3]=[e("div",{class:"text-center"},[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]),e("p",{class:"text-sm"},"Select a scene to preview")],-1)])]))],2)]),e("div",It,[e("button",{onClick:r,disabled:!E.value,class:T(["take-button w-20 h-16 rounded-lg font-bold text-lg transition-all",E.value?"bg-red-600 hover:bg-red-500 text-white shadow-lg shadow-red-500/30":"bg-r58-bg-tertiary text-r58-text-secondary cursor-not-allowed"]),"data-testid":"take-button"},[z(i).isTransitioning?(t(),s("span",Et,"...")):(t(),s("span",Dt,"TAKE"))],10,Rt),e("button",{onClick:g,disabled:!z(i).previewSceneId,class:T(["w-20 h-10 rounded-lg font-bold text-sm transition-all",z(i).previewSceneId?"bg-r58-bg-tertiary hover:bg-r58-accent-primary text-r58-text-primary":"bg-r58-bg-tertiary/50 text-r58-text-secondary cursor-not-allowed"]),"data-testid":"cut-button"}," CUT ",10,jt),e("div",Lt,[G(e("select",{"onUpdate:modelValue":x[0]||(x[0]=u=>m.value=u),class:"w-20 px-2 py-1 text-xs bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-center"},[(t(),s(F,null,W(C,u=>e("option",{key:u.value,value:u.value},y(u.label),9,Tt)),64))],512),[[_e,m.value]]),G(e("select",{"onUpdate:modelValue":x[1]||(x[1]=u=>S.value=u),class:"w-20 px-2 py-1 text-xs bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-center"},[(t(),s(F,null,W(O,u=>e("option",{key:u.value,value:u.value},y(u.label),9,Vt)),64))],512),[[_e,S.value,void 0,{number:!0}]])])]),e("div",Pt,[e("div",Ot,[e("div",Ut,[e("span",{class:T(["text-xs font-bold uppercase tracking-wider",b.value?"text-red-500":"text-r58-text-secondary"])}," PGM ",2),x[4]||(x[4]=e("span",{class:"text-xs text-r58-text-secondary"},"Program",-1)),b.value?(t(),s("span",Ht," LIVE ")):j("",!0)]),a.value?(t(),s("span",At,y(a.value.name),1)):j("",!0)]),e("div",{class:T(["flex-1 bg-black rounded-lg overflow-hidden border-2 transition-colors relative",b.value?"border-red-500":a.value?"border-emerald-500/50":"border-r58-bg-tertiary"])},[a.value?(t(),s("div",zt,[e("div",Bt,[(t(!0),s(F,null,W(a.value.slots,u=>{var f;return t(),s("div",{key:u.id,class:"absolute bg-r58-bg-primary border border-r58-bg-tertiary/50 flex items-center justify-center text-xs text-r58-text-secondary",style:de({left:`${u.position.x}%`,top:`${u.position.y}%`,width:`${u.position.w}%`,height:`${u.position.h}%`,zIndex:u.zIndex,borderRadius:(f=u.style)!=null&&f.borderRadius?`${u.style.borderRadius}px`:void 0})},[u.sourceId?(t(),s("span",Nt,y(u.sourceId),1)):(t(),s("span",Ft,"Empty"))],4)}),128))]),b.value?(t(),s("div",Kt,[...x[5]||(x[5]=[e("div",{class:"w-3 h-3 rounded-full bg-red-500 animate-recording"},null,-1)])])):j("",!0)])):(t(),s("div",Wt,[...x[6]||(x[6]=[be('<div class="text-center" data-v-7b73e210><svg class="w-8 h-8 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-7b73e210><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" data-v-7b73e210></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-7b73e210></path></svg><p class="text-sm" data-v-7b73e210>No scene on program</p></div>',1)])]))],2)])])]))}}),Yt=ie(Gt,[["__scopeId","data-v-7b73e210"]]),Jt={class:"scene-strip","data-testid":"scene-strip"},qt={class:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin"},Xt=["onClick","onDblclick","onContextmenu","data-testid"],Qt={class:"relative aspect-video bg-r58-bg-tertiary rounded-lg overflow-hidden"},Zt={class:"absolute inset-0"},es={key:0,class:"absolute top-1 left-1 w-5 h-5 flex items-center justify-center bg-r58-bg-primary/80 rounded text-xs font-mono font-bold"},ts={key:1,class:"absolute top-1 right-1 flex items-center gap-1 px-1.5 py-0.5 bg-red-600 rounded text-xs font-bold"},ss={key:2,class:"absolute top-1 right-1 px-1.5 py-0.5 bg-amber-500 rounded text-xs font-bold text-black"},ns={class:"mt-1 text-xs text-center truncate text-r58-text-secondary"},os=["disabled"],rs=X({__name:"SceneStrip",emits:["edit-scene","add-scene"],setup(I,{emit:p}){const o=p,i=ve(),l=te(),m=M(null),S=M({x:0,y:0}),d=M(!1),a=V(()=>i.scenes),E=V(()=>l.previewSceneId),b=V(()=>l.programSceneId);function r(f){l.mode==="simple"?l.setProgramScene(f.id):l.setPreviewScene(f.id)}function g(f){l.setProgramScene(f.id),P.info(`Scene: ${f.name}`)}function C(f,n){f.preventDefault(),m.value=n,S.value={x:f.clientX,y:f.clientY},d.value=!0;const _=()=>{d.value=!1,document.removeEventListener("click",_)};setTimeout(()=>document.addEventListener("click",_),0)}function O(f){d.value=!1,o("edit-scene",f)}function R(f){d.value=!1;const n=i.duplicateScene(f.id);n&&P.success(`Duplicated: ${n.name}`)}function x(f){if(d.value=!1,a.value.length<=1){P.error("Cannot delete the last scene");return}if(f.id===b.value){P.error("Cannot delete scene that is on program");return}i.deleteScene(f.id),P.info(`Deleted: ${f.name}`)}function u(f){return f.id===b.value?"ring-2 ring-red-500 ring-offset-2 ring-offset-r58-bg-primary":f.id===E.value?"ring-2 ring-amber-500 ring-offset-1 ring-offset-r58-bg-primary":"hover:ring-2 hover:ring-r58-accent-primary/50"}return(f,n)=>{var _;return t(),s("div",Jt,[e("div",qt,[(t(!0),s(F,null,W(a.value,(h,H)=>(t(),s("div",{key:h.id,class:T(["scene-thumbnail flex-shrink-0 w-28 cursor-pointer transition-all",u(h)]),onClick:$=>r(h),onDblclick:$=>g(h),onContextmenu:$=>C($,h),"data-testid":`scene-${h.id}`},[e("div",Qt,[e("div",Zt,[(t(!0),s(F,null,W(h.slots,$=>(t(),s("div",{key:$.id,class:"absolute bg-r58-bg-secondary border border-r58-bg-tertiary/30",style:de({left:`${$.position.x}%`,top:`${$.position.y}%`,width:`${$.position.w}%`,height:`${$.position.h}%`})},null,4))),128))]),H<8?(t(),s("div",es,y(H+1),1)):j("",!0),h.id===b.value?(t(),s("div",ts,[...n[4]||(n[4]=[e("div",{class:"w-1.5 h-1.5 rounded-full bg-white animate-pulse"},null,-1),q(" PGM ",-1)])])):h.id===E.value?(t(),s("div",ss," PVW ")):j("",!0)]),e("p",ns,y(h.name),1)],42,Xt))),128)),e("button",{onClick:n[0]||(n[0]=h=>o("add-scene")),class:"flex-shrink-0 w-28 aspect-video bg-r58-bg-tertiary/50 hover:bg-r58-bg-tertiary rounded-lg border-2 border-dashed border-r58-bg-tertiary hover:border-r58-accent-primary/50 flex items-center justify-center transition-colors","data-testid":"add-scene-button"},[...n[5]||(n[5]=[e("div",{class:"text-center text-r58-text-secondary"},[e("svg",{class:"w-6 h-6 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs"},"Add Scene")],-1)])])]),(t(),ue(fe,{to:"body"},[d.value&&m.value?(t(),s("div",{key:0,class:"fixed z-50 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg shadow-xl py-1 min-w-[140px]",style:de({left:`${S.value.x}px`,top:`${S.value.y}px`})},[e("button",{onClick:n[1]||(n[1]=h=>O(m.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-r58-bg-tertiary flex items-center gap-2"},[...n[6]||(n[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),q(" Edit ",-1)])]),e("button",{onClick:n[2]||(n[2]=h=>R(m.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-r58-bg-tertiary flex items-center gap-2"},[...n[7]||(n[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),q(" Duplicate ",-1)])]),n[9]||(n[9]=e("div",{class:"border-t border-r58-bg-tertiary my-1"},null,-1)),e("button",{onClick:n[3]||(n[3]=h=>x(m.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-red-500/20 text-red-400 flex items-center gap-2",disabled:((_=m.value)==null?void 0:_.id)===b.value},[...n[8]||(n[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),q(" Delete ",-1)])],8,os)],4)):j("",!0)]))])}}}),is=ie(rs,[["__scopeId","data-v-627912a1"]]),as={class:"mixer-workspace h-full flex flex-col","data-testid":"mixer-workspace"},ls={class:"flex-1 flex gap-4 min-h-0 p-4"},ds={key:0,class:"text-sm font-medium"},cs={class:"h-[calc(100%-48px)] overflow-y-auto scrollbar-thin"},us={class:"space-y-2"},vs=["title"],ms={class:"flex-1 flex flex-col min-w-0"},ps={class:"flex-1 min-h-0"},xs={class:"mt-4 pt-4 border-t border-r58-bg-tertiary"},gs=X({__name:"MixerWorkspace",props:{vdoEmbed:{}},emits:["edit-scene","add-scene"],setup(I,{emit:p}){const o=p,i=te();ve();const l=M(!1);function m(){l.value=!l.value}function S(b){o("edit-scene",b)}function d(){o("add-scene")}function a(){console.log("[Workspace] Take executed")}function E(){console.log("[Workspace] Cut executed")}return(b,r)=>(t(),s("div",as,[e("div",ls,[e("aside",{class:T(["sources-panel flex-shrink-0 transition-all duration-300 overflow-hidden",l.value?"w-12":"w-64"])},[e("button",{onClick:m,class:"w-full mb-3 flex items-center justify-between px-3 py-2 bg-r58-bg-tertiary rounded-lg hover:bg-r58-bg-tertiary/80 transition-colors"},[l.value?j("",!0):(t(),s("span",ds,"Sources")),(t(),s("svg",{class:T(["w-4 h-4 transition-transform",{"rotate-180":l.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[0]||(r[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"},null,-1)])],2))]),G(e("div",cs,[Q(bt,{"vdo-embed":I.vdoEmbed},null,8,["vdo-embed"])],512),[[xe,!l.value]]),G(e("div",us,[(t(!0),s(F,null,W(z(i).connectedSources.slice(0,6),g=>(t(),s("div",{key:g.id,class:"w-8 h-8 mx-auto rounded bg-r58-bg-tertiary flex items-center justify-center text-xs",title:g.label},y(g.label.charAt(0)),9,vs))),128))],512),[[xe,l.value]])],2),e("div",ms,[e("div",ps,[Q(Yt,{"vdo-embed":I.vdoEmbed,onTake:a,onCut:E},null,8,["vdo-embed"])]),e("div",xs,[r[1]||(r[1]=be('<div class="flex items-center justify-between mb-2" data-v-7b5f9921><h3 class="text-sm font-medium text-r58-text-secondary" data-v-7b5f9921>Scenes</h3><div class="flex items-center gap-2 text-xs text-r58-text-secondary" data-v-7b5f9921><span data-v-7b5f9921>Click = Preview</span><span class="opacity-50" data-v-7b5f9921>|</span><span data-v-7b5f9921>Double-click = Live</span><span class="opacity-50" data-v-7b5f9921>|</span><span data-v-7b5f9921>Right-click = Menu</span></div></div>',1)),Q(is,{onEditScene:S,onAddScene:d})])])])]))}}),bs=ie(gs,[["__scopeId","data-v-7b5f9921"]]),Se="vdo-debug",fs=500,ne=[];let $e=typeof localStorage<"u"&&localStorage.getItem(Se)==="true";function Le(I){$e=I,typeof localStorage<"u"&&(I?localStorage.setItem(Se,"true"):localStorage.removeItem(Se)),console.log(`[VDO.ninja Debug] ${I?"Enabled":"Disabled"}`)}function we(I){if(ne.push(I),ne.length>fs&&ne.shift(),$e){const p=new Date(I.timestamp).toISOString().split("T")[1].slice(0,-1),o=I.direction==="outgoing"?"âž¡ï¸ OUT":"â¬…ï¸ IN",i=I.direction==="outgoing"?"color: #3b82f6; font-weight: bold":"color: #22c55e; font-weight: bold";console.groupCollapsed(`%c[VDO.ninja ${o}] %c${I.type}`,i,"color: inherit"),console.log("Time:",p),I.target&&console.log("Target:",I.target),console.log("Data:",I.data),I.raw&&I.raw!==I.data&&console.log("Raw:",I.raw),console.groupEnd()}}function Pe(){return[...ne]}function ys(){ne.length=0,console.log("[VDO.ninja Debug] Event history cleared")}function Oe(){const I={total:ne.length,incoming:0,outgoing:0,byType:{},lastActivity:ne.length>0?ne[ne.length-1].timestamp:null};for(const p of ne)p.direction==="incoming"?I.incoming++:I.outgoing++,I.byType[p.type]=(I.byType[p.type]||0)+1;return I}typeof window<"u"&&(window.__VDO_DEBUG__={getHistory:Pe,clearHistory:ys,getStats:Oe,enable:()=>Le(!0),disable:()=>Le(!1),isEnabled:()=>$e});function hs(I){const p=M(!1),o=M(new Map),i=M(null),l=M(!1),m=M("disconnected"),S=M(null),d=Be();function a(D,A,N,re){var K;if(!((K=I.value)!=null&&K.contentWindow)){console.warn("[VDO.ninja] Cannot send command - iframe not ready"),S.value="iframe not ready";return}const J={action:D};A&&(J.target=A),N!==void 0&&(J.value=N),re!==void 0&&(J.value2=re),we({timestamp:Date.now(),direction:"outgoing",type:D,target:A,data:{action:D,target:A,value:N,value2:re},raw:J});try{I.value.contentWindow.postMessage(J,"*")}catch(Z){console.error("[VDO.ninja] Failed to send command:",Z),S.value=String(Z)}}function E(D,A){var re;if(!((re=I.value)!=null&&re.contentWindow)){console.warn("[VDO.ninja] Cannot send DOM command - iframe not ready");return}const N={action:"",target:D,...A};we({timestamp:Date.now(),direction:"outgoing",type:"dom-manipulation",target:D,data:A,raw:N});try{I.value.contentWindow.postMessage(N,"*")}catch(J){console.error("[VDO.ninja] Failed to send DOM command:",J)}}function b(D,A=1){a("addScene",D,A),i.value=A}function r(D,A=1){a("addScene",D,0)}function g(D){E(D,{replace:!0})}function C(D){E(D,{add:!0})}function O(D){E(D,{remove:!0})}function R(D,A){a("mic",D,!A);const N=o.value.get(D);N&&(N.muted=A)}function x(D){a("mic",D,"toggle");const A=o.value.get(D);A&&(A.muted=!A.muted)}function u(D,A){a("volume",D,Math.max(0,Math.min(200,A)))}function f(D){a("soloChat",D)}function n(D){a("soloChatBidirectional",D)}function _(D,A){a("sendChat",D,A)}function h(D,A){a("sendDirectorChat",D,A)}function H(D){a("hangup",D),o.value.delete(D)}function $(D){D?a("togglescreenshare",D):a("togglescreenshare")}function c(D,A){a("forward",D,A)}function k(D="guests"){a("getGuestList",void 0,void 0)}function B(){a("record",void 0,!0),l.value=!0}function ee(){a("record",void 0,!1),l.value=!1}function Y(D){a("layout",void 0,D)}function U(D){D?a("reload",D):a("reload")}function w(D,A){a("mixorder",D,A==="up"?-1:1)}function v(D){a("camera",void 0,D)}function L(D,A){a("camera",D,A)}function oe(D,A=!1){A?a("zoom",void 0,D,"abs"):a("zoom",void 0,D)}function ae(D){a("pan",void 0,D)}function he(D){a("tilt",void 0,D)}function Ce(D){const A=D.origin;if(!A.includes(d.split(":")[0])&&!A.includes("vdo.ninja")&&!A.includes("vdo.itagenten")&&!A.includes("localhost"))return;const N=D.data;if(!N||typeof N!="object")return;const re=N.type||N.action||"unknown",J=N.streamID||N.UUID||N.streamId;switch(we({timestamp:Date.now(),direction:"incoming",type:re,target:J,data:N.data||N.value,raw:N}),re){case"director-ready":case"loaded":case"ready":case"started":p.value=!0,m.value="connected",S.value=null;break;case"new-guest":case"guest-connected":case"push":case"view":case"joined":{if(J){const K=N.data,Z={id:J,label:(K==null?void 0:K.label)||N.label||J,type:(K==null?void 0:K.type)||"guest",hasVideo:(K==null?void 0:K.video)!==!1,hasAudio:(K==null?void 0:K.audio)!==!1,muted:!1,audioLevel:0};o.value.set(J,Z)}break}case"guest-left":case"guest-disconnected":case"left":case"disconnect":J&&o.value.delete(J);break;case"audio-level":case"loudness":{if(J){const K=o.value.get(J);if(K){const Z=N.data;K.audioLevel=(Z==null?void 0:Z.level)||N.value||0}}break}case"mute-state":case"muted":{if(J){const K=o.value.get(J);if(K){const Z=N.data;K.muted=(Z==null?void 0:Z.muted)??N.value??!1}}break}case"scene-changed":case"scene":{const K=N.data,Z=(K==null?void 0:K.scene)||N.value;i.value=typeof Z=="number"?Z:null;break}case"recording-started":l.value=!0;break;case"recording-stopped":l.value=!1;break;case"error":console.error("[VDO.ninja Error]",N.data),S.value=String(N.data);break}}return me(()=>{m.value="connecting",window.addEventListener("message",Ce),setTimeout(()=>{!p.value&&I.value&&(p.value=!0,m.value="connected")},5e3)}),pe(()=>{window.removeEventListener("message",Ce),m.value="disconnected"}),{isReady:p,sources:o,activeScene:i,isRecording:l,connectionState:m,lastError:S,addToScene:b,removeFromScene:r,setProgram:g,addSource:C,removeSource:O,setLayout:Y,changeMixOrder:w,setMute:R,toggleMute:x,setVolume:u,soloAudio:f,soloChatBidirectional:n,sendToGuest:_,sendDirectorMessage:h,kickGuest:H,toggleScreenShare:$,transferGuest:c,getGuestList:k,refreshSource:U,setCamera:v,setGuestCamera:L,zoom:oe,pan:ae,tilt:he,startRecording:B,stopRecording:ee,sendCommand:a,sendDomCommand:E,getEventHistory:Pe,getEventStats:Oe}}const ks={key:0,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary z-10","data-testid":"vdo-loading"},ws={class:"text-center"},_s={class:"text-xs text-r58-text-secondary mt-2"},Ss={key:1,class:"absolute bottom-4 left-4 right-4 bg-red-500/90 text-white px-4 py-2 rounded-lg text-sm z-20"},$s=["src","title"],Cs=X({__name:"VdoNinjaEmbed",props:{profile:{},sources:{},room:{},password:{}},setup(I,{expose:p}){const o=I,i=M(null),l=te(),m=hs(i),{isReady:S,sources:d,addToScene:a,removeFromScene:E,setMute:b,toggleMute:r,setVolume:g,sendCommand:C,sendDomCommand:O,isRecording:R,connectionState:x,lastError:u,startRecording:f,stopRecording:n,kickGuest:_,toggleScreenShare:h,setLayout:H,setProgram:$,addSource:c,removeSource:k,getEventHistory:B,getEventStats:ee}=m,Y=V(()=>{const w={};return o.sources&&(w.source_ids=o.sources.join(",")),o.room&&(w.room=o.room),o.password&&(w.password=o.password),Ne(o.profile,w)}),U=V(()=>o.profile==="mixer");return ce(d,w=>{l.updateSourcesFromVdo(Array.from(w.values()))},{deep:!0}),p({isReady:S,isRecording:R,connectionState:x,lastError:u,addToScene:a,removeFromScene:E,setLayout:H,setProgram:$,addSource:c,removeSource:k,setMute:b,toggleMute:r,setVolume:g,startRecording:f,stopRecording:n,kickGuest:_,toggleScreenShare:h,sendCommand:C,sendDomCommand:O,getEventHistory:B,getEventStats:ee}),(w,v)=>(t(),s("div",{class:T(["vdo-embed-container relative w-full h-full bg-black rounded-lg overflow-hidden",{"mixer-mode":U.value}]),"data-testid":"vdo-embed-container"},[z(S)?j("",!0):(t(),s("div",ks,[e("div",ws,[v[0]||(v[0]=e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full mx-auto mb-4"},null,-1)),v[1]||(v[1]=e("p",{class:"text-r58-text-secondary"},"Connecting to VDO.ninja...",-1)),e("p",_s,y(U.value?"Loading mixer controls...":"Local mixer on R58"),1)])])),z(u)?(t(),s("div",Ss,[v[2]||(v[2]=e("strong",null,"Error:",-1)),q(" "+y(z(u)),1)])):j("",!0),e("iframe",{ref_key:"iframeRef",ref:i,src:Y.value,class:T(["w-full h-full border-0",{"opacity-0":!z(S)}]),allow:"camera; microphone; display-capture; autoplay; clipboard-write",allowfullscreen:"","data-testid":"vdo-iframe",title:U.value?"VDO.ninja Mixer":"VDO.ninja"},null,10,$s)],2))}}),Ms=ie(Cs,[["__scopeId","data-v-4a9e915e"]]),Is={class:"camera-push-bar border-t border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"camera-push-bar"},Rs={class:"flex items-center gap-2"},Es={class:"text-r58-text-secondary"},Ds={key:0,class:"px-4 pb-3"},js={key:0,class:"flex gap-3 flex-wrap"},Ls={class:"text-sm font-medium"},Ts={class:"text-xs text-r58-text-secondary"},Vs=["onClick"],Ps={key:1,class:"text-sm text-r58-text-secondary py-2"},Os={class:"hidden"},Us=["src","onLoad","onError"],Hs=X({__name:"CameraPushBar",setup(I){const p=ge(),o=M(new Map),i=M(!0),l=V(()=>p.inputs.filter(r=>r.hasSignal));function m(r){return Fe(r)}ce(l,r=>{for(const C of r)if(!o.value.has(C.id)){const O=m(C.id),R=Ee(C.id,O,C.label);o.value.set(C.id,{cameraId:C.id,label:C.label,status:"connecting",iframeSrc:R})}const g=new Set(r.map(C=>C.id));for(const[C]of o.value)g.has(C)||o.value.delete(C)},{immediate:!0});function S(r){const g=o.value.get(r);g&&(g.status="connected",console.log(`[CameraPush] ${r} connected to VDO.ninja`))}function d(r){const g=o.value.get(r);g&&(g.status="error",console.error(`[CameraPush] ${r} failed to connect`))}function a(r){const g=p.inputs.find(R=>R.id===r);if(!g||!g.hasSignal)return;const C=m(r),O=Ee(r,C,g.label);o.value.set(r,{cameraId:r,label:g.label,status:"connecting",iframeSrc:O+`&_t=${Date.now()}`})}function E(r){switch(r){case"connected":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function b(r){switch(r){case"connected":return"Live in VDO.ninja";case"connecting":return"Connecting...";case"error":return"Failed to connect";default:return"Idle"}}return(r,g)=>(t(),s("div",Is,[e("button",{onClick:g[0]||(g[0]=C=>i.value=!i.value),class:"w-full px-4 py-2 flex items-center justify-between text-sm hover:bg-r58-bg-tertiary/50 transition-colors","data-testid":"camera-push-toggle","aria-expanded":"expanded"},[e("div",Rs,[g[1]||(g[1]=e("span",{class:"font-medium"},"Camera Sources",-1)),e("span",Es,"("+y(l.value.length)+" active)",1)]),(t(),s("svg",{class:T(["w-4 h-4 transition-transform",{"rotate-180":i.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...g[2]||(g[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),i.value?(t(),s("div",Ds,[o.value.size>0?(t(),s("div",js,[(t(!0),s(F,null,W(o.value,([C,O])=>(t(),s("div",{key:C,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},[e("span",{class:T(["w-2 h-2 rounded-full",E(O.status)])},null,2),e("span",Ls,y(O.label),1),e("span",Ts,y(b(O.status)),1),O.status==="error"?(t(),s("button",{key:0,onClick:R=>a(C),class:"ml-2 text-xs text-r58-accent-primary hover:underline"}," Retry ",8,Vs)):j("",!0)]))),128))])):(t(),s("div",Ps," No cameras connected. Connect HDMI sources to push them to the mixer. "))])):j("",!0),e("div",Os,[(t(!0),s(F,null,W(o.value,([C,O])=>(t(),s("iframe",{key:C,src:O.iframeSrc,onLoad:R=>S(C),onError:R=>d(C),allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,Us))),128))])]))}}),As={class:"program-output space-y-3","data-testid":"program-output"},zs={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg","data-testid":"program-output-status"},Bs={class:"text-sm font-medium","data-testid":"program-output-text"},Ns={key:0,class:"space-y-2"},Fs={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},Ks={class:"flex-1 text-xs truncate text-r58-text-secondary"},Ws={key:0,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},Gs={class:"text-xs text-r58-text-secondary"},Ys={key:1,class:"text-xs text-r58-text-secondary px-3"},Js={class:"hidden"},qs=["src"],Xs=X({__name:"ProgramOutput",setup(I){const p=te(),o=ye(),i=M(!1),l=M("idle"),m=M("");function S(){return`${window.location.origin}/api/v1/whip/program/whip`}function d(){i.value||(l.value="connecting",m.value=Ke(S()),i.value=!0,console.log("[ProgramOutput] Starting WHIP push to MediaMTX"))}function a(){i.value&&(i.value=!1,m.value="",l.value="idle",console.log("[ProgramOutput] Stopped WHIP push"))}function E(){i.value&&(l.value="live",console.log("[ProgramOutput] WHIP push connected"))}function b(){l.value="error",console.error("[ProgramOutput] WHIP push failed")}function r(){a(),setTimeout(()=>d(),500)}ce(()=>p.isLive,R=>{R?d():a()});function g(){switch(l.value){case"live":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function C(){switch(l.value){case"live":return"MediaMTX connected";case"connecting":return"Connecting...";case"error":return"Connection failed";default:return"Inactive"}}function O(){const R=o.programOutputUrls.srt;navigator.clipboard.writeText(R),P.success("SRT URL copied")}return(R,x)=>(t(),s("div",As,[e("div",zs,[e("span",{class:T(["w-2 h-2 rounded-full",g()]),"data-testid":"program-output-indicator"},null,2),e("span",Bs,y(C()),1),l.value==="error"?(t(),s("button",{key:0,onClick:x[0]||(x[0]=u=>r()),class:"ml-auto text-xs text-r58-accent-primary hover:underline"}," Retry ")):j("",!0)]),l.value==="live"?(t(),s("div",Ns,[e("div",Fs,[x[1]||(x[1]=e("span",{class:"text-xs text-r58-text-secondary"},"ðŸ”´ SRT:",-1)),e("code",Ks,y(z(o).programOutputUrls.srt),1),e("button",{onClick:O,class:"text-xs text-r58-accent-primary hover:underline"},"Copy")]),z(o).enabledDestinations.length>0?(t(),s("div",Ws,[x[2]||(x[2]=e("span",{class:"w-2 h-2 rounded-full bg-emerald-500"},null,-1)),e("span",Gs,y(z(o).enabledDestinations.length)+" streaming destination"+y(z(o).enabledDestinations.length>1?"s":"")+" active ",1)])):j("",!0)])):j("",!0),l.value==="idle"?(t(),s("p",Ys," Program output will start automatically when you go live. ")):j("",!0),e("div",Js,[i.value&&m.value?(t(),s("iframe",{key:0,src:m.value,onLoad:E,onError:b,allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,qs)):j("",!0)])]))}}),Qs={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Zs={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl"},en={class:"p-6 overflow-y-auto max-h-[60vh]"},tn={class:"mb-8"},sn={class:"flex items-center justify-between mb-4"},nn={key:0,class:"mb-4 p-4 bg-r58-bg-tertiary rounded-lg"},on={class:"grid grid-cols-2 gap-2"},rn=["onClick"],an={class:"text-xl"},ln={key:1,class:"space-y-3"},dn=["onClick"],cn={class:"text-xl"},un={class:"flex-1"},vn={class:"font-medium"},mn={class:"text-xs text-r58-text-secondary"},pn=["onClick"],xn=["onClick"],gn={key:2,class:"text-r58-text-secondary text-sm"},bn={key:0,class:"mb-8 p-4 bg-r58-bg-tertiary rounded-lg"},fn={class:"text-lg font-medium mb-4"},yn={class:"space-y-4"},hn=["placeholder"],kn={key:0},wn={class:"flex gap-2"},_n={class:"mb-8"},Sn={class:"space-y-3"},$n={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Cn={class:"flex items-center justify-between mb-1"},Mn={class:"text-xs text-r58-text-secondary break-all"},In={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Rn={class:"flex items-center justify-between mb-1"},En={class:"text-xs text-r58-text-secondary break-all"},Dn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},jn={class:"flex items-center justify-between mb-1"},Ln={class:"text-xs text-r58-text-secondary break-all"},Tn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Vn={class:"flex items-center justify-between mb-1"},Pn={class:"text-xs text-r58-text-secondary break-all"},On={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Un={class:"flex items-center justify-between mb-1"},Hn={class:"text-xs text-r58-text-secondary break-all"},An={class:"p-4 bg-r58-bg-tertiary rounded-lg"},zn={class:"flex items-center gap-3 mb-4"},Bn=X({__name:"StreamingSettings",setup(I,{expose:p}){const o=ye(),i=M(!1),l=M(null),m=M(!1);M(""),M("");const S=V(()=>o.destinations),d=V(()=>le),a=V(()=>o.programOutputUrls);function E(){i.value=!0}function b(){i.value=!1,l.value=null,m.value=!1}function r(f){const n=o.addDestination(f);l.value=n,m.value=!1,o.saveDestinations()}function g(){l.value&&(o.updateDestination(l.value.id,l.value),o.saveDestinations(),l.value=null,P.success("Streaming destination saved"))}function C(f){o.removeDestination(f),o.saveDestinations(),P.info("Destination removed")}function O(f){o.updateDestination(f.id,{enabled:!f.enabled}),o.saveDestinations()}function R(f,n){navigator.clipboard.writeText(f),P.success(`${n} copied to clipboard`)}function x(f){const n=le.find(_=>_.id===f);return(n==null?void 0:n.icon)||"ðŸ“¡"}function u(f){const n=le.find(_=>_.id===f);return(n==null?void 0:n.name)||"Unknown"}return p({open:E}),(f,n)=>{var _;return t(),ue(fe,{to:"body"},[i.value?(t(),s("div",Qs,[e("div",{class:"absolute inset-0 bg-black/60",onClick:b}),e("div",Zs,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[n[11]||(n[11]=e("h2",{class:"text-xl font-semibold"},"Streaming Settings",-1)),e("button",{onClick:b,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",en,[e("section",tn,[e("div",sn,[n[12]||(n[12]=e("h3",{class:"text-lg font-medium"},"Streaming Destinations",-1)),e("button",{onClick:n[0]||(n[0]=h=>m.value=!m.value),class:"btn btn-sm btn-primary"}," + Add Platform ")]),m.value?(t(),s("div",nn,[n[13]||(n[13]=e("p",{class:"text-sm text-r58-text-secondary mb-3"},"Select a streaming platform:",-1)),e("div",on,[(t(!0),s(F,null,W(d.value,h=>(t(),s("button",{key:h.id,onClick:H=>r(h.id),class:"flex items-center gap-2 p-3 bg-r58-bg-secondary hover:bg-r58-accent-primary/20 rounded-lg transition-colors text-left"},[e("span",an,y(h.icon),1),e("span",null,y(h.name),1)],8,rn))),128))])])):j("",!0),S.value.length>0?(t(),s("div",ln,[(t(!0),s(F,null,W(S.value,h=>(t(),s("div",{key:h.id,class:"flex items-center gap-3 p-3 bg-r58-bg-tertiary rounded-lg"},[e("button",{onClick:H=>O(h),class:T(["w-10 h-6 rounded-full transition-colors relative",h.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:T(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",h.enabled?"left-5":"left-1"])},null,2)],10,dn),e("span",cn,y(x(h.platformId)),1),e("div",un,[e("div",vn,y(h.name),1),e("div",mn,y(h.streamKey?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"+h.streamKey.slice(-4):"No stream key"),1)]),e("button",{onClick:H=>l.value={...h},class:"text-r58-accent-primary hover:underline text-sm"}," Edit ",8,pn),e("button",{onClick:H=>C(h.id),class:"text-r58-accent-danger hover:underline text-sm"}," Remove ",8,xn)]))),128))])):(t(),s("p",gn," No streaming destinations configured. Add a platform above. "))]),l.value?(t(),s("section",bn,[e("h3",fn," Edit "+y(u(l.value.platformId)),1),e("div",yn,[e("div",null,[n[14]||(n[14]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Display Name",-1)),G(e("input",{"onUpdate:modelValue":n[1]||(n[1]=h=>l.value.name=h),type:"text",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[se,l.value.name]])]),e("div",null,[n[15]||(n[15]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Stream Key",-1)),G(e("input",{"onUpdate:modelValue":n[2]||(n[2]=h=>l.value.streamKey=h),type:"password",placeholder:(_=z(le).find(h=>h.id===l.value.platformId))==null?void 0:_.streamKeyPlaceholder,class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,8,hn),[[se,l.value.streamKey]]),n[16]||(n[16]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Your stream key is stored locally and never sent to our servers. ",-1))]),l.value.platformId==="custom"?(t(),s("div",kn,[n[17]||(n[17]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"RTMP URL",-1)),G(e("input",{"onUpdate:modelValue":n[3]||(n[3]=h=>l.value.name=h),type:"text",placeholder:"rtmp://your-server.com/live/",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,512),[[se,l.value.name]])])):j("",!0),e("div",wn,[e("button",{onClick:g,class:"btn btn-primary"}," Save "),e("button",{onClick:n[4]||(n[4]=h=>l.value=null),class:"btn"}," Cancel ")])])])):j("",!0),e("section",_n,[n[26]||(n[26]=e("h3",{class:"text-lg font-medium mb-4"},"Program Output URLs",-1)),n[27]||(n[27]=e("p",{class:"text-sm text-r58-text-secondary mb-4"}," Use these URLs to consume the program feed from MediaMTX: ",-1)),e("div",Sn,[e("div",$n,[e("div",Cn,[n[18]||(n[18]=e("span",{class:"font-medium"},"ðŸ”´ SRT Output",-1)),e("button",{onClick:n[5]||(n[5]=h=>R(a.value.srt,"SRT URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Mn,y(a.value.srt),1),n[19]||(n[19]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Low-latency, reliable transport. Ideal for remote production. ",-1))]),e("div",In,[e("div",Rn,[n[20]||(n[20]=e("span",{class:"font-medium"},"ðŸ“º RTMP Output",-1)),e("button",{onClick:n[6]||(n[6]=h=>R(a.value.rtmp,"RTMP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",En,y(a.value.rtmp),1)]),e("div",Dn,[e("div",jn,[n[21]||(n[21]=e("span",{class:"font-medium"},"ðŸŽ¬ RTSP Output",-1)),e("button",{onClick:n[7]||(n[7]=h=>R(a.value.rtsp,"RTSP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Ln,y(a.value.rtsp),1)]),e("div",Tn,[e("div",Vn,[n[22]||(n[22]=e("span",{class:"font-medium"},"ðŸŒ HLS Output",-1)),e("button",{onClick:n[8]||(n[8]=h=>R(a.value.hls,"HLS URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Pn,y(a.value.hls),1),n[23]||(n[23]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Browser-compatible streaming. Higher latency. ",-1))]),e("div",On,[e("div",Un,[n[24]||(n[24]=e("span",{class:"font-medium"},"âš¡ WebRTC (WHEP)",-1)),e("button",{onClick:n[9]||(n[9]=h=>R(a.value.whep,"WHEP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Hn,y(a.value.whep),1),n[25]||(n[25]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Ultra-low latency WebRTC. Best for interactive use. ",-1))])])]),e("section",null,[n[30]||(n[30]=e("h3",{class:"text-lg font-medium mb-4"},"SRT Configuration",-1)),e("div",An,[e("div",zn,[e("button",{onClick:n[10]||(n[10]=h=>z(o).toggleSrtOutput(!z(o).srtOutput.enabled)),class:T(["w-10 h-6 rounded-full transition-colors relative",z(o).srtOutput.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:T(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",z(o).srtOutput.enabled?"left-5":"left-1"])},null,2)],2),n[28]||(n[28]=e("span",null,"Enable SRT Output",-1))]),n[29]||(n[29]=e("div",{class:"text-sm text-r58-text-secondary"},[e("p",{class:"mb-2"},"SRT (Secure Reliable Transport) provides:"),e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Low latency (typically 1-2 seconds)"),e("li",null,"Error correction for unreliable networks"),e("li",null,"AES encryption support"),e("li",null,"Compatible with OBS, vMix, and professional equipment")])],-1))])])]),e("div",{class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},[e("button",{onClick:b,class:"btn"},"Close")])])])):j("",!0)])}}}),Nn={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Fn={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-3xl max-h-[80vh] overflow-hidden shadow-2xl","data-testid":"hotkey-settings-modal"},Kn={class:"flex border-b border-r58-bg-tertiary"},Wn=["onClick"],Gn={class:"p-6 overflow-y-auto max-h-[55vh]"},Yn={key:0,class:"text-center py-12 text-r58-text-secondary"},Jn={key:1,class:"space-y-6"},qn={class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},Xn={class:"space-y-2"},Qn={class:"flex-1"},Zn={class:"text-sm"},eo={key:0,class:"ml-2 text-xs text-r58-accent-primary"},to={class:"flex items-center gap-2"},so={key:0,class:"flex items-center gap-2"},no={key:0,class:"px-3 py-1 bg-r58-accent-primary text-white rounded text-sm font-mono"},oo={key:1,class:"text-sm text-r58-text-secondary animate-pulse"},ro={class:"px-3 py-1 bg-r58-bg-secondary border border-r58-bg-tertiary rounded text-sm font-mono"},io=["onClick"],ao=["onClick"],Te="r58-hotkey-customizations",lo=X({__name:"HotkeySettings",setup(I,{expose:p}){const o=[{id:"help",key:"?",modifiers:["shift"],description:"Show keyboard shortcuts",context:"global",category:"Navigation",editable:!1},{id:"goto-recorder",key:"r",modifiers:["alt"],description:"Go to Recorder",context:"global",category:"Navigation",editable:!0},{id:"goto-mixer",key:"m",modifiers:["alt"],description:"Go to Mixer",context:"global",category:"Navigation",editable:!0},{id:"escape",key:"Escape",description:"Close modal / Cancel",context:"global",category:"Navigation",editable:!1},{id:"scene-1",key:"1",description:"Select Scene 1 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-2",key:"2",description:"Select Scene 2 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-3",key:"3",description:"Select Scene 3 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-4",key:"4",description:"Select Scene 4 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-5",key:"5",description:"Select Scene 5 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-6",key:"6",description:"Select Scene 6 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-7",key:"7",description:"Select Scene 7 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-8",key:"8",description:"Select Scene 8 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"take",key:" ",description:"TAKE - Transition preview to program",context:"mixer",category:"Transitions",editable:!1},{id:"cut",key:"Escape",description:"CUT - Immediate switch to preview",context:"mixer",category:"Transitions",editable:!1},{id:"transition-cut",key:"t",description:"Set transition: Cut",context:"mixer",category:"Transitions",editable:!0},{id:"transition-fade",key:"f",description:"Set transition: Fade",context:"mixer",category:"Transitions",editable:!0},{id:"go-live",key:"g",description:"Toggle Go Live",context:"mixer",category:"Control",editable:!0},{id:"toggle-recording",key:"r",description:"Toggle recording",context:"mixer",category:"Control",editable:!0},{id:"mute-all",key:"m",modifiers:["ctrl"],description:"Mute all sources",context:"mixer",category:"Control",editable:!0},{id:"toggle-sidebar",key:"s",modifiers:["ctrl"],description:"Toggle sidebar",context:"mixer",category:"Control",editable:!0},{id:"mute-1",key:"F1",description:"Toggle mute: Source 1",context:"mixer",category:"Audio",editable:!0},{id:"mute-2",key:"F2",description:"Toggle mute: Source 2",context:"mixer",category:"Audio",editable:!0},{id:"mute-3",key:"F3",description:"Toggle mute: Source 3",context:"mixer",category:"Audio",editable:!0},{id:"mute-4",key:"F4",description:"Toggle mute: Source 4",context:"mixer",category:"Audio",editable:!0},{id:"start-stop-recording",key:" ",description:"Start/Stop recording",context:"recorder",category:"Recording",editable:!0},{id:"mark-chapter",key:"c",description:"Mark chapter point",context:"recorder",category:"Recording",editable:!0},{id:"select-all",key:"a",modifiers:["ctrl"],description:"Select all cameras",context:"recorder",category:"Recording",editable:!0}],i=M(!1),l=M("mixer"),m=M({}),S=M(null),d=M(null);function a(){try{const c=localStorage.getItem(Te);c&&(m.value=JSON.parse(c))}catch(c){console.warn("[HotkeySettings] Failed to load customizations:",c)}}function E(){try{localStorage.setItem(Te,JSON.stringify(m.value))}catch(c){console.warn("[HotkeySettings] Failed to save customizations:",c)}}function b(c){const k=m.value[c.id];return k?{...c,key:k.key,modifiers:k.modifiers}:c}const r=V(()=>{const c={global:{},mixer:{},recorder:{}};for(const k of o){const B=b(k);c[k.context][B.category]||(c[k.context][B.category]=[]),c[k.context][B.category].push(B)}return c}),g=V(()=>r.value[l.value]||{});function C(c){return Ie(c.key,c.modifiers)}function O(c){return!!m.value[c]}function R(c){const k=o.find(B=>B.id===c);k!=null&&k.editable&&(S.value=c,d.value=null,document.addEventListener("keydown",x))}function x(c){if(c.preventDefault(),c.stopPropagation(),["Control","Alt","Shift","Meta"].includes(c.key))return;const k=[];c.ctrlKey&&k.push("ctrl"),c.altKey&&k.push("alt"),c.shiftKey&&k.push("shift"),c.metaKey&&k.push("meta"),d.value={key:c.key,modifiers:k},document.removeEventListener("keydown",x)}function u(){!S.value||!d.value||(m.value[S.value]={key:d.value.key,modifiers:d.value.modifiers.length>0?d.value.modifiers:void 0},E(),P.success("Hotkey updated"),S.value=null,d.value=null)}function f(){S.value=null,d.value=null,document.removeEventListener("keydown",x)}function n(c){delete m.value[c],E(),P.info("Hotkey reset to default")}function _(){confirm("Reset all hotkeys to defaults?")&&(m.value={},E(),P.info("All hotkeys reset to defaults"))}function h(){a(),i.value=!0}function H(){f(),i.value=!1}me(()=>{a()});function $(){return{...m.value}}return p({open:h,getCustomBindings:$}),(c,k)=>(t(),ue(fe,{to:"body"},[i.value?(t(),s("div",Nn,[e("div",{class:"absolute inset-0 bg-black/60",onClick:H}),e("div",Fn,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[k[0]||(k[0]=e("h2",{class:"text-xl font-semibold"},"Keyboard Shortcuts",-1)),e("div",{class:"flex items-center gap-4"},[e("button",{onClick:_,class:"text-sm text-r58-text-secondary hover:text-r58-text-primary"}," Reset All "),e("button",{onClick:H,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")])]),e("div",Kn,[(t(),s(F,null,W(["mixer","global","recorder"],B=>e("button",{key:B,onClick:ee=>l.value=B,class:T(["px-6 py-3 text-sm font-medium capitalize transition-colors",l.value===B?"text-r58-accent-primary border-b-2 border-r58-accent-primary":"text-r58-text-secondary hover:text-r58-text-primary"])},y(B),11,Wn)),64))]),e("div",Gn,[Object.keys(g.value).length===0?(t(),s("div",Yn," No shortcuts defined for this context. ")):(t(),s("div",Jn,[(t(!0),s(F,null,W(g.value,(B,ee)=>(t(),s("div",{key:ee},[e("h3",qn,y(ee),1),e("div",Xn,[(t(!0),s(F,null,W(B,Y=>(t(),s("div",{key:Y.id,class:T(["flex items-center justify-between p-3 bg-r58-bg-tertiary rounded-lg",{"ring-2 ring-r58-accent-primary":S.value===Y.id}])},[e("div",Qn,[e("span",Zn,y(Y.description),1),O(Y.id)?(t(),s("span",eo,"(customized)")):j("",!0)]),e("div",to,[S.value===Y.id?(t(),s("div",so,[d.value?(t(),s("kbd",no,y(z(Ie)(d.value.key,d.value.modifiers)),1)):(t(),s("span",oo," Press a key... ")),d.value?(t(),s("button",{key:2,onClick:u,class:"btn btn-sm btn-primary"}," Save ")):j("",!0),e("button",{onClick:f,class:"btn btn-sm"}," Cancel ")])):(t(),s(F,{key:1},[e("kbd",ro,y(C(Y)),1),Y.editable?(t(),s("button",{key:0,onClick:U=>R(Y.id),class:"text-xs text-r58-accent-primary hover:underline"}," Edit ",8,io)):j("",!0),O(Y.id)?(t(),s("button",{key:1,onClick:U=>n(Y.id),class:"text-xs text-r58-text-secondary hover:text-r58-accent-danger"}," Reset ",8,ao)):j("",!0)],64))])],2))),128))])]))),128))]))]),e("div",{class:"flex items-center justify-between px-6 py-4 border-t border-r58-bg-tertiary"},[k[1]||(k[1]=e("div",{class:"text-sm text-r58-text-secondary"},' Click "Edit" to customize a shortcut. Press any key combination to set. ',-1)),e("button",{onClick:H,class:"btn"},"Close")])])])):j("",!0)]))}}),co={class:"connection-status","data-testid":"connection-status"},uo={class:"text-xs text-r58-text-secondary"},vo={key:0,class:"text-xs text-r58-accent-danger",title:"Click for details"},mo={key:0,class:"mt-2 p-3 bg-r58-bg-tertiary rounded-lg text-xs space-y-2"},po={class:"grid grid-cols-2 gap-2"},xo={class:"ml-1 font-medium"},go={class:"ml-1"},bo={class:"ml-1"},fo={key:0,class:"p-2 bg-r58-accent-danger/10 border border-r58-accent-danger/30 rounded text-r58-accent-danger"},yo={class:"flex gap-2 pt-2 border-t border-r58-bg-tertiary"},ho=["disabled"],ko={key:1,class:"text-r58-text-secondary text-center"},wo=X({__name:"ConnectionStatus",props:{vdoEmbed:{}},setup(I){const p=I;te();const o=M(!1),i=M("never"),l=M(0),m=M(!1),S=V(()=>{var f,n;return((n=(f=p.vdoEmbed)==null?void 0:f.connectionState)==null?void 0:n.value)||"disconnected"}),d=V(()=>{var f,n;return((n=(f=p.vdoEmbed)==null?void 0:f.isReady)==null?void 0:n.value)||!1}),a=V(()=>{var f,n;return((n=(f=p.vdoEmbed)==null?void 0:f.lastError)==null?void 0:n.value)||null}),E=V(()=>S.value==="disconnected"||!d.value?"disconnected":a.value?"error":S.value==="connecting"?"degraded":"healthy"),b=V(()=>{switch(E.value){case"healthy":return"bg-r58-accent-success";case"degraded":return"bg-amber-500";case"error":return"bg-r58-accent-danger";case"disconnected":return"bg-r58-text-secondary";default:return"bg-r58-text-secondary"}}),r=V(()=>{switch(E.value){case"healthy":return"Connected";case"degraded":return"Connecting...";case"error":return"Error";case"disconnected":return"Disconnected";default:return"Unknown"}});let g=null;function C(){if(p.vdoEmbed){const f=p.vdoEmbed.getEventStats();if(f.lastActivity){const n=Date.now()-f.lastActivity;n<1e3?i.value="just now":n<6e4?i.value=`${Math.floor(n/1e3)}s ago`:n<36e5?i.value=`${Math.floor(n/6e4)}m ago`:i.value="over 1h ago"}}}me(()=>{C(),g=window.setInterval(C,1e3)}),pe(()=>{g&&clearInterval(g)});async function O(){if(!m.value){m.value=!0,l.value++,P.info("Attempting to reconnect...");try{p.vdoEmbed&&p.vdoEmbed.sendCommand("ping"),await new Promise(f=>setTimeout(f,2e3)),d.value&&!a.value?(P.success("Reconnected successfully"),l.value=0):P.error("Reconnection failed. Try refreshing the page.")}catch(f){P.error("Reconnection error"),console.error("[ConnectionStatus] Reconnect error:",f)}finally{m.value=!1}}}function R(){confirm("This will refresh the page and may interrupt active streams. Continue?")&&window.location.reload()}function x(){o.value=!o.value}const u=V(()=>p.vdoEmbed?p.vdoEmbed.getEventStats():{total:0,incoming:0,outgoing:0,lastActivity:null});return(f,n)=>(t(),s("div",co,[e("div",{class:"flex items-center gap-2 cursor-pointer",onClick:x},[e("span",{class:T(["w-2 h-2 rounded-full",[b.value,{"animate-pulse":E.value==="degraded"}]]),"data-testid":"status-indicator"},null,2),e("span",uo,y(r.value),1),a.value?(t(),s("span",vo," âš ï¸ ")):j("",!0),(t(),s("svg",{class:T(["w-3 h-3 text-r58-text-secondary transition-transform",{"rotate-180":o.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...n[0]||(n[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),o.value?(t(),s("div",mo,[e("div",po,[e("div",null,[n[1]||(n[1]=e("span",{class:"text-r58-text-secondary"},"VDO.ninja:",-1)),e("span",{class:T(["ml-1 font-medium",d.value?"text-r58-accent-success":"text-r58-accent-danger"])},y(d.value?"Ready":"Not Ready"),3)]),e("div",null,[n[2]||(n[2]=e("span",{class:"text-r58-text-secondary"},"State:",-1)),e("span",xo,y(S.value),1)]),e("div",null,[n[3]||(n[3]=e("span",{class:"text-r58-text-secondary"},"Last activity:",-1)),e("span",go,y(i.value),1)]),e("div",null,[n[4]||(n[4]=e("span",{class:"text-r58-text-secondary"},"Events:",-1)),e("span",bo,y(u.value.total),1)])]),a.value?(t(),s("div",fo,[n[5]||(n[5]=e("strong",null,"Error:",-1)),q(" "+y(a.value),1)])):j("",!0),e("div",yo,[e("button",{onClick:O,disabled:m.value,class:T(["btn btn-sm flex-1",{"opacity-50":m.value}])},y(m.value?"Reconnecting...":"ðŸ”„ Reconnect"),11,ho),e("button",{onClick:R,class:"btn btn-sm",title:"Refresh the page (last resort)"}," ðŸ”ƒ Refresh ")]),l.value>0?(t(),s("div",ko," Reconnect attempts: "+y(l.value),1)):j("",!0)])):j("",!0)]))}}),_o={class:"recording-controls space-y-3","data-testid":"recording-controls"},So={class:"flex items-center gap-3 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},$o={class:"text-sm font-medium flex-1","data-testid":"recording-status"},Co={key:0,class:"text-lg font-mono font-bold text-r58-accent-danger","data-testid":"recording-duration"},Mo=["disabled"],Io={key:0,class:"px-3 py-2 bg-r58-accent-success/10 border border-r58-accent-success/30 rounded-lg"},Ro={class:"flex items-center justify-between"},Eo=["href"],Do=X({__name:"RecordingControls",props:{vdoEmbed:{}},setup(I){const p=I,o=M(!1),i=M(null),l=M(0),m=M(null),S=M(!1);ce(()=>{var x,u;return(u=(x=p.vdoEmbed)==null?void 0:x.isRecording)==null?void 0:u.value},x=>{x!==void 0&&(o.value=x,x&&!i.value?i.value=Date.now():!x&&i.value&&(i.value=null))});let d=null;function a(){d&&clearInterval(d),d=window.setInterval(()=>{i.value&&(l.value=Date.now()-i.value)},100)}function E(){d&&(clearInterval(d),d=null)}me(()=>{a()}),pe(()=>{E()});const b=V(()=>{const x=Math.floor(l.value/1e3),u=Math.floor(x/3600),f=Math.floor(x%3600/60),n=x%60;return u>0?`${u}:${f.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`:`${f}:${n.toString().padStart(2,"0")}`});async function r(){if(!p.vdoEmbed){P.error("VDO.ninja not connected");return}S.value=!0;try{p.vdoEmbed.startRecording(),o.value=!0,i.value=Date.now(),l.value=0,m.value=null,P.success("Recording started")}catch(x){P.error("Failed to start recording"),console.error("[RecordingControls] Start recording error:",x)}finally{S.value=!1}}async function g(){if(!p.vdoEmbed){P.error("VDO.ninja not connected");return}S.value=!0;try{p.vdoEmbed.stopRecording(),o.value=!1,i.value=null,P.success(`Recording stopped (${b.value})`)}catch(x){P.error("Failed to stop recording"),console.error("[RecordingControls] Stop recording error:",x)}finally{S.value=!1}}function C(){o.value?g():r()}function O(){return o.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"}function R(){return S.value?"Processing...":o.value?`Recording â€¢ ${b.value}`:"Ready to record"}return(x,u)=>(t(),s("div",_o,[e("div",So,[e("span",{class:T(["w-3 h-3 rounded-full",O()]),"data-testid":"recording-indicator"},null,2),e("span",$o,y(R()),1),o.value?(t(),s("span",Co,y(b.value),1)):j("",!0)]),e("div",null,[e("button",{onClick:C,disabled:S.value,class:T(["btn w-full justify-center",o.value?"btn-danger":"btn-primary"]),"data-testid":"recording-toggle-button"},[S.value?(t(),s(F,{key:0},[u[0]||(u[0]=e("svg",{class:"animate-spin w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),u[1]||(u[1]=q(" Processing... ",-1))],64)):o.value?(t(),s(F,{key:1},[u[2]||(u[2]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("rect",{x:"6",y:"6",width:"12",height:"12",rx:"1"})],-1)),u[3]||(u[3]=q(" Stop Recording ",-1))],64)):(t(),s(F,{key:2},[u[4]||(u[4]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("circle",{cx:"12",cy:"12",r:"8"})],-1)),u[5]||(u[5]=q(" Start Recording ",-1))],64))],10,Mo)]),m.value?(t(),s("div",Io,[e("div",Ro,[u[6]||(u[6]=e("span",{class:"text-sm text-r58-accent-success"},"Recording ready!",-1)),e("a",{href:m.value,download:"",class:"text-sm text-r58-accent-primary hover:underline"}," Download ",8,Eo)])])):j("",!0),u[7]||(u[7]=e("p",{class:"text-xs text-r58-text-secondary px-1"}," Records the mixed output locally in your browser. Recording is saved when stopped. ",-1))]))}}),jo=ie(Do,[["__scopeId","data-v-14707e66"]]),Lo={class:"audio-mixer space-y-4","data-testid":"audio-mixer"},To={class:"master-volume p-3 bg-r58-bg-tertiary rounded-lg"},Vo={class:"flex items-center justify-between mb-2"},Po={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Oo={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Uo=["value"],Ho={class:"text-xs text-r58-text-secondary text-center mt-1"},Ao={key:0,class:"space-y-2"},zo={class:"flex items-center gap-2 mb-2"},Bo={class:"text-xs font-medium truncate flex-1"},No=["onClick"],Fo=["onClick"],Ko={class:"h-1.5 bg-r58-bg-secondary rounded-full overflow-hidden mb-2"},Wo=["value","onInput","disabled"],Go={key:1,class:"text-center py-4 text-r58-text-secondary"},Yo=X({__name:"AudioMixer",props:{vdoEmbed:{}},setup(I){const p=I,o=te(),i=V(()=>o.connectedSources.filter(b=>b.hasAudio));function l(b,r){var g,C;o.setSourceVolume(b.id,r),p.vdoEmbed&&((C=(g=p.vdoEmbed).setVolume)==null||C.call(g,b.id,r))}function m(b){var g,C;const r=!b.muted;o.setSourceMute(b.id,r),p.vdoEmbed&&((C=(g=p.vdoEmbed).setMute)==null||C.call(g,b.id,r))}function S(b){var g,C;const r=!b.solo;o.setSourceSolo(b.id,r),p.vdoEmbed&&r&&((C=(g=p.vdoEmbed).sendCommand)==null||C.call(g,"soloChat",b.id))}function d(){o.setMasterMuted(!o.masterMuted)}function a(b){o.setMasterVolume(b)}function E(b){return b>80?"bg-red-500":b>60?"bg-amber-500":"bg-emerald-500"}return(b,r)=>(t(),s("div",Lo,[e("div",To,[e("div",Vo,[r[3]||(r[3]=e("span",{class:"text-xs font-medium"},"Master",-1)),e("button",{onClick:d,class:T(["p-1 rounded hover:bg-r58-bg-secondary transition-colors",{"text-red-400":z(o).masterMuted}])},[z(o).masterMuted?(t(),s("svg",Po,[...r[1]||(r[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(t(),s("svg",Oo,[...r[2]||(r[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],2)]),e("input",{type:"range",value:z(o).masterVolume,onInput:r[0]||(r[0]=g=>a(g.target.valueAsNumber)),min:"0",max:"100",class:"w-full h-2 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary"},null,40,Uo),e("div",Ho,y(z(o).masterVolume)+"% ",1)]),i.value.length>0?(t(),s("div",Ao,[(t(!0),s(F,null,W(i.value,g=>(t(),s("div",{key:g.id,class:"source-channel p-2 bg-r58-bg-tertiary/50 rounded-lg"},[e("div",zo,[e("span",Bo,y(g.label),1),e("button",{onClick:C=>S(g),class:T(["w-6 h-6 text-xs font-bold rounded transition-colors",g.solo?"bg-amber-500 text-black":"bg-r58-bg-secondary text-r58-text-secondary hover:text-r58-text-primary"]),title:"Solo"}," S ",10,No),e("button",{onClick:C=>m(g),class:T(["w-6 h-6 text-xs font-bold rounded transition-colors",g.muted?"bg-red-500 text-white":"bg-r58-bg-secondary text-r58-text-secondary hover:text-r58-text-primary"]),title:"Mute"}," M ",10,Fo)]),e("div",Ko,[e("div",{class:T(["h-full transition-all duration-75 rounded-full",g.muted?"bg-r58-bg-tertiary":E(g.audioLevel)]),style:de({width:`${g.audioLevel}%`})},null,6)]),e("input",{type:"range",value:g.volume||100,onInput:C=>l(g,C.target.valueAsNumber),min:"0",max:"100",disabled:g.muted,class:"w-full h-1.5 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary disabled:opacity-50"},null,40,Wo)]))),128))])):(t(),s("div",Go,[...r[4]||(r[4]=[e("svg",{class:"w-6 h-6 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})],-1),e("p",{class:"text-xs"},"No audio sources",-1)])]))]))}}),Jo=ie(Yo,[["__scopeId","data-v-eb570d28"]]),qo={class:"transition-settings space-y-3","data-testid":"transition-settings"},Xo={class:"grid grid-cols-3 gap-1"},Qo=["onClick"],Zo={class:"block text-sm mb-0.5"},er=["disabled"],tr=["value"],sr={class:"p-3 bg-r58-bg-tertiary rounded-lg"},nr={class:"flex items-center justify-between text-xs"},or={class:"font-mono"},rr={key:0},ir=X({__name:"TransitionSettings",setup(I){const p=te(),o=V({get:()=>p.transition.type,set:d=>p.setTransition({type:d})}),i=V({get:()=>p.transition.duration,set:d=>p.setTransition({duration:d})}),l=[{value:"cut",label:"Cut",icon:"âš¡"},{value:"fade",label:"Fade",icon:"ðŸŒ«ï¸"},{value:"wipe-left",label:"Wipe L",icon:"â—€"},{value:"wipe-right",label:"Wipe R",icon:"â–¶"},{value:"wipe-up",label:"Wipe Up",icon:"â–²"},{value:"wipe-down",label:"Wipe Down",icon:"â–¼"}],m=[{value:0,label:"0ms"},{value:100,label:"100ms"},{value:300,label:"300ms"},{value:500,label:"500ms"},{value:750,label:"750ms"},{value:1e3,label:"1s"},{value:2e3,label:"2s"}];function S(d){p.setTransition({type:d})}return(d,a)=>{var E;return t(),s("div",qo,[e("div",Xo,[(t(),s(F,null,W(l,b=>e("button",{key:b.value,onClick:r=>S(b.value),class:T(["px-2 py-2 text-xs rounded transition-colors text-center",o.value===b.value?"bg-r58-accent-primary text-white":"bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 text-r58-text-secondary"])},[e("span",Zo,y(b.icon),1),q(" "+y(b.label),1)],10,Qo)),64))]),e("div",null,[a[1]||(a[1]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Duration",-1)),G(e("select",{"onUpdate:modelValue":a[0]||(a[0]=b=>i.value=b),class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none",disabled:o.value==="cut"},[(t(),s(F,null,W(m,b=>e("option",{key:b.value,value:b.value},y(b.label),9,tr)),64))],8,er),[[_e,i.value,void 0,{number:!0}]])]),e("div",sr,[e("div",nr,[a[2]||(a[2]=e("span",{class:"text-r58-text-secondary"},"Current:",-1)),e("span",or,[q(y((E=l.find(b=>b.value===o.value))==null?void 0:E.label)+" ",1),o.value!=="cut"?(t(),s("span",rr," ("+y(i.value)+"ms)",1)):j("",!0)])])]),a[3]||(a[3]=e("p",{class:"text-xs text-r58-text-secondary"},[q(" Press "),e("kbd",{class:"px-1 py-0.5 bg-r58-bg-tertiary rounded"},"Space"),q(" to Take with transition ")],-1))])}}}),ar={class:"invite-links space-y-3","data-testid":"invite-links"},lr={key:0,class:"space-y-2"},dr={class:"p-2 bg-r58-bg-tertiary rounded-lg"},cr={class:"text-xs text-r58-text-secondary break-all block"},ur={key:1,class:"space-y-2 p-3 bg-r58-bg-tertiary rounded-lg"},vr={class:"flex items-center gap-2 text-xs"},mr={class:"flex items-center gap-2 text-xs"},pr={key:2,class:"text-center"},xr={key:0,class:"mt-2 flex justify-center"},gr=["src"],br={class:"text-xs text-r58-text-secondary text-center"},fr={class:"font-mono"},yr=X({__name:"InviteLinks",setup(I){const p=M(""),o=M(!1),i=M(!0),l=M(!0),m=V(()=>p.value.trim()?We(p.value.trim()):"");function S(){if(!m.value){P.error("Enter a guest name first");return}navigator.clipboard.writeText(m.value),P.success("Invite link copied!")}function d(){if(!m.value){P.error("Enter a guest name first");return}window.open(m.value,"_blank")}async function a(){if(!m.value){P.error("Enter a guest name first");return}if(navigator.share)try{await navigator.share({title:`Join ${De} as ${p.value}`,text:`Click to join the video call as ${p.value}`,url:m.value})}catch(b){b.name!=="AbortError"&&S()}else S()}const E=V(()=>m.value?`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(m.value)}`:"");return(b,r)=>(t(),s("div",ar,[e("div",null,[r[5]||(r[5]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Guest Name",-1)),G(e("input",{"onUpdate:modelValue":r[0]||(r[0]=g=>p.value=g),type:"text",placeholder:"e.g., John Smith",class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[se,p.value]])]),m.value?(t(),s("div",lr,[e("div",dr,[e("code",cr,y(m.value),1)]),e("div",{class:"flex gap-2"},[e("button",{onClick:S,class:"flex-1 btn btn-sm btn-primary"},[...r[6]||(r[6]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})],-1),q(" Copy ",-1)])]),e("button",{onClick:a,class:"btn btn-sm",title:"Share"},[...r[7]||(r[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})],-1)])]),e("button",{onClick:d,class:"btn btn-sm",title:"Open in new tab"},[...r[8]||(r[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)])])])])):j("",!0),e("button",{onClick:r[1]||(r[1]=g=>o.value=!o.value),class:"w-full text-xs text-r58-text-secondary hover:text-r58-text-primary flex items-center justify-center gap-1"},[e("span",null,y(o.value?"Hide":"Show")+" options",1),(t(),s("svg",{class:T(["w-3 h-3 transition-transform",{"rotate-180":o.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[9]||(r[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),o.value?(t(),s("div",ur,[e("label",vr,[G(e("input",{type:"checkbox","onUpdate:modelValue":r[2]||(r[2]=g=>i.value=g),class:"rounded"},null,512),[[Re,i.value]]),r[10]||(r[10]=e("span",null,"Enable video",-1))]),e("label",mr,[G(e("input",{type:"checkbox","onUpdate:modelValue":r[3]||(r[3]=g=>l.value=g),class:"rounded"},null,512),[[Re,l.value]]),r[11]||(r[11]=e("span",null,"Enable audio",-1))])])):j("",!0),m.value&&E.value?(t(),s("div",pr,[e("button",{onClick:r[4]||(r[4]=g=>o.value=!o.value),class:"text-xs text-r58-text-secondary hover:text-r58-text-primary"}," Show QR Code "),o.value?(t(),s("div",xr,[e("img",{src:E.value,alt:"QR Code",class:"w-32 h-32 bg-white p-2 rounded"},null,8,gr)])):j("",!0)])):j("",!0),e("div",br,[r[12]||(r[12]=q(" Room: ",-1)),e("span",fr,y(z(De)),1)])]))}}),hr={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},kr={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-2xl"},wr={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},_r={class:"text-xl font-semibold"},Sr={class:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},$r={class:"flex gap-6"},Cr={class:"flex-1"},Mr={class:"mb-4"},Ir={class:"mb-4"},Rr={class:"flex gap-2 flex-wrap"},Er=["onClick"],Dr={class:"mb-4"},jr={id:"scene-canvas",class:"relative aspect-video bg-black rounded-lg overflow-hidden border border-r58-bg-tertiary"},Lr=["onMousedown","onClick"],Tr={class:"absolute inset-0 flex items-center justify-center text-xs text-r58-text-secondary"},Vr=["onMousedown"],Pr=["onClick"],Or={class:"w-64 flex-shrink-0"},Ur={key:0,class:"space-y-4"},Hr=["value"],Ar=["value"],zr={class:"grid grid-cols-2 gap-2"},Br={key:1,class:"text-sm text-r58-text-secondary p-4 bg-r58-bg-tertiary rounded-lg"},Nr={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},Fr=X({__name:"SceneEditor",setup(I,{expose:p}){const o=ve(),i=te(),l=M(!1),m=M(null),S=M(!1),d=M(""),a=M([]),E=M(null),b=M(!1),r=M(null),g=M({x:0,y:0}),C=M("move"),O=V(()=>i.connectedSources),R=[{id:"solo",name:"Solo",slots:[{x:0,y:0,w:100,h:100}]},{id:"split",name:"Split",slots:[{x:0,y:0,w:50,h:100},{x:50,y:0,w:50,h:100}]},{id:"pip",name:"PiP",slots:[{x:0,y:0,w:100,h:100},{x:65,y:60,w:30,h:35}]},{id:"quad",name:"Quad",slots:[{x:0,y:0,w:50,h:50},{x:50,y:0,w:50,h:50},{x:0,y:50,w:50,h:50},{x:50,y:50,w:50,h:50}]},{id:"three-up",name:"3-Up",slots:[{x:0,y:0,w:50,h:100},{x:50,y:0,w:50,h:50},{x:50,y:50,w:50,h:50}]}];function x(U){m.value=U,S.value=!1,d.value=U.name,a.value=JSON.parse(JSON.stringify(U.slots)),E.value=null,l.value=!0}function u(){m.value=null,S.value=!0,d.value="New Scene",a.value=[{id:"slot-1",sourceId:null,position:{x:0,y:0,w:100,h:100},zIndex:0}],E.value=null,l.value=!0}function f(){l.value=!1,m.value=null}function n(){if(!d.value.trim()){P.error("Scene name is required");return}if(S.value){const U=o.createScene({name:d.value.trim(),resolution:{width:1920,height:1080},slots:a.value});P.success(`Created: ${U.name}`)}else m.value&&(o.updateScene(m.value.id,{name:d.value.trim(),slots:a.value}),P.success(`Updated: ${d.value}`));f()}function _(U){a.value=U.slots.map((w,v)=>{var L;return{id:`slot-${v+1}`,sourceId:((L=a.value[v])==null?void 0:L.sourceId)||null,position:{x:w.x,y:w.y,w:w.w,h:w.h},zIndex:v}}),P.info(`Applied: ${U.name}`)}function h(){const U={id:`slot-${Date.now()}`,sourceId:null,position:{x:10,y:10,w:30,h:30},zIndex:a.value.length};a.value.push(U),E.value=U.id}function H(U){const w=a.value.findIndex(v=>v.id===U);w!==-1&&(a.value.splice(w,1),E.value===U&&(E.value=null))}function $(U){E.value=U}const c=V(()=>a.value.find(U=>U.id===E.value));function k(U){if(!E.value)return;const w=a.value.find(v=>v.id===E.value);w&&(w.sourceId=U)}function B(U,w,v="move"){U.preventDefault(),b.value=!0,r.value=w,C.value=v,g.value={x:U.clientX,y:U.clientY},window.addEventListener("mousemove",ee),window.addEventListener("mouseup",Y)}function ee(U){if(!b.value||!r.value)return;const w=a.value.find(he=>he.id===r.value);if(!w)return;const v=document.getElementById("scene-canvas");if(!v)return;const L=v.getBoundingClientRect(),oe=(U.clientX-g.value.x)/L.width*100,ae=(U.clientY-g.value.y)/L.height*100;C.value==="move"?(w.position.x=Math.max(0,Math.min(100-w.position.w,w.position.x+oe)),w.position.y=Math.max(0,Math.min(100-w.position.h,w.position.y+ae))):(w.position.w=Math.max(10,Math.min(100-w.position.x,w.position.w+oe)),w.position.h=Math.max(10,Math.min(100-w.position.y,w.position.h+ae))),g.value={x:U.clientX,y:U.clientY}}function Y(){b.value=!1,r.value=null,window.removeEventListener("mousemove",ee),window.removeEventListener("mouseup",Y)}return p({open:x,openNew:u}),(U,w)=>(t(),ue(fe,{to:"body"},[l.value?(t(),s("div",hr,[e("div",{class:"absolute inset-0 bg-black/70",onClick:f}),e("div",kr,[e("div",wr,[e("h2",_r,y(S.value?"Create Scene":"Edit Scene"),1),e("button",{onClick:f,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",Sr,[e("div",$r,[e("div",Cr,[e("div",Mr,[w[7]||(w[7]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Scene Name",-1)),G(e("input",{"onUpdate:modelValue":w[0]||(w[0]=v=>d.value=v),type:"text",class:"w-full px-3 py-2 bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[se,d.value]])]),e("div",Ir,[w[8]||(w[8]=e("label",{class:"block text-sm text-r58-text-secondary mb-2"},"Quick Layouts",-1)),e("div",Rr,[(t(),s(F,null,W(R,v=>e("button",{key:v.id,onClick:L=>_(v),class:"px-3 py-1 text-xs bg-r58-bg-tertiary hover:bg-r58-accent-primary/20 rounded transition-colors"},y(v.name),9,Er)),64))])]),e("div",Dr,[w[9]||(w[9]=e("label",{class:"block text-sm text-r58-text-secondary mb-2"},"Layout",-1)),e("div",jr,[(t(!0),s(F,null,W(a.value,v=>(t(),s("div",{key:v.id,onMousedown:L=>B(L,v.id,"move"),onClick:ke(L=>$(v.id),["stop"]),class:T(["absolute cursor-move transition-colors",[E.value===v.id?"border-2 border-r58-accent-primary":"border border-r58-bg-tertiary hover:border-r58-accent-primary/50"]]),style:de({left:`${v.position.x}%`,top:`${v.position.y}%`,width:`${v.position.w}%`,height:`${v.position.h}%`,zIndex:v.zIndex,backgroundColor:v.sourceId?"var(--r58-bg-tertiary)":"var(--r58-bg-secondary)"})},[e("div",Tr,y(v.sourceId||"Empty"),1),E.value===v.id?(t(),s("div",{key:0,onMousedown:ke(L=>B(L,v.id,"resize"),["stop"]),class:"absolute bottom-0 right-0 w-4 h-4 bg-r58-accent-primary cursor-se-resize"},null,40,Vr)):j("",!0),E.value===v.id&&a.value.length>1?(t(),s("button",{key:1,onClick:ke(L=>H(v.id),["stop"]),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center hover:bg-red-400"}," Ã— ",8,Pr)):j("",!0)],46,Lr))),128))])]),e("button",{onClick:h,class:"btn btn-sm"}," + Add Slot ")]),e("div",Or,[w[17]||(w[17]=e("h3",{class:"text-sm font-medium mb-3"},"Slot Properties",-1)),c.value?(t(),s("div",Ur,[e("div",null,[w[11]||(w[11]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Source",-1)),e("select",{value:c.value.sourceId||"",onChange:w[1]||(w[1]=v=>k(v.target.value||null)),class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg"},[w[10]||(w[10]=e("option",{value:""},"None (Empty)",-1)),(t(!0),s(F,null,W(O.value,v=>(t(),s("option",{key:v.id,value:v.id},y(v.label),9,Ar))),128))],40,Hr)]),e("div",zr,[e("div",null,[w[12]||(w[12]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"X %",-1)),G(e("input",{"onUpdate:modelValue":w[2]||(w[2]=v=>c.value.position.x=v),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[se,c.value.position.x,void 0,{number:!0}]])]),e("div",null,[w[13]||(w[13]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Y %",-1)),G(e("input",{"onUpdate:modelValue":w[3]||(w[3]=v=>c.value.position.y=v),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[se,c.value.position.y,void 0,{number:!0}]])]),e("div",null,[w[14]||(w[14]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Width %",-1)),G(e("input",{"onUpdate:modelValue":w[4]||(w[4]=v=>c.value.position.w=v),type:"number",min:"1",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[se,c.value.position.w,void 0,{number:!0}]])]),e("div",null,[w[15]||(w[15]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Height %",-1)),G(e("input",{"onUpdate:modelValue":w[5]||(w[5]=v=>c.value.position.h=v),type:"number",min:"1",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[se,c.value.position.h,void 0,{number:!0}]])])]),e("div",null,[w[16]||(w[16]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Layer (z-index)",-1)),G(e("input",{"onUpdate:modelValue":w[6]||(w[6]=v=>c.value.zIndex=v),type:"number",min:"0",max:"10",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[se,c.value.zIndex,void 0,{number:!0}]])])])):(t(),s("div",Br," Click a slot to edit its properties "))])])]),e("div",Nr,[e("button",{onClick:f,class:"btn"},"Cancel"),e("button",{onClick:n,class:"btn btn-primary"},y(S.value?"Create Scene":"Save Changes"),1)])])])):j("",!0)]))}}),Kr={class:"h-full flex flex-col bg-r58-bg-primary"},Wr={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},Gr={class:"flex items-center gap-4"},Yr={class:"flex items-center gap-2"},Jr={key:0,class:"badge badge-danger"},qr={class:"flex items-center gap-4"},Xr={class:"flex-1 p-6 overflow-auto"},Qr={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Zr={class:"card p-6"},ei={class:"grid grid-cols-4 gap-3"},ti=["onClick"],si={class:"card p-6"},ni={class:"text-lg font-semibold mb-4"},oi={class:"text-sm font-normal text-r58-text-secondary"},ri={class:"space-y-3"},ii={class:"flex items-center gap-3"},ai={class:"font-medium"},li={key:0,class:"text-xs text-r58-text-secondary ml-2"},di={key:0,class:"text-sm text-r58-text-secondary"},ci={class:"card p-6"},ui={class:"flex items-center gap-4"},vi={key:0,class:"w-2 h-2 rounded-full bg-white animate-pulse mr-2"},mi={key:0,class:"mt-3 text-sm text-r58-text-secondary"},pi={class:"card p-6"},xi={class:"grid grid-cols-2 gap-4"},gi={class:"text-2xl font-bold text-r58-text-primary"},bi=X({__name:"MixerLiteView",emits:["enable-full-mode"],setup(I,{emit:p}){const o=p,i=ge(),l=te(),m=ye(),{register:S}=Ve(),d=V(()=>l.isLive),a=V(()=>i.inputs),E=V(()=>a.value.filter(R=>R.hasSignal));let b=null;me(()=>{i.fetchInputs(),b=window.setInterval(()=>{i.fetchInputs()},5e3);for(let R=1;R<=4;R++)S({key:String(R),description:`Switch to scene ${R}`,action:()=>r(R),context:"mixer-lite"})}),pe(()=>{b&&clearInterval(b)});function r(R){l.setScene(`scene-${R}`),P.info(`Scene ${R}`)}function g(){l.isLive?(l.toggleLive(),m.stopStreaming(),P.info("Session ended")):(l.toggleLive(),m.startStreaming(),P.success("Going live!"))}async function C(){try{i.isRecording?(await i.stopRecording(),P.info("Recording stopped")):(await i.startRecording(),P.success("Recording started"))}catch{P.error("Recording action failed")}}function O(){confirm("Full Mixer mode loads VDO.ninja which uses significant CPU/GPU resources. This may cause lag on the device. Continue?")&&o("enable-full-mode")}return(R,x)=>(t(),s("div",Kr,[e("header",Wr,[e("div",Gr,[e("div",Yr,[e("span",{class:T(["w-3 h-3 rounded-full",d.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"])},null,2),x[0]||(x[0]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1)),x[1]||(x[1]=e("span",{class:"text-xs px-2 py-0.5 rounded bg-amber-500/20 text-amber-400 font-medium"}," LITE MODE ",-1))]),d.value?(t(),s("span",Jr,"ON AIR")):j("",!0)]),e("div",qr,[e("button",{class:"btn btn-sm btn-secondary",onClick:O,title:"Enable full VDO.ninja mixer (high CPU usage)"},[...x[2]||(x[2]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1),q(" Full Mode ",-1)])]),e("button",{class:T(["btn",d.value?"btn-danger":"btn-primary"]),onClick:g},y(d.value?"End Session":"Go Live"),3)])]),e("main",Xr,[x[10]||(x[10]=be('<div class="mb-6 p-4 rounded-lg bg-amber-500/10 border border-amber-500/30" data-v-6d9e9096><div class="flex items-start gap-3" data-v-6d9e9096><svg class="w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-6d9e9096><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-6d9e9096></path></svg><div data-v-6d9e9096><h3 class="font-medium text-amber-400" data-v-6d9e9096>Local Device Mode</h3><p class="text-sm text-r58-text-secondary mt-1" data-v-6d9e9096> VDO.ninja previews are disabled to save CPU. Scene switching and guest management should be done from a remote browser or the Electron app. </p></div></div></div>',1)),e("div",Qr,[e("div",Zr,[x[3]||(x[3]=e("h2",{class:"text-lg font-semibold mb-4"},"Scene Control",-1)),e("div",ei,[(t(),s(F,null,W(4,u=>e("button",{key:u,class:T(["aspect-video flex items-center justify-center text-2xl font-bold rounded-lg transition-all",z(l).currentScene===`scene-${u}`?"bg-r58-mixer text-white ring-2 ring-r58-mixer ring-offset-2 ring-offset-r58-bg-primary":"bg-r58-bg-tertiary hover:bg-r58-bg-secondary text-r58-text-primary"]),onClick:f=>r(u)},y(u),11,ti)),64))]),x[4]||(x[4]=e("p",{class:"text-xs text-r58-text-secondary mt-3"}," Press 1-4 to switch scenes. Full transitions require VDO.ninja (Full Mode). ",-1))]),e("div",si,[e("h2",ni,[x[5]||(x[5]=q(" Inputs ",-1)),e("span",oi,"("+y(E.value.length)+"/"+y(a.value.length)+" active)",1)]),e("div",ri,[(t(!0),s(F,null,W(a.value,u=>(t(),s("div",{key:u.id,class:T(["flex items-center justify-between p-3 rounded-lg",u.hasSignal?"bg-r58-bg-tertiary":"bg-r58-bg-secondary opacity-50"])},[e("div",ii,[e("div",{class:T(["w-2 h-2 rounded-full",u.hasSignal?"bg-green-500":"bg-gray-500"])},null,2),e("div",null,[e("span",ai,y(u.name),1),u.resolution?(t(),s("span",li,y(u.resolution),1)):j("",!0)])]),u.framerate?(t(),s("div",di,y(u.framerate.toFixed(1))+" fps ",1)):j("",!0)],2))),128))])]),e("div",ci,[x[6]||(x[6]=e("h2",{class:"text-lg font-semibold mb-4"},"Device Recording",-1)),e("div",ui,[e("button",{class:T(["btn flex-1",z(i).isRecording?"btn-danger":"btn-primary"]),onClick:C},[z(i).isRecording?(t(),s("span",vi)):j("",!0),q(" "+y(z(i).isRecording?"Stop Recording":"Start Recording"),1)],2)]),z(i).isRecording?(t(),s("div",mi," Duration: "+y(z(i).formattedDuration),1)):j("",!0)]),e("div",pi,[x[9]||(x[9]=e("h2",{class:"text-lg font-semibold mb-4"},"System Status",-1)),e("div",xi,[e("div",null,[e("div",gi,y(E.value.length),1),x[7]||(x[7]=e("div",{class:"text-sm text-r58-text-secondary"},"Active Inputs",-1))]),e("div",null,[e("div",{class:T(["text-2xl font-bold",d.value?"text-red-500":"text-r58-text-primary"])},y(d.value?"LIVE":"Offline"),3),x[8]||(x[8]=e("div",{class:"text-sm text-r58-text-secondary"},"Stream Status",-1))])])])])])]))}}),fi=ie(bi,[["__scopeId","data-v-6d9e9096"]]),yi={class:"h-full flex flex-col bg-r58-bg-primary"},hi={class:"flex items-center justify-between px-6 py-3 border-b border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"mixer-header"},ki={class:"flex items-center gap-4"},wi={class:"flex items-center gap-2"},_i={key:0,class:"px-3 py-1 bg-red-600 text-white text-xs font-bold uppercase tracking-wider rounded"},Si={class:"text-sm text-r58-text-secondary"},$i={key:1,class:"text-xs text-r58-text-secondary"},Ci={class:"flex items-center gap-3"},Mi={class:"flex items-center gap-1 bg-r58-bg-tertiary rounded-lg p-1"},Ii={class:"flex-1 flex overflow-hidden"},Ri={class:"flex-1 min-w-0"},Ei={key:0,class:"text-sm font-medium"},Di={class:"p-4 space-y-6"},ji={class:"p-2 space-y-4"},Li={class:"hidden"},Ti=X({__name:"MixerView",setup(I){const p=te(),o=ve(),i=ge(),l=ye(),{register:m}=Ve(),{isLiteMode:S}=He(),d=M(null),a=M(null),E=M(null),b=M(null),r=M(!1),g=V(()=>!S.value||r.value),C=M(!0),O=M(!1),R=M(!1),x=V(()=>p.isLive),u=V(()=>l.enabledDestinations.length),f=V(()=>{const v=o.getScene(p.programSceneId||"");return(v==null?void 0:v.name)||"No Scene"});function n(){C.value=!1}ce(()=>{var v,L;return(L=(v=d.value)==null?void 0:v.isReady)==null?void 0:L.value},v=>{v&&(console.log("[Mixer] VDO.ninja ready"),O.value=!0)},{immediate:!0});let _=null;function h(){return i.isRecording?1e4:3e4}function H(){_&&clearInterval(_),_=window.setInterval(()=>{i.fetchInputs()},h())}ce(()=>i.isRecording,()=>{H()});const $=[];me(async()=>{await i.fetchInputs(),H();for(let v=1;v<=8;v++){const L=v-1,oe=m({key:String(v),description:`Select scene ${v} for preview`,action:()=>{const ae=o.scenes[L];ae&&(p.setPreviewScene(ae.id),P.info(`Preview: ${ae.name}`))},context:"mixer"});$.push(oe)}$.push(m({key:" ",description:"Take (transition preview to program)",action:()=>{p.previewSceneId&&p.previewSceneId!==p.programSceneId&&(p.take(),P.success("Take!"))},context:"mixer"})),$.push(m({key:"Escape",description:"Cut (immediate switch)",action:()=>{p.previewSceneId&&(p.cut(),P.info("Cut"))},context:"mixer"})),$.push(m({key:"g",description:"Toggle Go Live",action:c,context:"mixer"})),$.push(m({key:"r",description:"Toggle recording",action:k,context:"mixer"}))}),pe(()=>{$.forEach(v=>v()),_&&(clearInterval(_),_=null)});function c(){if(p.isLive)p.toggleLive(),l.stopStreaming(),P.info("Session ended");else{p.toggleLive(),l.startStreaming();const v=l.enabledDestinations.length;v>0?P.success(`Live! Streaming to ${v} destination${v>1?"s":""}`):P.info("Live! (No streaming destinations configured)")}}function k(){var v;d.value&&((v=d.value.isRecording)!=null&&v.value?(d.value.stopRecording(),P.info("Recording stopped")):(d.value.startRecording(),P.success("Recording started")))}function B(){var v;(v=a.value)==null||v.open()}function ee(){var v;(v=E.value)==null||v.open()}function Y(v){var L;(L=b.value)==null||L.open(v)}function U(){var v;(v=b.value)==null||v.openNew()}function w(){R.value=!R.value}return(v,L)=>g.value?(t(),s(F,{key:1},[Q(ze,{name:"fade"},{default:Ae(()=>[C.value?(t(),ue(Ge,{key:0,mode:"mixer","content-ready":O.value,"min-time":2e3,"max-time":15e3,onReady:n},null,8,["content-ready"])):j("",!0)]),_:1}),e("div",yi,[e("header",hi,[e("div",ki,[e("div",wi,[e("span",{class:T(["w-3 h-3 rounded-full transition-colors",x.value?"bg-red-500 animate-pulse":"bg-r58-bg-tertiary"])},null,2),L[3]||(L[3]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1))]),x.value?(t(),s("span",_i," ON AIR ")):j("",!0),e("span",Si,y(f.value),1),x.value&&u.value>0?(t(),s("span",$i," â†’ "+y(u.value)+" platform"+y(u.value>1?"s":""),1)):j("",!0),Q(wo,{"vdo-embed":d.value},null,8,["vdo-embed"])]),e("div",Ci,[e("div",Mi,[e("button",{onClick:L[1]||(L[1]=oe=>z(p).setMode("simple")),class:T(["px-3 py-1 text-xs rounded transition-colors",z(p).mode==="simple"?"bg-r58-accent-primary text-white":"text-r58-text-secondary hover:text-r58-text-primary"])}," Simple ",2),e("button",{onClick:L[2]||(L[2]=oe=>z(p).setMode("pvw-pgm")),class:T(["px-3 py-1 text-xs rounded transition-colors",z(p).mode==="pvw-pgm"?"bg-r58-accent-primary text-white":"text-r58-text-secondary hover:text-r58-text-primary"])}," PVW/PGM ",2)]),e("button",{class:"btn btn-sm",onClick:ee,title:"Keyboard Shortcuts (Shift+?)"},[...L[4]||(L[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})],-1)])]),e("button",{class:"btn btn-sm",onClick:B,title:"Streaming Settings"},[...L[5]||(L[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])]),e("button",{class:T(["btn px-6",x.value?"btn-danger":"btn-primary"]),onClick:c},y(x.value?"End Session":"Go Live"),3)])]),e("div",Ii,[e("div",Ri,[Q(bs,{"vdo-embed":d.value,onEditScene:Y,onAddScene:U},null,8,["vdo-embed"])]),e("aside",{class:T(["flex-shrink-0 border-l border-r58-bg-tertiary bg-r58-bg-secondary overflow-y-auto transition-all duration-300",R.value?"w-12":"w-72"])},[e("button",{onClick:w,class:"w-full p-3 flex items-center justify-between border-b border-r58-bg-tertiary hover:bg-r58-bg-tertiary/50 transition-colors"},[R.value?j("",!0):(t(),s("span",Ei,"Controls")),(t(),s("svg",{class:T(["w-4 h-4 transition-transform",{"rotate-180":R.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...L[6]||(L[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))]),G(e("div",Di,[e("section",null,[L[7]||(L[7]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Transitions ",-1)),Q(ir)]),e("section",null,[L[8]||(L[8]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Audio ",-1)),Q(Jo,{"vdo-embed":d.value},null,8,["vdo-embed"])]),e("section",null,[L[9]||(L[9]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Program Output ",-1)),Q(Xs)]),e("section",null,[L[10]||(L[10]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Recording ",-1)),Q(jo,{"vdo-embed":d.value},null,8,["vdo-embed"])]),e("section",null,[L[11]||(L[11]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Invite Guests ",-1)),Q(yr)])],512),[[xe,!R.value]]),G(e("div",ji,[...L[12]||(L[12]=[be('<button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Transitions" data-v-f965ff7d><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-f965ff7d><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" data-v-f965ff7d></path></svg></button><button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Audio" data-v-f965ff7d><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-f965ff7d><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" data-v-f965ff7d></path></svg></button><button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Recording" data-v-f965ff7d><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-f965ff7d><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" data-v-f965ff7d></path></svg></button>',3)])],512),[[xe,R.value]])],2)]),Q(Hs),e("div",Li,[Q(Ms,{ref_key:"vdoEmbedRef",ref:d,profile:"director"},null,512)]),Q(Bn,{ref_key:"streamingSettingsRef",ref:a},null,512),Q(lo,{ref_key:"hotkeySettingsRef",ref:E},null,512),Q(Fr,{ref_key:"sceneEditorRef",ref:b},null,512)])],64)):(t(),ue(fi,{key:0,onEnableFullMode:L[0]||(L[0]=oe=>r.value=!0)}))}}),Ui=ie(Ti,[["__scopeId","data-v-f965ff7d"]]);export{Ui as default};
