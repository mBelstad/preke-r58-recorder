import{d as V,l as w,a6 as N,r as d,o as G,p as P,J as g,c as a,e,f as m,t as l,y as f,k as r,_ as $}from"./index-wGeF6xKQ.js";const D={class:"customer-portal"},z={key:0,class:"portal-content"},H={key:1,class:"portal-content"},U={class:"glass-card text-center"},A={class:"text-preke-text-dim"},E={key:2,class:"portal-content"},J={class:"portal-header glass-card"},W={class:"flex items-center gap-4"},q=["src"],K={class:"flex-1"},O={class:"text-xl font-bold"},Q={class:"text-preke-text-dim text-sm"},X={class:"mt-4 flex items-center justify-between text-sm"},Y={class:"text-preke-text-muted"},Z={key:0,class:"badge-v2 badge-v2--success"},ee={key:0,class:"glass-card"},te={class:"graphic-preview"},se=["src","alt"],oe={class:"slide-indicator"},le={class:"flex items-center gap-2 mt-4"},ne=["disabled"],ae=["disabled"],re={key:1,class:"glass-card"},ie={class:"space-y-3"},de={class:"flex items-center justify-between p-3 bg-preke-bg-elevated rounded-lg"},ce={class:"flex items-center gap-2"},ue={class:"font-mono font-bold min-w-[3rem] text-center"},ve={class:"glass-card"},pe={key:0,class:"text-center"},ge={key:1,class:"text-center"},me={class:"recording-indicator mb-4"},be={class:"text-2xl font-mono font-bold"},fe={class:"glass-panel p-3 text-sm"},xe={class:"flex items-center justify-between text-preke-text-muted"},ke=V({__name:"CustomerPortalView",setup(_e){const M=N(),u=w(()=>M.params.token),o=d(null),x=d(!0),i=d(null),n=d(0),v=d(!1),k=d("podcast");d(!1);const b=d(50);let _=null;G(async()=>{await y(),_=window.setInterval(y,2e3)}),P(()=>{_&&clearInterval(_)});async function y(){try{const s=await g.wordpress.getCustomerStatus(u.value);o.value=s,v.value=s.recording_active,n.value=s.current_slide_index,k.value=s.display_mode||"podcast",b.value=s.teleprompter_scroll_speed||50,i.value=null}catch(s){x.value&&(i.value=s.message||"Invalid or expired link")}finally{x.value=!1}}async function B(){try{await g.wordpress.customerStartRecording(u.value),v.value=!0,"vibrate"in navigator&&navigator.vibrate(50)}catch(s){i.value=s.message||"Failed to start recording"}}async function R(){if(confirm("Stop recording?"))try{await g.wordpress.customerStopRecording(u.value),v.value=!1,"vibrate"in navigator&&navigator.vibrate([50,100,50])}catch(s){i.value=s.message||"Failed to stop recording"}}async function S(s){try{await g.wordpress.customerGotoSlide(u.value,s),n.value=s,"vibrate"in navigator&&navigator.vibrate(30)}catch(t){i.value=t.message||"Failed to change slide"}}function F(){o.value&&n.value<o.value.project.graphics.length-1&&S(n.value+1)}function I(){n.value>0&&S(n.value-1)}const h=w(()=>{var s,t;return(t=(s=o.value)==null?void 0:s.project)!=null&&t.graphics?o.value.project.graphics[n.value]:null}),L=w(()=>{var p;if(!((p=o.value)!=null&&p.recording_duration_ms))return"00:00";const s=Math.floor(o.value.recording_duration_ms/1e3),t=Math.floor(s/60),c=s%60;return`${t.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`});async function C(s){const t=Math.max(1,Math.min(100,b.value+s));b.value=t;try{await g.wordpress.setTeleprompterSpeed(u.value,t),"vibrate"in navigator&&navigator.vibrate(20)}catch(c){i.value=c.message||"Failed to adjust speed"}}return(s,t)=>{var c,p,j;return r(),a("div",D,[t[18]||(t[18]=e("div",{class:"portal-bg"},[e("div",{class:"bg-orb bg-orb--1"}),e("div",{class:"bg-orb bg-orb--2"})],-1)),x.value?(r(),a("div",z,[...t[2]||(t[2]=[e("div",{class:"glass-card text-center"},[e("div",{class:"animate-spin w-12 h-12 border-4 border-preke-gold border-t-transparent rounded-full mx-auto mb-4"}),e("p",{class:"text-preke-text-dim"},"Loading your session...")],-1)])])):i.value?(r(),a("div",H,[e("div",U,[t[3]||(t[3]=e("svg",{class:"w-16 h-16 text-preke-red mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"})],-1)),t[4]||(t[4]=e("h2",{class:"text-xl font-bold mb-2"},"Session Not Found",-1)),e("p",A,l(i.value),1)])])):o.value?(r(),a("div",E,[e("div",J,[e("div",W,[(c=o.value.booking.client)!=null&&c.logo_url?(r(),a("img",{key:0,src:o.value.booking.client.logo_url,alt:"Logo",class:"w-16 h-16 object-contain rounded-lg bg-preke-bg-elevated p-2"},null,8,q)):m("",!0),e("div",K,[e("h1",O,"Welcome, "+l(((p=o.value.booking.customer)==null?void 0:p.name)||"Guest"),1),e("p",Q,l((j=o.value.booking.client)==null?void 0:j.name),1)])]),e("div",X,[e("span",Y,l(o.value.booking.date)+" â€¢ "+l(o.value.booking.slot_start)+" - "+l(o.value.booking.slot_end),1),v.value?(r(),a("span",Z,"Recording")):m("",!0)])]),h.value&&k.value!=="teleprompter"?(r(),a("div",ee,[t[7]||(t[7]=e("h2",{class:"text-lg font-semibold mb-3"},"Presentation",-1)),e("div",te,[e("img",{src:h.value.url,alt:h.value.filename,class:"w-full rounded-lg"},null,8,se),e("div",oe,l(n.value+1)+" / "+l(o.value.project.graphics.length),1)]),e("div",le,[e("button",{onClick:I,disabled:n.value===0,class:"btn-v2 btn-v2--glass flex-1 touch-target"},[...t[5]||(t[5]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),f(" Previous ",-1)])],8,ne),e("button",{onClick:F,disabled:n.value>=o.value.project.graphics.length-1,class:"btn-v2 btn-v2--glass flex-1 touch-target"},[...t[6]||(t[6]=[f(" Next ",-1),e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,ae)])])):m("",!0),k.value==="teleprompter"?(r(),a("div",re,[t[12]||(t[12]=e("h2",{class:"text-lg font-semibold mb-3"},"Teleprompter Controls",-1)),e("div",ie,[e("div",de,[t[10]||(t[10]=e("span",{class:"text-preke-text-dim"},"Scroll Speed",-1)),e("div",ce,[e("button",{onClick:t[0]||(t[0]=T=>C(-10)),class:"btn-v2 btn-v2--glass btn-sm touch-target"},[...t[8]||(t[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1)])]),e("span",ue,l(b.value)+"%",1),e("button",{onClick:t[1]||(t[1]=T=>C(10)),class:"btn-v2 btn-v2--glass btn-sm touch-target"},[...t[9]||(t[9]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])])]),t[11]||(t[11]=e("div",{class:"p-3 bg-preke-bg-elevated rounded-lg text-sm text-preke-text-muted"},[e("p",null,"ðŸ’¡ The teleprompter is displayed on the studio TV."),e("p",{class:"mt-1"},"Use the speed controls to adjust reading pace.")],-1))])])):m("",!0),e("div",ve,[t[16]||(t[16]=e("h2",{class:"text-lg font-semibold mb-3"},"Recording Controls",-1)),v.value?(r(),a("div",ge,[e("div",me,[t[14]||(t[14]=e("div",{class:"recording-dot"},null,-1)),e("span",be,l(L.value),1)]),e("button",{onClick:R,class:"btn-v2 btn-v2--danger w-full touch-target"},[...t[15]||(t[15]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("rect",{x:"6",y:"6",width:"8",height:"8",rx:"1"})],-1),f(" Stop Recording ",-1)])])])):(r(),a("div",pe,[e("button",{onClick:B,class:"record-button touch-target"},[...t[13]||(t[13]=[e("div",{class:"record-button-inner"},[e("svg",{class:"w-12 h-12",fill:"currentColor",viewBox:"0 0 20 20"},[e("circle",{cx:"10",cy:"10",r:"8"})])],-1),e("span",{class:"mt-3 block text-lg font-semibold"},"Start Recording",-1)])])]))]),e("div",fe,[e("div",xe,[e("span",null,"Disk Space: "+l(o.value.disk_space_gb.toFixed(1))+" GB",1),t[17]||(t[17]=e("span",{class:"flex items-center gap-2"},[e("span",{class:"w-2 h-2 rounded-full bg-preke-green"}),f(" Connected ")],-1))])])])):m("",!0)])}}}),we=$(ke,[["__scopeId","data-v-88c6542d"]]);export{we as default};
