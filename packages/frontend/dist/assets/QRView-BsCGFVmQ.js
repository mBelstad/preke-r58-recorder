import{d as m,r,m as q,h as g,K as f,w as c,b as e,c as d,e as h,y,t as R,n as S,o as a,_ as b}from"./index--1MZhSDs.js";import{S as k}from"./StudioDisplayShell-n0OOxJxI.js";import"./AnimatedBackground-CDAui2dr.js";const U={class:"qr-view__content"},C={key:0,class:"qr-view__loading glass-card"},x={key:1,class:"qr-view__error glass-card"},P={key:2,class:"qr-view__welcome-layout"},Q={class:"qr-view__qr-container glass-card qr-view__fade-in"},B=["src"],L="https://app.itagenten.no",N=m({__name:"QRView",setup(V){const _=r(null),i=r(!0),t=r(null),n=r(""),l=r("");q(async()=>{await w()});function v(){const o=window.location.origin;return o.includes("localhost")||o.includes("127.0.0.1")?L:o}async function w(){i.value=!0,t.value=null;try{const o=await fetch(await g("/api/v1/wordpress/qr-session"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!o.ok)throw new Error("Failed to create QR session");const s=await o.json();_.value=s.token;const u=v();l.value=`${u}#/customer/${s.token}`,console.log("[QR] Window origin:",window.location.origin),console.log("[QR] Public base URL:",u),console.log("[QR] Customer portal URL:",l.value);const p=Date.now();n.value=`https://api.qrserver.com/v1/create-qr-code/?size=600x600&data=${encodeURIComponent(l.value)}&t=${p}`}catch(o){t.value=o.message||"Failed to create session",console.error("QR session creation error:",o)}finally{i.value=!1}}return(o,s)=>(a(),f(k,{title:"Welcome to Preke Studio",subtitle:"Your professional recording experience starts here",accent:"gold","show-footer":!0,"main-class":"qr-view__main"},{"header-right":c(()=>[e("div",{class:S(["qr-view__status",{"qr-view__status--error":!!t.value}])},[s[0]||(s[0]=e("span",{class:"qr-view__status-dot"},null,-1)),y(" "+R(t.value?"Session unavailable":"Ready for scan"),1)],2)]),footer:c(()=>[...s[5]||(s[5]=[e("div",{class:"qr-view__footer-content"},[e("span",{class:"qr-view__footer-text"},"Need help? Ask the studio technician.")],-1)])]),default:c(()=>[e("div",U,[i.value?(a(),d("div",C,[...s[1]||(s[1]=[e("div",{class:"qr-view__spinner"},null,-1),e("p",{class:"qr-view__loading-text"},"Preparing your session...",-1)])])):t.value?(a(),d("div",x,[...s[2]||(s[2]=[e("div",{class:"qr-view__error-icon"},"!",-1),e("h2",{class:"qr-view__error-title"},"Unable to Load",-1),e("p",{class:"qr-view__error-message"},"Please refresh the page or contact staff",-1)])])):_.value&&n.value?(a(),d("div",P,[s[3]||(s[3]=e("div",{class:"qr-view__welcome-section"},[e("h1",{class:"qr-view__welcome-title"},"Welcome"),e("p",{class:"qr-view__welcome-tagline"},"Scan to begin your professional recording session")],-1)),e("div",Q,[e("img",{src:n.value,alt:"QR Code - Scan with your phone",class:"qr-view__qr-image"},null,8,B)]),s[4]||(s[4]=e("div",{class:"qr-view__instructions glass-card qr-view__fade-in"},[e("h2",{class:"qr-view__instructions-title"},"Get Started"),e("ol",{class:"qr-view__instructions-list"},[e("li",null,"Open your phone camera"),e("li",null,"Point it at the QR code above")]),e("p",{class:"qr-view__instructions-note"},"Your session controls will appear on your phone")],-1))])):h("",!0)])]),_:1}))}}),D=b(N,[["__scopeId","data-v-898df56d"]]);export{D as default};
