import{J as Ue,r as M,h as A,K as oe,L as ve,A as ge,B as re,j as me,d as Z,c as n,b as V,a as e,F as W,q as J,n as O,w as q,x as ne,M as Me,t as S,I as K,y as ue,o as t,_ as le,N as _e,e as be,E as pe,p as Q,G as ye,g as U,v as fe,l as ee,k as xe,O as Ie,P as Re,s as ke,H as Ve,Q as Ae,m as He,T as ze}from"./index-DvuxOPba.js";import{g as Be,b as Ne,a as Ee,c as Fe,d as Ke,e as Ge,V as De}from"./vdoninja-ByZo7au1.js";import{M as We}from"./ModeLoadingScreen-BGyAiTBe.js";const ce=[{id:"youtube",name:"YouTube Live",icon:"â–¶ï¸",rtmpBaseUrl:"rtmp://a.rtmp.youtube.com/live2/",streamKeyPlaceholder:"xxxx-xxxx-xxxx-xxxx-xxxx",helpUrl:"https://support.google.com/youtube/answer/2907883"},{id:"twitch",name:"Twitch",icon:"ðŸ“º",rtmpBaseUrl:"rtmp://live.twitch.tv/app/",streamKeyPlaceholder:"live_xxxxxxxxxx_xxxxxxxxxxxxxx",helpUrl:"https://help.twitch.tv/s/article/twitch-stream-key-faq"},{id:"facebook",name:"Facebook Live",icon:"ðŸ“˜",rtmpBaseUrl:"rtmps://live-api-s.facebook.com:443/rtmp/",streamKeyPlaceholder:"FB-xxxxxxxxxx-x",helpUrl:"https://www.facebook.com/help/587160588142067"},{id:"restream",name:"Restream",icon:"ðŸ”„",rtmpBaseUrl:"rtmp://live.restream.io/live/",streamKeyPlaceholder:"re_xxxxxx_xxxxxxxxxx",helpUrl:"https://support.restream.io/en/"},{id:"custom",name:"Custom RTMP",icon:"âš™ï¸",rtmpBaseUrl:"",streamKeyPlaceholder:"your-stream-key"}],he=Ue("streaming",()=>{const $=M([]),d=M(!1),s=M(null),m=M({enabled:!1,host:"",port:8890,streamId:"mixer_program"}),r=A(()=>$.value.find(R=>R.id===s.value)),p=A(()=>$.value.filter(R=>R.enabled)),x=A(()=>ce),c=A(()=>{const R=window.location.hostname,N=R==="localhost"||R==="127.0.0.1"?"localhost":R.replace("r58-api","r58-mediamtx");return{rtmp:`rtmp://${N}:1935/mixer_program`,rtsp:`rtsp://${N}:8554/mixer_program`,srt:`srt://${N}:8890?streamid=read:mixer_program`,hls:`https://${R}/hls/mixer_program/index.m3u8`,whep:`${window.location.origin}/api/v1/whep/mixer_program/whep`}});function a(R,h){const N=ce.find(v=>v.id===R);if(!N)throw new Error(`Unknown platform: ${R}`);const D={id:`dest-${Date.now()}`,platformId:R,name:h||N.name,streamKey:"",enabled:!1};return $.value.push(D),D}function C(R,h){const N=$.value.findIndex(D=>D.id===R);N!==-1&&($.value[N]={...$.value[N],...h})}function f(R){const h=$.value.findIndex(N=>N.id===R);h!==-1&&$.value.splice(h,1),s.value===R&&(s.value=null)}function i(R){s.value=R}function g(R){m.value.enabled=R}function I(R){m.value={...m.value,...R}}function H(){d.value=!0}function T(){d.value=!1}function b(R){const h=ce.find(N=>N.id===R.platformId);return h?R.platformId==="custom"?`${R.name}${R.streamKey}`:`${h.rtmpBaseUrl}${R.streamKey}`:""}function y(){const R=window.location.hostname;return`srt://${R==="localhost"||R==="127.0.0.1"?"localhost":R.replace("r58-api","r58-mediamtx")}:${m.value.port}?streamid=read:${m.value.streamId}`}function l(){try{const R=localStorage.getItem("r58-streaming-destinations");if(R){const h=JSON.parse(R);$.value=h.destinations||[],h.srtOutput&&(m.value={...m.value,...h.srtOutput})}}catch(R){console.warn("Failed to load saved streaming destinations:",R)}}function o(){try{localStorage.setItem("r58-streaming-destinations",JSON.stringify({destinations:$.value,srtOutput:m.value}))}catch(R){console.warn("Failed to save streaming destinations:",R)}}return l(),{destinations:$,isStreaming:d,activeDestinationId:s,srtOutput:m,activeDestination:r,enabledDestinations:p,platforms:x,programOutputUrls:c,addDestination:a,updateDestination:C,removeDestination:f,setActiveDestination:i,toggleSrtOutput:g,updateSrtConfig:I,startStreaming:H,stopStreaming:T,buildRtmpUrl:b,getSrtOutputUrl:y,saveDestinations:o,loadSavedDestinations:l}});function Ye($){const d=oe(),s=ve();ge();const m=M(!1),r=M(!1),p=M(null);function x(){return $.value}function c(){var _,z;const u=x();return u?((_=u.isReady)==null?void 0:_.value)===!0||((z=u.connectionState)==null?void 0:z.value)==="connected"?!0:r.value:!1}function a(u){return u.slots.filter(_=>_.sourceId).map(_=>_.sourceId)}function C(u){const _=x();if(!_){console.warn("[MixerController] VDO.ninja embed not available");return}c()||console.log("[MixerController] VDO.ninja may not be fully ready, attempting anyway"),console.log("[MixerController] Applying scene to VDO:",u.name);const z=a(u);let L=0;if(u.slots.length===1)L=1;else if(u.slots.length===2){const k=u.slots[0],E=u.slots[1];k.position.w===50&&E.position.w===50?L=2:E.position.w<=30&&E.position.h<=30?L=3:L=2}else u.slots.length===3?L=5:(u.slots.length,L=0);try{_.setLayout(L);const k=1;for(const E of z)_.addToScene(E,k);p.value=u.id}catch(k){console.error("[MixerController] Error applying scene to VDO:",k)}}function f(u){const _=s.getScene(u);_&&C(_)}async function i(){const u=d.previewSceneId;if(!u)return;const _=s.getScene(u);_&&(C(_),await d.take())}function g(){const u=d.previewSceneId;if(!u)return;const _=s.getScene(u);_&&(C(_),d.cut())}function I(u,_){const z=x();!z||!c()||(z.addToScene(u,1),d.previewSceneId&&s.updateSlot(d.previewSceneId,_||0,{sourceId:u}))}function H(u){const _=x();!_||!c()||_.removeFromScene(u)}function T(u){const _=x();!_||!c()||_.setProgram(u)}function b(u,_){const z=x();z&&c()&&z.setMute(u,_),d.setSourceMute(u,_)}function y(u){const _=x();_&&c()&&_.toggleMute(u);const z=d.sources.find(L=>L.id===u);z&&d.setSourceMute(u,!z.muted)}function l(u,_){const z=x();z&&c()&&z.setVolume(u,_*2),d.setSourceVolume(u,_)}function o(u,_){const z=x();z&&c()&&_&&z.sendCommand("soloChat",u),d.setSourceSolo(u,_)}function R(u){const _=x();_&&c()&&_.kickGuest(u),d.removeSource(u)}function h(u,_){const z=x();z&&c()&&z.sendCommand("sendChat",u,_)}function N(u){const _=x();_&&c()&&_.addToScene(u,1),d.admitFromGreenroom(u)}function D(){const u=x();u&&c()&&u.startRecording()}function v(){const u=x();u&&c()&&u.stopRecording()}function w(u,_,z){const L=x();L&&c()&&L.sendCommand(u,_,z)}return re(()=>{var u,_;return(_=(u=$.value)==null?void 0:u.isReady)==null?void 0:_.value},u=>{if(m.value=u===!0,u){if(console.log("[MixerController] VDO.ninja connected"),d.setVdoConnected(!0),r.value=!0,d.programSceneId){const _=s.getScene(d.programSceneId);_&&_.id!==p.value&&C(_)}}else d.setVdoConnected(!1)},{immediate:!0}),me(()=>{setTimeout(()=>{!r.value&&$.value&&(console.log("[MixerController] Fallback initialization (timeout)"),r.value=!0,m.value=!0,d.setVdoConnected(!0))},6e3)}),re(()=>d.programSceneId,u=>{if(u&&u!==p.value){const _=s.getScene(u);_&&c()&&C(_)}}),re(()=>{var u,_;return(_=(u=$.value)==null?void 0:u.lastError)==null?void 0:_.value},u=>{u&&d.setLastError(u)}),{isConnected:m,isInitialized:r,applySceneToVdo:C,switchToScene:f,takeToProgram:i,cutToProgram:g,addSourceToScene:I,removeSourceFromScene:H,setSourceAsProgram:T,setMute:b,toggleMute:y,setVolume:l,setSolo:o,kickGuest:R,sendMessage:h,admitFromGreenroom:N,startRecording:D,stopRecording:v,sendDirectorCommand:w}}const Je={class:"source-panel space-y-4","data-testid":"source-panel"},qe={key:0,class:"px-3 py-2 bg-amber-500/10 border border-amber-500/30 rounded-lg text-xs text-amber-400"},Xe={key:1,class:"text-center py-6 text-r58-text-secondary"},Qe={key:2,class:"space-y-2"},Ze={class:"flex items-center gap-3"},et={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},tt={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ot={key:2,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},nt={key:3,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},st={class:"flex-1 min-w-0"},rt={key:0,class:"flex items-center gap-1"},it=["onDblclick"],at={class:"flex items-center gap-2 text-xs text-r58-text-secondary"},lt={key:0,class:"text-red-400 font-bold"},dt={key:1,class:"text-amber-400"},ct={class:"flex items-center gap-1 flex-shrink-0"},ut=["onClick"],vt=["onClick","title"],mt={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},gt={key:0,class:"mt-2"},xt={class:"h-1 bg-r58-bg-primary rounded-full overflow-hidden"},je="preke-source-names",ft=Z({__name:"SourcePanel",props:{vdoEmbed:{}},setup($){function d(){try{const D=localStorage.getItem(je);return D?JSON.parse(D):{}}catch{return{}}}function s(D,v){const w=d();w[D]=v,localStorage.setItem(je,JSON.stringify(w))}const m=M(d()),r=M(null),p=M(""),x=$,c=oe(),a=ve(),C=ge(),f={cam0:{name:"HDMI 1",subtitle:"Connected to device"},cam1:{name:"HDMI 2",subtitle:"Connected to device"},cam2:{name:"HDMI 3",subtitle:"Connected to device"},cam3:{name:"HDMI 4",subtitle:"Connected to device"}},i=A(()=>c.sources.map(D=>{let v=D.label,w="VDO.ninja";const u=D.id.match(/cam(\d+)/i)||D.id.match(/hdmi[_-]?(\d+)/i);return u?(v=`HDMI ${parseInt(u[1])+1}`,w="Connected to device"):D.type==="guest"?(w="Remote guest",(!D.label||D.label.length>20||D.label.match(/^[a-z0-9]{8,}$/i))&&(v="Guest")):D.type==="screen"&&(w="Screen share"),{...D,label:v,subtitle:w}})),g=A(()=>C.inputs.filter(D=>D.hasSignal).map(D=>{const v=f[D.id]||{name:D.label,subtitle:"HDMI Input"};return{id:D.id,label:v.name,subtitle:v.subtitle,type:"camera",hasVideo:!0,hasAudio:!0,muted:!1,audioLevel:0}})),I=A(()=>i.value.length>0?i.value:g.value),H=A(()=>i.value.length===0&&g.value.length>0);function T(D){const v=a.getScene(c.previewSceneId||"");return(v==null?void 0:v.slots.some(w=>w.sourceId===D))||!1}function b(D){return c.liveSourceIds.includes(D)}function y(D){var v,w;x.vdoEmbed&&((w=(v=x.vdoEmbed).toggleMute)==null||w.call(v,D.id)),c.setSourceMute(D.id,!D.muted)}function l(D){const v=a.getScene(c.previewSceneId||"");if(!v)return;const w=v.slots.find(u=>!u.sourceId);w&&a.assignSourceToSlot(v.id,w.id,D.id)}function o(D){return m.value[D.id]||D.label}function R(D){r.value=D.id,p.value=m.value[D.id]||D.label}function h(){r.value&&p.value.trim()&&(s(r.value,p.value.trim()),m.value=d()),r.value=null}function N(){r.value=null,p.value=""}return(D,v)=>(t(),n("div",Je,[H.value?(t(),n("div",qe," Showing HDMI cameras. VDO.ninja sources will appear when connected. ")):V("",!0),I.value.length===0?(t(),n("div",Xe,[...v[1]||(v[1]=[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),e("p",{class:"text-sm"},"No sources connected",-1),e("p",{class:"text-xs mt-1 opacity-75"},"Connect HDMI or invite guests",-1)])])):(t(),n("div",Qe,[(t(!0),n(W,null,J(I.value,w=>(t(),n("div",{key:w.id,class:O(["source-card p-3 rounded-lg transition-all",[b(w.id)?"bg-red-500/10 border border-red-500/30":T(w.id)?"bg-amber-500/10 border border-amber-500/30":"bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 border border-transparent"]])},[e("div",Ze,[e("div",{class:O(["w-10 h-10 rounded-lg bg-r58-bg-primary flex items-center justify-center flex-shrink-0",{"ring-2 ring-red-500":b(w.id),"ring-2 ring-amber-500":T(w.id)&&!b(w.id)}])},[w.type==="camera"?(t(),n("svg",et,[...v[2]||(v[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])):w.type==="guest"?(t(),n("svg",tt,[...v[3]||(v[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])])):w.type==="screen"?(t(),n("svg",ot,[...v[4]||(v[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},null,-1)])])):(t(),n("svg",nt,[...v[5]||(v[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"},null,-1)])]))],2),e("div",st,[r.value===w.id?(t(),n("div",rt,[q(e("input",{"onUpdate:modelValue":v[0]||(v[0]=u=>p.value=u),onKeyup:[Me(h,["enter"]),Me(N,["escape"])],onBlur:h,class:"input text-sm py-0.5 px-1 w-full",autofocus:""},null,544),[[ne,p.value]])])):(t(),n("p",{key:1,onDblclick:u=>R(w),class:"font-medium text-sm truncate cursor-pointer hover:text-r58-accent-primary",title:"Double-click to rename"},S(o(w)),41,it)),e("div",at,[e("span",null,S(w.subtitle),1),b(w.id)?(t(),n("span",lt,"LIVE")):T(w.id)?(t(),n("span",dt,"PVW")):V("",!0)])]),e("div",ct,[K(c).previewSceneId&&!T(w.id)?(t(),n("button",{key:0,onClick:u=>l(w),class:"p-1.5 rounded hover:bg-r58-bg-primary transition-colors text-r58-text-secondary hover:text-r58-accent-primary",title:"Add to preview scene"},[...v[6]||(v[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,ut)):V("",!0),w.hasAudio?(t(),n("button",{key:1,onClick:u=>y(w),class:O(["p-1.5 rounded transition-colors",w.muted?"bg-red-500/20 text-red-400":"hover:bg-r58-bg-primary text-r58-text-secondary"]),title:w.muted?"Unmute":"Mute"},[w.muted?(t(),n("svg",mt,[...v[7]||(v[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(t(),n("svg",pt,[...v[8]||(v[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],10,vt)):V("",!0)])]),w.hasAudio?(t(),n("div",gt,[e("div",xt,[e("div",{class:O(["h-full transition-all duration-75 rounded-full",w.muted?"bg-r58-bg-tertiary":w.audioLevel>80?"bg-red-500":w.audioLevel>60?"bg-amber-500":"bg-emerald-500"]),style:ue({width:`${w.audioLevel||0}%`})},null,6)])])):V("",!0)],2))),128))]))]))}}),bt=le(ft,[["__scopeId","data-v-0f8f8e88"]]),yt={class:"preview-program-view h-full flex flex-col","data-testid":"preview-program-view"},ht={class:"flex-1 flex gap-4 min-h-0"},kt={class:"flex-1 flex flex-col min-w-0"},wt={class:"flex items-center justify-between mb-2"},_t={key:0,class:"text-xs text-r58-text-secondary"},St={key:0,class:"absolute inset-0 flex items-center justify-center"},$t={class:"relative w-full h-full bg-r58-bg-secondary"},Ct={key:0,class:"truncate px-1"},Mt={key:1,class:"opacity-50"},It={key:1,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},Rt={class:"flex flex-col items-center justify-center gap-3 px-2"},Et=["disabled"],Dt={key:0,class:"animate-pulse"},jt={key:1},Tt=["disabled"],Lt={class:"flex flex-col gap-1 mt-2"},Vt=["value"],Pt=["value"],Ot={class:"flex-1 flex flex-col min-w-0"},Ut={class:"flex items-center justify-between mb-2"},At={class:"flex items-center gap-2"},Ht={key:0,class:"px-2 py-0.5 bg-red-600 text-white text-xs font-bold rounded animate-pulse"},zt={key:0,class:"text-xs text-r58-text-secondary"},Bt={key:0,class:"absolute inset-0"},Nt={class:"relative w-full h-full bg-r58-bg-secondary"},Ft={key:0,class:"truncate px-1"},Kt={key:1,class:"opacity-50"},Gt={key:0,class:"absolute top-2 left-2 flex items-center gap-2"},Wt={key:1,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},Yt=Z({__name:"PreviewProgramView",props:{vdoEmbed:{},controller:{}},emits:["take","cut"],setup($,{emit:d}){const s=$,m=d,r=oe(),p=ve(),x=M(r.transition.type),c=M(r.transition.duration),a=A(()=>p.getScene(r.previewSceneId||"")),C=A(()=>p.getScene(r.programSceneId||"")),f=A(()=>r.previewSceneId!==null&&r.previewSceneId!==r.programSceneId&&!r.isTransitioning),i=A(()=>r.isLive);re([x,c],([b,y])=>{r.setTransition({type:b,duration:y})});function g(){f.value&&(s.controller?s.controller.takeToProgram():r.take(),m("take"))}function I(){r.previewSceneId&&(s.controller?s.controller.cutToProgram():r.cut(),m("cut"))}const H=[{value:"cut",label:"CUT"},{value:"fade",label:"FADE"},{value:"wipe-left",label:"WIPE L"},{value:"wipe-right",label:"WIPE R"}],T=[{value:100,label:"0.1s"},{value:300,label:"0.3s"},{value:500,label:"0.5s"},{value:1e3,label:"1.0s"}];return(b,y)=>(t(),n("div",yt,[e("div",ht,[e("div",kt,[e("div",wt,[y[2]||(y[2]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-xs font-bold uppercase tracking-wider text-amber-400"},"PVW"),e("span",{class:"text-xs text-r58-text-secondary"},"Preview")],-1)),a.value?(t(),n("span",_t,S(a.value.name),1)):V("",!0)]),e("div",{class:O(["flex-1 bg-black rounded-lg overflow-hidden border-2 transition-colors relative",a.value?"border-amber-500/50":"border-r58-bg-tertiary"])},[a.value?(t(),n("div",St,[e("div",$t,[(t(!0),n(W,null,J(a.value.slots,l=>{var o;return t(),n("div",{key:l.id,class:"absolute bg-r58-bg-tertiary border border-r58-bg-tertiary/50 flex items-center justify-center text-xs text-r58-text-secondary",style:ue({left:`${l.position.x}%`,top:`${l.position.y}%`,width:`${l.position.w}%`,height:`${l.position.h}%`,zIndex:l.zIndex,borderRadius:(o=l.style)!=null&&o.borderRadius?`${l.style.borderRadius}px`:void 0})},[l.sourceId?(t(),n("span",Ct,S(l.sourceId),1)):(t(),n("span",Mt,"Empty"))],4)}),128))])])):(t(),n("div",It,[...y[3]||(y[3]=[e("div",{class:"text-center"},[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]),e("p",{class:"text-sm"},"Select a scene to preview")],-1)])]))],2)]),e("div",Rt,[e("button",{onClick:g,disabled:!f.value,class:O(["take-button w-20 h-16 rounded-lg font-bold text-lg transition-all",f.value?"bg-red-600 hover:bg-red-500 text-white shadow-lg shadow-red-500/30":"bg-r58-bg-tertiary text-r58-text-secondary cursor-not-allowed"]),"data-testid":"take-button"},[K(r).isTransitioning?(t(),n("span",Dt,"...")):(t(),n("span",jt,"TAKE"))],10,Et),e("button",{onClick:I,disabled:!K(r).previewSceneId,class:O(["w-20 h-10 rounded-lg font-bold text-sm transition-all",K(r).previewSceneId?"bg-r58-bg-tertiary hover:bg-r58-accent-primary text-r58-text-primary":"bg-r58-bg-tertiary/50 text-r58-text-secondary cursor-not-allowed"]),"data-testid":"cut-button"}," CUT ",10,Tt),e("div",Lt,[q(e("select",{"onUpdate:modelValue":y[0]||(y[0]=l=>x.value=l),class:"w-20 px-2 py-1 text-xs bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-center"},[(t(),n(W,null,J(H,l=>e("option",{key:l.value,value:l.value},S(l.label),9,Vt)),64))],512),[[_e,x.value]]),q(e("select",{"onUpdate:modelValue":y[1]||(y[1]=l=>c.value=l),class:"w-20 px-2 py-1 text-xs bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-center"},[(t(),n(W,null,J(T,l=>e("option",{key:l.value,value:l.value},S(l.label),9,Pt)),64))],512),[[_e,c.value,void 0,{number:!0}]])])]),e("div",Ot,[e("div",Ut,[e("div",At,[e("span",{class:O(["text-xs font-bold uppercase tracking-wider",i.value?"text-red-500":"text-r58-text-secondary"])}," PGM ",2),y[4]||(y[4]=e("span",{class:"text-xs text-r58-text-secondary"},"Program",-1)),i.value?(t(),n("span",Ht," LIVE ")):V("",!0)]),C.value?(t(),n("span",zt,S(C.value.name),1)):V("",!0)]),e("div",{class:O(["flex-1 bg-black rounded-lg overflow-hidden border-2 transition-colors relative",i.value?"border-red-500":C.value?"border-emerald-500/50":"border-r58-bg-tertiary"])},[C.value?(t(),n("div",Bt,[e("div",Nt,[(t(!0),n(W,null,J(C.value.slots,l=>{var o;return t(),n("div",{key:l.id,class:"absolute bg-r58-bg-primary border border-r58-bg-tertiary/50 flex items-center justify-center text-xs text-r58-text-secondary",style:ue({left:`${l.position.x}%`,top:`${l.position.y}%`,width:`${l.position.w}%`,height:`${l.position.h}%`,zIndex:l.zIndex,borderRadius:(o=l.style)!=null&&o.borderRadius?`${l.style.borderRadius}px`:void 0})},[l.sourceId?(t(),n("span",Ft,S(l.sourceId),1)):(t(),n("span",Kt,"Empty"))],4)}),128))]),i.value?(t(),n("div",Gt,[...y[5]||(y[5]=[e("div",{class:"w-3 h-3 rounded-full bg-red-500 animate-recording"},null,-1)])])):V("",!0)])):(t(),n("div",Wt,[...y[6]||(y[6]=[be('<div class="text-center" data-v-8f51ead0><svg class="w-8 h-8 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8f51ead0><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" data-v-8f51ead0></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-8f51ead0></path></svg><p class="text-sm" data-v-8f51ead0>No scene on program</p></div>',1)])]))],2)])])]))}}),Jt=le(Yt,[["__scopeId","data-v-8f51ead0"]]),qt={class:"scene-strip","data-testid":"scene-strip"},Xt={class:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin"},Qt=["onClick","onDblclick","onContextmenu","data-testid"],Zt={class:"relative aspect-video bg-r58-bg-tertiary rounded-lg overflow-hidden"},eo={class:"absolute inset-0"},to={key:0,class:"absolute top-1 left-1 w-5 h-5 flex items-center justify-center bg-r58-bg-primary/80 rounded text-xs font-mono font-bold"},oo={key:1,class:"absolute top-1 right-1 flex items-center gap-1 px-1.5 py-0.5 bg-red-600 rounded text-xs font-bold"},no={key:2,class:"absolute top-1 right-1 px-1.5 py-0.5 bg-amber-500 rounded text-xs font-bold text-black"},so={class:"mt-1 text-xs text-center truncate text-r58-text-secondary"},ro=["disabled"],io=Z({__name:"SceneStrip",emits:["edit-scene","add-scene"],setup($,{emit:d}){const s=d,m=ve(),r=oe(),p=M(null),x=M({x:0,y:0}),c=M(!1),a=A(()=>m.scenes),C=A(()=>r.previewSceneId),f=A(()=>r.programSceneId);function i(l){r.mode==="simple"?r.setProgramScene(l.id):r.setPreviewScene(l.id)}function g(l){r.setProgramScene(l.id),U.info(`Scene: ${l.name}`)}function I(l,o){l.preventDefault(),p.value=o,x.value={x:l.clientX,y:l.clientY},c.value=!0;const R=()=>{c.value=!1,document.removeEventListener("click",R)};setTimeout(()=>document.addEventListener("click",R),0)}function H(l){c.value=!1,s("edit-scene",l)}function T(l){c.value=!1;const o=m.duplicateScene(l.id);o&&U.success(`Duplicated: ${o.name}`)}function b(l){if(c.value=!1,a.value.length<=1){U.error("Cannot delete the last scene");return}if(l.id===f.value){U.error("Cannot delete scene that is on program");return}m.deleteScene(l.id),U.info(`Deleted: ${l.name}`)}function y(l){return l.id===f.value?"ring-2 ring-red-500 ring-offset-2 ring-offset-r58-bg-primary":l.id===C.value?"ring-2 ring-amber-500 ring-offset-1 ring-offset-r58-bg-primary":"hover:ring-2 hover:ring-r58-accent-primary/50"}return(l,o)=>{var R;return t(),n("div",qt,[e("div",Xt,[(t(!0),n(W,null,J(a.value,(h,N)=>(t(),n("div",{key:h.id,class:O(["scene-thumbnail flex-shrink-0 w-28 cursor-pointer transition-all",y(h)]),onClick:D=>i(h),onDblclick:D=>g(h),onContextmenu:D=>I(D,h),"data-testid":`scene-${h.id}`},[e("div",Zt,[e("div",eo,[(t(!0),n(W,null,J(h.slots,D=>(t(),n("div",{key:D.id,class:"absolute bg-r58-bg-secondary border border-r58-bg-tertiary/30",style:ue({left:`${D.position.x}%`,top:`${D.position.y}%`,width:`${D.position.w}%`,height:`${D.position.h}%`})},null,4))),128))]),N<8?(t(),n("div",to,S(N+1),1)):V("",!0),h.id===f.value?(t(),n("div",oo,[...o[4]||(o[4]=[e("div",{class:"w-1.5 h-1.5 rounded-full bg-white animate-pulse"},null,-1),Q(" PGM ",-1)])])):h.id===C.value?(t(),n("div",no," PVW ")):V("",!0)]),e("p",so,S(h.name),1)],42,Qt))),128)),e("button",{onClick:o[0]||(o[0]=h=>s("add-scene")),class:"flex-shrink-0 w-28 aspect-video bg-r58-bg-tertiary/50 hover:bg-r58-bg-tertiary rounded-lg border-2 border-dashed border-r58-bg-tertiary hover:border-r58-accent-primary/50 flex items-center justify-center transition-colors","data-testid":"add-scene-button"},[...o[5]||(o[5]=[e("div",{class:"text-center text-r58-text-secondary"},[e("svg",{class:"w-6 h-6 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs"},"Add Scene")],-1)])])]),(t(),pe(ye,{to:"body"},[c.value&&p.value?(t(),n("div",{key:0,class:"fixed z-50 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg shadow-xl py-1 min-w-[140px]",style:ue({left:`${x.value.x}px`,top:`${x.value.y}px`})},[e("button",{onClick:o[1]||(o[1]=h=>H(p.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-r58-bg-tertiary flex items-center gap-2"},[...o[6]||(o[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),Q(" Edit ",-1)])]),e("button",{onClick:o[2]||(o[2]=h=>T(p.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-r58-bg-tertiary flex items-center gap-2"},[...o[7]||(o[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),Q(" Duplicate ",-1)])]),o[9]||(o[9]=e("div",{class:"border-t border-r58-bg-tertiary my-1"},null,-1)),e("button",{onClick:o[3]||(o[3]=h=>b(p.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-red-500/20 text-red-400 flex items-center gap-2",disabled:((R=p.value)==null?void 0:R.id)===f.value},[...o[8]||(o[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Q(" Delete ",-1)])],8,ro)],4)):V("",!0)]))])}}}),ao=le(io,[["__scopeId","data-v-627912a1"]]),lo={class:"mixer-workspace h-full flex flex-col","data-testid":"mixer-workspace"},co={class:"flex-1 flex gap-4 min-h-0 p-4"},uo={key:0,class:"text-sm font-medium"},vo={class:"h-[calc(100%-48px)] overflow-y-auto scrollbar-thin"},mo={class:"space-y-2"},po=["title"],go={class:"flex-1 flex flex-col min-w-0"},xo={class:"flex-1 min-h-0"},fo={class:"mt-4 pt-4 border-t border-r58-bg-tertiary"},bo=Z({__name:"MixerWorkspace",props:{vdoEmbed:{},controller:{}},emits:["edit-scene","add-scene"],setup($,{emit:d}){const s=d,m=oe();ve();const r=M(!1);function p(){r.value=!r.value}function x(f){s("edit-scene",f)}function c(){s("add-scene")}function a(){console.log("[Workspace] Take executed")}function C(){console.log("[Workspace] Cut executed")}return(f,i)=>(t(),n("div",lo,[e("div",co,[e("aside",{class:O(["sources-panel flex-shrink-0 transition-all duration-300 overflow-hidden",r.value?"w-12":"w-64"])},[e("button",{onClick:p,class:"w-full mb-3 flex items-center justify-between px-3 py-2 bg-r58-bg-tertiary rounded-lg hover:bg-r58-bg-tertiary/80 transition-colors"},[r.value?V("",!0):(t(),n("span",uo,"Sources")),(t(),n("svg",{class:O(["w-4 h-4 transition-transform",{"rotate-180":r.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...i[0]||(i[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"},null,-1)])],2))]),q(e("div",vo,[ee(bt,{"vdo-embed":$.vdoEmbed},null,8,["vdo-embed"])],512),[[fe,!r.value]]),q(e("div",mo,[(t(!0),n(W,null,J(K(m).connectedSources.slice(0,6),g=>(t(),n("div",{key:g.id,class:"w-8 h-8 mx-auto rounded bg-r58-bg-tertiary flex items-center justify-center text-xs",title:g.label},S(g.label.charAt(0)),9,po))),128))],512),[[fe,r.value]])],2),e("div",go,[e("div",xo,[ee(Jt,{"vdo-embed":$.vdoEmbed,controller:$.controller,onTake:a,onCut:C},null,8,["vdo-embed","controller"])]),e("div",fo,[i[1]||(i[1]=be('<div class="flex items-center justify-between mb-2" data-v-6d99dadf><h3 class="text-sm font-medium text-r58-text-secondary" data-v-6d99dadf>Scenes</h3><div class="flex items-center gap-2 text-xs text-r58-text-secondary" data-v-6d99dadf><span data-v-6d99dadf>Click = Preview</span><span class="opacity-50" data-v-6d99dadf>|</span><span data-v-6d99dadf>Double-click = Live</span><span class="opacity-50" data-v-6d99dadf>|</span><span data-v-6d99dadf>Right-click = Menu</span></div></div>',1)),ee(ao,{onEditScene:x,onAddScene:c})])])])]))}}),yo=le(bo,[["__scopeId","data-v-6d99dadf"]]),Se="vdo-debug",ho=500,se=[];let $e=typeof localStorage<"u"&&localStorage.getItem(Se)==="true";function Te($){$e=$,typeof localStorage<"u"&&($?localStorage.setItem(Se,"true"):localStorage.removeItem(Se)),console.log(`[VDO.ninja Debug] ${$?"Enabled":"Disabled"}`)}function we($){if(se.push($),se.length>ho&&se.shift(),$e){const d=new Date($.timestamp).toISOString().split("T")[1].slice(0,-1),s=$.direction==="outgoing"?"âž¡ï¸ OUT":"â¬…ï¸ IN",m=$.direction==="outgoing"?"color: #3b82f6; font-weight: bold":"color: #22c55e; font-weight: bold";console.groupCollapsed(`%c[VDO.ninja ${s}] %c${$.type}`,m,"color: inherit"),console.log("Time:",d),$.target&&console.log("Target:",$.target),console.log("Data:",$.data),$.raw&&$.raw!==$.data&&console.log("Raw:",$.raw),console.groupEnd()}}function Pe(){return[...se]}function ko(){se.length=0,console.log("[VDO.ninja Debug] Event history cleared")}function Oe(){const $={total:se.length,incoming:0,outgoing:0,byType:{},lastActivity:se.length>0?se[se.length-1].timestamp:null};for(const d of se)d.direction==="incoming"?$.incoming++:$.outgoing++,$.byType[d.type]=($.byType[d.type]||0)+1;return $}typeof window<"u"&&(window.__VDO_DEBUG__={getHistory:Pe,clearHistory:ko,getStats:Oe,enable:()=>Te(!0),disable:()=>Te(!1),isEnabled:()=>$e});function wo($){const d=M(!1),s=M(new Map),m=M(null),r=M(!1),p=M("disconnected"),x=M(null),c=Be();function a(j,F,G,ae){var Y;if(!((Y=$.value)!=null&&Y.contentWindow)){console.warn("[VDO.ninja] Cannot send command - iframe not ready"),x.value="iframe not ready";return}const X={action:j};F&&(X.target=F),G!==void 0&&(X.value=G),ae!==void 0&&(X.value2=ae),we({timestamp:Date.now(),direction:"outgoing",type:j,target:F,data:{action:j,target:F,value:G,value2:ae},raw:X});try{$.value.contentWindow.postMessage(X,"*")}catch(te){console.error("[VDO.ninja] Failed to send command:",te),x.value=String(te)}}function C(j,F){var ae;if(!((ae=$.value)!=null&&ae.contentWindow)){console.warn("[VDO.ninja] Cannot send DOM command - iframe not ready");return}const G={action:"",target:j,...F};we({timestamp:Date.now(),direction:"outgoing",type:"dom-manipulation",target:j,data:F,raw:G});try{$.value.contentWindow.postMessage(G,"*")}catch(X){console.error("[VDO.ninja] Failed to send DOM command:",X)}}function f(j,F=1){a("addScene",j,F),m.value=F}function i(j,F=1){a("addScene",j,0)}function g(j){C(j,{replace:!0})}function I(j){C(j,{add:!0})}function H(j){C(j,{remove:!0})}function T(j,F){a("mic",j,!F);const G=s.value.get(j);G&&(G.muted=F)}function b(j){a("mic",j,"toggle");const F=s.value.get(j);F&&(F.muted=!F.muted)}function y(j,F){a("volume",j,Math.max(0,Math.min(200,F)))}function l(j){a("soloChat",j)}function o(j){a("soloChatBidirectional",j)}function R(j,F){a("sendChat",j,F)}function h(j,F){a("sendDirectorChat",j,F)}function N(j){a("hangup",j),s.value.delete(j)}function D(j){j?a("togglescreenshare",j):a("togglescreenshare")}function v(j,F){a("forward",j,F)}function w(j="guests"){a("getGuestList",void 0,void 0)}function u(){a("record",void 0,!0),r.value=!0}function _(){a("record",void 0,!1),r.value=!1}function z(j){a("layout",void 0,j)}function L(j){j?a("reload",j):a("reload")}function k(j,F){a("mixorder",j,F==="up"?-1:1)}function E(j){a("camera",void 0,j)}function P(j,F){a("camera",j,F)}function B(j,F=!1){F?a("zoom",void 0,j,"abs"):a("zoom",void 0,j)}function ie(j){a("pan",void 0,j)}function de(j){a("tilt",void 0,j)}function Ce(j){const F=j.origin;if(!F.includes(c.split(":")[0])&&!F.includes("vdo.ninja")&&!F.includes("vdo.itagenten")&&!F.includes("localhost"))return;const G=j.data;if(!G||typeof G!="object")return;const ae=G.type||G.action||"unknown",X=G.streamID||G.UUID||G.streamId;switch(we({timestamp:Date.now(),direction:"incoming",type:ae,target:X,data:G.data||G.value,raw:G}),ae){case"director-ready":case"loaded":case"ready":case"started":d.value=!0,p.value="connected",x.value=null;break;case"new-guest":case"guest-connected":case"push":case"view":case"joined":{if(X){const Y=G.data,te={id:X,label:(Y==null?void 0:Y.label)||G.label||X,type:(Y==null?void 0:Y.type)||"guest",hasVideo:(Y==null?void 0:Y.video)!==!1,hasAudio:(Y==null?void 0:Y.audio)!==!1,muted:!1,audioLevel:0};s.value.set(X,te)}break}case"guest-left":case"guest-disconnected":case"left":case"disconnect":X&&s.value.delete(X);break;case"audio-level":case"loudness":{if(X){const Y=s.value.get(X);if(Y){const te=G.data;Y.audioLevel=(te==null?void 0:te.level)||G.value||0}}break}case"mute-state":case"muted":{if(X){const Y=s.value.get(X);if(Y){const te=G.data;Y.muted=(te==null?void 0:te.muted)??G.value??!1}}break}case"scene-changed":case"scene":{const Y=G.data,te=(Y==null?void 0:Y.scene)||G.value;m.value=typeof te=="number"?te:null;break}case"recording-started":r.value=!0;break;case"recording-stopped":r.value=!1;break;case"error":console.error("[VDO.ninja Error]",G.data),x.value=String(G.data);break}}return me(()=>{p.value="connecting",window.addEventListener("message",Ce),setTimeout(()=>{!d.value&&$.value&&(d.value=!0,p.value="connected")},5e3)}),xe(()=>{window.removeEventListener("message",Ce),p.value="disconnected"}),{isReady:d,sources:s,activeScene:m,isRecording:r,connectionState:p,lastError:x,addToScene:f,removeFromScene:i,setProgram:g,addSource:I,removeSource:H,setLayout:z,changeMixOrder:k,setMute:T,toggleMute:b,setVolume:y,soloAudio:l,soloChatBidirectional:o,sendToGuest:R,sendDirectorMessage:h,kickGuest:N,toggleScreenShare:D,transferGuest:v,getGuestList:w,refreshSource:L,setCamera:E,setGuestCamera:P,zoom:B,pan:ie,tilt:de,startRecording:u,stopRecording:_,sendCommand:a,sendDomCommand:C,getEventHistory:Pe,getEventStats:Oe}}const _o={key:0,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary z-10","data-testid":"vdo-loading"},So={class:"text-center"},$o={class:"text-xs text-r58-text-secondary mt-2"},Co={key:1,class:"absolute bottom-4 left-4 right-4 bg-red-500/90 text-white px-4 py-2 rounded-lg text-sm z-20"},Mo=["src","title"],Io=Z({__name:"VdoNinjaEmbed",props:{profile:{},sources:{},room:{},password:{}},setup($,{expose:d}){const s=$,m=M(null),r=oe(),p=wo(m),{isReady:x,sources:c,addToScene:a,removeFromScene:C,setMute:f,toggleMute:i,setVolume:g,sendCommand:I,sendDomCommand:H,isRecording:T,connectionState:b,lastError:y,startRecording:l,stopRecording:o,kickGuest:R,toggleScreenShare:h,setLayout:N,setProgram:D,addSource:v,removeSource:w,getEventHistory:u,getEventStats:_}=p,z=A(()=>{const k={};return s.sources&&(k.source_ids=s.sources.join(",")),s.room&&(k.room=s.room),s.password&&(k.password=s.password),Ne(s.profile,k)}),L=A(()=>s.profile==="mixer");return re(c,k=>{r.updateSourcesFromVdo(Array.from(k.values()))},{deep:!0}),d({isReady:x,isRecording:T,connectionState:b,lastError:y,addToScene:a,removeFromScene:C,setLayout:N,setProgram:D,addSource:v,removeSource:w,setMute:f,toggleMute:i,setVolume:g,startRecording:l,stopRecording:o,kickGuest:R,toggleScreenShare:h,sendCommand:I,sendDomCommand:H,getEventHistory:u,getEventStats:_}),(k,E)=>(t(),n("div",{class:O(["vdo-embed-container relative w-full h-full bg-black rounded-lg overflow-hidden",{"mixer-mode":L.value}]),"data-testid":"vdo-embed-container"},[K(x)?V("",!0):(t(),n("div",_o,[e("div",So,[E[0]||(E[0]=e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full mx-auto mb-4"},null,-1)),E[1]||(E[1]=e("p",{class:"text-r58-text-secondary"},"Connecting to VDO.ninja...",-1)),e("p",$o,S(L.value?"Loading mixer controls...":"Local mixer on R58"),1)])])),K(y)?(t(),n("div",Co,[E[2]||(E[2]=e("strong",null,"Error:",-1)),Q(" "+S(K(y)),1)])):V("",!0),e("iframe",{ref_key:"iframeRef",ref:m,src:z.value,class:O(["w-full h-full border-0",{"opacity-0":!K(x)}]),allow:"camera; microphone; display-capture; autoplay; clipboard-write",allowfullscreen:"","data-testid":"vdo-iframe",title:L.value?"VDO.ninja Mixer":"VDO.ninja"},null,10,Mo)],2))}}),Ro=le(Io,[["__scopeId","data-v-4a9e915e"]]),Eo={class:"camera-push-bar border-t border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"camera-push-bar"},Do={class:"flex items-center gap-2"},jo={class:"text-r58-text-secondary"},To={key:0,class:"px-4 pb-3"},Lo={key:0,class:"flex gap-3 flex-wrap"},Vo={class:"text-sm font-medium"},Po={class:"text-xs text-r58-text-secondary"},Oo=["onClick"],Uo={key:1,class:"text-sm text-r58-text-secondary py-2"},Ao={class:"hidden"},Ho=["src","onLoad","onError"],zo=Z({__name:"CameraPushBar",setup($){const d=ge(),s=M(new Map),m=M(!0),r=A(()=>d.inputs.filter(i=>i.hasSignal));function p(i){return Fe(i)}re(r,i=>{for(const I of i)if(!s.value.has(I.id)){const H=p(I.id),T=Ee(I.id,H,I.label);s.value.set(I.id,{cameraId:I.id,label:I.label,status:"connecting",iframeSrc:T})}const g=new Set(i.map(I=>I.id));for(const[I]of s.value)g.has(I)||s.value.delete(I)},{immediate:!0});function x(i){const g=s.value.get(i);g&&(g.status="connected",console.log(`[CameraPush] ${i} connected to VDO.ninja`))}function c(i){const g=s.value.get(i);g&&(g.status="error",console.error(`[CameraPush] ${i} failed to connect`))}function a(i){const g=d.inputs.find(T=>T.id===i);if(!g||!g.hasSignal)return;const I=p(i),H=Ee(i,I,g.label);s.value.set(i,{cameraId:i,label:g.label,status:"connecting",iframeSrc:H+`&_t=${Date.now()}`})}function C(i){switch(i){case"connected":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function f(i){switch(i){case"connected":return"Live in VDO.ninja";case"connecting":return"Connecting...";case"error":return"Failed to connect";default:return"Idle"}}return(i,g)=>(t(),n("div",Eo,[e("button",{onClick:g[0]||(g[0]=I=>m.value=!m.value),class:"w-full px-4 py-2 flex items-center justify-between text-sm hover:bg-r58-bg-tertiary/50 transition-colors","data-testid":"camera-push-toggle","aria-expanded":"expanded"},[e("div",Do,[g[1]||(g[1]=e("span",{class:"font-medium"},"Camera Sources",-1)),e("span",jo,"("+S(r.value.length)+" active)",1)]),(t(),n("svg",{class:O(["w-4 h-4 transition-transform",{"rotate-180":m.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...g[2]||(g[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),m.value?(t(),n("div",To,[s.value.size>0?(t(),n("div",Lo,[(t(!0),n(W,null,J(s.value,([I,H])=>(t(),n("div",{key:I,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},[e("span",{class:O(["w-2 h-2 rounded-full",C(H.status)])},null,2),e("span",Vo,S(H.label),1),e("span",Po,S(f(H.status)),1),H.status==="error"?(t(),n("button",{key:0,onClick:T=>a(I),class:"ml-2 text-xs text-r58-accent-primary hover:underline"}," Retry ",8,Oo)):V("",!0)]))),128))])):(t(),n("div",Uo," No cameras connected. Connect HDMI sources to push them to the mixer. "))])):V("",!0),e("div",Ao,[(t(!0),n(W,null,J(s.value,([I,H])=>(t(),n("iframe",{key:I,src:H.iframeSrc,onLoad:T=>x(I),onError:T=>c(I),allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,Ho))),128))])]))}}),Bo={class:"program-output space-y-3","data-testid":"program-output"},No={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg","data-testid":"program-output-status"},Fo={class:"text-sm font-medium","data-testid":"program-output-text"},Ko={key:0,class:"space-y-2"},Go={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},Wo={class:"flex-1 text-xs truncate text-r58-text-secondary"},Yo={key:0,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},Jo={class:"text-xs text-r58-text-secondary"},qo={key:1,class:"text-xs text-r58-text-secondary px-3"},Xo={class:"hidden"},Qo=["src"],Zo=Z({__name:"ProgramOutput",setup($){const d=oe(),s=he(),m=M(!1),r=M("idle"),p=M("");function x(){return`${window.location.origin}/api/v1/whip/program/whip`}function c(){m.value||(r.value="connecting",p.value=Ke(x()),m.value=!0,console.log("[ProgramOutput] Starting WHIP push to MediaMTX"))}function a(){m.value&&(m.value=!1,p.value="",r.value="idle",console.log("[ProgramOutput] Stopped WHIP push"))}function C(){m.value&&(r.value="live",console.log("[ProgramOutput] WHIP push connected"))}function f(){r.value="error",console.error("[ProgramOutput] WHIP push failed")}function i(){a(),setTimeout(()=>c(),500)}re(()=>d.isLive,T=>{T?c():a()});function g(){switch(r.value){case"live":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function I(){switch(r.value){case"live":return"MediaMTX connected";case"connecting":return"Connecting...";case"error":return"Connection failed";default:return"Inactive"}}function H(){const T=s.programOutputUrls.srt;navigator.clipboard.writeText(T),U.success("SRT URL copied")}return(T,b)=>(t(),n("div",Bo,[e("div",No,[e("span",{class:O(["w-2 h-2 rounded-full",g()]),"data-testid":"program-output-indicator"},null,2),e("span",Fo,S(I()),1),r.value==="error"?(t(),n("button",{key:0,onClick:b[0]||(b[0]=y=>i()),class:"ml-auto text-xs text-r58-accent-primary hover:underline"}," Retry ")):V("",!0)]),r.value==="live"?(t(),n("div",Ko,[e("div",Go,[b[1]||(b[1]=e("span",{class:"text-xs text-r58-text-secondary"},"ðŸ”´ SRT:",-1)),e("code",Wo,S(K(s).programOutputUrls.srt),1),e("button",{onClick:H,class:"text-xs text-r58-accent-primary hover:underline"},"Copy")]),K(s).enabledDestinations.length>0?(t(),n("div",Yo,[b[2]||(b[2]=e("span",{class:"w-2 h-2 rounded-full bg-emerald-500"},null,-1)),e("span",Jo,S(K(s).enabledDestinations.length)+" streaming destination"+S(K(s).enabledDestinations.length>1?"s":"")+" active ",1)])):V("",!0)])):V("",!0),r.value==="idle"?(t(),n("p",qo," Program output will start automatically when you go live. ")):V("",!0),e("div",Xo,[m.value&&p.value?(t(),n("iframe",{key:0,src:p.value,onLoad:C,onError:f,allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,Qo)):V("",!0)])]))}}),en={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},tn={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl"},on={class:"p-6 overflow-y-auto max-h-[60vh]"},nn={class:"mb-8"},sn={class:"flex items-center justify-between mb-4"},rn={key:0,class:"mb-4 p-4 bg-r58-bg-tertiary rounded-lg"},an={class:"grid grid-cols-2 gap-2"},ln=["onClick"],dn={class:"text-xl"},cn={key:1,class:"space-y-3"},un=["onClick"],vn={class:"text-xl"},mn={class:"flex-1"},pn={class:"font-medium"},gn={class:"text-xs text-r58-text-secondary"},xn=["onClick"],fn=["onClick"],bn={key:2,class:"text-r58-text-secondary text-sm"},yn={key:0,class:"mb-8 p-4 bg-r58-bg-tertiary rounded-lg"},hn={class:"text-lg font-medium mb-4"},kn={class:"space-y-4"},wn=["placeholder"],_n={key:0},Sn={class:"flex gap-2"},$n={class:"mb-8"},Cn={class:"space-y-3"},Mn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},In={class:"flex items-center justify-between mb-1"},Rn={class:"text-xs text-r58-text-secondary break-all"},En={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Dn={class:"flex items-center justify-between mb-1"},jn={class:"text-xs text-r58-text-secondary break-all"},Tn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Ln={class:"flex items-center justify-between mb-1"},Vn={class:"text-xs text-r58-text-secondary break-all"},Pn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},On={class:"flex items-center justify-between mb-1"},Un={class:"text-xs text-r58-text-secondary break-all"},An={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Hn={class:"flex items-center justify-between mb-1"},zn={class:"text-xs text-r58-text-secondary break-all"},Bn={class:"p-4 bg-r58-bg-tertiary rounded-lg"},Nn={class:"flex items-center gap-3 mb-4"},Fn=Z({__name:"StreamingSettings",setup($,{expose:d}){const s=he(),m=M(!1),r=M(null),p=M(!1);M(""),M("");const x=A(()=>s.destinations),c=A(()=>ce),a=A(()=>s.programOutputUrls);function C(){m.value=!0}function f(){m.value=!1,r.value=null,p.value=!1}function i(l){const o=s.addDestination(l);r.value=o,p.value=!1,s.saveDestinations()}function g(){r.value&&(s.updateDestination(r.value.id,r.value),s.saveDestinations(),r.value=null,U.success("Streaming destination saved"))}function I(l){s.removeDestination(l),s.saveDestinations(),U.info("Destination removed")}function H(l){s.updateDestination(l.id,{enabled:!l.enabled}),s.saveDestinations()}function T(l,o){navigator.clipboard.writeText(l),U.success(`${o} copied to clipboard`)}function b(l){const o=ce.find(R=>R.id===l);return(o==null?void 0:o.icon)||"ðŸ“¡"}function y(l){const o=ce.find(R=>R.id===l);return(o==null?void 0:o.name)||"Unknown"}return d({open:C}),(l,o)=>{var R;return t(),pe(ye,{to:"body"},[m.value?(t(),n("div",en,[e("div",{class:"absolute inset-0 bg-black/60",onClick:f}),e("div",tn,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[o[11]||(o[11]=e("h2",{class:"text-xl font-semibold"},"Streaming Settings",-1)),e("button",{onClick:f,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",on,[e("section",nn,[e("div",sn,[o[12]||(o[12]=e("h3",{class:"text-lg font-medium"},"Streaming Destinations",-1)),e("button",{onClick:o[0]||(o[0]=h=>p.value=!p.value),class:"btn btn-sm btn-primary"}," + Add Platform ")]),p.value?(t(),n("div",rn,[o[13]||(o[13]=e("p",{class:"text-sm text-r58-text-secondary mb-3"},"Select a streaming platform:",-1)),e("div",an,[(t(!0),n(W,null,J(c.value,h=>(t(),n("button",{key:h.id,onClick:N=>i(h.id),class:"flex items-center gap-2 p-3 bg-r58-bg-secondary hover:bg-r58-accent-primary/20 rounded-lg transition-colors text-left"},[e("span",dn,S(h.icon),1),e("span",null,S(h.name),1)],8,ln))),128))])])):V("",!0),x.value.length>0?(t(),n("div",cn,[(t(!0),n(W,null,J(x.value,h=>(t(),n("div",{key:h.id,class:"flex items-center gap-3 p-3 bg-r58-bg-tertiary rounded-lg"},[e("button",{onClick:N=>H(h),class:O(["w-10 h-6 rounded-full transition-colors relative",h.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:O(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",h.enabled?"left-5":"left-1"])},null,2)],10,un),e("span",vn,S(b(h.platformId)),1),e("div",mn,[e("div",pn,S(h.name),1),e("div",gn,S(h.streamKey?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"+h.streamKey.slice(-4):"No stream key"),1)]),e("button",{onClick:N=>r.value={...h},class:"text-r58-accent-primary hover:underline text-sm"}," Edit ",8,xn),e("button",{onClick:N=>I(h.id),class:"text-r58-accent-danger hover:underline text-sm"}," Remove ",8,fn)]))),128))])):(t(),n("p",bn," No streaming destinations configured. Add a platform above. "))]),r.value?(t(),n("section",yn,[e("h3",hn," Edit "+S(y(r.value.platformId)),1),e("div",kn,[e("div",null,[o[14]||(o[14]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Display Name",-1)),q(e("input",{"onUpdate:modelValue":o[1]||(o[1]=h=>r.value.name=h),type:"text",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ne,r.value.name]])]),e("div",null,[o[15]||(o[15]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Stream Key",-1)),q(e("input",{"onUpdate:modelValue":o[2]||(o[2]=h=>r.value.streamKey=h),type:"password",placeholder:(R=K(ce).find(h=>h.id===r.value.platformId))==null?void 0:R.streamKeyPlaceholder,class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,8,wn),[[ne,r.value.streamKey]]),o[16]||(o[16]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Your stream key is stored locally and never sent to our servers. ",-1))]),r.value.platformId==="custom"?(t(),n("div",_n,[o[17]||(o[17]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"RTMP URL",-1)),q(e("input",{"onUpdate:modelValue":o[3]||(o[3]=h=>r.value.name=h),type:"text",placeholder:"rtmp://your-server.com/live/",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,512),[[ne,r.value.name]])])):V("",!0),e("div",Sn,[e("button",{onClick:g,class:"btn btn-primary"}," Save "),e("button",{onClick:o[4]||(o[4]=h=>r.value=null),class:"btn"}," Cancel ")])])])):V("",!0),e("section",$n,[o[26]||(o[26]=e("h3",{class:"text-lg font-medium mb-4"},"Program Output URLs",-1)),o[27]||(o[27]=e("p",{class:"text-sm text-r58-text-secondary mb-4"}," Use these URLs to consume the program feed from MediaMTX: ",-1)),e("div",Cn,[e("div",Mn,[e("div",In,[o[18]||(o[18]=e("span",{class:"font-medium"},"ðŸ”´ SRT Output",-1)),e("button",{onClick:o[5]||(o[5]=h=>T(a.value.srt,"SRT URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Rn,S(a.value.srt),1),o[19]||(o[19]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Low-latency, reliable transport. Ideal for remote production. ",-1))]),e("div",En,[e("div",Dn,[o[20]||(o[20]=e("span",{class:"font-medium"},"ðŸ“º RTMP Output",-1)),e("button",{onClick:o[6]||(o[6]=h=>T(a.value.rtmp,"RTMP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",jn,S(a.value.rtmp),1)]),e("div",Tn,[e("div",Ln,[o[21]||(o[21]=e("span",{class:"font-medium"},"ðŸŽ¬ RTSP Output",-1)),e("button",{onClick:o[7]||(o[7]=h=>T(a.value.rtsp,"RTSP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Vn,S(a.value.rtsp),1)]),e("div",Pn,[e("div",On,[o[22]||(o[22]=e("span",{class:"font-medium"},"ðŸŒ HLS Output",-1)),e("button",{onClick:o[8]||(o[8]=h=>T(a.value.hls,"HLS URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Un,S(a.value.hls),1),o[23]||(o[23]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Browser-compatible streaming. Higher latency. ",-1))]),e("div",An,[e("div",Hn,[o[24]||(o[24]=e("span",{class:"font-medium"},"âš¡ WebRTC (WHEP)",-1)),e("button",{onClick:o[9]||(o[9]=h=>T(a.value.whep,"WHEP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",zn,S(a.value.whep),1),o[25]||(o[25]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Ultra-low latency WebRTC. Best for interactive use. ",-1))])])]),e("section",null,[o[30]||(o[30]=e("h3",{class:"text-lg font-medium mb-4"},"SRT Configuration",-1)),e("div",Bn,[e("div",Nn,[e("button",{onClick:o[10]||(o[10]=h=>K(s).toggleSrtOutput(!K(s).srtOutput.enabled)),class:O(["w-10 h-6 rounded-full transition-colors relative",K(s).srtOutput.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:O(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",K(s).srtOutput.enabled?"left-5":"left-1"])},null,2)],2),o[28]||(o[28]=e("span",null,"Enable SRT Output",-1))]),o[29]||(o[29]=e("div",{class:"text-sm text-r58-text-secondary"},[e("p",{class:"mb-2"},"SRT (Secure Reliable Transport) provides:"),e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Low latency (typically 1-2 seconds)"),e("li",null,"Error correction for unreliable networks"),e("li",null,"AES encryption support"),e("li",null,"Compatible with OBS, vMix, and professional equipment")])],-1))])])]),e("div",{class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},[e("button",{onClick:f,class:"btn"},"Close")])])])):V("",!0)])}}}),Kn={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Gn={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-3xl max-h-[80vh] overflow-hidden shadow-2xl","data-testid":"hotkey-settings-modal"},Wn={class:"flex border-b border-r58-bg-tertiary"},Yn=["onClick"],Jn={class:"p-6 overflow-y-auto max-h-[55vh]"},qn={key:0,class:"text-center py-12 text-r58-text-secondary"},Xn={key:1,class:"space-y-6"},Qn={class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},Zn={class:"space-y-2"},es={class:"flex-1"},ts={class:"text-sm"},os={key:0,class:"ml-2 text-xs text-r58-accent-primary"},ns={class:"flex items-center gap-2"},ss={key:0,class:"flex items-center gap-2"},rs={key:0,class:"px-3 py-1 bg-r58-accent-primary text-white rounded text-sm font-mono"},is={key:1,class:"text-sm text-r58-text-secondary animate-pulse"},as={class:"px-3 py-1 bg-r58-bg-secondary border border-r58-bg-tertiary rounded text-sm font-mono"},ls=["onClick"],ds=["onClick"],Le="r58-hotkey-customizations",cs=Z({__name:"HotkeySettings",setup($,{expose:d}){const s=[{id:"help",key:"?",modifiers:["shift"],description:"Show keyboard shortcuts",context:"global",category:"Navigation",editable:!1},{id:"goto-recorder",key:"r",modifiers:["alt"],description:"Go to Recorder",context:"global",category:"Navigation",editable:!0},{id:"goto-mixer",key:"m",modifiers:["alt"],description:"Go to Mixer",context:"global",category:"Navigation",editable:!0},{id:"escape",key:"Escape",description:"Close modal / Cancel",context:"global",category:"Navigation",editable:!1},{id:"scene-1",key:"1",description:"Select Scene 1 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-2",key:"2",description:"Select Scene 2 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-3",key:"3",description:"Select Scene 3 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-4",key:"4",description:"Select Scene 4 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-5",key:"5",description:"Select Scene 5 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-6",key:"6",description:"Select Scene 6 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-7",key:"7",description:"Select Scene 7 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-8",key:"8",description:"Select Scene 8 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"take",key:" ",description:"TAKE - Transition preview to program",context:"mixer",category:"Transitions",editable:!1},{id:"cut",key:"Escape",description:"CUT - Immediate switch to preview",context:"mixer",category:"Transitions",editable:!1},{id:"transition-cut",key:"t",description:"Set transition: Cut",context:"mixer",category:"Transitions",editable:!0},{id:"transition-fade",key:"f",description:"Set transition: Fade",context:"mixer",category:"Transitions",editable:!0},{id:"go-live",key:"g",description:"Toggle Go Live",context:"mixer",category:"Control",editable:!0},{id:"toggle-recording",key:"r",description:"Toggle recording",context:"mixer",category:"Control",editable:!0},{id:"mute-all",key:"m",modifiers:["ctrl"],description:"Mute all sources",context:"mixer",category:"Control",editable:!0},{id:"toggle-sidebar",key:"s",modifiers:["ctrl"],description:"Toggle sidebar",context:"mixer",category:"Control",editable:!0},{id:"mute-1",key:"F1",description:"Toggle mute: Source 1",context:"mixer",category:"Audio",editable:!0},{id:"mute-2",key:"F2",description:"Toggle mute: Source 2",context:"mixer",category:"Audio",editable:!0},{id:"mute-3",key:"F3",description:"Toggle mute: Source 3",context:"mixer",category:"Audio",editable:!0},{id:"mute-4",key:"F4",description:"Toggle mute: Source 4",context:"mixer",category:"Audio",editable:!0},{id:"start-stop-recording",key:" ",description:"Start/Stop recording",context:"recorder",category:"Recording",editable:!0},{id:"mark-chapter",key:"c",description:"Mark chapter point",context:"recorder",category:"Recording",editable:!0},{id:"select-all",key:"a",modifiers:["ctrl"],description:"Select all cameras",context:"recorder",category:"Recording",editable:!0}],m=M(!1),r=M("mixer"),p=M({}),x=M(null),c=M(null);function a(){try{const v=localStorage.getItem(Le);v&&(p.value=JSON.parse(v))}catch(v){console.warn("[HotkeySettings] Failed to load customizations:",v)}}function C(){try{localStorage.setItem(Le,JSON.stringify(p.value))}catch(v){console.warn("[HotkeySettings] Failed to save customizations:",v)}}function f(v){const w=p.value[v.id];return w?{...v,key:w.key,modifiers:w.modifiers}:v}const i=A(()=>{const v={global:{},mixer:{},recorder:{}};for(const w of s){const u=f(w);v[w.context][u.category]||(v[w.context][u.category]=[]),v[w.context][u.category].push(u)}return v}),g=A(()=>i.value[r.value]||{});function I(v){return Ie(v.key,v.modifiers)}function H(v){return!!p.value[v]}function T(v){const w=s.find(u=>u.id===v);w!=null&&w.editable&&(x.value=v,c.value=null,document.addEventListener("keydown",b))}function b(v){if(v.preventDefault(),v.stopPropagation(),["Control","Alt","Shift","Meta"].includes(v.key))return;const w=[];v.ctrlKey&&w.push("ctrl"),v.altKey&&w.push("alt"),v.shiftKey&&w.push("shift"),v.metaKey&&w.push("meta"),c.value={key:v.key,modifiers:w},document.removeEventListener("keydown",b)}function y(){!x.value||!c.value||(p.value[x.value]={key:c.value.key,modifiers:c.value.modifiers.length>0?c.value.modifiers:void 0},C(),U.success("Hotkey updated"),x.value=null,c.value=null)}function l(){x.value=null,c.value=null,document.removeEventListener("keydown",b)}function o(v){delete p.value[v],C(),U.info("Hotkey reset to default")}function R(){confirm("Reset all hotkeys to defaults?")&&(p.value={},C(),U.info("All hotkeys reset to defaults"))}function h(){a(),m.value=!0}function N(){l(),m.value=!1}me(()=>{a()});function D(){return{...p.value}}return d({open:h,getCustomBindings:D}),(v,w)=>(t(),pe(ye,{to:"body"},[m.value?(t(),n("div",Kn,[e("div",{class:"absolute inset-0 bg-black/60",onClick:N}),e("div",Gn,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[w[0]||(w[0]=e("h2",{class:"text-xl font-semibold"},"Keyboard Shortcuts",-1)),e("div",{class:"flex items-center gap-4"},[e("button",{onClick:R,class:"text-sm text-r58-text-secondary hover:text-r58-text-primary"}," Reset All "),e("button",{onClick:N,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")])]),e("div",Wn,[(t(),n(W,null,J(["mixer","global","recorder"],u=>e("button",{key:u,onClick:_=>r.value=u,class:O(["px-6 py-3 text-sm font-medium capitalize transition-colors",r.value===u?"text-r58-accent-primary border-b-2 border-r58-accent-primary":"text-r58-text-secondary hover:text-r58-text-primary"])},S(u),11,Yn)),64))]),e("div",Jn,[Object.keys(g.value).length===0?(t(),n("div",qn," No shortcuts defined for this context. ")):(t(),n("div",Xn,[(t(!0),n(W,null,J(g.value,(u,_)=>(t(),n("div",{key:_},[e("h3",Qn,S(_),1),e("div",Zn,[(t(!0),n(W,null,J(u,z=>(t(),n("div",{key:z.id,class:O(["flex items-center justify-between p-3 bg-r58-bg-tertiary rounded-lg",{"ring-2 ring-r58-accent-primary":x.value===z.id}])},[e("div",es,[e("span",ts,S(z.description),1),H(z.id)?(t(),n("span",os,"(customized)")):V("",!0)]),e("div",ns,[x.value===z.id?(t(),n("div",ss,[c.value?(t(),n("kbd",rs,S(K(Ie)(c.value.key,c.value.modifiers)),1)):(t(),n("span",is," Press a key... ")),c.value?(t(),n("button",{key:2,onClick:y,class:"btn btn-sm btn-primary"}," Save ")):V("",!0),e("button",{onClick:l,class:"btn btn-sm"}," Cancel ")])):(t(),n(W,{key:1},[e("kbd",as,S(I(z)),1),z.editable?(t(),n("button",{key:0,onClick:L=>T(z.id),class:"text-xs text-r58-accent-primary hover:underline"}," Edit ",8,ls)):V("",!0),H(z.id)?(t(),n("button",{key:1,onClick:L=>o(z.id),class:"text-xs text-r58-text-secondary hover:text-r58-accent-danger"}," Reset ",8,ds)):V("",!0)],64))])],2))),128))])]))),128))]))]),e("div",{class:"flex items-center justify-between px-6 py-4 border-t border-r58-bg-tertiary"},[w[1]||(w[1]=e("div",{class:"text-sm text-r58-text-secondary"},' Click "Edit" to customize a shortcut. Press any key combination to set. ',-1)),e("button",{onClick:N,class:"btn"},"Close")])])])):V("",!0)]))}}),us={class:"connection-status","data-testid":"connection-status"},vs={class:"text-xs text-r58-text-secondary"},ms={key:0,class:"text-xs text-r58-accent-danger",title:"Click for details"},ps={key:0,class:"mt-2 p-3 bg-r58-bg-tertiary rounded-lg text-xs space-y-2"},gs={class:"grid grid-cols-2 gap-2"},xs={class:"ml-1 font-medium"},fs={class:"ml-1"},bs={class:"ml-1"},ys={key:0,class:"p-2 bg-r58-accent-danger/10 border border-r58-accent-danger/30 rounded text-r58-accent-danger"},hs={class:"flex gap-2 pt-2 border-t border-r58-bg-tertiary"},ks=["disabled"],ws={key:1,class:"text-r58-text-secondary text-center"},_s=Z({__name:"ConnectionStatus",props:{vdoEmbed:{}},setup($){const d=$;oe();const s=M(!1),m=M("never"),r=M(0),p=M(!1),x=A(()=>{var l,o;return((o=(l=d.vdoEmbed)==null?void 0:l.connectionState)==null?void 0:o.value)||"disconnected"}),c=A(()=>{var l,o;return((o=(l=d.vdoEmbed)==null?void 0:l.isReady)==null?void 0:o.value)||!1}),a=A(()=>{var l,o;return((o=(l=d.vdoEmbed)==null?void 0:l.lastError)==null?void 0:o.value)||null}),C=A(()=>x.value==="disconnected"||!c.value?"disconnected":a.value?"error":x.value==="connecting"?"degraded":"healthy"),f=A(()=>{switch(C.value){case"healthy":return"bg-r58-accent-success";case"degraded":return"bg-amber-500";case"error":return"bg-r58-accent-danger";case"disconnected":return"bg-r58-text-secondary";default:return"bg-r58-text-secondary"}}),i=A(()=>{switch(C.value){case"healthy":return"Connected";case"degraded":return"Connecting...";case"error":return"Error";case"disconnected":return"Disconnected";default:return"Unknown"}});let g=null;function I(){if(d.vdoEmbed){const l=d.vdoEmbed.getEventStats();if(l.lastActivity){const o=Date.now()-l.lastActivity;o<1e3?m.value="just now":o<6e4?m.value=`${Math.floor(o/1e3)}s ago`:o<36e5?m.value=`${Math.floor(o/6e4)}m ago`:m.value="over 1h ago"}}}me(()=>{I(),g=window.setInterval(I,1e3)}),xe(()=>{g&&clearInterval(g)});async function H(){if(!p.value){p.value=!0,r.value++,U.info("Attempting to reconnect...");try{d.vdoEmbed&&d.vdoEmbed.sendCommand("ping"),await new Promise(l=>setTimeout(l,2e3)),c.value&&!a.value?(U.success("Reconnected successfully"),r.value=0):U.error("Reconnection failed. Try refreshing the page.")}catch(l){U.error("Reconnection error"),console.error("[ConnectionStatus] Reconnect error:",l)}finally{p.value=!1}}}function T(){confirm("This will refresh the page and may interrupt active streams. Continue?")&&window.location.reload()}function b(){s.value=!s.value}const y=A(()=>d.vdoEmbed?d.vdoEmbed.getEventStats():{total:0,incoming:0,outgoing:0,lastActivity:null});return(l,o)=>(t(),n("div",us,[e("div",{class:"flex items-center gap-2 cursor-pointer",onClick:b},[e("span",{class:O(["w-2 h-2 rounded-full",[f.value,{"animate-pulse":C.value==="degraded"}]]),"data-testid":"status-indicator"},null,2),e("span",vs,S(i.value),1),a.value?(t(),n("span",ms," âš ï¸ ")):V("",!0),(t(),n("svg",{class:O(["w-3 h-3 text-r58-text-secondary transition-transform",{"rotate-180":s.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...o[0]||(o[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),s.value?(t(),n("div",ps,[e("div",gs,[e("div",null,[o[1]||(o[1]=e("span",{class:"text-r58-text-secondary"},"VDO.ninja:",-1)),e("span",{class:O(["ml-1 font-medium",c.value?"text-r58-accent-success":"text-r58-accent-danger"])},S(c.value?"Ready":"Not Ready"),3)]),e("div",null,[o[2]||(o[2]=e("span",{class:"text-r58-text-secondary"},"State:",-1)),e("span",xs,S(x.value),1)]),e("div",null,[o[3]||(o[3]=e("span",{class:"text-r58-text-secondary"},"Last activity:",-1)),e("span",fs,S(m.value),1)]),e("div",null,[o[4]||(o[4]=e("span",{class:"text-r58-text-secondary"},"Events:",-1)),e("span",bs,S(y.value.total),1)])]),a.value?(t(),n("div",ys,[o[5]||(o[5]=e("strong",null,"Error:",-1)),Q(" "+S(a.value),1)])):V("",!0),e("div",hs,[e("button",{onClick:H,disabled:p.value,class:O(["btn btn-sm flex-1",{"opacity-50":p.value}])},S(p.value?"Reconnecting...":"ðŸ”„ Reconnect"),11,ks),e("button",{onClick:T,class:"btn btn-sm",title:"Refresh the page (last resort)"}," ðŸ”ƒ Refresh ")]),r.value>0?(t(),n("div",ws," Reconnect attempts: "+S(r.value),1)):V("",!0)])):V("",!0)]))}}),Ss={class:"recording-controls space-y-3","data-testid":"recording-controls"},$s={class:"flex items-center gap-3 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},Cs={class:"text-sm font-medium flex-1","data-testid":"recording-status"},Ms={key:0,class:"text-lg font-mono font-bold text-r58-accent-danger","data-testid":"recording-duration"},Is=["disabled"],Rs={key:0,class:"px-3 py-2 bg-r58-accent-success/10 border border-r58-accent-success/30 rounded-lg"},Es={class:"flex items-center justify-between"},Ds=["href"],js=Z({__name:"RecordingControls",props:{vdoEmbed:{}},setup($){const d=$,s=M(!1),m=M(null),r=M(0),p=M(null),x=M(!1);re(()=>{var b,y;return(y=(b=d.vdoEmbed)==null?void 0:b.isRecording)==null?void 0:y.value},b=>{b!==void 0&&(s.value=b,b&&!m.value?m.value=Date.now():!b&&m.value&&(m.value=null))});let c=null;function a(){c&&clearInterval(c),c=window.setInterval(()=>{m.value&&(r.value=Date.now()-m.value)},100)}function C(){c&&(clearInterval(c),c=null)}me(()=>{a()}),xe(()=>{C()});const f=A(()=>{const b=Math.floor(r.value/1e3),y=Math.floor(b/3600),l=Math.floor(b%3600/60),o=b%60;return y>0?`${y}:${l.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`:`${l}:${o.toString().padStart(2,"0")}`});async function i(){if(!d.vdoEmbed){U.error("VDO.ninja not connected");return}x.value=!0;try{d.vdoEmbed.startRecording(),s.value=!0,m.value=Date.now(),r.value=0,p.value=null,U.success("Recording started")}catch(b){U.error("Failed to start recording"),console.error("[RecordingControls] Start recording error:",b)}finally{x.value=!1}}async function g(){if(!d.vdoEmbed){U.error("VDO.ninja not connected");return}x.value=!0;try{d.vdoEmbed.stopRecording(),s.value=!1,m.value=null,U.success(`Recording stopped (${f.value})`)}catch(b){U.error("Failed to stop recording"),console.error("[RecordingControls] Stop recording error:",b)}finally{x.value=!1}}function I(){s.value?g():i()}function H(){return s.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"}function T(){return x.value?"Processing...":s.value?`Recording â€¢ ${f.value}`:"Ready to record"}return(b,y)=>(t(),n("div",Ss,[e("div",$s,[e("span",{class:O(["w-3 h-3 rounded-full",H()]),"data-testid":"recording-indicator"},null,2),e("span",Cs,S(T()),1),s.value?(t(),n("span",Ms,S(f.value),1)):V("",!0)]),e("div",null,[e("button",{onClick:I,disabled:x.value,class:O(["btn w-full justify-center",s.value?"btn-danger":"btn-primary"]),"data-testid":"recording-toggle-button"},[x.value?(t(),n(W,{key:0},[y[0]||(y[0]=e("svg",{class:"animate-spin w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),y[1]||(y[1]=Q(" Processing... ",-1))],64)):s.value?(t(),n(W,{key:1},[y[2]||(y[2]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("rect",{x:"6",y:"6",width:"12",height:"12",rx:"1"})],-1)),y[3]||(y[3]=Q(" Stop Recording ",-1))],64)):(t(),n(W,{key:2},[y[4]||(y[4]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("circle",{cx:"12",cy:"12",r:"8"})],-1)),y[5]||(y[5]=Q(" Start Recording ",-1))],64))],10,Is)]),p.value?(t(),n("div",Rs,[e("div",Es,[y[6]||(y[6]=e("span",{class:"text-sm text-r58-accent-success"},"Recording ready!",-1)),e("a",{href:p.value,download:"",class:"text-sm text-r58-accent-primary hover:underline"}," Download ",8,Ds)])])):V("",!0),y[7]||(y[7]=e("p",{class:"text-xs text-r58-text-secondary px-1"}," Records the mixed output locally in your browser. Recording is saved when stopped. ",-1))]))}}),Ts=le(js,[["__scopeId","data-v-14707e66"]]),Ls={class:"audio-mixer space-y-4","data-testid":"audio-mixer"},Vs={class:"master-volume p-3 bg-r58-bg-tertiary rounded-lg"},Ps={class:"flex items-center justify-between mb-2"},Os={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Us={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},As=["value"],Hs={class:"text-xs text-r58-text-secondary text-center mt-1"},zs={key:0,class:"space-y-2"},Bs={class:"flex items-center gap-2 mb-2"},Ns={class:"text-xs font-medium truncate flex-1"},Fs=["onClick"],Ks=["onClick"],Gs={class:"h-1.5 bg-r58-bg-secondary rounded-full overflow-hidden mb-2"},Ws=["value","onInput","disabled"],Ys={key:1,class:"text-center py-4 text-r58-text-secondary"},Js=Z({__name:"AudioMixer",props:{vdoEmbed:{}},setup($){const d=$,s=oe(),m=A(()=>s.connectedSources.filter(f=>f.hasAudio));function r(f,i){var g,I;if(s.setSourceVolume(f.id,i),d.vdoEmbed){const H=Math.round(i*2);(I=(g=d.vdoEmbed).setVolume)==null||I.call(g,f.id,H)}}function p(f){var g,I;const i=!f.muted;s.setSourceMute(f.id,i),d.vdoEmbed&&((I=(g=d.vdoEmbed).setMute)==null||I.call(g,f.id,i))}function x(f){var g,I;const i=!f.solo;s.setSourceSolo(f.id,i),d.vdoEmbed&&i&&((I=(g=d.vdoEmbed).sendCommand)==null||I.call(g,"soloChat",f.id))}function c(){s.setMasterMuted(!s.masterMuted)}function a(f){s.setMasterVolume(f)}function C(f){return f>80?"bg-red-500":f>60?"bg-amber-500":"bg-emerald-500"}return(f,i)=>(t(),n("div",Ls,[e("div",Vs,[e("div",Ps,[i[3]||(i[3]=e("span",{class:"text-xs font-medium"},"Master",-1)),e("button",{onClick:c,class:O(["p-1 rounded hover:bg-r58-bg-secondary transition-colors",{"text-red-400":K(s).masterMuted}])},[K(s).masterMuted?(t(),n("svg",Os,[...i[1]||(i[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(t(),n("svg",Us,[...i[2]||(i[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],2)]),e("input",{type:"range",value:K(s).masterVolume,onInput:i[0]||(i[0]=g=>a(g.target.valueAsNumber)),min:"0",max:"100",class:"w-full h-2 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary"},null,40,As),e("div",Hs,S(K(s).masterVolume)+"% ",1)]),m.value.length>0?(t(),n("div",zs,[(t(!0),n(W,null,J(m.value,g=>(t(),n("div",{key:g.id,class:"source-channel p-2 bg-r58-bg-tertiary/50 rounded-lg"},[e("div",Bs,[e("span",Ns,S(g.label),1),e("button",{onClick:I=>x(g),class:O(["w-6 h-6 text-xs font-bold rounded transition-colors",g.solo?"bg-amber-500 text-black":"bg-r58-bg-secondary text-r58-text-secondary hover:text-r58-text-primary"]),title:"Solo"}," S ",10,Fs),e("button",{onClick:I=>p(g),class:O(["w-6 h-6 text-xs font-bold rounded transition-colors",g.muted?"bg-red-500 text-white":"bg-r58-bg-secondary text-r58-text-secondary hover:text-r58-text-primary"]),title:"Mute"}," M ",10,Ks)]),e("div",Gs,[e("div",{class:O(["h-full transition-all duration-75 rounded-full",g.muted?"bg-r58-bg-tertiary":C(g.audioLevel)]),style:ue({width:`${g.audioLevel}%`})},null,6)]),e("input",{type:"range",value:g.volume||100,onInput:I=>r(g,I.target.valueAsNumber),min:"0",max:"100",disabled:g.muted,class:"w-full h-1.5 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary disabled:opacity-50"},null,40,Ws)]))),128))])):(t(),n("div",Ys,[...i[4]||(i[4]=[e("svg",{class:"w-6 h-6 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})],-1),e("p",{class:"text-xs"},"No audio sources",-1)])]))]))}}),qs=le(Js,[["__scopeId","data-v-cecaf15d"]]),Xs={class:"transition-settings space-y-3","data-testid":"transition-settings"},Qs={class:"grid grid-cols-3 gap-1"},Zs=["onClick"],er={class:"block text-sm mb-0.5"},tr=["disabled"],or=["value"],nr={class:"p-3 bg-r58-bg-tertiary rounded-lg"},sr={class:"flex items-center justify-between text-xs"},rr={class:"font-mono"},ir={key:0},ar=Z({__name:"TransitionSettings",setup($){const d=oe(),s=A({get:()=>d.transition.type,set:c=>d.setTransition({type:c})}),m=A({get:()=>d.transition.duration,set:c=>d.setTransition({duration:c})}),r=[{value:"cut",label:"Cut",icon:"âš¡"},{value:"fade",label:"Fade",icon:"ðŸŒ«ï¸"},{value:"wipe-left",label:"Wipe L",icon:"â—€"},{value:"wipe-right",label:"Wipe R",icon:"â–¶"},{value:"wipe-up",label:"Wipe Up",icon:"â–²"},{value:"wipe-down",label:"Wipe Down",icon:"â–¼"}],p=[{value:0,label:"0ms"},{value:100,label:"100ms"},{value:300,label:"300ms"},{value:500,label:"500ms"},{value:750,label:"750ms"},{value:1e3,label:"1s"},{value:2e3,label:"2s"}];function x(c){d.setTransition({type:c})}return(c,a)=>{var C;return t(),n("div",Xs,[e("div",Qs,[(t(),n(W,null,J(r,f=>e("button",{key:f.value,onClick:i=>x(f.value),class:O(["px-2 py-2 text-xs rounded transition-colors text-center",s.value===f.value?"bg-r58-accent-primary text-white":"bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 text-r58-text-secondary"])},[e("span",er,S(f.icon),1),Q(" "+S(f.label),1)],10,Zs)),64))]),e("div",null,[a[1]||(a[1]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Duration",-1)),q(e("select",{"onUpdate:modelValue":a[0]||(a[0]=f=>m.value=f),class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none",disabled:s.value==="cut"},[(t(),n(W,null,J(p,f=>e("option",{key:f.value,value:f.value},S(f.label),9,or)),64))],8,tr),[[_e,m.value,void 0,{number:!0}]])]),e("div",nr,[e("div",sr,[a[2]||(a[2]=e("span",{class:"text-r58-text-secondary"},"Current:",-1)),e("span",rr,[Q(S((C=r.find(f=>f.value===s.value))==null?void 0:C.label)+" ",1),s.value!=="cut"?(t(),n("span",ir," ("+S(m.value)+"ms)",1)):V("",!0)])])]),a[3]||(a[3]=e("p",{class:"text-xs text-r58-text-secondary"},[Q(" Press "),e("kbd",{class:"px-1 py-0.5 bg-r58-bg-tertiary rounded"},"Space"),Q(" to Take with transition ")],-1))])}}}),lr={class:"invite-links space-y-3","data-testid":"invite-links"},dr={key:0,class:"space-y-2"},cr={class:"p-2 bg-r58-bg-tertiary rounded-lg"},ur={class:"text-xs text-r58-text-secondary break-all block"},vr={key:1,class:"space-y-2 p-3 bg-r58-bg-tertiary rounded-lg"},mr={class:"flex items-center gap-2 text-xs"},pr={class:"flex items-center gap-2 text-xs"},gr={key:2,class:"text-center"},xr={key:0,class:"mt-2 flex justify-center"},fr=["src"],br={class:"text-xs text-r58-text-secondary text-center"},yr={class:"font-mono"},hr=Z({__name:"InviteLinks",setup($){const d=M(""),s=M(!1),m=M(!0),r=M(!0),p=A(()=>d.value.trim()?Ge(d.value.trim()):"");function x(){if(!p.value){U.error("Enter a guest name first");return}navigator.clipboard.writeText(p.value),U.success("Invite link copied!")}function c(){if(!p.value){U.error("Enter a guest name first");return}window.open(p.value,"_blank")}async function a(){if(!p.value){U.error("Enter a guest name first");return}if(navigator.share)try{await navigator.share({title:`Join ${De} as ${d.value}`,text:`Click to join the video call as ${d.value}`,url:p.value})}catch(f){f.name!=="AbortError"&&x()}else x()}const C=A(()=>p.value?`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(p.value)}`:"");return(f,i)=>(t(),n("div",lr,[e("div",null,[i[5]||(i[5]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Guest Name",-1)),q(e("input",{"onUpdate:modelValue":i[0]||(i[0]=g=>d.value=g),type:"text",placeholder:"e.g., John Smith",class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ne,d.value]])]),p.value?(t(),n("div",dr,[e("div",cr,[e("code",ur,S(p.value),1)]),e("div",{class:"flex gap-2"},[e("button",{onClick:x,class:"flex-1 btn btn-sm btn-primary"},[...i[6]||(i[6]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})],-1),Q(" Copy ",-1)])]),e("button",{onClick:a,class:"btn btn-sm",title:"Share"},[...i[7]||(i[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})],-1)])]),e("button",{onClick:c,class:"btn btn-sm",title:"Open in new tab"},[...i[8]||(i[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)])])])])):V("",!0),e("button",{onClick:i[1]||(i[1]=g=>s.value=!s.value),class:"w-full text-xs text-r58-text-secondary hover:text-r58-text-primary flex items-center justify-center gap-1"},[e("span",null,S(s.value?"Hide":"Show")+" options",1),(t(),n("svg",{class:O(["w-3 h-3 transition-transform",{"rotate-180":s.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...i[9]||(i[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),s.value?(t(),n("div",vr,[e("label",mr,[q(e("input",{type:"checkbox","onUpdate:modelValue":i[2]||(i[2]=g=>m.value=g),class:"rounded"},null,512),[[Re,m.value]]),i[10]||(i[10]=e("span",null,"Enable video",-1))]),e("label",pr,[q(e("input",{type:"checkbox","onUpdate:modelValue":i[3]||(i[3]=g=>r.value=g),class:"rounded"},null,512),[[Re,r.value]]),i[11]||(i[11]=e("span",null,"Enable audio",-1))])])):V("",!0),p.value&&C.value?(t(),n("div",gr,[e("button",{onClick:i[4]||(i[4]=g=>s.value=!s.value),class:"text-xs text-r58-text-secondary hover:text-r58-text-primary"}," Show QR Code "),s.value?(t(),n("div",xr,[e("img",{src:C.value,alt:"QR Code",class:"w-32 h-32 bg-white p-2 rounded"},null,8,fr)])):V("",!0)])):V("",!0),e("div",br,[i[12]||(i[12]=Q(" Room: ",-1)),e("span",yr,S(K(De)),1)])]))}}),kr={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},wr={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-2xl"},_r={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},Sr={class:"text-xl font-semibold"},$r={class:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},Cr={class:"flex gap-6"},Mr={class:"flex-1"},Ir={class:"mb-4"},Rr={class:"mb-4"},Er={class:"flex gap-2 flex-wrap"},Dr=["onClick"],jr={class:"mb-4"},Tr={id:"scene-canvas",class:"relative aspect-video bg-black rounded-lg overflow-hidden border border-r58-bg-tertiary"},Lr=["onMousedown","onClick"],Vr={class:"absolute inset-0 flex items-center justify-center text-xs text-r58-text-secondary"},Pr=["onMousedown"],Or=["onClick"],Ur={class:"w-64 flex-shrink-0"},Ar={key:0,class:"space-y-4"},Hr=["value"],zr=["value"],Br={class:"grid grid-cols-2 gap-2"},Nr={key:1,class:"text-sm text-r58-text-secondary p-4 bg-r58-bg-tertiary rounded-lg"},Fr={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},Kr=Z({__name:"SceneEditor",setup($,{expose:d}){const s=ve(),m=oe(),r=M(!1),p=M(null),x=M(!1),c=M(""),a=M([]),C=M(null),f=M(!1),i=M(null),g=M({x:0,y:0}),I=M("move"),H=A(()=>m.connectedSources),T=[{id:"solo",name:"Solo",slots:[{x:0,y:0,w:100,h:100}]},{id:"split",name:"Split",slots:[{x:0,y:0,w:50,h:100},{x:50,y:0,w:50,h:100}]},{id:"pip",name:"PiP",slots:[{x:0,y:0,w:100,h:100},{x:65,y:60,w:30,h:35}]},{id:"quad",name:"Quad",slots:[{x:0,y:0,w:50,h:50},{x:50,y:0,w:50,h:50},{x:0,y:50,w:50,h:50},{x:50,y:50,w:50,h:50}]},{id:"three-up",name:"3-Up",slots:[{x:0,y:0,w:50,h:100},{x:50,y:0,w:50,h:50},{x:50,y:50,w:50,h:50}]}];function b(L){p.value=L,x.value=!1,c.value=L.name,a.value=JSON.parse(JSON.stringify(L.slots)),C.value=null,r.value=!0}function y(){p.value=null,x.value=!0,c.value="New Scene",a.value=[{id:"slot-1",sourceId:null,position:{x:0,y:0,w:100,h:100},zIndex:0}],C.value=null,r.value=!0}function l(){r.value=!1,p.value=null}function o(){if(!c.value.trim()){U.error("Scene name is required");return}if(x.value){const L=s.createScene({name:c.value.trim(),resolution:{width:1920,height:1080},slots:a.value});U.success(`Created: ${L.name}`)}else p.value&&(s.updateScene(p.value.id,{name:c.value.trim(),slots:a.value}),U.success(`Updated: ${c.value}`));l()}function R(L){a.value=L.slots.map((k,E)=>{var P;return{id:`slot-${E+1}`,sourceId:((P=a.value[E])==null?void 0:P.sourceId)||null,position:{x:k.x,y:k.y,w:k.w,h:k.h},zIndex:E}}),U.info(`Applied: ${L.name}`)}function h(){const L={id:`slot-${Date.now()}`,sourceId:null,position:{x:10,y:10,w:30,h:30},zIndex:a.value.length};a.value.push(L),C.value=L.id}function N(L){const k=a.value.findIndex(E=>E.id===L);k!==-1&&(a.value.splice(k,1),C.value===L&&(C.value=null))}function D(L){C.value=L}const v=A(()=>a.value.find(L=>L.id===C.value));function w(L){if(!C.value)return;const k=a.value.find(E=>E.id===C.value);k&&(k.sourceId=L)}function u(L,k,E="move"){L.preventDefault(),f.value=!0,i.value=k,I.value=E,g.value={x:L.clientX,y:L.clientY},window.addEventListener("mousemove",_),window.addEventListener("mouseup",z)}function _(L){if(!f.value||!i.value)return;const k=a.value.find(de=>de.id===i.value);if(!k)return;const E=document.getElementById("scene-canvas");if(!E)return;const P=E.getBoundingClientRect(),B=(L.clientX-g.value.x)/P.width*100,ie=(L.clientY-g.value.y)/P.height*100;I.value==="move"?(k.position.x=Math.max(0,Math.min(100-k.position.w,k.position.x+B)),k.position.y=Math.max(0,Math.min(100-k.position.h,k.position.y+ie))):(k.position.w=Math.max(10,Math.min(100-k.position.x,k.position.w+B)),k.position.h=Math.max(10,Math.min(100-k.position.y,k.position.h+ie))),g.value={x:L.clientX,y:L.clientY}}function z(){f.value=!1,i.value=null,window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",z)}return d({open:b,openNew:y}),(L,k)=>(t(),pe(ye,{to:"body"},[r.value?(t(),n("div",kr,[e("div",{class:"absolute inset-0 bg-black/70",onClick:l}),e("div",wr,[e("div",_r,[e("h2",Sr,S(x.value?"Create Scene":"Edit Scene"),1),e("button",{onClick:l,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",$r,[e("div",Cr,[e("div",Mr,[e("div",Ir,[k[7]||(k[7]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Scene Name",-1)),q(e("input",{"onUpdate:modelValue":k[0]||(k[0]=E=>c.value=E),type:"text",class:"w-full px-3 py-2 bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ne,c.value]])]),e("div",Rr,[k[8]||(k[8]=e("label",{class:"block text-sm text-r58-text-secondary mb-2"},"Quick Layouts",-1)),e("div",Er,[(t(),n(W,null,J(T,E=>e("button",{key:E.id,onClick:P=>R(E),class:"px-3 py-1 text-xs bg-r58-bg-tertiary hover:bg-r58-accent-primary/20 rounded transition-colors"},S(E.name),9,Dr)),64))])]),e("div",jr,[k[9]||(k[9]=e("label",{class:"block text-sm text-r58-text-secondary mb-2"},"Layout",-1)),e("div",Tr,[(t(!0),n(W,null,J(a.value,E=>(t(),n("div",{key:E.id,onMousedown:P=>u(P,E.id,"move"),onClick:ke(P=>D(E.id),["stop"]),class:O(["absolute cursor-move transition-colors",[C.value===E.id?"border-2 border-r58-accent-primary":"border border-r58-bg-tertiary hover:border-r58-accent-primary/50"]]),style:ue({left:`${E.position.x}%`,top:`${E.position.y}%`,width:`${E.position.w}%`,height:`${E.position.h}%`,zIndex:E.zIndex,backgroundColor:E.sourceId?"var(--r58-bg-tertiary)":"var(--r58-bg-secondary)"})},[e("div",Vr,S(E.sourceId||"Empty"),1),C.value===E.id?(t(),n("div",{key:0,onMousedown:ke(P=>u(P,E.id,"resize"),["stop"]),class:"absolute bottom-0 right-0 w-4 h-4 bg-r58-accent-primary cursor-se-resize"},null,40,Pr)):V("",!0),C.value===E.id&&a.value.length>1?(t(),n("button",{key:1,onClick:ke(P=>N(E.id),["stop"]),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center hover:bg-red-400"}," Ã— ",8,Or)):V("",!0)],46,Lr))),128))])]),e("button",{onClick:h,class:"btn btn-sm"}," + Add Slot ")]),e("div",Ur,[k[17]||(k[17]=e("h3",{class:"text-sm font-medium mb-3"},"Slot Properties",-1)),v.value?(t(),n("div",Ar,[e("div",null,[k[11]||(k[11]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Source",-1)),e("select",{value:v.value.sourceId||"",onChange:k[1]||(k[1]=E=>w(E.target.value||null)),class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg"},[k[10]||(k[10]=e("option",{value:""},"None (Empty)",-1)),(t(!0),n(W,null,J(H.value,E=>(t(),n("option",{key:E.id,value:E.id},S(E.label),9,zr))),128))],40,Hr)]),e("div",Br,[e("div",null,[k[12]||(k[12]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"X %",-1)),q(e("input",{"onUpdate:modelValue":k[2]||(k[2]=E=>v.value.position.x=E),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,v.value.position.x,void 0,{number:!0}]])]),e("div",null,[k[13]||(k[13]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Y %",-1)),q(e("input",{"onUpdate:modelValue":k[3]||(k[3]=E=>v.value.position.y=E),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,v.value.position.y,void 0,{number:!0}]])]),e("div",null,[k[14]||(k[14]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Width %",-1)),q(e("input",{"onUpdate:modelValue":k[4]||(k[4]=E=>v.value.position.w=E),type:"number",min:"1",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,v.value.position.w,void 0,{number:!0}]])]),e("div",null,[k[15]||(k[15]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Height %",-1)),q(e("input",{"onUpdate:modelValue":k[5]||(k[5]=E=>v.value.position.h=E),type:"number",min:"1",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,v.value.position.h,void 0,{number:!0}]])])]),e("div",null,[k[16]||(k[16]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Layer (z-index)",-1)),q(e("input",{"onUpdate:modelValue":k[6]||(k[6]=E=>v.value.zIndex=E),type:"number",min:"0",max:"10",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,v.value.zIndex,void 0,{number:!0}]])])])):(t(),n("div",Nr," Click a slot to edit its properties "))])])]),e("div",Fr,[e("button",{onClick:l,class:"btn"},"Cancel"),e("button",{onClick:o,class:"btn btn-primary"},S(x.value?"Create Scene":"Save Changes"),1)])])])):V("",!0)]))}}),Gr={class:"h-full flex flex-col bg-r58-bg-primary"},Wr={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},Yr={class:"flex items-center gap-4"},Jr={class:"flex items-center gap-2"},qr={key:0,class:"badge badge-danger"},Xr={class:"flex items-center gap-4"},Qr={class:"flex-1 p-6 overflow-auto"},Zr={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ei={class:"card p-6"},ti={class:"grid grid-cols-4 gap-3"},oi=["onClick"],ni={class:"card p-6"},si={class:"text-lg font-semibold mb-4"},ri={class:"text-sm font-normal text-r58-text-secondary"},ii={class:"space-y-3"},ai={class:"flex items-center gap-3"},li={class:"font-medium"},di={key:0,class:"text-xs text-r58-text-secondary ml-2"},ci={key:0,class:"text-sm text-r58-text-secondary"},ui={class:"card p-6"},vi={class:"flex items-center gap-4"},mi={key:0,class:"w-2 h-2 rounded-full bg-white animate-pulse mr-2"},pi={key:0,class:"mt-3 text-sm text-r58-text-secondary"},gi={class:"card p-6"},xi={class:"grid grid-cols-2 gap-4"},fi={class:"text-2xl font-bold text-r58-text-primary"},bi=Z({__name:"MixerLiteView",emits:["enable-full-mode"],setup($,{emit:d}){const s=d,m=ge(),r=oe(),p=he(),{register:x}=Ve(),c=A(()=>r.isLive),a=A(()=>m.inputs),C=A(()=>a.value.filter(T=>T.hasSignal));let f=null;me(()=>{m.fetchInputs(),f=window.setInterval(()=>{m.fetchInputs()},5e3);for(let T=1;T<=4;T++)x({key:String(T),description:`Switch to scene ${T}`,action:()=>i(T),context:"mixer-lite"})}),xe(()=>{f&&clearInterval(f)});function i(T){r.setScene(`scene-${T}`),U.info(`Scene ${T}`)}function g(){r.isLive?(r.toggleLive(),p.stopStreaming(),U.info("Session ended")):(r.toggleLive(),p.startStreaming(),U.success("Going live!"))}async function I(){try{m.isRecording?(await m.stopRecording(),U.info("Recording stopped")):(await m.startRecording(),U.success("Recording started"))}catch{U.error("Recording action failed")}}function H(){confirm("Full Mixer mode loads VDO.ninja which uses significant CPU/GPU resources. This may cause lag on the device. Continue?")&&s("enable-full-mode")}return(T,b)=>(t(),n("div",Gr,[e("header",Wr,[e("div",Yr,[e("div",Jr,[e("span",{class:O(["w-3 h-3 rounded-full",c.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"])},null,2),b[0]||(b[0]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1)),b[1]||(b[1]=e("span",{class:"text-xs px-2 py-0.5 rounded bg-amber-500/20 text-amber-400 font-medium"}," LITE MODE ",-1))]),c.value?(t(),n("span",qr,"ON AIR")):V("",!0)]),e("div",Xr,[e("button",{class:"btn btn-sm btn-secondary",onClick:H,title:"Enable full VDO.ninja mixer (high CPU usage)"},[...b[2]||(b[2]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1),Q(" Full Mode ",-1)])]),e("button",{class:O(["btn",c.value?"btn-danger":"btn-primary"]),onClick:g},S(c.value?"End Session":"Go Live"),3)])]),e("main",Qr,[b[10]||(b[10]=be('<div class="mb-6 p-4 rounded-lg bg-amber-500/10 border border-amber-500/30" data-v-6d9e9096><div class="flex items-start gap-3" data-v-6d9e9096><svg class="w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-6d9e9096><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-6d9e9096></path></svg><div data-v-6d9e9096><h3 class="font-medium text-amber-400" data-v-6d9e9096>Local Device Mode</h3><p class="text-sm text-r58-text-secondary mt-1" data-v-6d9e9096> VDO.ninja previews are disabled to save CPU. Scene switching and guest management should be done from a remote browser or the Electron app. </p></div></div></div>',1)),e("div",Zr,[e("div",ei,[b[3]||(b[3]=e("h2",{class:"text-lg font-semibold mb-4"},"Scene Control",-1)),e("div",ti,[(t(),n(W,null,J(4,y=>e("button",{key:y,class:O(["aspect-video flex items-center justify-center text-2xl font-bold rounded-lg transition-all",K(r).currentScene===`scene-${y}`?"bg-r58-mixer text-white ring-2 ring-r58-mixer ring-offset-2 ring-offset-r58-bg-primary":"bg-r58-bg-tertiary hover:bg-r58-bg-secondary text-r58-text-primary"]),onClick:l=>i(y)},S(y),11,oi)),64))]),b[4]||(b[4]=e("p",{class:"text-xs text-r58-text-secondary mt-3"}," Press 1-4 to switch scenes. Full transitions require VDO.ninja (Full Mode). ",-1))]),e("div",ni,[e("h2",si,[b[5]||(b[5]=Q(" Inputs ",-1)),e("span",ri,"("+S(C.value.length)+"/"+S(a.value.length)+" active)",1)]),e("div",ii,[(t(!0),n(W,null,J(a.value,y=>(t(),n("div",{key:y.id,class:O(["flex items-center justify-between p-3 rounded-lg",y.hasSignal?"bg-r58-bg-tertiary":"bg-r58-bg-secondary opacity-50"])},[e("div",ai,[e("div",{class:O(["w-2 h-2 rounded-full",y.hasSignal?"bg-green-500":"bg-gray-500"])},null,2),e("div",null,[e("span",li,S(y.name),1),y.resolution?(t(),n("span",di,S(y.resolution),1)):V("",!0)])]),y.framerate?(t(),n("div",ci,S(y.framerate.toFixed(1))+" fps ",1)):V("",!0)],2))),128))])]),e("div",ui,[b[6]||(b[6]=e("h2",{class:"text-lg font-semibold mb-4"},"Device Recording",-1)),e("div",vi,[e("button",{class:O(["btn flex-1",K(m).isRecording?"btn-danger":"btn-primary"]),onClick:I},[K(m).isRecording?(t(),n("span",mi)):V("",!0),Q(" "+S(K(m).isRecording?"Stop Recording":"Start Recording"),1)],2)]),K(m).isRecording?(t(),n("div",pi," Duration: "+S(K(m).formattedDuration),1)):V("",!0)]),e("div",gi,[b[9]||(b[9]=e("h2",{class:"text-lg font-semibold mb-4"},"System Status",-1)),e("div",xi,[e("div",null,[e("div",fi,S(C.value.length),1),b[7]||(b[7]=e("div",{class:"text-sm text-r58-text-secondary"},"Active Inputs",-1))]),e("div",null,[e("div",{class:O(["text-2xl font-bold",c.value?"text-red-500":"text-r58-text-primary"])},S(c.value?"LIVE":"Offline"),3),b[8]||(b[8]=e("div",{class:"text-sm text-r58-text-secondary"},"Stream Status",-1))])])])])])]))}}),yi=le(bi,[["__scopeId","data-v-6d9e9096"]]),hi={class:"h-full flex flex-col bg-r58-bg-primary"},ki={class:"flex items-center justify-between px-6 py-3 border-b border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"mixer-header"},wi={class:"flex items-center gap-4"},_i={class:"flex items-center gap-2"},Si={key:0,class:"px-3 py-1 bg-red-600 text-white text-xs font-bold uppercase tracking-wider rounded"},$i={class:"text-sm text-r58-text-secondary"},Ci={key:1,class:"text-xs text-r58-text-secondary"},Mi={class:"flex items-center gap-3"},Ii={class:"flex items-center gap-1 bg-r58-bg-tertiary rounded-lg p-1"},Ri={class:"flex-1 flex overflow-hidden"},Ei={class:"flex-1 min-w-0"},Di={key:0,class:"text-sm font-medium"},ji={class:"p-4 space-y-6"},Ti={class:"p-2 space-y-4"},Li={class:"hidden"},Vi=Z({__name:"MixerView",setup($){const d=oe(),s=ve(),m=ge(),r=he(),{register:p}=Ve(),{isLiteMode:x}=Ae(),c=M(null),a=Ye(c),C=M(null),f=M(null),i=M(null),g=M(!1),I=A(()=>!x.value||g.value),H=M(!0),T=M(!1),b=M(!1),y=A(()=>d.isLive),l=A(()=>r.enabledDestinations.length),o=A(()=>{const P=s.getScene(d.programSceneId||"");return(P==null?void 0:P.name)||"No Scene"});function R(){H.value=!1}re(()=>{var P,B;return(B=(P=c.value)==null?void 0:P.isReady)==null?void 0:B.value},P=>{P&&(console.log("[Mixer] VDO.ninja ready"),T.value=!0)},{immediate:!0});let h=null;function N(){return m.isRecording?1e4:3e4}function D(){h&&clearInterval(h),h=window.setInterval(()=>{m.fetchInputs()},N())}re(()=>m.isRecording,()=>{D()});const v=[];me(async()=>{await m.fetchInputs(),D();for(let P=1;P<=8;P++){const B=P-1,ie=p({key:String(P),description:`Select scene ${P} for preview`,action:()=>{const de=s.scenes[B];de&&(d.setPreviewScene(de.id),U.info(`Preview: ${de.name}`))},context:"mixer"});v.push(ie)}v.push(p({key:" ",description:"Take (transition preview to program)",action:()=>{d.previewSceneId&&d.previewSceneId!==d.programSceneId&&(a.takeToProgram(),U.success("Take!"))},context:"mixer"})),v.push(p({key:"Escape",description:"Cut (immediate switch)",action:()=>{d.previewSceneId&&(a.cutToProgram(),U.info("Cut"))},context:"mixer"})),v.push(p({key:"g",description:"Toggle Go Live",action:w,context:"mixer"})),v.push(p({key:"r",description:"Toggle recording",action:u,context:"mixer"}))}),xe(()=>{v.forEach(P=>P()),h&&(clearInterval(h),h=null)});function w(){if(d.isLive)d.toggleLive(),r.stopStreaming(),U.info("Session ended");else{d.toggleLive(),r.startStreaming();const P=r.enabledDestinations.length;P>0?U.success(`Live! Streaming to ${P} destination${P>1?"s":""}`):U.info("Live! (No streaming destinations configured)")}}function u(){var P,B;if(!a.isConnected.value){U.error("VDO.ninja not connected");return}(B=(P=c.value)==null?void 0:P.isRecording)!=null&&B.value?(a.stopRecording(),U.info("Recording stopped")):(a.startRecording(),U.success("Recording started"))}function _(){var P;(P=C.value)==null||P.open()}function z(){var P;(P=f.value)==null||P.open()}function L(P){var B;(B=i.value)==null||B.open(P)}function k(){var P;(P=i.value)==null||P.openNew()}function E(){b.value=!b.value}return(P,B)=>I.value?(t(),n(W,{key:1},[ee(ze,{name:"fade"},{default:He(()=>[H.value?(t(),pe(We,{key:0,mode:"mixer","content-ready":T.value,"min-time":2e3,"max-time":15e3,onReady:R},null,8,["content-ready"])):V("",!0)]),_:1}),e("div",hi,[e("header",ki,[e("div",wi,[e("div",_i,[e("span",{class:O(["w-3 h-3 rounded-full transition-colors",y.value?"bg-red-500 animate-pulse":"bg-r58-bg-tertiary"])},null,2),B[3]||(B[3]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1))]),y.value?(t(),n("span",Si," ON AIR ")):V("",!0),e("span",$i,S(o.value),1),y.value&&l.value>0?(t(),n("span",Ci," â†’ "+S(l.value)+" platform"+S(l.value>1?"s":""),1)):V("",!0),ee(_s,{"vdo-embed":c.value},null,8,["vdo-embed"])]),e("div",Mi,[e("div",Ii,[e("button",{onClick:B[1]||(B[1]=ie=>K(d).setMode("simple")),class:O(["px-3 py-1 text-xs rounded transition-colors",K(d).mode==="simple"?"bg-r58-accent-primary text-white":"text-r58-text-secondary hover:text-r58-text-primary"])}," Simple ",2),e("button",{onClick:B[2]||(B[2]=ie=>K(d).setMode("pvw-pgm")),class:O(["px-3 py-1 text-xs rounded transition-colors",K(d).mode==="pvw-pgm"?"bg-r58-accent-primary text-white":"text-r58-text-secondary hover:text-r58-text-primary"])}," PVW/PGM ",2)]),e("button",{class:"btn btn-sm",onClick:z,title:"Keyboard Shortcuts (Shift+?)"},[...B[4]||(B[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})],-1)])]),e("button",{class:"btn btn-sm",onClick:_,title:"Streaming Settings"},[...B[5]||(B[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])]),e("button",{class:O(["btn px-6",y.value?"btn-danger":"btn-primary"]),onClick:w},S(y.value?"End Session":"Go Live"),3)])]),e("div",Ri,[e("div",Ei,[ee(yo,{"vdo-embed":c.value,controller:K(a),onEditScene:L,onAddScene:k},null,8,["vdo-embed","controller"])]),e("aside",{class:O(["flex-shrink-0 border-l border-r58-bg-tertiary bg-r58-bg-secondary overflow-y-auto transition-all duration-300",b.value?"w-12":"w-72"])},[e("button",{onClick:E,class:"w-full p-3 flex items-center justify-between border-b border-r58-bg-tertiary hover:bg-r58-bg-tertiary/50 transition-colors"},[b.value?V("",!0):(t(),n("span",Di,"Controls")),(t(),n("svg",{class:O(["w-4 h-4 transition-transform",{"rotate-180":b.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...B[6]||(B[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))]),q(e("div",ji,[e("section",null,[B[7]||(B[7]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Transitions ",-1)),ee(ar)]),e("section",null,[B[8]||(B[8]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Audio ",-1)),ee(qs,{"vdo-embed":c.value},null,8,["vdo-embed"])]),e("section",null,[B[9]||(B[9]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Program Output ",-1)),ee(Zo)]),e("section",null,[B[10]||(B[10]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Recording ",-1)),ee(Ts,{"vdo-embed":c.value},null,8,["vdo-embed"])]),e("section",null,[B[11]||(B[11]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Invite Guests ",-1)),ee(hr)])],512),[[fe,!b.value]]),q(e("div",Ti,[...B[12]||(B[12]=[be('<button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Transitions" data-v-0714cc22><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-0714cc22><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" data-v-0714cc22></path></svg></button><button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Audio" data-v-0714cc22><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-0714cc22><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" data-v-0714cc22></path></svg></button><button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Recording" data-v-0714cc22><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-0714cc22><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" data-v-0714cc22></path></svg></button>',3)])],512),[[fe,b.value]])],2)]),ee(zo),e("div",Li,[ee(Ro,{ref_key:"vdoEmbedRef",ref:c,profile:"director"},null,512)]),ee(Fn,{ref_key:"streamingSettingsRef",ref:C},null,512),ee(cs,{ref_key:"hotkeySettingsRef",ref:f},null,512),ee(Kr,{ref_key:"sceneEditorRef",ref:i},null,512)])],64)):(t(),pe(yi,{key:0,onEnableFullMode:B[0]||(B[0]=ie=>g.value=!0)}))}}),Ai=le(Vi,[["__scopeId","data-v-0714cc22"]]);export{Ai as default};
