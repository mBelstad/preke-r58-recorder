import{d as f,u as g,r as _,o as x,b as v,c as d,a as y,e as t,f as k,n as w,t as h,g as C,h as S,i as M,j as a,_ as A}from"./index-C6GdwtdT.js";import{A as B}from"./AnimatedBackground-XAhX1bHe.js";const V={class:"studio"},E={class:"studio__content"},z={class:"studio__modes"},$=["disabled"],N={class:"studio__mode-icon"},F={key:0,class:"animate-spin",fill:"none",viewBox:"0 0 24 24",width:"32",height:"32"},O={key:1,fill:"currentColor",viewBox:"0 0 24 24",width:"32",height:"32"},P={class:"studio__mode-info"},j={class:"studio__mode-desc"},H=["disabled"],I={class:"studio__mode-icon"},R={key:0,class:"animate-spin",fill:"none",viewBox:"0 0 24 24",width:"32",height:"32"},T={key:1,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"32",height:"32","stroke-width":"1.8"},D={class:"studio__mode-info"},L={class:"studio__mode-desc"},U={key:0,class:"studio__error"},q=f({__name:"StudioView",setup(G){const b=S(),p=g(),r=_(null),o=_(!1),c=_(null);let l=null;x(async()=>{try{(await fetch(v("/api/mode/idle"),{method:"POST"})).ok&&(console.log("[Studio] Switched to idle mode"),await p.fetchCapabilities())}catch(s){console.warn("[Studio] Failed to switch to idle mode:",s)}});async function m(s){if(o.value)return;l&&l.abort(),l=new AbortController;const e=l,n=e.signal;r.value=s,o.value=!0,c.value=null;try{const i=await fetch(v(`/api/mode/${s}`),{method:"POST",signal:n});if(n.aborted)return;if(!i.ok){const u=await i.json().catch(()=>({}));throw new Error(u.detail||`Failed to switch to ${s} mode`)}if(n.aborted)return;b.push(`/${s}`)}catch(i){if(i instanceof Error&&i.name==="AbortError"){console.log("[Studio] Mode switch cancelled by user");return}const u=i instanceof Error?i.message:"Failed to switch mode";c.value=u,M.error(u),console.error("Mode switch error:",i)}finally{l===e&&(o.value=!1,l=null)}}return(s,e)=>(a(),d("div",V,[y(B,{accent:"gold","show-beams":!0,"show-grid":!0,"show-circuits":!0}),t("div",E,[e[8]||(e[8]=t("h1",{class:"studio__title"},"Preke Studio",-1)),e[9]||(e[9]=t("p",{class:"studio__subtitle"},"Select a mode to begin",-1)),t("div",z,[t("button",{onClick:e[0]||(e[0]=n=>m("recorder")),disabled:o.value,class:w(["studio__mode studio__mode--recorder",{"studio__mode--selected":r.value==="recorder"}])},[t("div",N,[o.value&&r.value==="recorder"?(a(),d("svg",F,[...e[2]||(e[2]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(a(),d("svg",O,[...e[3]||(e[3]=[t("circle",{cx:"12",cy:"12",r:"8"},null,-1)])]))]),t("div",P,[e[4]||(e[4]=t("h3",{class:"studio__mode-title"},"Recorder",-1)),t("p",j,h(o.value&&r.value==="recorder"?"Starting recorder...":"Multi-cam ISO recording"),1)])],10,$),t("button",{onClick:e[1]||(e[1]=n=>m("mixer")),disabled:o.value,class:w(["studio__mode studio__mode--mixer",{"studio__mode--selected":r.value==="mixer"}])},[t("div",I,[o.value&&r.value==="mixer"?(a(),d("svg",R,[...e[5]||(e[5]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(a(),d("svg",T,[...e[6]||(e[6]=[C('<rect x="2" y="2" width="9" height="6" rx="1" data-v-b13e48b2></rect><rect x="13" y="2" width="9" height="6" rx="1" data-v-b13e48b2></rect><rect x="2" y="10" width="9" height="6" rx="1" data-v-b13e48b2></rect><rect x="13" y="10" width="9" height="6" rx="1" data-v-b13e48b2></rect><circle cx="12" cy="20" r="2" fill="currentColor" data-v-b13e48b2></circle><path d="M9 19.5a4 4 0 0 1 6 0" stroke-linecap="round" data-v-b13e48b2></path>',6)])]))]),t("div",D,[e[7]||(e[7]=t("h3",{class:"studio__mode-title"},"Mixer",-1)),t("p",L,h(o.value&&r.value==="mixer"?"Starting mixer...":"Live switching & streaming"),1)])],10,H)]),c.value?(a(),d("div",U,h(c.value),1)):k("",!0)])]))}}),Q=A(q,[["__scopeId","data-v-b13e48b2"]]);export{Q as default};
