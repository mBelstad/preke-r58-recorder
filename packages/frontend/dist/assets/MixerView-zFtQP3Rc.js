import{J as Ee,r as $,h as T,j as ne,k as re,d as J,K as oe,B as se,c as n,n as V,b as L,a as e,I as H,t as b,p as Q,o as s,_ as ce,A as de,F as A,q as G,w as ae,x as ie,L as fe,y as Le,g as P,E as le,G as _e,M as xe,H as we,e as Oe,N as Ie,l as X,m as je,T as Te}from"./index-DcaWFwl-.js";import{g as Ve,b as Pe,a as be,c as Ue,d as He}from"./vdoninja-D8mLQF_b.js";import{M as Be}from"./ModeLoadingScreen-BtuWCHIZ.js";const te=[{id:"youtube",name:"YouTube Live",icon:"â–¶ï¸",rtmpBaseUrl:"rtmp://a.rtmp.youtube.com/live2/",streamKeyPlaceholder:"xxxx-xxxx-xxxx-xxxx-xxxx",helpUrl:"https://support.google.com/youtube/answer/2907883"},{id:"twitch",name:"Twitch",icon:"ðŸ“º",rtmpBaseUrl:"rtmp://live.twitch.tv/app/",streamKeyPlaceholder:"live_xxxxxxxxxx_xxxxxxxxxxxxxx",helpUrl:"https://help.twitch.tv/s/article/twitch-stream-key-faq"},{id:"facebook",name:"Facebook Live",icon:"ðŸ“˜",rtmpBaseUrl:"rtmps://live-api-s.facebook.com:443/rtmp/",streamKeyPlaceholder:"FB-xxxxxxxxxx-x",helpUrl:"https://www.facebook.com/help/587160588142067"},{id:"restream",name:"Restream",icon:"ðŸ”„",rtmpBaseUrl:"rtmp://live.restream.io/live/",streamKeyPlaceholder:"re_xxxxxx_xxxxxxxxxx",helpUrl:"https://support.restream.io/en/"},{id:"custom",name:"Custom RTMP",icon:"âš™ï¸",rtmpBaseUrl:"",streamKeyPlaceholder:"your-stream-key"}],ue=Ee("streaming",()=>{const f=$([]),x=$(!1),a=$(null),i=$({enabled:!1,host:"",port:8890,streamId:"mixer_program"}),l=T(()=>f.value.find(o=>o.id===a.value)),v=T(()=>f.value.filter(o=>o.enabled)),p=T(()=>te),y=T(()=>{const o=window.location.hostname,D=o==="localhost"||o==="127.0.0.1"?"localhost":o.replace("r58-api","r58-mediamtx");return{rtmp:`rtmp://${D}:1935/mixer_program`,rtsp:`rtsp://${D}:8554/mixer_program`,srt:`srt://${D}:8890?streamid=read:mixer_program`,hls:`https://${o}/hls/mixer_program/index.m3u8`,whep:`${window.location.origin}/api/v1/whep/mixer_program/whep`}});function d(o,r){const D=te.find(C=>C.id===o);if(!D)throw new Error(`Unknown platform: ${o}`);const K={id:`dest-${Date.now()}`,platformId:o,name:r||D.name,streamKey:"",enabled:!1};return f.value.push(K),K}function M(o,r){const D=f.value.findIndex(K=>K.id===o);D!==-1&&(f.value[D]={...f.value[D],...r})}function I(o){const r=f.value.findIndex(D=>D.id===o);r!==-1&&f.value.splice(r,1),a.value===o&&(a.value=null)}function k(o){a.value=o}function _(o){i.value.enabled=o}function S(o){i.value={...i.value,...o}}function O(){x.value=!0}function w(){x.value=!1}function c(o){const r=te.find(D=>D.id===o.platformId);return r?o.platformId==="custom"?`${o.name}${o.streamKey}`:`${r.rtmpBaseUrl}${o.streamKey}`:""}function g(){const o=window.location.hostname;return`srt://${o==="localhost"||o==="127.0.0.1"?"localhost":o.replace("r58-api","r58-mediamtx")}:${i.value.port}?streamid=read:${i.value.streamId}`}function h(){try{const o=localStorage.getItem("r58-streaming-destinations");if(o){const r=JSON.parse(o);f.value=r.destinations||[],r.srtOutput&&(i.value={...i.value,...r.srtOutput})}}catch(o){console.warn("Failed to load saved streaming destinations:",o)}}function t(){try{localStorage.setItem("r58-streaming-destinations",JSON.stringify({destinations:f.value,srtOutput:i.value}))}catch(o){console.warn("Failed to save streaming destinations:",o)}}return h(),{destinations:f,isStreaming:x,activeDestinationId:a,srtOutput:i,activeDestination:l,enabledDestinations:v,platforms:p,programOutputUrls:y,addDestination:d,updateDestination:M,removeDestination:I,setActiveDestination:k,toggleSrtOutput:_,updateSrtConfig:S,startStreaming:O,stopStreaming:w,buildRtmpUrl:c,getSrtOutputUrl:g,saveDestinations:t,loadSavedDestinations:h}}),ge="vdo-debug",Ae=500,W=[];let ve=typeof localStorage<"u"&&localStorage.getItem(ge)==="true";function ye(f){ve=f,typeof localStorage<"u"&&(f?localStorage.setItem(ge,"true"):localStorage.removeItem(ge)),console.log(`[VDO.ninja Debug] ${f?"Enabled":"Disabled"}`)}function me(f){if(W.push(f),W.length>Ae&&W.shift(),ve){const x=new Date(f.timestamp).toISOString().split("T")[1].slice(0,-1),a=f.direction==="outgoing"?"âž¡ï¸ OUT":"â¬…ï¸ IN",i=f.direction==="outgoing"?"color: #3b82f6; font-weight: bold":"color: #22c55e; font-weight: bold";console.groupCollapsed(`%c[VDO.ninja ${a}] %c${f.type}`,i,"color: inherit"),console.log("Time:",x),f.target&&console.log("Target:",f.target),console.log("Data:",f.data),f.raw&&f.raw!==f.data&&console.log("Raw:",f.raw),console.groupEnd()}}function Se(){return[...W]}function Ne(){W.length=0,console.log("[VDO.ninja Debug] Event history cleared")}function $e(){const f={total:W.length,incoming:0,outgoing:0,byType:{},lastActivity:W.length>0?W[W.length-1].timestamp:null};for(const x of W)x.direction==="incoming"?f.incoming++:f.outgoing++,f.byType[x.type]=(f.byType[x.type]||0)+1;return f}typeof window<"u"&&(window.__VDO_DEBUG__={getHistory:Se,clearHistory:Ne,getStats:$e,enable:()=>ye(!0),disable:()=>ye(!1),isEnabled:()=>ve});function Fe(f){const x=$(!1),a=$(new Map),i=$(null),l=$(!1),v=$("disconnected"),p=$(null),y=Ve();function d(u,E,j,q){var U;if(!((U=f.value)!=null&&U.contentWindow)){console.warn("[VDO.ninja] Cannot send command - iframe not ready"),p.value="iframe not ready";return}const B={action:u};E&&(B.target=E),j!==void 0&&(B.value=j),q!==void 0&&(B.value2=q),me({timestamp:Date.now(),direction:"outgoing",type:u,target:E,data:{action:u,target:E,value:j,value2:q},raw:B});try{f.value.contentWindow.postMessage(B,"*")}catch(F){console.error("[VDO.ninja] Failed to send command:",F),p.value=String(F)}}function M(u,E){var q;if(!((q=f.value)!=null&&q.contentWindow)){console.warn("[VDO.ninja] Cannot send DOM command - iframe not ready");return}const j={action:"",target:u,...E};me({timestamp:Date.now(),direction:"outgoing",type:"dom-manipulation",target:u,data:E,raw:j});try{f.value.contentWindow.postMessage(j,"*")}catch(B){console.error("[VDO.ninja] Failed to send DOM command:",B)}}function I(u,E=1){d("addScene",u,E),i.value=E}function k(u,E=1){d("addScene",u,0)}function _(u){M(u,{replace:!0})}function S(u){M(u,{add:!0})}function O(u){M(u,{remove:!0})}function w(u,E){d("mic",u,!E);const j=a.value.get(u);j&&(j.muted=E)}function c(u){d("mic",u,"toggle");const E=a.value.get(u);E&&(E.muted=!E.muted)}function g(u,E){d("volume",u,Math.max(0,Math.min(200,E)))}function h(u){d("soloChat",u)}function t(u){d("soloChatBidirectional",u)}function o(u,E){d("sendChat",u,E)}function r(u,E){d("sendDirectorChat",u,E)}function D(u){d("hangup",u),a.value.delete(u)}function K(u){u?d("togglescreenshare",u):d("togglescreenshare")}function C(u,E){d("forward",u,E)}function m(u="guests"){d("getGuestList",void 0,void 0)}function R(){d("record",void 0,!0),l.value=!0}function z(){d("record",void 0,!1),l.value=!1}function N(u){d("layout",void 0,u)}function ee(u){u?d("reload",u):d("reload")}function Y(u,E){d("mixorder",u,E==="up"?-1:1)}function Z(u){d("camera",void 0,u)}function Ce(u,E){d("camera",u,E)}function Re(u,E=!1){E?d("zoom",void 0,u,"abs"):d("zoom",void 0,u)}function Me(u){d("pan",void 0,u)}function De(u){d("tilt",void 0,u)}function pe(u){const E=u.origin;if(!E.includes(y.split(":")[0])&&!E.includes("vdo.ninja")&&!E.includes("vdo.itagenten")&&!E.includes("localhost"))return;const j=u.data;if(!j||typeof j!="object")return;const q=j.type||j.action||"unknown",B=j.streamID||j.UUID||j.streamId;switch(me({timestamp:Date.now(),direction:"incoming",type:q,target:B,data:j.data||j.value,raw:j}),q){case"director-ready":case"loaded":case"ready":case"started":x.value=!0,v.value="connected",p.value=null;break;case"new-guest":case"guest-connected":case"push":case"view":case"joined":{if(B){const U=j.data,F={id:B,label:(U==null?void 0:U.label)||j.label||B,type:(U==null?void 0:U.type)||"guest",hasVideo:(U==null?void 0:U.video)!==!1,hasAudio:(U==null?void 0:U.audio)!==!1,muted:!1,audioLevel:0};a.value.set(B,F)}break}case"guest-left":case"guest-disconnected":case"left":case"disconnect":B&&a.value.delete(B);break;case"audio-level":case"loudness":{if(B){const U=a.value.get(B);if(U){const F=j.data;U.audioLevel=(F==null?void 0:F.level)||j.value||0}}break}case"mute-state":case"muted":{if(B){const U=a.value.get(B);if(U){const F=j.data;U.muted=(F==null?void 0:F.muted)??j.value??!1}}break}case"scene-changed":case"scene":{const U=j.data,F=(U==null?void 0:U.scene)||j.value;i.value=typeof F=="number"?F:null;break}case"recording-started":l.value=!0;break;case"recording-stopped":l.value=!1;break;case"error":console.error("[VDO.ninja Error]",j.data),p.value=String(j.data);break}}return ne(()=>{v.value="connecting",window.addEventListener("message",pe),setTimeout(()=>{!x.value&&f.value&&(x.value=!0,v.value="connected")},5e3)}),re(()=>{window.removeEventListener("message",pe),v.value="disconnected"}),{isReady:x,sources:a,activeScene:i,isRecording:l,connectionState:v,lastError:p,addToScene:I,removeFromScene:k,setProgram:_,addSource:S,removeSource:O,setLayout:N,changeMixOrder:Y,setMute:w,toggleMute:c,setVolume:g,soloAudio:h,soloChatBidirectional:t,sendToGuest:o,sendDirectorMessage:r,kickGuest:D,toggleScreenShare:K,transferGuest:C,getGuestList:m,refreshSource:ee,setCamera:Z,setGuestCamera:Ce,zoom:Re,pan:Me,tilt:De,startRecording:R,stopRecording:z,sendCommand:d,sendDomCommand:M,getEventHistory:Se,getEventStats:$e}}const ze={key:0,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary z-10","data-testid":"vdo-loading"},Ke={class:"text-center"},Ge={class:"text-xs text-r58-text-secondary mt-2"},We={key:1,class:"absolute bottom-4 left-4 right-4 bg-red-500/90 text-white px-4 py-2 rounded-lg text-sm z-20"},Je=["src","title"],Ye=J({__name:"VdoNinjaEmbed",props:{profile:{},sources:{},room:{},password:{}},setup(f,{expose:x}){const a=f,i=$(null),l=oe(),v=Fe(i),{isReady:p,sources:y,addToScene:d,removeFromScene:M,setMute:I,toggleMute:k,setVolume:_,sendCommand:S,sendDomCommand:O,isRecording:w,connectionState:c,lastError:g,startRecording:h,stopRecording:t,kickGuest:o,toggleScreenShare:r,setLayout:D,setProgram:K,addSource:C,removeSource:m,getEventHistory:R,getEventStats:z}=v,N=T(()=>{const Y={};return a.sources&&(Y.source_ids=a.sources.join(",")),a.room&&(Y.room=a.room),a.password&&(Y.password=a.password),Pe(a.profile,Y)}),ee=T(()=>a.profile==="mixer");return se(y,Y=>{l.updateSourcesFromVdo(Array.from(Y.values()))},{deep:!0}),x({isReady:p,isRecording:w,connectionState:c,lastError:g,addToScene:d,removeFromScene:M,setLayout:D,setProgram:K,addSource:C,removeSource:m,setMute:I,toggleMute:k,setVolume:_,startRecording:h,stopRecording:t,kickGuest:o,toggleScreenShare:r,sendCommand:S,sendDomCommand:O,getEventHistory:R,getEventStats:z}),(Y,Z)=>(s(),n("div",{class:V(["vdo-embed-container relative w-full h-full bg-black rounded-lg overflow-hidden",{"mixer-mode":ee.value}]),"data-testid":"vdo-embed-container"},[H(p)?L("",!0):(s(),n("div",ze,[e("div",Ke,[Z[0]||(Z[0]=e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full mx-auto mb-4"},null,-1)),Z[1]||(Z[1]=e("p",{class:"text-r58-text-secondary"},"Connecting to VDO.ninja...",-1)),e("p",Ge,b(ee.value?"Loading mixer controls...":"Local mixer on R58"),1)])])),H(g)?(s(),n("div",We,[Z[2]||(Z[2]=e("strong",null,"Error:",-1)),Q(" "+b(H(g)),1)])):L("",!0),e("iframe",{ref_key:"iframeRef",ref:i,src:N.value,class:V(["w-full h-full border-0",{"opacity-0":!H(p)}]),allow:"camera; microphone; display-capture; autoplay; clipboard-write",allowfullscreen:"","data-testid":"vdo-iframe",title:ee.value?"VDO.ninja Mixer":"VDO.ninja"},null,10,Je)],2))}}),qe=ce(Ye,[["__scopeId","data-v-4a9e915e"]]),Xe={class:"space-y-4","data-testid":"source-panel"},Qe={class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide","data-testid":"sources-heading"},Ze={key:0,class:"ml-2 text-r58-accent-primary"},et={key:0,class:"px-3 py-2 bg-amber-500/10 border border-amber-500/30 rounded-lg text-xs text-amber-400"},tt={key:1,class:"text-center py-6 text-r58-text-secondary"},st={key:2,class:"space-y-2"},nt={class:"flex items-center gap-3 min-w-0"},ot={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},rt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},at={key:2,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},it={key:3,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},lt={class:"min-w-0"},ct={key:0,class:"flex items-center gap-1"},dt=["onDblclick"],ut={class:"text-xs text-r58-text-secondary"},mt={class:"flex items-center gap-2 flex-shrink-0"},gt={key:0,class:"w-12 h-1.5 bg-r58-bg-primary rounded-full overflow-hidden"},vt=["onClick","data-testid","title"],pt={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ft={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},he="preke-source-names",xt=J({__name:"SourcePanel",props:{vdoEmbed:{}},setup(f){function x(){try{const t=localStorage.getItem(he);return t?JSON.parse(t):{}}catch{return{}}}function a(t,o){const r=x();r[t]=o,localStorage.setItem(he,JSON.stringify(r))}const i=$(x()),l=$(null),v=$(""),p=f,y=oe(),d=de(),M=T(()=>y.sources.map(t=>{let o=t.label,r="VDO.ninja";const D=t.id.match(/cam(\d+)/i)||t.id.match(/hdmi[_-]?(\d+)/i);return D?(o=`HDMI ${parseInt(D[1])+1}`,r="Connected to device"):t.type==="guest"?(r="Remote guest",(!t.label||t.label.length>20||t.label.match(/^[a-z0-9]{8,}$/i))&&(o="Guest")):t.type==="screen"&&(r="Screen share"),{...t,label:o,subtitle:r}})),I={cam0:{name:"HDMI 1",subtitle:"Connected to device"},cam1:{name:"HDMI 2",subtitle:"Connected to device"},cam2:{name:"HDMI 3",subtitle:"Connected to device"},cam3:{name:"HDMI 4",subtitle:"Connected to device"}},k=T(()=>d.inputs.filter(t=>t.hasSignal).map(t=>{const o=I[t.id]||{name:t.label,subtitle:"HDMI Input"};return{id:t.id,label:o.name,subtitle:o.subtitle,type:"camera",hasVideo:!0,hasAudio:!0,muted:!1,audioLevel:0}})),_=T(()=>M.value.length>0?M.value:k.value),S=T(()=>M.value.length===0&&k.value.length>0);function O(t){p.vdoEmbed&&p.vdoEmbed.toggleMute(t.id),y.setSourceMute(t.id,!t.muted)}function w(t){return i.value[t.id]||t.label}function c(t){l.value=t.id,v.value=i.value[t.id]||t.label}function g(){l.value&&v.value.trim()&&(a(l.value,v.value.trim()),i.value=x()),l.value=null}function h(){l.value=null,v.value=""}return(t,o)=>(s(),n("div",Xe,[e("h3",Qe,[o[1]||(o[1]=Q(" Sources ",-1)),_.value.length>0?(s(),n("span",Ze,"("+b(_.value.length)+")",1)):L("",!0)]),S.value?(s(),n("div",et," Showing HDMI cameras. VDO.ninja sources will appear when guests join. ")):L("",!0),_.value.length===0?(s(),n("div",tt,[...o[2]||(o[2]=[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),e("p",{class:"text-sm"},"No sources connected",-1),e("p",{class:"text-xs mt-1 opacity-75"},"Connect HDMI sources or have guests join",-1)])])):(s(),n("div",st,[(s(!0),n(A,null,G(_.value,r=>(s(),n("div",{key:r.id,class:"flex items-center justify-between p-3 rounded-lg bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 transition-colors"},[e("div",nt,[e("div",{class:V(["w-8 h-8 rounded bg-r58-bg-primary flex items-center justify-center flex-shrink-0",{"ring-2 ring-r58-accent-primary":H(y).programSource===r.id}])},[r.type==="camera"?(s(),n("svg",ot,[...o[3]||(o[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])):r.type==="guest"?(s(),n("svg",rt,[...o[4]||(o[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])])):r.type==="screen"?(s(),n("svg",at,[...o[5]||(o[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},null,-1)])])):(s(),n("svg",it,[...o[6]||(o[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"},null,-1)])]))],2),e("div",lt,[l.value===r.id?(s(),n("div",ct,[ae(e("input",{"onUpdate:modelValue":o[0]||(o[0]=D=>v.value=D),onKeyup:[fe(g,["enter"]),fe(h,["escape"])],onBlur:g,class:"input text-sm py-0.5 px-1 w-24",autofocus:""},null,544),[[ie,v.value]])])):(s(),n("p",{key:1,onDblclick:D=>c(r),class:"font-medium text-sm truncate cursor-pointer hover:text-r58-accent-primary",title:"Double-click to rename"},b(w(r)),41,dt)),e("p",ut,b(r.subtitle||r.type),1)])]),e("div",mt,[r.hasAudio?(s(),n("div",gt,[e("div",{class:V(["h-full rounded-full transition-all duration-100",r.muted?"bg-r58-accent-danger":"bg-r58-accent-success"]),style:Le({width:`${r.audioLevel||0}%`})},null,6)])):L("",!0),r.hasAudio?(s(),n("button",{key:1,onClick:D=>O(r),class:V(["p-1.5 rounded hover:bg-r58-bg-primary transition-colors",{"text-r58-accent-danger":r.muted}]),"data-testid":`mute-button-${r.id}`,title:r.muted?"Unmute "+r.label:"Mute "+r.label},[r.muted?(s(),n("svg",pt,[...o[7]||(o[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(s(),n("svg",ft,[...o[8]||(o[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],10,vt)):L("",!0)])]))),128))])),o[9]||(o[9]=e("p",{class:"text-xs text-r58-text-secondary text-center pt-2"}," Full guest/source management available in the mixer above ",-1))]))}}),bt={class:"camera-push-bar border-t border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"camera-push-bar"},yt={class:"flex items-center gap-2"},ht={class:"text-r58-text-secondary"},kt={key:0,class:"px-4 pb-3"},_t={key:0,class:"flex gap-3 flex-wrap"},wt={class:"text-sm font-medium"},St={class:"text-xs text-r58-text-secondary"},$t=["onClick"],Ct={key:1,class:"text-sm text-r58-text-secondary py-2"},Rt={class:"hidden"},Mt=["src","onLoad","onError"],Dt=J({__name:"CameraPushBar",setup(f){const x=de(),a=$(new Map),i=$(!0),l=T(()=>x.inputs.filter(k=>k.hasSignal));function v(k){return Ue(k)}se(l,k=>{for(const S of k)if(!a.value.has(S.id)){const O=v(S.id),w=be(S.id,O,S.label);a.value.set(S.id,{cameraId:S.id,label:S.label,status:"connecting",iframeSrc:w})}const _=new Set(k.map(S=>S.id));for(const[S]of a.value)_.has(S)||a.value.delete(S)},{immediate:!0});function p(k){const _=a.value.get(k);_&&(_.status="connected",console.log(`[CameraPush] ${k} connected to VDO.ninja`))}function y(k){const _=a.value.get(k);_&&(_.status="error",console.error(`[CameraPush] ${k} failed to connect`))}function d(k){const _=x.inputs.find(w=>w.id===k);if(!_||!_.hasSignal)return;const S=v(k),O=be(k,S,_.label);a.value.set(k,{cameraId:k,label:_.label,status:"connecting",iframeSrc:O+`&_t=${Date.now()}`})}function M(k){switch(k){case"connected":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function I(k){switch(k){case"connected":return"Live in VDO.ninja";case"connecting":return"Connecting...";case"error":return"Failed to connect";default:return"Idle"}}return(k,_)=>(s(),n("div",bt,[e("button",{onClick:_[0]||(_[0]=S=>i.value=!i.value),class:"w-full px-4 py-2 flex items-center justify-between text-sm hover:bg-r58-bg-tertiary/50 transition-colors","data-testid":"camera-push-toggle","aria-expanded":"expanded"},[e("div",yt,[_[1]||(_[1]=e("span",{class:"font-medium"},"Camera Sources",-1)),e("span",ht,"("+b(l.value.length)+" active)",1)]),(s(),n("svg",{class:V(["w-4 h-4 transition-transform",{"rotate-180":i.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[..._[2]||(_[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),i.value?(s(),n("div",kt,[a.value.size>0?(s(),n("div",_t,[(s(!0),n(A,null,G(a.value,([S,O])=>(s(),n("div",{key:S,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},[e("span",{class:V(["w-2 h-2 rounded-full",M(O.status)])},null,2),e("span",wt,b(O.label),1),e("span",St,b(I(O.status)),1),O.status==="error"?(s(),n("button",{key:0,onClick:w=>d(S),class:"ml-2 text-xs text-r58-accent-primary hover:underline"}," Retry ",8,$t)):L("",!0)]))),128))])):(s(),n("div",Ct," No cameras connected. Connect HDMI sources to push them to the mixer. "))])):L("",!0),e("div",Rt,[(s(!0),n(A,null,G(a.value,([S,O])=>(s(),n("iframe",{key:S,src:O.iframeSrc,onLoad:w=>p(S),onError:w=>y(S),allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,Mt))),128))])]))}}),Et={class:"program-output space-y-3","data-testid":"program-output"},Lt={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg","data-testid":"program-output-status"},Ot={class:"text-sm font-medium","data-testid":"program-output-text"},It={key:0,class:"space-y-2"},jt={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},Tt={class:"flex-1 text-xs truncate text-r58-text-secondary"},Vt={key:0,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},Pt={class:"text-xs text-r58-text-secondary"},Ut={key:1,class:"text-xs text-r58-text-secondary px-3"},Ht={class:"hidden"},Bt=["src"],At=J({__name:"ProgramOutput",setup(f){const x=oe(),a=ue(),i=$(!1),l=$("idle"),v=$("");function p(){return`${window.location.origin}/api/v1/whip/program/whip`}function y(){i.value||(l.value="connecting",v.value=He(p()),i.value=!0,console.log("[ProgramOutput] Starting WHIP push to MediaMTX"))}function d(){i.value&&(i.value=!1,v.value="",l.value="idle",console.log("[ProgramOutput] Stopped WHIP push"))}function M(){i.value&&(l.value="live",console.log("[ProgramOutput] WHIP push connected"))}function I(){l.value="error",console.error("[ProgramOutput] WHIP push failed")}function k(){d(),setTimeout(()=>y(),500)}se(()=>x.isLive,w=>{w?y():d()});function _(){switch(l.value){case"live":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function S(){switch(l.value){case"live":return"MediaMTX connected";case"connecting":return"Connecting...";case"error":return"Connection failed";default:return"Inactive"}}function O(){const w=a.programOutputUrls.srt;navigator.clipboard.writeText(w),P.success("SRT URL copied")}return(w,c)=>(s(),n("div",Et,[e("div",Lt,[e("span",{class:V(["w-2 h-2 rounded-full",_()]),"data-testid":"program-output-indicator"},null,2),e("span",Ot,b(S()),1),l.value==="error"?(s(),n("button",{key:0,onClick:c[0]||(c[0]=g=>k()),class:"ml-auto text-xs text-r58-accent-primary hover:underline"}," Retry ")):L("",!0)]),l.value==="live"?(s(),n("div",It,[e("div",jt,[c[1]||(c[1]=e("span",{class:"text-xs text-r58-text-secondary"},"ðŸ”´ SRT:",-1)),e("code",Tt,b(H(a).programOutputUrls.srt),1),e("button",{onClick:O,class:"text-xs text-r58-accent-primary hover:underline"},"Copy")]),H(a).enabledDestinations.length>0?(s(),n("div",Vt,[c[2]||(c[2]=e("span",{class:"w-2 h-2 rounded-full bg-emerald-500"},null,-1)),e("span",Pt,b(H(a).enabledDestinations.length)+" streaming destination"+b(H(a).enabledDestinations.length>1?"s":"")+" active ",1)])):L("",!0)])):L("",!0),l.value==="idle"?(s(),n("p",Ut," Program output will start automatically when you go live. ")):L("",!0),e("div",Ht,[i.value&&v.value?(s(),n("iframe",{key:0,src:v.value,onLoad:M,onError:I,allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,Bt)):L("",!0)])]))}}),Nt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Ft={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl"},zt={class:"p-6 overflow-y-auto max-h-[60vh]"},Kt={class:"mb-8"},Gt={class:"flex items-center justify-between mb-4"},Wt={key:0,class:"mb-4 p-4 bg-r58-bg-tertiary rounded-lg"},Jt={class:"grid grid-cols-2 gap-2"},Yt=["onClick"],qt={class:"text-xl"},Xt={key:1,class:"space-y-3"},Qt=["onClick"],Zt={class:"text-xl"},es={class:"flex-1"},ts={class:"font-medium"},ss={class:"text-xs text-r58-text-secondary"},ns=["onClick"],os=["onClick"],rs={key:2,class:"text-r58-text-secondary text-sm"},as={key:0,class:"mb-8 p-4 bg-r58-bg-tertiary rounded-lg"},is={class:"text-lg font-medium mb-4"},ls={class:"space-y-4"},cs=["placeholder"],ds={key:0},us={class:"flex gap-2"},ms={class:"mb-8"},gs={class:"space-y-3"},vs={class:"p-3 bg-r58-bg-tertiary rounded-lg"},ps={class:"flex items-center justify-between mb-1"},fs={class:"text-xs text-r58-text-secondary break-all"},xs={class:"p-3 bg-r58-bg-tertiary rounded-lg"},bs={class:"flex items-center justify-between mb-1"},ys={class:"text-xs text-r58-text-secondary break-all"},hs={class:"p-3 bg-r58-bg-tertiary rounded-lg"},ks={class:"flex items-center justify-between mb-1"},_s={class:"text-xs text-r58-text-secondary break-all"},ws={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Ss={class:"flex items-center justify-between mb-1"},$s={class:"text-xs text-r58-text-secondary break-all"},Cs={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Rs={class:"flex items-center justify-between mb-1"},Ms={class:"text-xs text-r58-text-secondary break-all"},Ds={class:"p-4 bg-r58-bg-tertiary rounded-lg"},Es={class:"flex items-center gap-3 mb-4"},Ls=J({__name:"StreamingSettings",setup(f,{expose:x}){const a=ue(),i=$(!1),l=$(null),v=$(!1);$(""),$("");const p=T(()=>a.destinations),y=T(()=>te),d=T(()=>a.programOutputUrls);function M(){i.value=!0}function I(){i.value=!1,l.value=null,v.value=!1}function k(h){const t=a.addDestination(h);l.value=t,v.value=!1,a.saveDestinations()}function _(){l.value&&(a.updateDestination(l.value.id,l.value),a.saveDestinations(),l.value=null,P.success("Streaming destination saved"))}function S(h){a.removeDestination(h),a.saveDestinations(),P.info("Destination removed")}function O(h){a.updateDestination(h.id,{enabled:!h.enabled}),a.saveDestinations()}function w(h,t){navigator.clipboard.writeText(h),P.success(`${t} copied to clipboard`)}function c(h){const t=te.find(o=>o.id===h);return(t==null?void 0:t.icon)||"ðŸ“¡"}function g(h){const t=te.find(o=>o.id===h);return(t==null?void 0:t.name)||"Unknown"}return x({open:M}),(h,t)=>{var o;return s(),le(_e,{to:"body"},[i.value?(s(),n("div",Nt,[e("div",{class:"absolute inset-0 bg-black/60",onClick:I}),e("div",Ft,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[t[11]||(t[11]=e("h2",{class:"text-xl font-semibold"},"Streaming Settings",-1)),e("button",{onClick:I,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",zt,[e("section",Kt,[e("div",Gt,[t[12]||(t[12]=e("h3",{class:"text-lg font-medium"},"Streaming Destinations",-1)),e("button",{onClick:t[0]||(t[0]=r=>v.value=!v.value),class:"btn btn-sm btn-primary"}," + Add Platform ")]),v.value?(s(),n("div",Wt,[t[13]||(t[13]=e("p",{class:"text-sm text-r58-text-secondary mb-3"},"Select a streaming platform:",-1)),e("div",Jt,[(s(!0),n(A,null,G(y.value,r=>(s(),n("button",{key:r.id,onClick:D=>k(r.id),class:"flex items-center gap-2 p-3 bg-r58-bg-secondary hover:bg-r58-accent-primary/20 rounded-lg transition-colors text-left"},[e("span",qt,b(r.icon),1),e("span",null,b(r.name),1)],8,Yt))),128))])])):L("",!0),p.value.length>0?(s(),n("div",Xt,[(s(!0),n(A,null,G(p.value,r=>(s(),n("div",{key:r.id,class:"flex items-center gap-3 p-3 bg-r58-bg-tertiary rounded-lg"},[e("button",{onClick:D=>O(r),class:V(["w-10 h-6 rounded-full transition-colors relative",r.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:V(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",r.enabled?"left-5":"left-1"])},null,2)],10,Qt),e("span",Zt,b(c(r.platformId)),1),e("div",es,[e("div",ts,b(r.name),1),e("div",ss,b(r.streamKey?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"+r.streamKey.slice(-4):"No stream key"),1)]),e("button",{onClick:D=>l.value={...r},class:"text-r58-accent-primary hover:underline text-sm"}," Edit ",8,ns),e("button",{onClick:D=>S(r.id),class:"text-r58-accent-danger hover:underline text-sm"}," Remove ",8,os)]))),128))])):(s(),n("p",rs," No streaming destinations configured. Add a platform above. "))]),l.value?(s(),n("section",as,[e("h3",is," Edit "+b(g(l.value.platformId)),1),e("div",ls,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Display Name",-1)),ae(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>l.value.name=r),type:"text",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ie,l.value.name]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Stream Key",-1)),ae(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>l.value.streamKey=r),type:"password",placeholder:(o=H(te).find(r=>r.id===l.value.platformId))==null?void 0:o.streamKeyPlaceholder,class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,8,cs),[[ie,l.value.streamKey]]),t[16]||(t[16]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Your stream key is stored locally and never sent to our servers. ",-1))]),l.value.platformId==="custom"?(s(),n("div",ds,[t[17]||(t[17]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"RTMP URL",-1)),ae(e("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>l.value.name=r),type:"text",placeholder:"rtmp://your-server.com/live/",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,512),[[ie,l.value.name]])])):L("",!0),e("div",us,[e("button",{onClick:_,class:"btn btn-primary"}," Save "),e("button",{onClick:t[4]||(t[4]=r=>l.value=null),class:"btn"}," Cancel ")])])])):L("",!0),e("section",ms,[t[26]||(t[26]=e("h3",{class:"text-lg font-medium mb-4"},"Program Output URLs",-1)),t[27]||(t[27]=e("p",{class:"text-sm text-r58-text-secondary mb-4"}," Use these URLs to consume the program feed from MediaMTX: ",-1)),e("div",gs,[e("div",vs,[e("div",ps,[t[18]||(t[18]=e("span",{class:"font-medium"},"ðŸ”´ SRT Output",-1)),e("button",{onClick:t[5]||(t[5]=r=>w(d.value.srt,"SRT URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",fs,b(d.value.srt),1),t[19]||(t[19]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Low-latency, reliable transport. Ideal for remote production. ",-1))]),e("div",xs,[e("div",bs,[t[20]||(t[20]=e("span",{class:"font-medium"},"ðŸ“º RTMP Output",-1)),e("button",{onClick:t[6]||(t[6]=r=>w(d.value.rtmp,"RTMP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",ys,b(d.value.rtmp),1)]),e("div",hs,[e("div",ks,[t[21]||(t[21]=e("span",{class:"font-medium"},"ðŸŽ¬ RTSP Output",-1)),e("button",{onClick:t[7]||(t[7]=r=>w(d.value.rtsp,"RTSP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",_s,b(d.value.rtsp),1)]),e("div",ws,[e("div",Ss,[t[22]||(t[22]=e("span",{class:"font-medium"},"ðŸŒ HLS Output",-1)),e("button",{onClick:t[8]||(t[8]=r=>w(d.value.hls,"HLS URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",$s,b(d.value.hls),1),t[23]||(t[23]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Browser-compatible streaming. Higher latency. ",-1))]),e("div",Cs,[e("div",Rs,[t[24]||(t[24]=e("span",{class:"font-medium"},"âš¡ WebRTC (WHEP)",-1)),e("button",{onClick:t[9]||(t[9]=r=>w(d.value.whep,"WHEP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Ms,b(d.value.whep),1),t[25]||(t[25]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Ultra-low latency WebRTC. Best for interactive use. ",-1))])])]),e("section",null,[t[30]||(t[30]=e("h3",{class:"text-lg font-medium mb-4"},"SRT Configuration",-1)),e("div",Ds,[e("div",Es,[e("button",{onClick:t[10]||(t[10]=r=>H(a).toggleSrtOutput(!H(a).srtOutput.enabled)),class:V(["w-10 h-6 rounded-full transition-colors relative",H(a).srtOutput.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:V(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",H(a).srtOutput.enabled?"left-5":"left-1"])},null,2)],2),t[28]||(t[28]=e("span",null,"Enable SRT Output",-1))]),t[29]||(t[29]=e("div",{class:"text-sm text-r58-text-secondary"},[e("p",{class:"mb-2"},"SRT (Secure Reliable Transport) provides:"),e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Low latency (typically 1-2 seconds)"),e("li",null,"Error correction for unreliable networks"),e("li",null,"AES encryption support"),e("li",null,"Compatible with OBS, vMix, and professional equipment")])],-1))])])]),e("div",{class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},[e("button",{onClick:I,class:"btn"},"Close")])])])):L("",!0)])}}}),Os={class:"recording-controls space-y-3","data-testid":"recording-controls"},Is={class:"flex items-center gap-3 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},js={class:"text-sm font-medium flex-1","data-testid":"recording-status"},Ts={key:0,class:"text-lg font-mono font-bold text-r58-accent-danger","data-testid":"recording-duration"},Vs=["disabled"],Ps={key:0,class:"px-3 py-2 bg-r58-accent-success/10 border border-r58-accent-success/30 rounded-lg"},Us={class:"flex items-center justify-between"},Hs=["href"],Bs=J({__name:"RecordingControls",props:{vdoEmbed:{}},setup(f){const x=f,a=$(!1),i=$(null),l=$(0),v=$(null),p=$(!1);se(()=>{var c,g;return(g=(c=x.vdoEmbed)==null?void 0:c.isRecording)==null?void 0:g.value},c=>{c!==void 0&&(a.value=c,c&&!i.value?i.value=Date.now():!c&&i.value&&(i.value=null))});let y=null;function d(){y&&clearInterval(y),y=window.setInterval(()=>{i.value&&(l.value=Date.now()-i.value)},100)}function M(){y&&(clearInterval(y),y=null)}ne(()=>{d()}),re(()=>{M()});const I=T(()=>{const c=Math.floor(l.value/1e3),g=Math.floor(c/3600),h=Math.floor(c%3600/60),t=c%60;return g>0?`${g}:${h.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`:`${h}:${t.toString().padStart(2,"0")}`});async function k(){if(!x.vdoEmbed){P.error("VDO.ninja not connected");return}p.value=!0;try{x.vdoEmbed.startRecording(),a.value=!0,i.value=Date.now(),l.value=0,v.value=null,P.success("Recording started")}catch(c){P.error("Failed to start recording"),console.error("[RecordingControls] Start recording error:",c)}finally{p.value=!1}}async function _(){if(!x.vdoEmbed){P.error("VDO.ninja not connected");return}p.value=!0;try{x.vdoEmbed.stopRecording(),a.value=!1,i.value=null,P.success(`Recording stopped (${I.value})`)}catch(c){P.error("Failed to stop recording"),console.error("[RecordingControls] Stop recording error:",c)}finally{p.value=!1}}function S(){a.value?_():k()}function O(){return a.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"}function w(){return p.value?"Processing...":a.value?`Recording â€¢ ${I.value}`:"Ready to record"}return(c,g)=>(s(),n("div",Os,[e("div",Is,[e("span",{class:V(["w-3 h-3 rounded-full",O()]),"data-testid":"recording-indicator"},null,2),e("span",js,b(w()),1),a.value?(s(),n("span",Ts,b(I.value),1)):L("",!0)]),e("div",null,[e("button",{onClick:S,disabled:p.value,class:V(["btn w-full justify-center",a.value?"btn-danger":"btn-primary"]),"data-testid":"recording-toggle-button"},[p.value?(s(),n(A,{key:0},[g[0]||(g[0]=e("svg",{class:"animate-spin w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),g[1]||(g[1]=Q(" Processing... ",-1))],64)):a.value?(s(),n(A,{key:1},[g[2]||(g[2]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("rect",{x:"6",y:"6",width:"12",height:"12",rx:"1"})],-1)),g[3]||(g[3]=Q(" Stop Recording ",-1))],64)):(s(),n(A,{key:2},[g[4]||(g[4]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("circle",{cx:"12",cy:"12",r:"8"})],-1)),g[5]||(g[5]=Q(" Start Recording ",-1))],64))],10,Vs)]),v.value?(s(),n("div",Ps,[e("div",Us,[g[6]||(g[6]=e("span",{class:"text-sm text-r58-accent-success"},"Recording ready!",-1)),e("a",{href:v.value,download:"",class:"text-sm text-r58-accent-primary hover:underline"}," Download ",8,Hs)])])):L("",!0),g[7]||(g[7]=e("p",{class:"text-xs text-r58-text-secondary px-1"}," Records the mixed output locally in your browser. Recording is saved when stopped. ",-1))]))}}),As=ce(Bs,[["__scopeId","data-v-14707e66"]]),Ns={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Fs={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-3xl max-h-[80vh] overflow-hidden shadow-2xl","data-testid":"hotkey-settings-modal"},zs={class:"flex border-b border-r58-bg-tertiary"},Ks=["onClick"],Gs={class:"p-6 overflow-y-auto max-h-[55vh]"},Ws={key:0,class:"text-center py-12 text-r58-text-secondary"},Js={key:1,class:"space-y-6"},Ys={class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},qs={class:"space-y-2"},Xs={class:"flex-1"},Qs={class:"text-sm"},Zs={key:0,class:"ml-2 text-xs text-r58-accent-primary"},en={class:"flex items-center gap-2"},tn={key:0,class:"flex items-center gap-2"},sn={key:0,class:"px-3 py-1 bg-r58-accent-primary text-white rounded text-sm font-mono"},nn={key:1,class:"text-sm text-r58-text-secondary animate-pulse"},on={class:"px-3 py-1 bg-r58-bg-secondary border border-r58-bg-tertiary rounded text-sm font-mono"},rn=["onClick"],an=["onClick"],ke="r58-hotkey-customizations",ln=J({__name:"HotkeySettings",setup(f,{expose:x}){const a=[{id:"help",key:"?",modifiers:["shift"],description:"Show keyboard shortcuts",context:"global",category:"Navigation",editable:!1},{id:"goto-recorder",key:"r",description:"Go to Recorder",context:"global",category:"Navigation",editable:!0},{id:"goto-mixer",key:"m",description:"Go to Mixer",context:"global",category:"Navigation",editable:!0},{id:"escape",key:"Escape",description:"Close modal / Cancel",context:"global",category:"Navigation",editable:!1},{id:"scene-1",key:"1",description:"Switch to Scene 1",context:"mixer",category:"Scenes",editable:!0},{id:"scene-2",key:"2",description:"Switch to Scene 2",context:"mixer",category:"Scenes",editable:!0},{id:"scene-3",key:"3",description:"Switch to Scene 3",context:"mixer",category:"Scenes",editable:!0},{id:"scene-4",key:"4",description:"Switch to Scene 4",context:"mixer",category:"Scenes",editable:!0},{id:"scene-5",key:"5",description:"Switch to Scene 5",context:"mixer",category:"Scenes",editable:!0},{id:"scene-6",key:"6",description:"Switch to Scene 6",context:"mixer",category:"Scenes",editable:!0},{id:"scene-7",key:"7",description:"Switch to Scene 7",context:"mixer",category:"Scenes",editable:!0},{id:"scene-8",key:"8",description:"Switch to Scene 8",context:"mixer",category:"Scenes",editable:!0},{id:"scene-9",key:"9",description:"Switch to Scene 9",context:"mixer",category:"Scenes",editable:!0},{id:"cut",key:"t",description:"Cut transition",context:"mixer",category:"Transitions",editable:!0},{id:"fade",key:"a",description:"Auto-transition (fade)",context:"mixer",category:"Transitions",editable:!0},{id:"cycle-sources",key:"Tab",description:"Cycle through sources",context:"mixer",category:"Transitions",editable:!0},{id:"go-live",key:"g",description:"Toggle Go Live",context:"mixer",category:"Control",editable:!0},{id:"toggle-recording",key:"r",modifiers:["ctrl"],description:"Toggle local recording",context:"mixer",category:"Control",editable:!0},{id:"mute-all",key:"m",modifiers:["ctrl"],description:"Mute all sources",context:"mixer",category:"Control",editable:!0},{id:"source-1",key:"F1",description:"Select source 1",context:"mixer",category:"Sources",editable:!0},{id:"source-2",key:"F2",description:"Select source 2",context:"mixer",category:"Sources",editable:!0},{id:"source-3",key:"F3",description:"Select source 3",context:"mixer",category:"Sources",editable:!0},{id:"source-4",key:"F4",description:"Select source 4",context:"mixer",category:"Sources",editable:!0},{id:"start-stop-recording",key:" ",description:"Start/Stop recording",context:"recorder",category:"Recording",editable:!0},{id:"mark-chapter",key:"c",description:"Mark chapter point",context:"recorder",category:"Recording",editable:!0}],i=$(!1),l=$("mixer"),v=$({}),p=$(null),y=$(null);function d(){try{const C=localStorage.getItem(ke);C&&(v.value=JSON.parse(C))}catch(C){console.warn("[HotkeySettings] Failed to load customizations:",C)}}function M(){try{localStorage.setItem(ke,JSON.stringify(v.value))}catch(C){console.warn("[HotkeySettings] Failed to save customizations:",C)}}function I(C){const m=v.value[C.id];return m?{...C,key:m.key,modifiers:m.modifiers}:C}const k=T(()=>{const C={global:{},mixer:{},recorder:{}};for(const m of a){const R=I(m);C[m.context][R.category]||(C[m.context][R.category]=[]),C[m.context][R.category].push(R)}return C}),_=T(()=>k.value[l.value]||{});function S(C){return xe(C.key,C.modifiers)}function O(C){return!!v.value[C]}function w(C){const m=a.find(R=>R.id===C);m!=null&&m.editable&&(p.value=C,y.value=null,document.addEventListener("keydown",c))}function c(C){if(C.preventDefault(),C.stopPropagation(),["Control","Alt","Shift","Meta"].includes(C.key))return;const m=[];C.ctrlKey&&m.push("ctrl"),C.altKey&&m.push("alt"),C.shiftKey&&m.push("shift"),C.metaKey&&m.push("meta"),y.value={key:C.key,modifiers:m},document.removeEventListener("keydown",c)}function g(){!p.value||!y.value||(v.value[p.value]={key:y.value.key,modifiers:y.value.modifiers.length>0?y.value.modifiers:void 0},M(),P.success("Hotkey updated"),p.value=null,y.value=null)}function h(){p.value=null,y.value=null,document.removeEventListener("keydown",c)}function t(C){delete v.value[C],M(),P.info("Hotkey reset to default")}function o(){confirm("Reset all hotkeys to defaults?")&&(v.value={},M(),P.info("All hotkeys reset to defaults"))}function r(){d(),i.value=!0}function D(){h(),i.value=!1}ne(()=>{d()});function K(){return{...v.value}}return x({open:r,getCustomBindings:K}),(C,m)=>(s(),le(_e,{to:"body"},[i.value?(s(),n("div",Ns,[e("div",{class:"absolute inset-0 bg-black/60",onClick:D}),e("div",Fs,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[m[0]||(m[0]=e("h2",{class:"text-xl font-semibold"},"Keyboard Shortcuts",-1)),e("div",{class:"flex items-center gap-4"},[e("button",{onClick:o,class:"text-sm text-r58-text-secondary hover:text-r58-text-primary"}," Reset All "),e("button",{onClick:D,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")])]),e("div",zs,[(s(),n(A,null,G(["mixer","global","recorder"],R=>e("button",{key:R,onClick:z=>l.value=R,class:V(["px-6 py-3 text-sm font-medium capitalize transition-colors",l.value===R?"text-r58-accent-primary border-b-2 border-r58-accent-primary":"text-r58-text-secondary hover:text-r58-text-primary"])},b(R),11,Ks)),64))]),e("div",Gs,[Object.keys(_.value).length===0?(s(),n("div",Ws," No shortcuts defined for this context. ")):(s(),n("div",Js,[(s(!0),n(A,null,G(_.value,(R,z)=>(s(),n("div",{key:z},[e("h3",Ys,b(z),1),e("div",qs,[(s(!0),n(A,null,G(R,N=>(s(),n("div",{key:N.id,class:V(["flex items-center justify-between p-3 bg-r58-bg-tertiary rounded-lg",{"ring-2 ring-r58-accent-primary":p.value===N.id}])},[e("div",Xs,[e("span",Qs,b(N.description),1),O(N.id)?(s(),n("span",Zs,"(customized)")):L("",!0)]),e("div",en,[p.value===N.id?(s(),n("div",tn,[y.value?(s(),n("kbd",sn,b(H(xe)(y.value.key,y.value.modifiers)),1)):(s(),n("span",nn," Press a key... ")),y.value?(s(),n("button",{key:2,onClick:g,class:"btn btn-sm btn-primary"}," Save ")):L("",!0),e("button",{onClick:h,class:"btn btn-sm"}," Cancel ")])):(s(),n(A,{key:1},[e("kbd",on,b(S(N)),1),N.editable?(s(),n("button",{key:0,onClick:ee=>w(N.id),class:"text-xs text-r58-accent-primary hover:underline"}," Edit ",8,rn)):L("",!0),O(N.id)?(s(),n("button",{key:1,onClick:ee=>t(N.id),class:"text-xs text-r58-text-secondary hover:text-r58-accent-danger"}," Reset ",8,an)):L("",!0)],64))])],2))),128))])]))),128))]))]),e("div",{class:"flex items-center justify-between px-6 py-4 border-t border-r58-bg-tertiary"},[m[1]||(m[1]=e("div",{class:"text-sm text-r58-text-secondary"},' Click "Edit" to customize a shortcut. Press any key combination to set. ',-1)),e("button",{onClick:D,class:"btn"},"Close")])])])):L("",!0)]))}}),cn={class:"connection-status","data-testid":"connection-status"},dn={class:"text-xs text-r58-text-secondary"},un={key:0,class:"text-xs text-r58-accent-danger",title:"Click for details"},mn={key:0,class:"mt-2 p-3 bg-r58-bg-tertiary rounded-lg text-xs space-y-2"},gn={class:"grid grid-cols-2 gap-2"},vn={class:"ml-1 font-medium"},pn={class:"ml-1"},fn={class:"ml-1"},xn={key:0,class:"p-2 bg-r58-accent-danger/10 border border-r58-accent-danger/30 rounded text-r58-accent-danger"},bn={class:"flex gap-2 pt-2 border-t border-r58-bg-tertiary"},yn=["disabled"],hn={key:1,class:"text-r58-text-secondary text-center"},kn=J({__name:"ConnectionStatus",props:{vdoEmbed:{}},setup(f){const x=f;oe();const a=$(!1),i=$("never"),l=$(0),v=$(!1),p=T(()=>{var h,t;return((t=(h=x.vdoEmbed)==null?void 0:h.connectionState)==null?void 0:t.value)||"disconnected"}),y=T(()=>{var h,t;return((t=(h=x.vdoEmbed)==null?void 0:h.isReady)==null?void 0:t.value)||!1}),d=T(()=>{var h,t;return((t=(h=x.vdoEmbed)==null?void 0:h.lastError)==null?void 0:t.value)||null}),M=T(()=>p.value==="disconnected"||!y.value?"disconnected":d.value?"error":p.value==="connecting"?"degraded":"healthy"),I=T(()=>{switch(M.value){case"healthy":return"bg-r58-accent-success";case"degraded":return"bg-amber-500";case"error":return"bg-r58-accent-danger";case"disconnected":return"bg-r58-text-secondary";default:return"bg-r58-text-secondary"}}),k=T(()=>{switch(M.value){case"healthy":return"Connected";case"degraded":return"Connecting...";case"error":return"Error";case"disconnected":return"Disconnected";default:return"Unknown"}});let _=null;function S(){if(x.vdoEmbed){const h=x.vdoEmbed.getEventStats();if(h.lastActivity){const t=Date.now()-h.lastActivity;t<1e3?i.value="just now":t<6e4?i.value=`${Math.floor(t/1e3)}s ago`:t<36e5?i.value=`${Math.floor(t/6e4)}m ago`:i.value="over 1h ago"}}}ne(()=>{S(),_=window.setInterval(S,1e3)}),re(()=>{_&&clearInterval(_)});async function O(){if(!v.value){v.value=!0,l.value++,P.info("Attempting to reconnect...");try{x.vdoEmbed&&x.vdoEmbed.sendCommand("ping"),await new Promise(h=>setTimeout(h,2e3)),y.value&&!d.value?(P.success("Reconnected successfully"),l.value=0):P.error("Reconnection failed. Try refreshing the page.")}catch(h){P.error("Reconnection error"),console.error("[ConnectionStatus] Reconnect error:",h)}finally{v.value=!1}}}function w(){confirm("This will refresh the page and may interrupt active streams. Continue?")&&window.location.reload()}function c(){a.value=!a.value}const g=T(()=>x.vdoEmbed?x.vdoEmbed.getEventStats():{total:0,incoming:0,outgoing:0,lastActivity:null});return(h,t)=>(s(),n("div",cn,[e("div",{class:"flex items-center gap-2 cursor-pointer",onClick:c},[e("span",{class:V(["w-2 h-2 rounded-full",[I.value,{"animate-pulse":M.value==="degraded"}]]),"data-testid":"status-indicator"},null,2),e("span",dn,b(k.value),1),d.value?(s(),n("span",un," âš ï¸ ")):L("",!0),(s(),n("svg",{class:V(["w-3 h-3 text-r58-text-secondary transition-transform",{"rotate-180":a.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[0]||(t[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),a.value?(s(),n("div",mn,[e("div",gn,[e("div",null,[t[1]||(t[1]=e("span",{class:"text-r58-text-secondary"},"VDO.ninja:",-1)),e("span",{class:V(["ml-1 font-medium",y.value?"text-r58-accent-success":"text-r58-accent-danger"])},b(y.value?"Ready":"Not Ready"),3)]),e("div",null,[t[2]||(t[2]=e("span",{class:"text-r58-text-secondary"},"State:",-1)),e("span",vn,b(p.value),1)]),e("div",null,[t[3]||(t[3]=e("span",{class:"text-r58-text-secondary"},"Last activity:",-1)),e("span",pn,b(i.value),1)]),e("div",null,[t[4]||(t[4]=e("span",{class:"text-r58-text-secondary"},"Events:",-1)),e("span",fn,b(g.value.total),1)])]),d.value?(s(),n("div",xn,[t[5]||(t[5]=e("strong",null,"Error:",-1)),Q(" "+b(d.value),1)])):L("",!0),e("div",bn,[e("button",{onClick:O,disabled:v.value,class:V(["btn btn-sm flex-1",{"opacity-50":v.value}])},b(v.value?"Reconnecting...":"ðŸ”„ Reconnect"),11,yn),e("button",{onClick:w,class:"btn btn-sm",title:"Refresh the page (last resort)"}," ðŸ”ƒ Refresh ")]),l.value>0?(s(),n("div",hn," Reconnect attempts: "+b(l.value),1)):L("",!0)])):L("",!0)]))}}),_n={class:"h-full flex flex-col bg-r58-bg-primary"},wn={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},Sn={class:"flex items-center gap-4"},$n={class:"flex items-center gap-2"},Cn={key:0,class:"badge badge-danger"},Rn={class:"flex items-center gap-4"},Mn={class:"flex-1 p-6 overflow-auto"},Dn={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},En={class:"card p-6"},Ln={class:"grid grid-cols-4 gap-3"},On=["onClick"],In={class:"card p-6"},jn={class:"text-lg font-semibold mb-4"},Tn={class:"text-sm font-normal text-r58-text-secondary"},Vn={class:"space-y-3"},Pn={class:"flex items-center gap-3"},Un={class:"font-medium"},Hn={key:0,class:"text-xs text-r58-text-secondary ml-2"},Bn={key:0,class:"text-sm text-r58-text-secondary"},An={class:"card p-6"},Nn={class:"flex items-center gap-4"},Fn={key:0,class:"w-2 h-2 rounded-full bg-white animate-pulse mr-2"},zn={key:0,class:"mt-3 text-sm text-r58-text-secondary"},Kn={class:"card p-6"},Gn={class:"grid grid-cols-2 gap-4"},Wn={class:"text-2xl font-bold text-r58-text-primary"},Jn=J({__name:"MixerLiteView",emits:["enable-full-mode"],setup(f,{emit:x}){const a=x,i=de(),l=oe(),v=ue(),{register:p}=we(),y=T(()=>l.isLive),d=T(()=>i.inputs),M=T(()=>d.value.filter(w=>w.hasSignal));let I=null;ne(()=>{i.fetchInputs(),I=window.setInterval(()=>{i.fetchInputs()},5e3);for(let w=1;w<=4;w++)p({key:String(w),description:`Switch to scene ${w}`,action:()=>k(w),context:"mixer-lite"})}),re(()=>{I&&clearInterval(I)});function k(w){l.setScene(`scene-${w}`),P.info(`Scene ${w}`)}function _(){l.isLive?(l.toggleLive(),v.stopStreaming(),P.info("Session ended")):(l.toggleLive(),v.startStreaming(),P.success("Going live!"))}async function S(){try{i.isRecording?(await i.stopRecording(),P.info("Recording stopped")):(await i.startRecording(),P.success("Recording started"))}catch{P.error("Recording action failed")}}function O(){confirm("Full Mixer mode loads VDO.ninja which uses significant CPU/GPU resources. This may cause lag on the device. Continue?")&&a("enable-full-mode")}return(w,c)=>(s(),n("div",_n,[e("header",wn,[e("div",Sn,[e("div",$n,[e("span",{class:V(["w-3 h-3 rounded-full",y.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"])},null,2),c[0]||(c[0]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1)),c[1]||(c[1]=e("span",{class:"text-xs px-2 py-0.5 rounded bg-amber-500/20 text-amber-400 font-medium"}," LITE MODE ",-1))]),y.value?(s(),n("span",Cn,"ON AIR")):L("",!0)]),e("div",Rn,[e("button",{class:"btn btn-sm btn-secondary",onClick:O,title:"Enable full VDO.ninja mixer (high CPU usage)"},[...c[2]||(c[2]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1),Q(" Full Mode ",-1)])]),e("button",{class:V(["btn",y.value?"btn-danger":"btn-primary"]),onClick:_},b(y.value?"End Session":"Go Live"),3)])]),e("main",Mn,[c[10]||(c[10]=Oe('<div class="mb-6 p-4 rounded-lg bg-amber-500/10 border border-amber-500/30" data-v-6d9e9096><div class="flex items-start gap-3" data-v-6d9e9096><svg class="w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-6d9e9096><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-6d9e9096></path></svg><div data-v-6d9e9096><h3 class="font-medium text-amber-400" data-v-6d9e9096>Local Device Mode</h3><p class="text-sm text-r58-text-secondary mt-1" data-v-6d9e9096> VDO.ninja previews are disabled to save CPU. Scene switching and guest management should be done from a remote browser or the Electron app. </p></div></div></div>',1)),e("div",Dn,[e("div",En,[c[3]||(c[3]=e("h2",{class:"text-lg font-semibold mb-4"},"Scene Control",-1)),e("div",Ln,[(s(),n(A,null,G(4,g=>e("button",{key:g,class:V(["aspect-video flex items-center justify-center text-2xl font-bold rounded-lg transition-all",H(l).currentScene===`scene-${g}`?"bg-r58-mixer text-white ring-2 ring-r58-mixer ring-offset-2 ring-offset-r58-bg-primary":"bg-r58-bg-tertiary hover:bg-r58-bg-secondary text-r58-text-primary"]),onClick:h=>k(g)},b(g),11,On)),64))]),c[4]||(c[4]=e("p",{class:"text-xs text-r58-text-secondary mt-3"}," Press 1-4 to switch scenes. Full transitions require VDO.ninja (Full Mode). ",-1))]),e("div",In,[e("h2",jn,[c[5]||(c[5]=Q(" Inputs ",-1)),e("span",Tn,"("+b(M.value.length)+"/"+b(d.value.length)+" active)",1)]),e("div",Vn,[(s(!0),n(A,null,G(d.value,g=>(s(),n("div",{key:g.id,class:V(["flex items-center justify-between p-3 rounded-lg",g.hasSignal?"bg-r58-bg-tertiary":"bg-r58-bg-secondary opacity-50"])},[e("div",Pn,[e("div",{class:V(["w-2 h-2 rounded-full",g.hasSignal?"bg-green-500":"bg-gray-500"])},null,2),e("div",null,[e("span",Un,b(g.name),1),g.resolution?(s(),n("span",Hn,b(g.resolution),1)):L("",!0)])]),g.framerate?(s(),n("div",Bn,b(g.framerate.toFixed(1))+" fps ",1)):L("",!0)],2))),128))])]),e("div",An,[c[6]||(c[6]=e("h2",{class:"text-lg font-semibold mb-4"},"Device Recording",-1)),e("div",Nn,[e("button",{class:V(["btn flex-1",H(i).isRecording?"btn-danger":"btn-primary"]),onClick:S},[H(i).isRecording?(s(),n("span",Fn)):L("",!0),Q(" "+b(H(i).isRecording?"Stop Recording":"Start Recording"),1)],2)]),H(i).isRecording?(s(),n("div",zn," Duration: "+b(H(i).formattedDuration),1)):L("",!0)]),e("div",Kn,[c[9]||(c[9]=e("h2",{class:"text-lg font-semibold mb-4"},"System Status",-1)),e("div",Gn,[e("div",null,[e("div",Wn,b(M.value.length),1),c[7]||(c[7]=e("div",{class:"text-sm text-r58-text-secondary"},"Active Inputs",-1))]),e("div",null,[e("div",{class:V(["text-2xl font-bold",y.value?"text-red-500":"text-r58-text-primary"])},b(y.value?"LIVE":"Offline"),3),c[8]||(c[8]=e("div",{class:"text-sm text-r58-text-secondary"},"Stream Status",-1))])])])])])]))}}),Yn=ce(Jn,[["__scopeId","data-v-6d9e9096"]]),qn={class:"h-full flex flex-col"},Xn={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"mixer-header"},Qn={class:"flex items-center gap-4"},Zn={class:"flex items-center gap-2"},eo={key:0,class:"badge badge-danger","data-testid":"on-air-badge"},to={key:1,class:"text-xs text-r58-text-secondary"},so={class:"flex items-center gap-4"},no={class:"flex-1 flex overflow-hidden"},oo={class:"flex-1 p-4"},ro={class:"w-80 border-l border-r58-bg-tertiary bg-r58-bg-secondary p-4 overflow-y-auto"},ao={class:"mb-6"},io={class:"grid grid-cols-4 gap-2"},lo=["onClick","data-testid"],co={class:"mb-6 pt-4 border-t border-r58-bg-tertiary"},uo={class:"mb-6 pt-4 border-t border-r58-bg-tertiary"},mo={class:"pt-4 border-t border-r58-bg-tertiary"},go=J({__name:"MixerView",setup(f){const x=oe(),a=de(),i=ue(),{register:l}=we(),{isLiteMode:v}=Ie(),p=$(null),y=$(null),d=$(null),M=T(()=>x.isLive),I=T(()=>i.enabledDestinations.length),k=$(!1),_=T(()=>!v.value||k.value),S=$(!0),O=$(!1);function w(){S.value=!1}se(()=>{var m,R;return(R=(m=p.value)==null?void 0:m.isReady)==null?void 0:R.value},m=>{m&&(console.log("[Mixer] VDO.ninja iframe ready, dismissing loading screen"),O.value=!0)},{immediate:!0});let c=null;function g(){return a.isRecording?1e4:3e4}function h(){c&&clearInterval(c),c=window.setInterval(()=>{a.fetchInputs()},g())}const t=[];se(()=>a.isRecording,()=>{h()}),ne(async()=>{await a.fetchInputs(),h();for(let m=1;m<=4;m++){const R=l({key:String(m),description:`Switch to scene ${m}`,action:()=>o(m),context:"mixer"});t.push(R)}t.push(l({key:"g",description:"Toggle Go Live",action:()=>D(),context:"mixer"})),t.push(l({key:"r",description:"Toggle recording",action:()=>r(),context:"mixer"}))}),re(()=>{t.forEach(m=>m()),c&&(clearInterval(c),c=null)});function o(m){p.value&&p.value.sendCommand("addScene","*",m),x.setScene(`scene-${m}`),P.info(`Scene ${m}`)}function r(){var m;p.value&&((m=p.value.isRecording)!=null&&m.value?(p.value.stopRecording(),P.info("Recording stopped")):(p.value.startRecording(),P.success("Recording started")))}function D(){if(x.isLive)x.toggleLive(),i.stopStreaming(),P.info("Session ended");else{x.toggleLive(),i.startStreaming();const m=i.enabledDestinations.length;m>0?P.success(`Live! Streaming to ${m} destination${m>1?"s":""}`):P.info("Live! (No streaming destinations configured)")}}function K(){var m;(m=y.value)==null||m.open()}function C(){var m;(m=d.value)==null||m.open()}return(m,R)=>_.value?(s(),n(A,{key:1},[X(Te,{name:"fade"},{default:je(()=>[S.value?(s(),le(Be,{key:0,mode:"mixer","content-ready":O.value,"min-time":2e3,"max-time":15e3,onReady:w},null,8,["content-ready"])):L("",!0)]),_:1}),e("div",qn,[e("header",Xn,[e("div",Qn,[e("div",Zn,[e("span",{class:V(["w-3 h-3 rounded-full",M.value?"bg-r58-accent-danger animate-recording":"bg-r58-bg-tertiary"]),"data-testid":"live-indicator"},null,2),R[1]||(R[1]=e("span",{class:"text-xl font-semibold text-r58-mixer","data-testid":"mixer-title"},"Mixer",-1))]),M.value?(s(),n("span",eo,"ON AIR")):L("",!0),M.value&&I.value>0?(s(),n("span",to," Streaming to "+b(I.value)+" platform"+b(I.value>1?"s":""),1)):L("",!0),X(kn,{"vdo-embed":p.value},null,8,["vdo-embed"])]),e("div",so,[e("button",{class:"btn btn-sm",onClick:C,title:"Keyboard Shortcuts (Shift+?)","data-testid":"hotkey-settings-button"},[...R[2]||(R[2]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})],-1)])]),e("button",{class:"btn btn-sm",onClick:K,title:"Streaming Settings","data-testid":"streaming-settings-button"},[...R[3]||(R[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])]),e("button",{class:V(["btn",M.value?"btn-danger":"btn-primary"]),onClick:D,"data-testid":"go-live-button"},b(M.value?"End Session":"Go Live"),3)])]),e("div",no,[e("div",oo,[X(qe,{ref_key:"vdoEmbedRef",ref:p,profile:"director",class:"h-full"},null,512)]),e("aside",ro,[e("div",ao,[R[4]||(R[4]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Quick Scenes",-1)),e("div",io,[(s(),n(A,null,G(4,z=>e("button",{key:z,class:V(["btn btn-sm",H(x).currentScene===`scene-${z}`?"btn-primary":""]),onClick:N=>o(z),"data-testid":`scene-btn-${z}`},b(z),11,lo)),64))]),R[5]||(R[5]=e("p",{class:"text-xs text-r58-text-secondary mt-2"}," Press 1-4 for quick switch. Full layout control is in the mixer above. ",-1))]),e("div",co,[X(xt,{"vdo-embed":p.value},null,8,["vdo-embed"])]),e("div",uo,[R[6]||(R[6]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Program Output",-1)),X(At)]),e("div",mo,[R[7]||(R[7]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Local Recording",-1)),X(As,{"vdo-embed":p.value},null,8,["vdo-embed"])])])]),X(Dt),X(Ls,{ref_key:"streamingSettingsRef",ref:y},null,512),X(ln,{ref_key:"hotkeySettingsRef",ref:d},null,512)])],64)):(s(),le(Yn,{key:0,onEnableFullMode:R[0]||(R[0]=z=>k.value=!0)}))}}),xo=ce(go,[["__scopeId","data-v-1208ebb3"]]);export{xo as default};
