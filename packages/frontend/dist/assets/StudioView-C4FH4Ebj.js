import{d as b,u as g,r as _,o as x,b as v,c as d,a as e,e as y,n as w,t as h,f as k,g as C,h as n,_ as S}from"./index-CF6Mgpgb.js";const M={class:"studio"},B={class:"studio__content"},A={class:"studio__modes"},E=["disabled"],V={class:"studio__mode-icon"},z={key:0,class:"animate-spin",fill:"none",viewBox:"0 0 24 24",width:"32",height:"32"},$={key:1,fill:"currentColor",viewBox:"0 0 24 24",width:"32",height:"32"},F={class:"studio__mode-info"},O={class:"studio__mode-desc"},P=["disabled"],H={class:"studio__mode-icon"},I={key:0,class:"animate-spin",fill:"none",viewBox:"0 0 24 24",width:"32",height:"32"},N={key:1,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"32",height:"32","stroke-width":"1.8"},R={class:"studio__mode-info"},T={class:"studio__mode-desc"},j={key:0,class:"studio__error"},D=b({__name:"StudioView",setup(L){const f=k(),p=g(),r=_(null),o=_(!1),c=_(null);let l=null;x(async()=>{try{(await fetch(v("/api/mode/idle"),{method:"POST"})).ok&&(console.log("[Studio] Switched to idle mode"),await p.fetchCapabilities())}catch(s){console.warn("[Studio] Failed to switch to idle mode:",s)}});async function m(s){if(o.value)return;l&&l.abort(),l=new AbortController;const t=l,a=t.signal;r.value=s,o.value=!0,c.value=null;try{const i=await fetch(v(`/api/mode/${s}`),{method:"POST",signal:a});if(a.aborted)return;if(!i.ok){const u=await i.json().catch(()=>({}));throw new Error(u.detail||`Failed to switch to ${s} mode`)}if(a.aborted)return;f.push(`/${s}`)}catch(i){if(i instanceof Error&&i.name==="AbortError"){console.log("[Studio] Mode switch cancelled by user");return}const u=i instanceof Error?i.message:"Failed to switch mode";c.value=u,C.error(u),console.error("Mode switch error:",i)}finally{l===t&&(o.value=!1,l=null)}}return(s,t)=>(n(),d("div",M,[t[10]||(t[10]=e("div",{class:"studio__bg"},[e("div",{class:"studio__orb studio__orb--1"}),e("div",{class:"studio__orb studio__orb--2"}),e("div",{class:"studio__orb studio__orb--3"})],-1)),e("div",B,[t[8]||(t[8]=e("h1",{class:"studio__title"},"Preke Studio",-1)),t[9]||(t[9]=e("p",{class:"studio__subtitle"},"Select a mode to begin",-1)),e("div",A,[e("button",{onClick:t[0]||(t[0]=a=>m("recorder")),disabled:o.value,class:w(["studio__mode studio__mode--recorder",{"studio__mode--selected":r.value==="recorder"}])},[e("div",V,[o.value&&r.value==="recorder"?(n(),d("svg",z,[...t[2]||(t[2]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(n(),d("svg",$,[...t[3]||(t[3]=[e("circle",{cx:"12",cy:"12",r:"8"},null,-1)])]))]),e("div",F,[t[4]||(t[4]=e("h3",{class:"studio__mode-title"},"Recorder",-1)),e("p",O,h(o.value&&r.value==="recorder"?"Starting recorder...":"Multi-cam ISO recording"),1)])],10,E),e("button",{onClick:t[1]||(t[1]=a=>m("mixer")),disabled:o.value,class:w(["studio__mode studio__mode--mixer",{"studio__mode--selected":r.value==="mixer"}])},[e("div",H,[o.value&&r.value==="mixer"?(n(),d("svg",I,[...t[5]||(t[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(n(),d("svg",N,[...t[6]||(t[6]=[e("rect",{x:"2",y:"2",width:"9",height:"9",rx:"1"},null,-1),e("rect",{x:"13",y:"2",width:"9",height:"6",rx:"1"},null,-1),e("rect",{x:"13",y:"10",width:"9",height:"6",rx:"1"},null,-1),e("rect",{x:"2",y:"13",width:"9",height:"9",rx:"1"},null,-1)])]))]),e("div",R,[t[7]||(t[7]=e("h3",{class:"studio__mode-title"},"Mixer",-1)),e("p",T,h(o.value&&r.value==="mixer"?"Starting mixer...":"Live switching & streaming"),1)])],10,P)]),c.value?(n(),d("div",j,h(c.value),1)):y("",!0)])]))}}),q=S(D,[["__scopeId","data-v-bead4ef7"]]);export{q as default};
