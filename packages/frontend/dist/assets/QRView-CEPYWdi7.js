import{d as w,r,o as q,b as f,K as m,w as c,e,c as d,f as g,t as u,y as h,n as y,k as a,_ as k}from"./index-51tLXJEQ.js";import{S as b}from"./StudioDisplayShell-CDM7sgBi.js";import"./AnimatedBackground-7lCWB0G6.js";const S={class:"qr-view__content"},C={key:0,class:"qr-view__loading glass-card"},R={key:1,class:"qr-view__error glass-card"},x={key:2,class:"qr-view__grid"},U={class:"qr-view__qr glass-card"},Q=["src"],N={class:"qr-view__footer-left"},V={class:"qr-view__footer-url"},B=w({__name:"QRView",setup(P){const _=r(null),i=r(!0),t=r(null),n=r(""),l=r("");q(async()=>{await v()});async function v(){i.value=!0,t.value=null;try{const o=await fetch(await f("/api/v1/wordpress/qr-session"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!o.ok)throw new Error("Failed to create QR session");const s=await o.json();_.value=s.token;const p=window.location.origin;l.value=`${p}/#/customer/${s.token}`,n.value=`https://api.qrserver.com/v1/create-qr-code/?size=600x600&data=${encodeURIComponent(l.value)}`}catch(o){t.value=o.message||"Failed to create session",console.error("QR session creation error:",o)}finally{i.value=!1}}return(o,s)=>(a(),m(b,{title:"Scan to Start",subtitle:"Your session begins on your phone",accent:"gold","show-footer":!0,"main-class":"qr-view__main"},{"header-right":c(()=>[e("div",{class:y(["qr-view__status",{"qr-view__status--error":!!t.value}])},[s[0]||(s[0]=e("span",{class:"qr-view__status-dot"},null,-1)),h(" "+u(t.value?"Session unavailable":"Ready for scan"),1)],2)]),footer:c(()=>[e("div",N,[s[5]||(s[5]=e("span",{class:"qr-view__footer-label"},"Session link",-1)),e("span",V,u(l.value||"Generating secure link..."),1)]),s[6]||(s[6]=e("div",{class:"qr-view__footer-right"}," Need help? Ask the studio technician. ",-1))]),default:c(()=>[e("div",S,[i.value?(a(),d("div",C,[...s[1]||(s[1]=[e("div",{class:"qr-view__spinner"},null,-1),e("p",{class:"qr-view__loading-text"},"Preparing your session...",-1)])])):t.value?(a(),d("div",R,[...s[2]||(s[2]=[e("div",{class:"qr-view__error-icon"},"!",-1),e("h2",{class:"qr-view__error-title"},"Unable to Load",-1),e("p",{class:"qr-view__error-message"},"Please refresh the page or contact staff",-1)])])):_.value&&n.value?(a(),d("div",x,[e("div",U,[e("img",{src:n.value,alt:"QR Code - Scan with your phone",class:"qr-view__qr-image"},null,8,Q),s[3]||(s[3]=e("p",{class:"qr-view__qr-caption"},"Open your phone camera and scan",-1))]),s[4]||(s[4]=e("div",{class:"qr-view__steps glass-card"},[e("h2",{class:"qr-view__steps-title"},"Start your booked session"),e("ol",{class:"qr-view__steps-list"},[e("li",null,"Scan the QR code with your phone"),e("li",null,"Confirm your booking details"),e("li",null,"Use the mobile controls to begin")])],-1))])):g("",!0)])]),_:1}))}}),j=k(B,[["__scopeId","data-v-ab936074"]]);export{j as default};
