const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PodcastPortal-CcJKf6Ag.js","assets/index-CSAxumLz.js","assets/index-Domh98PJ.css","assets/PodcastPortal-Md_Qa5li.css","assets/TalkingHeadPortal-CFFteWY4.js","assets/TalkingHeadPortal-CqO-WOFA.css","assets/WebinarPortal-BAl2QLtO.js","assets/vdoninja-Cfz24N-O.js","assets/WebinarPortal-Bd3kkgzC.css"])))=>i.map(i=>d[i]);
import{d as E,l as I,c as v,e,f as b,t as d,a8 as U,y as D,k as r,_ as j,a6 as G,r as p,o as O,p as z,J as f,K as k,w as H,s as $,a9 as C,a5 as T}from"./index-CSAxumLz.js";const W={class:"customer-portal"},J={class:"portal-content"},K={class:"portal-header glass-card"},q={class:"flex items-center gap-4"},Q=["src"],X={class:"flex-1 min-w-0"},Y={class:"text-xl font-bold truncate"},Z={class:"text-preke-text-dim text-sm truncate"},ee={class:"mt-4 flex items-center justify-between text-sm"},te={class:"flex flex-col"},se={class:"text-preke-text-muted"},oe={class:"font-mono text-preke-text-dim"},ae={class:"flex flex-col items-end gap-1"},ne={key:0,class:"badge-v2 badge-v2--success"},re={key:1,class:"text-preke-amber font-mono font-medium"},ie={class:"portal-main"},le={class:"mt-8 text-center space-y-4 pb-8"},ce={class:"glass-panel p-3 text-xs text-preke-text-muted"},de={class:"flex items-center justify-between"},ue=E({__name:"CustomerPortalShell",props:{status:{},isRecording:{type:Boolean}},setup(i){const m=i,h=I(()=>{var n;if(!((n=m.status)!=null&&n.recording_duration_ms))return"00:00";const u=Math.floor(m.status.recording_duration_ms/1e3),s=Math.floor(u/60),o=u%60;return`${s.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}),x=I(()=>{var a;if(!((a=m.status)!=null&&a.booking))return null;const u=new Date,o=new Date(`${m.status.booking.date} ${m.status.booking.slot_end}`).getTime()-u.getTime();if(o<=0)return"Time expired";const n=Math.floor(o/(1e3*60*60)),l=Math.floor(o%(1e3*60*60)/(1e3*60));return n>0?`${n}h ${l}m left`:`${l}m left`});return(u,s)=>{var o,n,l,a;return r(),v("div",W,[s[2]||(s[2]=e("div",{class:"portal-bg"},[e("div",{class:"bg-orb bg-orb--1"}),e("div",{class:"bg-orb bg-orb--2"})],-1)),e("div",J,[e("header",K,[e("div",q,[(o=i.status.booking.client)!=null&&o.logo_url?(r(),v("img",{key:0,src:i.status.booking.client.logo_url,alt:"Logo",class:"w-16 h-16 object-contain rounded-lg bg-preke-bg-elevated p-2"},null,8,Q)):b("",!0),e("div",X,[e("h1",Y,"Welcome, "+d(((n=i.status.booking.customer)==null?void 0:n.name)||"Guest"),1),e("p",Z,d((l=i.status.booking.client)==null?void 0:l.name),1)])]),e("div",ee,[e("div",te,[e("span",se,d(i.status.booking.date),1),e("span",oe,d(i.status.booking.slot_start)+" - "+d(i.status.booking.slot_end),1)]),e("div",ae,[i.isRecording?(r(),v("span",ne," REC "+d(h.value),1)):b("",!0),x.value?(r(),v("span",re,d(x.value),1)):b("",!0)])])]),e("main",ie,[U(u.$slots,"default",{},void 0)]),e("footer",le,[s[1]||(s[1]=e("a",{href:"https://preke.no/wp-login.php",target:"_blank",class:"inline-flex items-center gap-2 text-preke-text-dim hover:text-preke-gold transition-colors text-sm"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})]),D(" Login to Customer Portal ")],-1)),e("div",ce,[e("div",de,[e("span",null,"Disk Space: "+d(((a=i.status.disk_space_gb)==null?void 0:a.toFixed(1))||"0.0")+" GB",1),s[0]||(s[0]=e("span",{class:"flex items-center gap-2"},[e("span",{class:"w-2 h-2 rounded-full bg-preke-green"}),D(" Connected ")],-1))])])])])])}}}),pe=j(ue,[["__scopeId","data-v-73c903a8"]]),ve={class:"customer-portal-view"},me={key:0,class:"flex h-screen items-center justify-center bg-preke-bg-base text-preke-text-dim"},ge={key:1,class:"flex h-screen items-center justify-center bg-preke-bg-base text-preke-text-dim p-4"},_e={class:"glass-card text-center max-w-md w-full p-8"},fe={key:3,class:"text-center p-8 glass-card"},xe={class:"text-preke-text-muted"},ke=E({__name:"CustomerPortalView",setup(i){const m=C(()=>T(()=>import("./PodcastPortal-CcJKf6Ag.js"),__vite__mapDeps([0,1,2,3]))),h=C(()=>T(()=>import("./TalkingHeadPortal-CFFteWY4.js"),__vite__mapDeps([4,1,2,5]))),x=C(()=>T(()=>import("./WebinarPortal-BAl2QLtO.js"),__vite__mapDeps([6,1,2,7,8]))),u=G(),s=I(()=>u.params.token),o=p(null),n=p(!0),l=p(null),a=p(0),g=p(!1),_=p("podcast"),w=p(50),S=p("");let y=null;O(async()=>{await L(),y=window.setInterval(L,2e3),o.value&&!l.value&&F()}),z(()=>{y&&clearInterval(y)});async function L(){try{const t=await f.wordpress.getCustomerStatus(s.value);o.value=t,g.value=t.recording_active,a.value=t.current_slide_index,_.value=t.display_mode||"podcast",w.value=t.teleprompter_scroll_speed||50,S.value=t.teleprompter_script||"",l.value=null}catch(t){n.value&&(l.value=t.message||"Invalid or expired link")}finally{n.value=!1}}async function F(){try{await f.wordpress.activateSession(s.value)}catch(t){console.error("Failed to activate session:",t)}}async function M(){try{await f.wordpress.customerStartRecording(s.value),g.value=!0,"vibrate"in navigator&&navigator.vibrate(50)}catch(t){alert(t.message||"Failed to start recording")}}async function V(){if(confirm("Stop recording?"))try{await f.wordpress.customerStopRecording(s.value),g.value=!1,"vibrate"in navigator&&navigator.vibrate([50,100,50])}catch(t){alert(t.message||"Failed to stop recording")}}async function B(t){try{await f.wordpress.customerGotoSlide(s.value,t),a.value=t,"vibrate"in navigator&&navigator.vibrate(30)}catch(c){console.error("Failed to change slide:",c)}}function R(){o.value&&a.value<o.value.project.graphics.length-1&&B(a.value+1)}function P(){a.value>0&&B(a.value-1)}async function N(t){w.value=t;try{await f.wordpress.setTeleprompterSpeed(s.value,t)}catch(c){console.error("Failed to set speed:",c)}}async function A(t){S.value=t}return(t,c)=>(r(),v("div",ve,[n.value?(r(),v("div",me,[...c[0]||(c[0]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin w-12 h-12 border-4 border-preke-gold border-t-transparent rounded-full mx-auto mb-4"}),e("p",null,"Loading your session...")],-1)])])):l.value?(r(),v("div",ge,[e("div",_e,[c[1]||(c[1]=e("svg",{class:"w-16 h-16 text-preke-red mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"})],-1)),c[2]||(c[2]=e("h2",{class:"text-xl font-bold mb-2"},"Session Not Found",-1)),e("p",null,d(l.value),1)])])):o.value?(r(),k(pe,{key:2,status:o.value,"is-recording":g.value},{default:H(()=>[_.value==="podcast"?(r(),k($(m),{key:0,status:o.value,"current-slide-index":a.value,"is-recording":g.value,onStartRecording:M,onStopRecording:V,onPrevSlide:P,onNextSlide:R},null,8,["status","current-slide-index","is-recording"])):_.value==="teleprompter"||_.value==="course"?(r(),k($(h),{key:1,token:s.value,status:o.value,"current-slide-index":a.value,"is-recording":g.value,"teleprompter-speed":w.value,"teleprompter-script":S.value,onStartRecording:M,onStopRecording:V,onPrevSlide:P,onNextSlide:R,onUpdateSpeed:N,onUpdateScript:A},null,8,["token","status","current-slide-index","is-recording","teleprompter-speed","teleprompter-script"])):_.value==="webinar"?(r(),k($(x),{key:2,token:s.value,status:o.value,"current-slide-index":a.value,"is-recording":g.value,onPrevSlide:P,onNextSlide:R},null,8,["token","status","current-slide-index","is-recording"])):(r(),v("div",fe,[e("p",xe,"Unknown display mode: "+d(_.value),1)]))]),_:1},8,["status","is-recording"])):b("",!0)]))}}),he=j(ke,[["__scopeId","data-v-6a920a72"]]);export{he as default};
