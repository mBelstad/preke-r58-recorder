const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-51tLXJEQ.js","assets/index-CUkGBgLQ.css"])))=>i.map(i=>d[i]);
import{a1 as P}from"./index-51tLXJEQ.js";let d=null;async function g(){if(d)return d;try{const{getDeviceUrl:a}=await P(async()=>{const{getDeviceUrl:n}=await import("./index-51tLXJEQ.js").then(t=>t.a8);return{getDeviceUrl:n}},__vite__mapDeps([0,1])),o=a();if(o){const n=new AbortController,t=setTimeout(()=>n.abort(),3e3),s=await fetch(`${o}/api/config`,{signal:n.signal,mode:"cors",cache:"no-cache"});if(clearTimeout(t),s.ok){const c=await s.json();if(c.vdo_host||c.vdoninja_host)return d=c.vdo_host||c.vdoninja_host,d}}}catch{console.log("[VDO.ninja] Device does not provide VDO.ninja host configuration")}const e="app.itagenten.no";return d=e,console.log(`[VDO.ninja] Using default host: ${e}`),e}function b(){return"https"}async function w(){return await g()==="app.itagenten.no"?"/vdo":""}const m="studio",f="preke-r58-2024";function O(){var a,o;const e=`
/* R58 VDO.ninja Theme - Colors Only */
:root {
  --r58-bg: #0f172a;
  --r58-bg2: #1e293b;
  --r58-bg3: #334155;
  --r58-text: #f8fafc;
  --r58-muted: #94a3b8;
  --r58-blue: #3b82f6;
  --r58-green: #22c55e;
  --r58-gold: #f59e0b;
  --r58-border: #475569;
}
body { background: var(--r58-bg); color: var(--r58-text); }
#mainmenu, .controlButtons, #guestFeatures { background: var(--r58-bg2); }
button, .button { background: var(--r58-bg3); color: var(--r58-text); border-color: var(--r58-border); }
button:hover { background: var(--r58-blue); }
input, select, textarea { background: var(--r58-bg3); color: var(--r58-text); border-color: var(--r58-border); }
a { color: var(--r58-blue); }
.vidcon { background: var(--r58-bg2); border-color: var(--r58-border); border-radius: 8px; }
video { border-radius: 6px; }
`;if(typeof window<"u"&&((o=(a=window.location)==null?void 0:a.origin)!=null&&o.startsWith("file://")))return"";try{return btoa(unescape(encodeURIComponent(e)))}catch{return""}}async function R(e,a,o,n={}){const t=await g();if(!t)return null;const s=b(),c=await w(),i=new URL(`${s}://${t}${c}/`);if(i.searchParams.set("whepplay",a),i.searchParams.set("push",e),i.searchParams.set("room",m),i.searchParams.set("password",f),i.searchParams.set("label",o),i.searchParams.set("autostart","true"),i.searchParams.set("stereo","2"),i.searchParams.set("whepwait","2000"),n.useMediamtx!==!1){const r=await D();r&&i.searchParams.set("mediamtx",r)}const u=O();u&&i.searchParams.set("b64css",u);const p=i.toString();return console.log(`[VDO.ninja] Camera contribution URL for ${e}: room=${m}, password=${f.substring(0,4)}...`),p}async function x(e){const a=await g();if(!a)return null;const o=b(),n=await w(),t=new URL(`${o}://${a}${n}/`);t.searchParams.set("scene",""),t.searchParams.set("room",m),t.searchParams.set("cover",""),t.searchParams.set("quality","0"),t.searchParams.set("width","1280"),t.searchParams.set("height","720"),t.searchParams.set("cleanoutput",""),t.searchParams.set("hideheader",""),t.searchParams.set("nologo",""),t.searchParams.set("whipout",e),t.searchParams.set("autostart",""),t.searchParams.set("videodevice","0"),t.searchParams.set("audiodevice","0");const s=O();return s&&t.searchParams.set("b64css",s),t.toString()}async function _(){var e;try{const{getDeviceUrl:a}=await P(async()=>{const{getDeviceUrl:n}=await import("./index-51tLXJEQ.js").then(t=>t.a8);return{getDeviceUrl:n}},__vite__mapDeps([0,1])),o=a();if(o){const n=new AbortController,t=setTimeout(()=>n.abort(),3e3),s=await fetch(`${o}/api/config`,{signal:n.signal,mode:"cors",cache:"no-cache"});if(clearTimeout(t),s.ok){const c=await s.json();if((e=c.vdo_ninja)!=null&&e.api_key)return c.vdo_ninja.api_key}}}catch{console.log("[VDO.ninja] Could not fetch API key from config")}return"preke-r58-2024-secure-key"}async function L(e={}){const a=await g();if(!a)return null;const o=b(),n=await w(),t=new URL(`${o}://${a}${n}/mixer.html`),s=e.room||m;t.searchParams.set("room",s),t.searchParams.set("director",s),t.searchParams.set("password",f);const c=await _();c&&t.searchParams.set("api",c),e.useMediamtx!==!1&&e.mediamtxHost&&t.searchParams.set("mediamtx",e.mediamtxHost),t.searchParams.set("totalroombitrate","6000"),t.searchParams.set("maxvideobitrate","2000");const i=O();i&&t.searchParams.set("b64css",i);const l=t.toString();return console.log(`[VDO.ninja] Mixer URL: room=${s}, director=${s}, password=${f.substring(0,4)}...`),l}async function D(){try{const{getFrpUrl:e}=await P(async()=>{const{getFrpUrl:o}=await import("./index-51tLXJEQ.js").then(n=>n.a8);return{getFrpUrl:o}},__vite__mapDeps([0,1])),a=await e();if(a)try{const o=new URL(a);return o.hostname.includes("itagenten.no")?"app.itagenten.no":o.hostname.replace("api","mediamtx")}catch{console.warn("[VDO.ninja] Failed to construct MediaMTX host from FRP URL")}}catch{}return null}async function T(e){const{getDeviceUrl:a,getFallbackUrl:o,getFrpUrl:n}=await P(async()=>{const{getDeviceUrl:r,getFallbackUrl:h,getFrpUrl:v}=await import("./index-51tLXJEQ.js").then(U=>U.a8);return{getDeviceUrl:r,getFallbackUrl:h,getFrpUrl:v}},__vite__mapDeps([0,1])),t=r=>`${r.replace(/\/+$/,"")}/whep/${e}`,s=r=>`http://${r}:8889/${e}/whep`,c=r=>{if(r==="localhost"||r==="127.0.0.1"||r.endsWith(".local")||r.startsWith("192.168.")||r.startsWith("10."))return!0;if(r.startsWith("172.")){const h=Number(r.split(".")[1]);return h>=16&&h<=31}return!1},i=r=>r.startsWith("100.")||r.endsWith(".ts.net"),l=a();if(l)try{const r=new URL(l);if(c(r.hostname))return console.log(`[VDO.ninja] Using LAN WHEP for ${e}`),s(r.hostname)}catch{}const u=o();if(u)try{const r=new URL(u);if(i(r.hostname))return console.log(`[VDO.ninja] Using Tailscale WHEP for ${e}`),t(r.toString())}catch{}if(l)try{const r=new URL(l);if(i(r.hostname))return console.log(`[VDO.ninja] Using device fallback WHEP for ${e}`),t(r.toString())}catch{}const p=await n();if(p)try{const r=new URL(p);return r.hostname.includes("itagenten.no")?`https://app.itagenten.no/whep/${e}`:t(r.toString())}catch{console.warn("[VDO.ninja] Failed to construct MediaMTX WHEP URL")}return null}async function y(e,a={}){const o=await g();if(!o)return null;const n=b(),t=await w(),s=new URL(`${n}://${o}${t}/`);e===0?s.searchParams.set("scene",""):s.searchParams.set("scene",e.toString()),s.searchParams.set("room",a.room||m),s.searchParams.set("password",f),s.searchParams.set("cover",""),s.searchParams.set("cleanoutput",""),s.searchParams.set("hideheader",""),s.searchParams.set("nologo",""),s.searchParams.set("quality",(a.quality??2).toString()),a.muted&&s.searchParams.set("muted","");const c=O();return c&&s.searchParams.set("b64css",c),s.toString()}async function V(e=1,a){return y(e,{muted:!1,quality:2,room:a})}async function j(e=1){const a=await V(e);if(!a)return console.warn("[VDO.ninja] Cannot open popup - VDO.ninja not configured"),null;const n=window.open(a,"R58_Program_Output","width=1280,height=720,menubar=no,toolbar=no,location=no,status=no");return n||console.warn("[VDO.ninja] Popup blocked - please allow popups for this site"),n}export{m as V,y as a,x as b,T as c,R as d,f as e,D as f,g,L as h,b as i,j as o};
