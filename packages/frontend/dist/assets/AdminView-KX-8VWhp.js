import{e as L,r as g,f as h,d as k,h as C,c,a as e,t as i,B as v,n as w,D as P,F as $,C as S,o as r,w as D,v as j,E,G as A,k as F,q as I,l as N}from"./index-DVhIzN-T.js";const R=L("capabilities",()=>{const b=g(null),a=g(!1),d=g(null),f=h(()=>{var s;return((s=b.value)==null?void 0:s.mixer_available)??!1}),t=h(()=>{var s;return((s=b.value)==null?void 0:s.recorder_available)??!0}),l=h(()=>{var s;return((s=b.value)==null?void 0:s.vdoninja.enabled)??!1}),u=h(()=>{if(!b.value)return 0;const s=b.value.storage_total_gb-b.value.storage_available_gb;return Math.round(s/b.value.storage_total_gb*100)});async function o(){a.value=!0,d.value=null;try{const s=await fetch("/api/v1/capabilities");if(!s.ok)throw new Error("Failed to fetch capabilities");b.value=await s.json()}catch(s){d.value=s instanceof Error?s.message:"Unknown error",console.error("Failed to fetch capabilities:",s)}finally{a.value=!1}}return{capabilities:b,loading:a,error:d,mixerEnabled:f,recorderEnabled:t,vdoNinjaEnabled:l,storagePercent:u,fetchCapabilities:o}}),U={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},V={class:"card"},B={class:"space-y-3"},M={class:"flex justify-between"},O={class:"font-mono text-sm"},T={class:"flex justify-between"},z={class:"capitalize"},G={class:"flex justify-between"},q={class:"card"},H={class:"space-y-3"},X={class:"flex justify-between items-center"},Y={class:"flex justify-between items-center"},Z={class:"flex justify-between items-center"},J={class:"card"},K={class:"space-y-4"},Q={class:"flex justify-between text-sm mb-2"},W={class:"w-full h-3 bg-r58-bg-tertiary rounded-full overflow-hidden"},ee={class:"flex justify-between text-sm"},se={class:"flex justify-between text-sm"},te={class:"card md:col-span-2 lg:col-span-3"},ne={class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4"},ae={class:"flex items-center gap-2 mb-2"},oe={class:"font-medium"},le={class:"space-y-1 text-sm text-r58-text-secondary"},ie=k({__name:"DeviceStatus",setup(b){const a=R();C(()=>{a.fetchCapabilities()});const d=a.capabilities;return(f,t)=>{var l,u,o,s,n,_,y,x;return r(),c("div",U,[e("div",V,[t[3]||(t[3]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Device Info",-1)),e("div",B,[e("div",M,[t[0]||(t[0]=e("span",{class:"text-r58-text-secondary"},"Device ID",-1)),e("span",O,i(((l=v(d))==null?void 0:l.device_id)||"Loading..."),1)]),e("div",T,[t[1]||(t[1]=e("span",{class:"text-r58-text-secondary"},"Platform",-1)),e("span",z,i(((u=v(d))==null?void 0:u.platform)||"-"),1)]),e("div",G,[t[2]||(t[2]=e("span",{class:"text-r58-text-secondary"},"API Version",-1)),e("span",null,i(((o=v(d))==null?void 0:o.api_version)||"-"),1)])])]),e("div",q,[t[7]||(t[7]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Features",-1)),e("div",H,[e("div",X,[t[4]||(t[4]=e("span",null,"Mixer",-1)),e("span",{class:w(["badge",v(a).mixerEnabled?"badge-success":"badge-warning"])},i(v(a).mixerEnabled?"Enabled":"Disabled"),3)]),e("div",Y,[t[5]||(t[5]=e("span",null,"Recorder",-1)),e("span",{class:w(["badge",v(a).recorderEnabled?"badge-success":"badge-warning"])},i(v(a).recorderEnabled?"Enabled":"Disabled"),3)]),e("div",Z,[t[6]||(t[6]=e("span",null,"VDO.ninja",-1)),e("span",{class:w(["badge",v(a).vdoNinjaEnabled?"badge-success":"badge-warning"])},i(v(a).vdoNinjaEnabled?"Enabled":"Disabled"),3)])])]),e("div",J,[t[11]||(t[11]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Storage",-1)),e("div",K,[e("div",null,[e("div",Q,[t[8]||(t[8]=e("span",{class:"text-r58-text-secondary"},"Used",-1)),e("span",null,i(v(a).storagePercent)+"%",1)]),e("div",W,[e("div",{class:w(["h-full rounded-full transition-all",[v(a).storagePercent>90?"bg-r58-accent-danger":v(a).storagePercent>70?"bg-r58-accent-warning":"bg-r58-accent-success"]]),style:P({width:`${v(a).storagePercent}%`})},null,6)])]),e("div",ee,[t[9]||(t[9]=e("span",{class:"text-r58-text-secondary"},"Available",-1)),e("span",null,i(((n=(s=v(d))==null?void 0:s.storage_available_gb)==null?void 0:n.toFixed(1))||"0")+" GB",1)]),e("div",se,[t[10]||(t[10]=e("span",{class:"text-r58-text-secondary"},"Total",-1)),e("span",null,i(((y=(_=v(d))==null?void 0:_.storage_total_gb)==null?void 0:y.toFixed(1))||"0")+" GB",1)])])]),e("div",te,[t[13]||(t[13]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Hardware Inputs",-1)),e("div",ne,[(r(!0),c($,null,S(((x=v(d))==null?void 0:x.inputs)||[],p=>(r(),c("div",{key:p.id,class:"p-4 rounded-lg bg-r58-bg-tertiary"},[e("div",ae,[t[12]||(t[12]=e("span",{class:"w-2 h-2 rounded-full bg-r58-accent-success"},null,-1)),e("span",oe,i(p.label),1)]),e("div",le,[e("p",null,"Type: "+i(p.type.toUpperCase()),1),e("p",null,"Max: "+i(p.max_resolution),1),e("p",null,"Audio: "+i(p.supports_audio?"Yes":"No"),1)])]))),128))])])])}}}),re={class:"space-y-4"},de={class:"flex items-center gap-4 flex-wrap"},ce=["value"],ue={class:"flex items-center gap-2 cursor-pointer"},pe=["disabled"],ve={key:0},be={key:1},fe={class:"bg-r58-bg-primary rounded-lg p-4 font-mono text-sm text-r58-text-secondary h-[500px] overflow-auto whitespace-pre-wrap"},ge=k({__name:"LogViewer",props:{service:{}},setup(b){const a=b,d=g(""),f=g(!1),t=g(a.service||"r58-api"),l=g(100),u=g(!1),o=[{id:"r58-api",label:"R58 API"},{id:"r58-pipeline",label:"Pipeline Manager"},{id:"mediamtx",label:"MediaMTX"}];let s=null;async function n(){f.value=!0;try{const p=await(await fetch(`/api/v1/support/logs?service=${t.value}&lines=${l.value}`)).json();d.value=p.logs||""}catch(x){d.value=`Error fetching logs: ${x}`}finally{f.value=!1}}function _(){s&&clearInterval(s),s=window.setInterval(n,5e3)}function y(){s&&(clearInterval(s),s=null)}return D(u,x=>{x?_():y()}),D([t,l],()=>{n()}),C(()=>{n()}),(x,p)=>(r(),c("div",re,[e("div",de,[j(e("select",{"onUpdate:modelValue":p[0]||(p[0]=m=>t.value=m),class:"input"},[(r(),c($,null,S(o,m=>e("option",{key:m.id,value:m.id},i(m.label),9,ce)),64))],512),[[E,t.value]]),j(e("select",{"onUpdate:modelValue":p[1]||(p[1]=m=>l.value=m),class:"input"},[...p[3]||(p[3]=[e("option",{value:50},"50 lines",-1),e("option",{value:100},"100 lines",-1),e("option",{value:250},"250 lines",-1),e("option",{value:500},"500 lines",-1)])],512),[[E,l.value]]),e("label",ue,[j(e("input",{type:"checkbox","onUpdate:modelValue":p[2]||(p[2]=m=>u.value=m),class:"w-4 h-4 rounded"},null,512),[[A,u.value]]),p[4]||(p[4]=e("span",{class:"text-sm"},"Auto-refresh",-1))]),e("button",{onClick:n,disabled:f.value,class:"btn"},[f.value?(r(),c("span",ve,"Loading...")):(r(),c("span",be,"Refresh"))],8,pe)]),e("pre",fe,i(d.value||"No logs available"),1)]))}}),me={class:"space-y-6"},xe={class:"flex items-center justify-between"},_e=["disabled"],ye={key:0},we={key:1},he={key:0,class:"flex items-center justify-center py-12"},ke={key:1,class:"text-center py-12 text-r58-text-secondary"},$e={key:2,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Se=["onClick"],je={class:"flex items-start justify-between mb-4"},Ce={class:"font-semibold"},De={class:"text-sm text-r58-text-secondary"},Ee={class:"space-y-2 text-sm"},Ne={class:"flex justify-between"},Le={class:"font-mono"},Pe={class:"flex justify-between"},Ae=k({__name:"FleetOverview",setup(b){const a=g([]),d=g(!0),f=g(!1);async function t(){d.value=!0;try{const o=await fetch("/api/v1/lan-devices");if(o.ok){const s=await o.json();a.value=s.map(n=>({id:n.id,name:n.name,ip:n.ip,status:n.status,lastSeen:n.last_seen,version:n.api_version||"unknown"}))}}catch(o){console.error("Failed to fetch LAN devices:",o)}finally{d.value=!1}}C(t);async function l(){f.value=!0;try{const o=await fetch("/api/v1/lan-devices/scan",{method:"POST"});if(o.ok){const s=await o.json();for(const n of s)a.value.find(y=>y.id===n.id)||a.value.push({id:n.id,name:n.name,ip:n.ip,status:n.status,lastSeen:n.last_seen,version:n.api_version||"unknown"})}}catch(o){console.error("LAN network scan failed:",o)}finally{f.value=!1}}async function u(o){try{const n=await(await fetch(`/api/v1/lan-devices/${o.id}/connect`,{method:"POST"})).json();n.connected?window.open(`http://${o.ip}:8000`,"_blank"):alert(`Failed to connect: ${n.error||"Unknown error"}`)}catch(s){console.error("Failed to connect to device:",s)}}return(o,s)=>(r(),c("div",me,[e("div",xe,[s[0]||(s[0]=e("h2",{class:"text-lg font-semibold"},"LAN Devices",-1)),e("button",{onClick:l,disabled:f.value,class:"btn"},[f.value?(r(),c("span",ye,"Scanning...")):(r(),c("span",we,"Scan Network"))],8,_e)]),d.value?(r(),c("div",he,[...s[1]||(s[1]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full"},null,-1)])])):a.value.length===0?(r(),c("div",ke,[...s[2]||(s[2]=[e("p",null,"No devices found",-1),e("p",{class:"text-sm mt-2"},'Click "Scan Network" to discover R58 devices',-1)])])):(r(),c("div",$e,[(r(!0),c($,null,S(a.value,n=>(r(),c("div",{key:n.id,class:"card hover:border-r58-accent-primary/50 transition-colors cursor-pointer",onClick:_=>u(n)},[e("div",je,[e("div",null,[e("h3",Ce,i(n.name),1),e("p",De,i(n.id),1)]),e("span",{class:w(["badge",{"badge-success":n.status==="online","badge-danger":n.status==="offline","badge-warning":n.status==="unknown"}])},i(n.status),3)]),e("div",Ee,[e("div",Ne,[s[3]||(s[3]=e("span",{class:"text-r58-text-secondary"},"IP Address",-1)),e("span",Le,i(n.ip),1)]),e("div",Pe,[s[4]||(s[4]=e("span",{class:"text-r58-text-secondary"},"Version",-1)),e("span",null,i(n.version),1)])])],8,Se))),128))]))]))}}),Fe={class:"h-full flex flex-col"},Ie={class:"px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},Re={class:"flex gap-2"},Ue=["onClick"],Ve={class:"flex-1 p-6 overflow-y-auto"},Be={key:1,class:"card"},Me={key:2,class:"card"},Oe={key:3,class:"card space-y-6"},ze=k({__name:"AdminView",setup(b){const a=g("status"),d=[{id:"status",label:"Device Status"},{id:"logs",label:"Logs"},{id:"fleet",label:"Fleet"},{id:"settings",label:"Settings"}];async function f(){try{const l=await(await fetch("/api/v1/support/bundle",{method:"POST"})).blob(),u=URL.createObjectURL(l),o=document.createElement("a");o.href=u,o.download=`r58-support-bundle-${new Date().toISOString().slice(0,10)}.zip`,o.click(),URL.revokeObjectURL(u)}catch(t){console.error("Failed to download support bundle:",t)}}return(t,l)=>(r(),c("div",Fe,[e("header",Ie,[l[0]||(l[0]=e("h1",{class:"text-xl font-semibold mb-4"},"Admin",-1)),e("div",Re,[(r(),c($,null,S(d,u=>e("button",{key:u.id,onClick:o=>a.value=u.id,class:w(["px-4 py-2 rounded-t-lg transition-colors",[a.value===u.id?"bg-r58-bg-primary text-r58-text-primary":"text-r58-text-secondary hover:text-r58-text-primary"]])},i(u.label),11,Ue)),64))])]),e("div",Ve,[a.value==="status"?(r(),F(ie,{key:0})):a.value==="logs"?(r(),c("div",Be,[l[1]||(l[1]=e("h2",{class:"text-lg font-semibold mb-4"},"System Logs",-1)),N(ge)])):a.value==="fleet"?(r(),c("div",Me,[N(Ae)])):a.value==="settings"?(r(),c("div",Oe,[l[4]||(l[4]=e("div",null,[e("h2",{class:"text-lg font-semibold mb-4"},"Settings"),e("p",{class:"text-r58-text-secondary"},"Settings configuration coming soon.")],-1)),e("div",{class:"pt-4 border-t border-r58-bg-tertiary"},[l[2]||(l[2]=e("h3",{class:"font-medium mb-3"},"Support",-1)),e("button",{onClick:f,class:"btn"}," Download Support Bundle "),l[3]||(l[3]=e("p",{class:"text-sm text-r58-text-secondary mt-2"}," Downloads a ZIP file containing logs, configuration, and diagnostic information. ",-1))])])):I("",!0)])]))}});export{ze as default};
