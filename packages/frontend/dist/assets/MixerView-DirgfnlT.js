import{K as ze,r as I,h as N,L as ne,M as me,A as xe,B as ae,j as pe,V as Fe,d as ee,c as o,b as O,a as e,F as Y,q,n as H,w as X,x as ie,N as Re,t as _,J as K,y as fe,o as t,_ as ce,O as $e,e as he,E as ge,p as Z,G as we,g as B,v as ye,l as oe,k as be,P as Ee,Q as je,s as Se,H as Ue,R as Ge,m as Ke,T as We}from"./index-B6sxAStT.js";import{b as Ye,a as Je,g as qe,c as Xe,d as Ve,e as Qe,f as Ze,h as et,V as Te}from"./vdoninja-G1prOe4C.js";import{M as tt}from"./ModeLoadingScreen-Bh3zm6F4.js";const ve=[{id:"youtube",name:"YouTube Live",icon:"â–¶ï¸",rtmpBaseUrl:"rtmp://a.rtmp.youtube.com/live2/",streamKeyPlaceholder:"xxxx-xxxx-xxxx-xxxx-xxxx",helpUrl:"https://support.google.com/youtube/answer/2907883"},{id:"twitch",name:"Twitch",icon:"ðŸ“º",rtmpBaseUrl:"rtmp://live.twitch.tv/app/",streamKeyPlaceholder:"live_xxxxxxxxxx_xxxxxxxxxxxxxx",helpUrl:"https://help.twitch.tv/s/article/twitch-stream-key-faq"},{id:"facebook",name:"Facebook Live",icon:"ðŸ“˜",rtmpBaseUrl:"rtmps://live-api-s.facebook.com:443/rtmp/",streamKeyPlaceholder:"FB-xxxxxxxxxx-x",helpUrl:"https://www.facebook.com/help/587160588142067"},{id:"restream",name:"Restream",icon:"ðŸ”„",rtmpBaseUrl:"rtmp://live.restream.io/live/",streamKeyPlaceholder:"re_xxxxxx_xxxxxxxxxx",helpUrl:"https://support.restream.io/en/"},{id:"custom",name:"Custom RTMP",icon:"âš™ï¸",rtmpBaseUrl:"",streamKeyPlaceholder:"your-stream-key"}],ke=ze("streaming",()=>{const M=I([]),r=I(!1),s=I(null),m=I({enabled:!1,host:"",port:8890,streamId:"mixer_program"}),i=N(()=>M.value.find(p=>p.id===s.value)),g=N(()=>M.value.filter(p=>p.enabled)),$=N(()=>ve),a=N(()=>{const p=window.location.hostname,A=p==="localhost"||p==="127.0.0.1"?"localhost":p.replace("r58-api","r58-mediamtx");return{rtmp:`rtmp://${A}:1935/mixer_program`,rtsp:`rtsp://${A}:8554/mixer_program`,srt:`srt://${A}:8890?streamid=read:mixer_program`,hls:`https://${p}/hls/mixer_program/index.m3u8`,whep:`${window.location.origin}/api/v1/whep/mixer_program/whep`}});function v(p,d){const A=ve.find(l=>l.id===p);if(!A)throw new Error(`Unknown platform: ${p}`);const S={id:`dest-${Date.now()}`,platformId:p,name:d||A.name,streamKey:"",enabled:!1};return M.value.push(S),S}function j(p,d){const A=M.value.findIndex(S=>S.id===p);A!==-1&&(M.value[A]={...M.value[A],...d})}function c(p){const d=M.value.findIndex(A=>A.id===p);d!==-1&&M.value.splice(d,1),s.value===p&&(s.value=null)}function u(p){s.value=p}function E(p){m.value.enabled=p}function b(p){m.value={...m.value,...p}}function C(){r.value=!0}function w(){r.value=!1}function f(p){const d=ve.find(A=>A.id===p.platformId);return d?p.platformId==="custom"?`${p.name}${p.streamKey}`:`${d.rtmpBaseUrl}${p.streamKey}`:""}function T(){const p=window.location.hostname;return`srt://${p==="localhost"||p==="127.0.0.1"?"localhost":p.replace("r58-api","r58-mediamtx")}:${m.value.port}?streamid=read:${m.value.streamId}`}function V(){try{const p=localStorage.getItem("r58-streaming-destinations");if(p){const d=JSON.parse(p);M.value=d.destinations||[],d.srtOutput&&(m.value={...m.value,...d.srtOutput})}}catch(p){console.warn("Failed to load saved streaming destinations:",p)}}function n(){try{localStorage.setItem("r58-streaming-destinations",JSON.stringify({destinations:M.value,srtOutput:m.value}))}catch(p){console.warn("Failed to save streaming destinations:",p)}}return V(),{destinations:M,isStreaming:r,activeDestinationId:s,srtOutput:m,activeDestination:i,enabledDestinations:g,platforms:$,programOutputUrls:a,addDestination:v,updateDestination:j,removeDestination:c,setActiveDestination:u,toggleSrtOutput:E,updateSrtConfig:b,startStreaming:C,stopStreaming:w,buildRtmpUrl:f,getSrtOutputUrl:T,saveDestinations:n,loadSavedDestinations:V}});function ot(M){const r=ne(),s=me();xe();const m=I(!1),i=I(!1),g=I(null),$=I(new Map);function a(){return M.value}function v(){var h,D;const x=a();return x?((h=x.isReady)==null?void 0:h.value)===!0||((D=x.connectionState)==null?void 0:D.value)==="connected"?!0:i.value:!1}function j(x){return x.slots.filter(h=>h.sourceId).map(h=>h.sourceId)}function c(x){const h=a();if(!h){console.warn("[MixerController] VDO.ninja embed not available");return}v()||console.log("[MixerController] VDO.ninja may not be fully ready, attempting anyway"),console.log("[MixerController] Applying scene to VDO:",x.name,"- VDO Scene:",x.vdoSceneNumber,"- Layout:",Fe[x.layoutPreset]||x.layoutPreset);try{h.setLayout(x.layoutPreset);const D=j(x);for(const y of D)h.addToScene(y,x.vdoSceneNumber);g.value=x.id,console.log("[MixerController] Scene applied successfully:",x.name,"- Sources:",D.length)}catch(D){console.error("[MixerController] Error applying scene to VDO:",D)}}function u(x){const h=s.getScene(x);h&&c(h)}async function E(){const x=r.previewSceneId;if(!x)return;const h=s.getScene(x);h&&(c(h),await r.take())}function b(){const x=r.previewSceneId;if(!x)return;const h=s.getScene(x);h&&(c(h),r.cut())}function C(x,h){const D=a();if(!D||!v())return;const y=r.previewSceneId?s.getScene(r.previewSceneId):null,R=(y==null?void 0:y.vdoSceneNumber)||1;if(D.addToScene(x,R),r.previewSceneId&&y){const U=h??y.slots.findIndex(L=>!L.sourceId);if(U>=0&&U<y.slots.length){const L=y.slots[U].id;s.updateSlot(r.previewSceneId,L,{sourceId:x})}}}function w(x){const h=a();!h||!v()||h.removeFromScene(x)}function f(x){const h=a();!h||!v()||h.setProgram(x)}function T(x,h){const D=a();D&&v()&&D.setMute(x,h),r.setSourceMute(x,h)}function V(x){const h=a();h&&v()&&h.toggleMute(x);const D=r.sources.find(y=>y.id===x);D&&r.setSourceMute(x,!D.muted)}function n(x,h){const D=a();D&&v()&&D.setVolume(x,h*2),r.setSourceVolume(x,h)}function p(x,h){const D=a();D&&v()&&h&&D.sendCommand("soloChat",x),r.setSourceSolo(x,h)}function d(x){const h=a();h&&v()&&h.kickGuest(x),r.removeSource(x)}function A(x,h){const D=a();D&&v()&&D.sendCommand("sendChat",x,h)}function S(x){const h=a();if(h&&v()){const D=r.previewSceneId?s.getScene(r.previewSceneId):null,y=(D==null?void 0:D.vdoSceneNumber)||1;h.addToScene(x,y)}r.admitFromGreenroom(x)}function l(){const x=a();x&&v()&&x.startRecording()}function k(){const x=a();x&&v()&&x.stopRecording()}function F(x,h,D){const y=a();y&&v()&&y.sendCommand(x,h,D)}return ae(()=>{var x,h;return(h=(x=M.value)==null?void 0:x.isReady)==null?void 0:h.value},x=>{if(m.value=x===!0,x){if(console.log("[MixerController] VDO.ninja connected"),r.setVdoConnected(!0),i.value=!0,r.programSceneId){const h=s.getScene(r.programSceneId);h&&h.id!==g.value&&c(h)}}else r.setVdoConnected(!1)},{immediate:!0}),ae(()=>{var x,h;return(h=(x=M.value)==null?void 0:x.sourcesVersion)==null?void 0:h.value},()=>{var D,y;const x=(y=(D=M.value)==null?void 0:D.sources)==null?void 0:y.value;if(!x||x.size===0)return;const h=a();if(h){for(const[R,U]of x)if(!$.value.has(R)){console.log(`[MixerController] Auto-adding source ${R} (${U.label}) to scene 1`);try{h.addToScene(R,1),$.value.set(R,1),console.log(`[MixerController] Successfully added ${R} to scene 1`)}catch(L){console.error(`[MixerController] Failed to add ${R} to scene:`,L)}}for(const[R]of $.value)x.has(R)||(console.log(`[MixerController] Source ${R} disconnected, removing from tracking`),$.value.delete(R))}},{immediate:!0}),pe(()=>{setTimeout(()=>{!i.value&&M.value&&(console.log("[MixerController] Fallback initialization (timeout)"),i.value=!0,m.value=!0,r.setVdoConnected(!0))},6e3)}),ae(()=>r.programSceneId,x=>{if(x&&x!==g.value){const h=s.getScene(x);h&&v()&&c(h)}}),ae(()=>{var x,h;return(h=(x=M.value)==null?void 0:x.lastError)==null?void 0:h.value},x=>{x&&r.setLastError(x)}),{isConnected:m,isInitialized:i,applySceneToVdo:c,switchToScene:u,takeToProgram:E,cutToProgram:b,addSourceToScene:C,removeSourceFromScene:w,setSourceAsProgram:f,setMute:T,toggleMute:V,setVolume:n,setSolo:p,kickGuest:d,sendMessage:A,admitFromGreenroom:S,startRecording:l,stopRecording:k,sendDirectorCommand:F}}const nt={class:"source-panel space-y-4","data-testid":"source-panel"},st={key:0,class:"px-3 py-2 bg-amber-500/10 border border-amber-500/30 rounded-lg text-xs text-amber-400"},rt={key:1,class:"text-center py-6 text-r58-text-secondary"},it={key:2,class:"space-y-2"},at={class:"flex items-center gap-3"},lt={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},dt={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ct={key:2,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ut={key:3,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},vt={class:"flex-1 min-w-0"},mt={key:0,class:"flex items-center gap-1"},pt=["onDblclick"],gt={class:"flex items-center gap-2 text-xs text-r58-text-secondary"},xt={key:0,class:"text-red-400 font-bold"},ft={key:1,class:"text-amber-400"},bt={class:"flex items-center gap-1 flex-shrink-0"},yt=["onClick"],ht=["onClick","title"],wt={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},kt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},St={key:0,class:"mt-2"},_t={class:"h-1 bg-r58-bg-primary rounded-full overflow-hidden"},Le="preke-source-names",$t=ee({__name:"SourcePanel",props:{vdoEmbed:{},controller:{}},setup(M){function r(){try{const S=localStorage.getItem(Le);return S?JSON.parse(S):{}}catch{return{}}}function s(S,l){const k=r();k[S]=l,localStorage.setItem(Le,JSON.stringify(k))}const m=I(r()),i=I(null),g=I(""),$=M,a=ne(),v=me(),j=xe(),c={cam0:{name:"HDMI 1",subtitle:"Connected to device"},cam1:{name:"HDMI 2",subtitle:"Connected to device"},cam2:{name:"HDMI 3",subtitle:"Connected to device"},cam3:{name:"HDMI 4",subtitle:"Connected to device"}},u=N(()=>a.sources.map(S=>{let l=S.label,k="VDO.ninja";const F=S.id.match(/cam(\d+)/i)||S.id.match(/hdmi[_-]?(\d+)/i);return F?(l=`HDMI ${parseInt(F[1])+1}`,k="Connected to device"):S.type==="guest"?(k="Remote guest",(!S.label||S.label.length>20||S.label.match(/^[a-z0-9]{8,}$/i))&&(l="Guest")):S.type==="screen"&&(k="Screen share"),{...S,label:l,subtitle:k}})),E=N(()=>j.inputs.filter(S=>S.hasSignal).map(S=>{const l=c[S.id]||{name:S.label,subtitle:"HDMI Input"};return{id:S.id,label:l.name,subtitle:l.subtitle,type:"camera",hasVideo:!0,hasAudio:!0,muted:!1,audioLevel:0}})),b=N(()=>{const S=new Map;for(const l of E.value)S.set(l.id,l);for(const l of u.value){const k=S.get(l.id);k?S.set(l.id,{...k,...l,subtitle:l.subtitle||k.subtitle}):S.set(l.id,l)}return Array.from(S.values())}),C=N(()=>u.value.length===0&&E.value.length>0);function w(S){const l=v.getScene(a.previewSceneId||"");return(l==null?void 0:l.slots.some(k=>k.sourceId===S))||!1}function f(S){return a.liveSourceIds.includes(S)}function T(S){var l,k;$.controller?$.controller.toggleMute(S.id):($.vdoEmbed&&((k=(l=$.vdoEmbed).toggleMute)==null||k.call(l,S.id)),a.setSourceMute(S.id,!S.muted))}function V(S){const l=v.getScene(a.previewSceneId||"");if(!l)return;$.controller&&$.controller.addSourceToScene(S.id);const k=l.slots.find(F=>!F.sourceId);k&&v.assignSourceToSlot(l.id,k.id,S.id)}function n(S){return m.value[S.id]||S.label}function p(S){i.value=S.id,g.value=m.value[S.id]||S.label}function d(){i.value&&g.value.trim()&&(s(i.value,g.value.trim()),m.value=r()),i.value=null}function A(){i.value=null,g.value=""}return(S,l)=>(t(),o("div",nt,[C.value?(t(),o("div",st," Showing HDMI cameras. VDO.ninja sources will appear when connected. ")):O("",!0),b.value.length===0?(t(),o("div",rt,[...l[1]||(l[1]=[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),e("p",{class:"text-sm"},"No sources connected",-1),e("p",{class:"text-xs mt-1 opacity-75"},"Connect HDMI or invite guests",-1)])])):(t(),o("div",it,[(t(!0),o(Y,null,q(b.value,k=>(t(),o("div",{key:k.id,class:H(["source-card p-3 rounded-lg transition-all",[f(k.id)?"bg-red-500/10 border border-red-500/30":w(k.id)?"bg-amber-500/10 border border-amber-500/30":"bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 border border-transparent"]])},[e("div",at,[e("div",{class:H(["w-10 h-10 rounded-lg bg-r58-bg-primary flex items-center justify-center flex-shrink-0",{"ring-2 ring-red-500":f(k.id),"ring-2 ring-amber-500":w(k.id)&&!f(k.id)}])},[k.type==="camera"?(t(),o("svg",lt,[...l[2]||(l[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])):k.type==="guest"?(t(),o("svg",dt,[...l[3]||(l[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])])):k.type==="screen"?(t(),o("svg",ct,[...l[4]||(l[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},null,-1)])])):(t(),o("svg",ut,[...l[5]||(l[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"},null,-1)])]))],2),e("div",vt,[i.value===k.id?(t(),o("div",mt,[X(e("input",{"onUpdate:modelValue":l[0]||(l[0]=F=>g.value=F),onKeyup:[Re(d,["enter"]),Re(A,["escape"])],onBlur:d,class:"input text-sm py-0.5 px-1 w-full",autofocus:""},null,544),[[ie,g.value]])])):(t(),o("p",{key:1,onDblclick:F=>p(k),class:"font-medium text-sm truncate cursor-pointer hover:text-r58-accent-primary",title:"Double-click to rename"},_(n(k)),41,pt)),e("div",gt,[e("span",null,_(k.subtitle),1),f(k.id)?(t(),o("span",xt,"LIVE")):w(k.id)?(t(),o("span",ft,"PVW")):O("",!0)])]),e("div",bt,[K(a).previewSceneId&&!w(k.id)?(t(),o("button",{key:0,onClick:F=>V(k),class:"p-1.5 rounded hover:bg-r58-bg-primary transition-colors text-r58-text-secondary hover:text-r58-accent-primary",title:"Add to preview scene"},[...l[6]||(l[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,yt)):O("",!0),k.hasAudio?(t(),o("button",{key:1,onClick:F=>T(k),class:H(["p-1.5 rounded transition-colors",k.muted?"bg-red-500/20 text-red-400":"hover:bg-r58-bg-primary text-r58-text-secondary"]),title:k.muted?"Unmute":"Mute"},[k.muted?(t(),o("svg",wt,[...l[7]||(l[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(t(),o("svg",kt,[...l[8]||(l[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],10,ht)):O("",!0)])]),k.hasAudio?(t(),o("div",St,[e("div",_t,[e("div",{class:H(["h-full transition-all duration-75 rounded-full",k.muted?"bg-r58-bg-tertiary":k.audioLevel>80?"bg-red-500":k.audioLevel>60?"bg-amber-500":"bg-emerald-500"]),style:fe({width:`${k.audioLevel||0}%`})},null,6)])])):O("",!0)],2))),128))]))]))}}),Ct=ce($t,[["__scopeId","data-v-bdd0be29"]]),Mt={class:"preview-program-view h-full flex flex-col","data-testid":"preview-program-view"},It={class:"flex-1 flex gap-4 min-h-0"},Dt={class:"flex-1 flex flex-col min-w-0"},Rt={class:"flex items-center justify-between mb-2"},Et={key:0,class:"text-xs text-r58-text-secondary"},jt=["src"],Vt={key:1,class:"absolute bottom-2 left-2 right-2 flex items-center justify-between pointer-events-none"},Tt={class:"px-2 py-1 bg-black/70 rounded text-xs text-white"},Lt={class:"px-2 py-1 bg-black/70 rounded text-xs text-amber-400"},Pt={key:2,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary"},Ot={key:3,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},Ut={class:"flex flex-col items-center justify-center gap-3 px-2"},At=["disabled"],Ht={key:0,class:"animate-pulse"},Nt={key:1},Bt=["disabled"],zt={class:"flex flex-col gap-1 mt-2"},Ft=["value"],Gt=["value"],Kt={class:"flex-1 flex flex-col min-w-0"},Wt={class:"flex items-center justify-between mb-2"},Yt={class:"flex items-center gap-2"},Jt={key:0,class:"px-2 py-0.5 bg-red-600 text-white text-xs font-bold rounded animate-pulse"},qt={key:0,class:"text-xs text-r58-text-secondary"},Xt=["src"],Qt={key:1,class:"absolute bottom-2 left-2 right-2 flex items-center justify-between pointer-events-none"},Zt={class:"px-2 py-1 bg-black/70 rounded text-xs text-white"},eo={key:0,class:"px-2 py-1 bg-red-600/90 rounded text-xs text-white font-bold"},to={key:2,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary"},oo={key:3,class:"absolute top-2 left-2 flex items-center gap-2 pointer-events-none"},no={key:4,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},so=ee({__name:"PreviewProgramView",props:{vdoEmbed:{},controller:{}},emits:["take","cut"],setup(M,{emit:r}){const s=M,m=r,i=ne(),g=me(),$=I(i.transition.type),a=I(i.transition.duration),v=I(!1),j=I(!1),c=N(()=>g.getScene(i.previewSceneId||"")),u=N(()=>g.getScene(i.programSceneId||"")),E=N(()=>i.previewSceneId!==null&&i.previewSceneId!==i.programSceneId&&!i.isTransitioning),b=N(()=>i.isLive),C=N(()=>c.value?Ye(c.value.vdoSceneNumber):null),w=N(()=>Je(0));ae([$,a],([p,d])=>{i.setTransition({type:p,duration:d})});function f(){E.value&&(s.controller?s.controller.takeToProgram():i.take(),m("take"))}function T(){i.previewSceneId&&(s.controller?s.controller.cutToProgram():i.cut(),m("cut"))}const V=[{value:"cut",label:"CUT"},{value:"fade",label:"FADE"},{value:"wipe-left",label:"WIPE L"},{value:"wipe-right",label:"WIPE R"}],n=[{value:100,label:"0.1s"},{value:300,label:"0.3s"},{value:500,label:"0.5s"},{value:1e3,label:"1.0s"}];return(p,d)=>(t(),o("div",Mt,[e("div",It,[e("div",Dt,[e("div",Rt,[d[4]||(d[4]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-xs font-bold uppercase tracking-wider text-amber-400"},"PVW"),e("span",{class:"text-xs text-r58-text-secondary"},"Preview")],-1)),c.value?(t(),o("span",Et,_(c.value.name),1)):O("",!0)]),e("div",{class:H(["flex-1 bg-black rounded-lg overflow-hidden border-2 transition-colors relative",c.value?"border-amber-500/50":"border-r58-bg-tertiary"])},[C.value?(t(),o("iframe",{key:0,src:C.value,class:H(["absolute inset-0 w-full h-full border-0",{"opacity-0":!v.value}]),allow:"autoplay; fullscreen",onLoad:d[0]||(d[0]=A=>v.value=!0)},null,42,jt)):O("",!0),c.value?(t(),o("div",Vt,[e("span",Tt," Scene "+_(c.value.vdoSceneNumber)+": "+_(c.value.name),1),e("span",Lt,_(c.value.slots.filter(A=>A.sourceId).length)+"/"+_(c.value.slots.length)+" sources ",1)])):O("",!0),c.value&&!v.value?(t(),o("div",Pt,[...d[5]||(d[5]=[e("div",{class:"animate-spin w-6 h-6 border-2 border-amber-400 border-t-transparent rounded-full"},null,-1)])])):O("",!0),c.value?O("",!0):(t(),o("div",Ot,[...d[6]||(d[6]=[e("div",{class:"text-center"},[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]),e("p",{class:"text-sm"},"Select a scene to preview")],-1)])]))],2)]),e("div",Ut,[e("button",{onClick:f,disabled:!E.value,class:H(["take-button w-20 h-16 rounded-lg font-bold text-lg transition-all",E.value?"bg-red-600 hover:bg-red-500 text-white shadow-lg shadow-red-500/30":"bg-r58-bg-tertiary text-r58-text-secondary cursor-not-allowed"]),"data-testid":"take-button"},[K(i).isTransitioning?(t(),o("span",Ht,"...")):(t(),o("span",Nt,"TAKE"))],10,At),e("button",{onClick:T,disabled:!K(i).previewSceneId,class:H(["w-20 h-10 rounded-lg font-bold text-sm transition-all",K(i).previewSceneId?"bg-r58-bg-tertiary hover:bg-r58-accent-primary text-r58-text-primary":"bg-r58-bg-tertiary/50 text-r58-text-secondary cursor-not-allowed"]),"data-testid":"cut-button"}," CUT ",10,Bt),e("div",zt,[X(e("select",{"onUpdate:modelValue":d[1]||(d[1]=A=>$.value=A),class:"w-20 px-2 py-1 text-xs bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-center"},[(t(),o(Y,null,q(V,A=>e("option",{key:A.value,value:A.value},_(A.label),9,Ft)),64))],512),[[$e,$.value]]),X(e("select",{"onUpdate:modelValue":d[2]||(d[2]=A=>a.value=A),class:"w-20 px-2 py-1 text-xs bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-center"},[(t(),o(Y,null,q(n,A=>e("option",{key:A.value,value:A.value},_(A.label),9,Gt)),64))],512),[[$e,a.value,void 0,{number:!0}]])])]),e("div",Kt,[e("div",Wt,[e("div",Yt,[e("span",{class:H(["text-xs font-bold uppercase tracking-wider",b.value?"text-red-500":"text-r58-text-secondary"])}," PGM ",2),d[7]||(d[7]=e("span",{class:"text-xs text-r58-text-secondary"},"Program",-1)),b.value?(t(),o("span",Jt," LIVE ")):O("",!0)]),u.value?(t(),o("span",qt,_(u.value.name),1)):O("",!0)]),e("div",{class:H(["flex-1 bg-black rounded-lg overflow-hidden border-2 transition-colors relative",b.value?"border-red-500":u.value?"border-emerald-500/50":"border-r58-bg-tertiary"])},[w.value?(t(),o("iframe",{key:0,src:w.value,class:H(["absolute inset-0 w-full h-full border-0",{"opacity-0":!j.value}]),allow:"autoplay; fullscreen",onLoad:d[3]||(d[3]=A=>j.value=!0)},null,42,Xt)):O("",!0),u.value?(t(),o("div",Qt,[e("span",Zt,_(u.value.name),1),b.value?(t(),o("span",eo," ON AIR ")):O("",!0)])):O("",!0),j.value?O("",!0):(t(),o("div",to,[...d[8]||(d[8]=[e("div",{class:"animate-spin w-6 h-6 border-2 border-emerald-400 border-t-transparent rounded-full"},null,-1)])])),b.value?(t(),o("div",oo,[...d[9]||(d[9]=[e("div",{class:"w-3 h-3 rounded-full bg-red-500 animate-recording"},null,-1)])])):O("",!0),!u.value&&!j.value?(t(),o("div",no,[...d[10]||(d[10]=[he('<div class="text-center" data-v-003871a7><svg class="w-8 h-8 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-003871a7><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" data-v-003871a7></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-003871a7></path></svg><p class="text-sm" data-v-003871a7>Waiting for program...</p></div>',1)])])):O("",!0)],2)])])]))}}),ro=ce(so,[["__scopeId","data-v-003871a7"]]),io={class:"scene-strip","data-testid":"scene-strip"},ao={class:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin"},lo=["onClick","onDblclick","onContextmenu","data-testid"],co={class:"relative aspect-video bg-r58-bg-tertiary rounded-lg overflow-hidden"},uo={class:"absolute inset-0"},vo={key:0,class:"absolute top-1 left-1 w-5 h-5 flex items-center justify-center bg-r58-bg-primary/80 rounded text-xs font-mono font-bold"},mo={key:1,class:"absolute top-1 right-1 flex items-center gap-1 px-1.5 py-0.5 bg-red-600 rounded text-xs font-bold"},po={key:2,class:"absolute top-1 right-1 px-1.5 py-0.5 bg-amber-500 rounded text-xs font-bold text-black"},go={class:"mt-1 text-xs text-center truncate text-r58-text-secondary"},xo=["disabled"],fo=ee({__name:"SceneStrip",emits:["edit-scene","add-scene"],setup(M,{emit:r}){const s=r,m=me(),i=ne(),g=I(null),$=I({x:0,y:0}),a=I(!1),v=N(()=>m.scenes),j=N(()=>i.previewSceneId),c=N(()=>i.programSceneId);function u(V){i.mode==="simple"?i.setProgramScene(V.id):i.setPreviewScene(V.id)}function E(V){i.setProgramScene(V.id),B.info(`Scene: ${V.name}`)}function b(V,n){V.preventDefault(),g.value=n,$.value={x:V.clientX,y:V.clientY},a.value=!0;const p=()=>{a.value=!1,document.removeEventListener("click",p)};setTimeout(()=>document.addEventListener("click",p),0)}function C(V){a.value=!1,s("edit-scene",V)}function w(V){a.value=!1;const n=m.duplicateScene(V.id);n&&B.success(`Duplicated: ${n.name}`)}function f(V){if(a.value=!1,v.value.length<=1){B.error("Cannot delete the last scene");return}if(V.id===c.value){B.error("Cannot delete scene that is on program");return}m.deleteScene(V.id),B.info(`Deleted: ${V.name}`)}function T(V){return V.id===c.value?"ring-2 ring-red-500 ring-offset-2 ring-offset-r58-bg-primary":V.id===j.value?"ring-2 ring-amber-500 ring-offset-1 ring-offset-r58-bg-primary":"hover:ring-2 hover:ring-r58-accent-primary/50"}return(V,n)=>{var p;return t(),o("div",io,[e("div",ao,[(t(!0),o(Y,null,q(v.value,(d,A)=>(t(),o("div",{key:d.id,class:H(["scene-thumbnail flex-shrink-0 w-28 cursor-pointer transition-all",T(d)]),onClick:S=>u(d),onDblclick:S=>E(d),onContextmenu:S=>b(S,d),"data-testid":`scene-${d.id}`},[e("div",co,[e("div",uo,[(t(!0),o(Y,null,q(d.slots,S=>(t(),o("div",{key:S.id,class:"absolute bg-r58-bg-secondary border border-r58-bg-tertiary/30",style:fe({left:`${S.position.x}%`,top:`${S.position.y}%`,width:`${S.position.w}%`,height:`${S.position.h}%`})},null,4))),128))]),A<8?(t(),o("div",vo,_(A+1),1)):O("",!0),d.id===c.value?(t(),o("div",mo,[...n[4]||(n[4]=[e("div",{class:"w-1.5 h-1.5 rounded-full bg-white animate-pulse"},null,-1),Z(" PGM ",-1)])])):d.id===j.value?(t(),o("div",po," PVW ")):O("",!0)]),e("p",go,_(d.name),1)],42,lo))),128)),e("button",{onClick:n[0]||(n[0]=d=>s("add-scene")),class:"flex-shrink-0 w-28 aspect-video bg-r58-bg-tertiary/50 hover:bg-r58-bg-tertiary rounded-lg border-2 border-dashed border-r58-bg-tertiary hover:border-r58-accent-primary/50 flex items-center justify-center transition-colors","data-testid":"add-scene-button"},[...n[5]||(n[5]=[e("div",{class:"text-center text-r58-text-secondary"},[e("svg",{class:"w-6 h-6 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs"},"Add Scene")],-1)])])]),(t(),ge(we,{to:"body"},[a.value&&g.value?(t(),o("div",{key:0,class:"fixed z-50 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg shadow-xl py-1 min-w-[140px]",style:fe({left:`${$.value.x}px`,top:`${$.value.y}px`})},[e("button",{onClick:n[1]||(n[1]=d=>C(g.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-r58-bg-tertiary flex items-center gap-2"},[...n[6]||(n[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),Z(" Edit ",-1)])]),e("button",{onClick:n[2]||(n[2]=d=>w(g.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-r58-bg-tertiary flex items-center gap-2"},[...n[7]||(n[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),Z(" Duplicate ",-1)])]),n[9]||(n[9]=e("div",{class:"border-t border-r58-bg-tertiary my-1"},null,-1)),e("button",{onClick:n[3]||(n[3]=d=>f(g.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-red-500/20 text-red-400 flex items-center gap-2",disabled:((p=g.value)==null?void 0:p.id)===c.value},[...n[8]||(n[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Z(" Delete ",-1)])],8,xo)],4)):O("",!0)]))])}}}),bo=ce(fo,[["__scopeId","data-v-627912a1"]]),yo={class:"mixer-workspace h-full flex flex-col","data-testid":"mixer-workspace"},ho={class:"flex-1 flex gap-4 min-h-0 p-4"},wo={key:0,class:"text-sm font-medium"},ko={class:"h-[calc(100%-48px)] overflow-y-auto scrollbar-thin"},So={class:"space-y-2"},_o=["title"],$o={class:"flex-1 flex flex-col min-w-0"},Co={class:"flex-1 min-h-0"},Mo={class:"mt-4 pt-4 border-t border-r58-bg-tertiary"},Io=ee({__name:"MixerWorkspace",props:{vdoEmbed:{},controller:{}},emits:["edit-scene","add-scene"],setup(M,{emit:r}){const s=r,m=ne();me();const i=I(!1);function g(){i.value=!i.value}function $(c){s("edit-scene",c)}function a(){s("add-scene")}function v(){console.log("[Workspace] Take executed")}function j(){console.log("[Workspace] Cut executed")}return(c,u)=>(t(),o("div",yo,[e("div",ho,[e("aside",{class:H(["sources-panel flex-shrink-0 transition-all duration-300 overflow-hidden",i.value?"w-12":"w-64"])},[e("button",{onClick:g,class:"w-full mb-3 flex items-center justify-between px-3 py-2 bg-r58-bg-tertiary rounded-lg hover:bg-r58-bg-tertiary/80 transition-colors"},[i.value?O("",!0):(t(),o("span",wo,"Sources")),(t(),o("svg",{class:H(["w-4 h-4 transition-transform",{"rotate-180":i.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...u[0]||(u[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"},null,-1)])],2))]),X(e("div",ko,[oe(Ct,{"vdo-embed":M.vdoEmbed,controller:M.controller},null,8,["vdo-embed","controller"])],512),[[ye,!i.value]]),X(e("div",So,[(t(!0),o(Y,null,q(K(m).connectedSources.slice(0,6),E=>(t(),o("div",{key:E.id,class:"w-8 h-8 mx-auto rounded bg-r58-bg-tertiary flex items-center justify-center text-xs",title:E.label},_(E.label.charAt(0)),9,_o))),128))],512),[[ye,i.value]])],2),e("div",$o,[e("div",Co,[oe(ro,{"vdo-embed":M.vdoEmbed,controller:M.controller,onTake:v,onCut:j},null,8,["vdo-embed","controller"])]),e("div",Mo,[u[1]||(u[1]=he('<div class="flex items-center justify-between mb-2" data-v-87ccc636><h3 class="text-sm font-medium text-r58-text-secondary" data-v-87ccc636>Scenes</h3><div class="flex items-center gap-2 text-xs text-r58-text-secondary" data-v-87ccc636><span data-v-87ccc636>Click = Preview</span><span class="opacity-50" data-v-87ccc636>|</span><span data-v-87ccc636>Double-click = Live</span><span class="opacity-50" data-v-87ccc636>|</span><span data-v-87ccc636>Right-click = Menu</span></div></div>',1)),oe(bo,{onEditScene:$,onAddScene:a})])])])]))}}),Do=ce(Io,[["__scopeId","data-v-87ccc636"]]),Ce="vdo-debug",Ro=500,le=[];let Me=typeof localStorage<"u"&&localStorage.getItem(Ce)==="true";function Pe(M){Me=M,typeof localStorage<"u"&&(M?localStorage.setItem(Ce,"true"):localStorage.removeItem(Ce)),console.log(`[VDO.ninja Debug] ${M?"Enabled":"Disabled"}`)}function _e(M){if(le.push(M),le.length>Ro&&le.shift(),Me){const r=new Date(M.timestamp).toISOString().split("T")[1].slice(0,-1),s=M.direction==="outgoing"?"âž¡ï¸ OUT":"â¬…ï¸ IN",m=M.direction==="outgoing"?"color: #3b82f6; font-weight: bold":"color: #22c55e; font-weight: bold";console.groupCollapsed(`%c[VDO.ninja ${s}] %c${M.type}`,m,"color: inherit"),console.log("Time:",r),M.target&&console.log("Target:",M.target),console.log("Data:",M.data),M.raw&&M.raw!==M.data&&console.log("Raw:",M.raw),console.groupEnd()}}function Ae(){return[...le]}function Eo(){le.length=0,console.log("[VDO.ninja Debug] Event history cleared")}function He(){const M={total:le.length,incoming:0,outgoing:0,byType:{},lastActivity:le.length>0?le[le.length-1].timestamp:null};for(const r of le)r.direction==="incoming"?M.incoming++:M.outgoing++,M.byType[r.type]=(M.byType[r.type]||0)+1;return M}typeof window<"u"&&(window.__VDO_DEBUG__={getHistory:Ae,clearHistory:Eo,getStats:He,enable:()=>Pe(!0),disable:()=>Pe(!1),isEnabled:()=>Me});function jo(M){const r=I(!1),s=I(new Map),m=I(0),i=I(null),g=I(!1),$=I("disconnected"),a=I(null),v=qe(),j=new Map;function c(P,G,z,de){var W;if(!((W=M.value)!=null&&W.contentWindow)){console.warn("[VDO.ninja] Cannot send command - iframe not ready"),a.value="iframe not ready";return}const te={action:P};G&&(te.target=G),z!==void 0&&(te.value=z),de!==void 0&&(te.value2=de),_e({timestamp:Date.now(),direction:"outgoing",type:P,target:G,data:{action:P,target:G,value:z,value2:de},raw:te});try{M.value.contentWindow.postMessage(te,"*")}catch(J){console.error("[VDO.ninja] Failed to send command:",J),a.value=String(J)}}function u(P,G){var de;if(!((de=M.value)!=null&&de.contentWindow)){console.warn("[VDO.ninja] Cannot send DOM command - iframe not ready");return}const z={action:"",target:P,...G};_e({timestamp:Date.now(),direction:"outgoing",type:"dom-manipulation",target:P,data:G,raw:z});try{M.value.contentWindow.postMessage(z,"*")}catch(te){console.error("[VDO.ninja] Failed to send DOM command:",te)}}function E(P,G=1){const z=j.get(P)||P;z!==P&&console.log(`[VDO.ninja] Resolved UUID ${P} to stream ID ${z} for addScene`),c("addScene",z,G),i.value=G}function b(P,G=1){j.get(P),c("addScene",P,0)}function C(P){u(P,{replace:!0})}function w(P){u(P,{add:!0})}function f(P){u(P,{remove:!0})}function T(P,G){c("mic",P,!G);const z=s.value.get(P);z&&(z.muted=G)}function V(P){c("mic",P,"toggle");const G=s.value.get(P);G&&(G.muted=!G.muted)}function n(P,G){c("volume",P,Math.max(0,Math.min(200,G)))}function p(P){c("soloChat",P)}function d(P){c("soloChatBidirectional",P)}function A(P,G){c("sendChat",P,G)}function S(P,G){c("sendDirectorChat",P,G)}function l(P){c("hangup",P),s.value.delete(P)}function k(P){P?c("togglescreenshare",P):c("togglescreenshare")}function F(P,G){c("forward",P,G)}function x(P="guests"){c("getGuestList",void 0,void 0)}function h(){c("record",void 0,!0),g.value=!0}function D(){c("record",void 0,!1),g.value=!1}function y(P){c("layout",void 0,P)}function R(P){P?c("reload",P):c("reload")}function U(P,G){c("mixorder",P,G==="up"?-1:1)}function L(P){c("camera",void 0,P)}function Q(P,G){c("camera",P,G)}function ue(P,G=!1){G?c("zoom",void 0,P,"abs"):c("zoom",void 0,P)}function Ne(P){c("pan",void 0,P)}function Be(P){c("tilt",void 0,P)}function Ie(P){const G=P.origin;if(!G.includes(v.split(":")[0])&&!G.includes("vdo.ninja")&&!G.includes("vdo.itagenten")&&!G.includes("localhost"))return;const z=P.data;if(!z||typeof z!="object")return;const de=z.type||z.action||"unknown",te=z.streamID||z.UUID||z.streamId;switch(_e({timestamp:Date.now(),direction:"incoming",type:de,target:te,data:z.data||z.value,raw:z}),de){case"director-ready":case"loaded":case"ready":case"started":case"director":case"joined-room-complete":case"seeding-started":r.value=!0,$.value="connected",a.value=null;break;case"stream-id-detected":{const W=z.value||z.data,J=z.UUID;if(W){if(J){j.set(J,W),console.log(`[VDO.ninja] Stream ID mapping: ${J} -> ${W}`);const re=s.value.get(J);re&&(s.value.delete(J),re.id=W,s.value.set(W,re),m.value++,console.log(`[VDO.ninja] Updated source ID from UUID to stream ID: ${W}`))}if(!s.value.has(W)){const re={id:W,label:z.label||W,type:"guest",hasVideo:!0,hasAudio:!0,muted:!1,audioLevel:0};s.value.set(W,re),m.value++,console.log(`[VDO.ninja] Source added via stream-id-detected: ${W}`)}}break}case"new-guest":case"guest-connected":case"push":case"view":case"joined":case"new-push-connection":case"push-connection":case"new-view-connection":case"view-connection":{const W=z.UUID,J=z.streamID,re=J||W||te;if(re){W&&J&&j.set(W,J);const se=z.data,De={id:re,label:(se==null?void 0:se.label)||z.label||re,type:(se==null?void 0:se.type)||"guest",hasVideo:(se==null?void 0:se.video)!==!1,hasAudio:(se==null?void 0:se.audio)!==!1,muted:!1,audioLevel:0};s.value.set(re,De),m.value++,console.log(`[VDO.ninja] Source added: ${re} (${De.label})${W&&!J?" (UUID, awaiting stream ID)":""}`)}break}case"guest-left":case"guest-disconnected":case"left":case"disconnect":te&&(s.value.delete(te),m.value++);break;case"audio-level":case"loudness":{if(te){const W=s.value.get(te);if(W){const J=z.data;W.audioLevel=(J==null?void 0:J.level)||z.value||0}}break}case"mute-state":case"muted":{if(te){const W=s.value.get(te);if(W){const J=z.data;W.muted=(J==null?void 0:J.muted)??z.value??!1}}break}case"scene-changed":case"scene":{const W=z.data,J=(W==null?void 0:W.scene)||z.value;i.value=typeof J=="number"?J:null;break}case"recording-started":g.value=!0;break;case"recording-stopped":g.value=!1;break;case"error":console.error("[VDO.ninja Error]",z.data),a.value=String(z.data);break}}return pe(()=>{$.value="connecting",window.addEventListener("message",Ie),setTimeout(()=>{!r.value&&M.value&&(r.value=!0,$.value="connected")},5e3)}),be(()=>{window.removeEventListener("message",Ie),$.value="disconnected"}),{isReady:r,sources:s,sourcesVersion:m,activeScene:i,isRecording:g,connectionState:$,lastError:a,addToScene:E,removeFromScene:b,setProgram:C,addSource:w,removeSource:f,setLayout:y,changeMixOrder:U,setMute:T,toggleMute:V,setVolume:n,soloAudio:p,soloChatBidirectional:d,sendToGuest:A,sendDirectorMessage:S,kickGuest:l,toggleScreenShare:k,transferGuest:F,getGuestList:x,refreshSource:R,setCamera:L,setGuestCamera:Q,zoom:ue,pan:Ne,tilt:Be,startRecording:h,stopRecording:D,sendCommand:c,sendDomCommand:u,getEventHistory:Ae,getEventStats:He}}const Vo={key:0,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary z-10","data-testid":"vdo-loading"},To={class:"text-center"},Lo={class:"text-xs text-r58-text-secondary mt-2"},Po={key:1,class:"absolute bottom-4 left-4 right-4 bg-red-500/90 text-white px-4 py-2 rounded-lg text-sm z-20"},Oo=["src","title"],Uo=ee({__name:"VdoNinjaEmbed",props:{profile:{},sources:{},room:{},password:{}},setup(M,{expose:r}){const s=M,m=I(null),i=ne(),g=jo(m),{isReady:$,sources:a,sourcesVersion:v,addToScene:j,removeFromScene:c,setMute:u,toggleMute:E,setVolume:b,sendCommand:C,sendDomCommand:w,isRecording:f,connectionState:T,lastError:V,startRecording:n,stopRecording:p,kickGuest:d,toggleScreenShare:A,setLayout:S,setProgram:l,addSource:k,removeSource:F,getEventHistory:x,getEventStats:h}=g,D=N(()=>{const L={};return s.sources&&(L.source_ids=s.sources.join(",")),s.room&&(L.room=s.room),s.password&&(L.password=s.password),Xe(s.profile,L)}),y=N(()=>s.profile==="mixer"),R=new Set,U=L=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(L);return ae(v,()=>{i.updateSourcesFromVdo(Array.from(a.value.values()));for(const[L,Q]of a.value)if(!R.has(L)){if(U(L)){console.log(`[VdoNinjaEmbed] Skipping UUID ${L} - waiting for stream ID`);continue}console.log(`[VdoNinjaEmbed] Auto-adding source ${L} (${Q.label}) to scene 1`),j(L,1),R.add(L)}for(const L of R)a.value.has(L)||(console.log(`[VdoNinjaEmbed] Source ${L} disconnected, removing from tracking`),R.delete(L))},{immediate:!0}),r({isReady:$,isRecording:f,connectionState:T,lastError:V,sources:a,sourcesVersion:v,addToScene:j,removeFromScene:c,setLayout:S,setProgram:l,addSource:k,removeSource:F,setMute:u,toggleMute:E,setVolume:b,startRecording:n,stopRecording:p,kickGuest:d,toggleScreenShare:A,sendCommand:C,sendDomCommand:w,getEventHistory:x,getEventStats:h}),(L,Q)=>(t(),o("div",{class:H(["vdo-embed-container relative w-full h-full bg-black rounded-lg overflow-hidden",{"mixer-mode":y.value}]),"data-testid":"vdo-embed-container"},[K($)?O("",!0):(t(),o("div",Vo,[e("div",To,[Q[0]||(Q[0]=e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full mx-auto mb-4"},null,-1)),Q[1]||(Q[1]=e("p",{class:"text-r58-text-secondary"},"Connecting to VDO.ninja...",-1)),e("p",Lo,_(y.value?"Loading mixer controls...":"Local mixer on R58"),1)])])),K(V)?(t(),o("div",Po,[Q[2]||(Q[2]=e("strong",null,"Error:",-1)),Z(" "+_(K(V)),1)])):O("",!0),e("iframe",{ref_key:"iframeRef",ref:m,src:D.value,class:H(["w-full h-full border-0",{"opacity-0":!K($)}]),allow:"camera; microphone; display-capture; autoplay; clipboard-write",allowfullscreen:"","data-testid":"vdo-iframe",title:y.value?"VDO.ninja Mixer":"VDO.ninja"},null,10,Oo)],2))}}),Ao=ce(Uo,[["__scopeId","data-v-c32f6e0e"]]),Ho={class:"camera-push-bar border-t border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"camera-push-bar"},No={class:"flex items-center gap-2"},Bo={class:"text-r58-text-secondary"},zo={key:0,class:"px-4 pb-3"},Fo={key:0,class:"flex gap-3 flex-wrap"},Go={class:"text-sm font-medium"},Ko={class:"text-xs text-r58-text-secondary"},Wo=["onClick"],Yo={key:1,class:"text-sm text-r58-text-secondary py-2"},Jo={class:"hidden"},qo=["src","onLoad","onError"],Xo=ee({__name:"CameraPushBar",setup(M){const r=xe(),s=I(new Map),m=I(!0),i=N(()=>r.inputs.filter(u=>u.hasSignal));function g(u){return Qe(u)}ae(i,u=>{for(const b of u)if(!s.value.has(b.id)){const C=g(b.id),w=Ve(b.id,C,b.label);s.value.set(b.id,{cameraId:b.id,label:b.label,status:"connecting",iframeSrc:w})}const E=new Set(u.map(b=>b.id));for(const[b]of s.value)E.has(b)||s.value.delete(b)},{immediate:!0});function $(u){const E=s.value.get(u);E&&(E.status="connected",console.log(`[CameraPush] ${u} connected to VDO.ninja`))}function a(u){const E=s.value.get(u);E&&(E.status="error",console.error(`[CameraPush] ${u} failed to connect`))}function v(u){const E=r.inputs.find(w=>w.id===u);if(!E||!E.hasSignal)return;const b=g(u),C=Ve(u,b,E.label);s.value.set(u,{cameraId:u,label:E.label,status:"connecting",iframeSrc:C+`&_t=${Date.now()}`})}function j(u){switch(u){case"connected":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function c(u){switch(u){case"connected":return"Live in VDO.ninja";case"connecting":return"Connecting...";case"error":return"Failed to connect";default:return"Idle"}}return(u,E)=>(t(),o("div",Ho,[e("button",{onClick:E[0]||(E[0]=b=>m.value=!m.value),class:"w-full px-4 py-2 flex items-center justify-between text-sm hover:bg-r58-bg-tertiary/50 transition-colors","data-testid":"camera-push-toggle","aria-expanded":"expanded"},[e("div",No,[E[1]||(E[1]=e("span",{class:"font-medium"},"Camera Sources",-1)),e("span",Bo,"("+_(i.value.length)+" active)",1)]),(t(),o("svg",{class:H(["w-4 h-4 transition-transform",{"rotate-180":m.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...E[2]||(E[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),m.value?(t(),o("div",zo,[s.value.size>0?(t(),o("div",Fo,[(t(!0),o(Y,null,q(s.value,([b,C])=>(t(),o("div",{key:b,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},[e("span",{class:H(["w-2 h-2 rounded-full",j(C.status)])},null,2),e("span",Go,_(C.label),1),e("span",Ko,_(c(C.status)),1),C.status==="error"?(t(),o("button",{key:0,onClick:w=>v(b),class:"ml-2 text-xs text-r58-accent-primary hover:underline"}," Retry ",8,Wo)):O("",!0)]))),128))])):(t(),o("div",Yo," No cameras connected. Connect HDMI sources to push them to the mixer. "))])):O("",!0),e("div",Jo,[(t(!0),o(Y,null,q(s.value,([b,C])=>(t(),o("iframe",{key:b,src:C.iframeSrc,onLoad:w=>$(b),onError:w=>a(b),allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,qo))),128))])]))}}),Qo={class:"program-output space-y-3","data-testid":"program-output"},Zo={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg","data-testid":"program-output-status"},en={class:"text-sm font-medium","data-testid":"program-output-text"},tn={key:0,class:"space-y-2"},on={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},nn={class:"flex-1 text-xs truncate text-r58-text-secondary"},sn={key:0,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},rn={class:"text-xs text-r58-text-secondary"},an={key:1,class:"text-xs text-r58-text-secondary px-3"},ln={class:"hidden"},dn=["src"],cn=ee({__name:"ProgramOutput",setup(M){const r=ne(),s=ke(),m=I(!1),i=I("idle"),g=I("");function $(){return`${window.location.origin}/api/v1/whip/program/whip`}function a(){m.value||(i.value="connecting",g.value=Ze($()),m.value=!0,console.log("[ProgramOutput] Starting WHIP push to MediaMTX"))}function v(){m.value&&(m.value=!1,g.value="",i.value="idle",console.log("[ProgramOutput] Stopped WHIP push"))}function j(){m.value&&(i.value="live",console.log("[ProgramOutput] WHIP push connected"))}function c(){i.value="error",console.error("[ProgramOutput] WHIP push failed")}function u(){v(),setTimeout(()=>a(),500)}ae(()=>r.isLive,w=>{w?a():v()});function E(){switch(i.value){case"live":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function b(){switch(i.value){case"live":return"MediaMTX connected";case"connecting":return"Connecting...";case"error":return"Connection failed";default:return"Inactive"}}function C(){const w=s.programOutputUrls.srt;navigator.clipboard.writeText(w),B.success("SRT URL copied")}return(w,f)=>(t(),o("div",Qo,[e("div",Zo,[e("span",{class:H(["w-2 h-2 rounded-full",E()]),"data-testid":"program-output-indicator"},null,2),e("span",en,_(b()),1),i.value==="error"?(t(),o("button",{key:0,onClick:f[0]||(f[0]=T=>u()),class:"ml-auto text-xs text-r58-accent-primary hover:underline"}," Retry ")):O("",!0)]),i.value==="live"?(t(),o("div",tn,[e("div",on,[f[1]||(f[1]=e("span",{class:"text-xs text-r58-text-secondary"},"ðŸ”´ SRT:",-1)),e("code",nn,_(K(s).programOutputUrls.srt),1),e("button",{onClick:C,class:"text-xs text-r58-accent-primary hover:underline"},"Copy")]),K(s).enabledDestinations.length>0?(t(),o("div",sn,[f[2]||(f[2]=e("span",{class:"w-2 h-2 rounded-full bg-emerald-500"},null,-1)),e("span",rn,_(K(s).enabledDestinations.length)+" streaming destination"+_(K(s).enabledDestinations.length>1?"s":"")+" active ",1)])):O("",!0)])):O("",!0),i.value==="idle"?(t(),o("p",an," Program output will start automatically when you go live. ")):O("",!0),e("div",ln,[m.value&&g.value?(t(),o("iframe",{key:0,src:g.value,onLoad:j,onError:c,allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,dn)):O("",!0)])]))}}),un={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},vn={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl"},mn={class:"p-6 overflow-y-auto max-h-[60vh]"},pn={class:"mb-8"},gn={class:"flex items-center justify-between mb-4"},xn={key:0,class:"mb-4 p-4 bg-r58-bg-tertiary rounded-lg"},fn={class:"grid grid-cols-2 gap-2"},bn=["onClick"],yn={class:"text-xl"},hn={key:1,class:"space-y-3"},wn=["onClick"],kn={class:"text-xl"},Sn={class:"flex-1"},_n={class:"font-medium"},$n={class:"text-xs text-r58-text-secondary"},Cn=["onClick"],Mn=["onClick"],In={key:2,class:"text-r58-text-secondary text-sm"},Dn={key:0,class:"mb-8 p-4 bg-r58-bg-tertiary rounded-lg"},Rn={class:"text-lg font-medium mb-4"},En={class:"space-y-4"},jn=["placeholder"],Vn={key:0},Tn={class:"flex gap-2"},Ln={class:"mb-8"},Pn={class:"space-y-3"},On={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Un={class:"flex items-center justify-between mb-1"},An={class:"text-xs text-r58-text-secondary break-all"},Hn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Nn={class:"flex items-center justify-between mb-1"},Bn={class:"text-xs text-r58-text-secondary break-all"},zn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Fn={class:"flex items-center justify-between mb-1"},Gn={class:"text-xs text-r58-text-secondary break-all"},Kn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Wn={class:"flex items-center justify-between mb-1"},Yn={class:"text-xs text-r58-text-secondary break-all"},Jn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},qn={class:"flex items-center justify-between mb-1"},Xn={class:"text-xs text-r58-text-secondary break-all"},Qn={class:"p-4 bg-r58-bg-tertiary rounded-lg"},Zn={class:"flex items-center gap-3 mb-4"},es=ee({__name:"StreamingSettings",setup(M,{expose:r}){const s=ke(),m=I(!1),i=I(null),g=I(!1);I(""),I("");const $=N(()=>s.destinations),a=N(()=>ve),v=N(()=>s.programOutputUrls);function j(){m.value=!0}function c(){m.value=!1,i.value=null,g.value=!1}function u(V){const n=s.addDestination(V);i.value=n,g.value=!1,s.saveDestinations()}function E(){i.value&&(s.updateDestination(i.value.id,i.value),s.saveDestinations(),i.value=null,B.success("Streaming destination saved"))}function b(V){s.removeDestination(V),s.saveDestinations(),B.info("Destination removed")}function C(V){s.updateDestination(V.id,{enabled:!V.enabled}),s.saveDestinations()}function w(V,n){navigator.clipboard.writeText(V),B.success(`${n} copied to clipboard`)}function f(V){const n=ve.find(p=>p.id===V);return(n==null?void 0:n.icon)||"ðŸ“¡"}function T(V){const n=ve.find(p=>p.id===V);return(n==null?void 0:n.name)||"Unknown"}return r({open:j}),(V,n)=>{var p;return t(),ge(we,{to:"body"},[m.value?(t(),o("div",un,[e("div",{class:"absolute inset-0 bg-black/60",onClick:c}),e("div",vn,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[n[11]||(n[11]=e("h2",{class:"text-xl font-semibold"},"Streaming Settings",-1)),e("button",{onClick:c,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",mn,[e("section",pn,[e("div",gn,[n[12]||(n[12]=e("h3",{class:"text-lg font-medium"},"Streaming Destinations",-1)),e("button",{onClick:n[0]||(n[0]=d=>g.value=!g.value),class:"btn btn-sm btn-primary"}," + Add Platform ")]),g.value?(t(),o("div",xn,[n[13]||(n[13]=e("p",{class:"text-sm text-r58-text-secondary mb-3"},"Select a streaming platform:",-1)),e("div",fn,[(t(!0),o(Y,null,q(a.value,d=>(t(),o("button",{key:d.id,onClick:A=>u(d.id),class:"flex items-center gap-2 p-3 bg-r58-bg-secondary hover:bg-r58-accent-primary/20 rounded-lg transition-colors text-left"},[e("span",yn,_(d.icon),1),e("span",null,_(d.name),1)],8,bn))),128))])])):O("",!0),$.value.length>0?(t(),o("div",hn,[(t(!0),o(Y,null,q($.value,d=>(t(),o("div",{key:d.id,class:"flex items-center gap-3 p-3 bg-r58-bg-tertiary rounded-lg"},[e("button",{onClick:A=>C(d),class:H(["w-10 h-6 rounded-full transition-colors relative",d.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:H(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",d.enabled?"left-5":"left-1"])},null,2)],10,wn),e("span",kn,_(f(d.platformId)),1),e("div",Sn,[e("div",_n,_(d.name),1),e("div",$n,_(d.streamKey?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"+d.streamKey.slice(-4):"No stream key"),1)]),e("button",{onClick:A=>i.value={...d},class:"text-r58-accent-primary hover:underline text-sm"}," Edit ",8,Cn),e("button",{onClick:A=>b(d.id),class:"text-r58-accent-danger hover:underline text-sm"}," Remove ",8,Mn)]))),128))])):(t(),o("p",In," No streaming destinations configured. Add a platform above. "))]),i.value?(t(),o("section",Dn,[e("h3",Rn," Edit "+_(T(i.value.platformId)),1),e("div",En,[e("div",null,[n[14]||(n[14]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Display Name",-1)),X(e("input",{"onUpdate:modelValue":n[1]||(n[1]=d=>i.value.name=d),type:"text",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ie,i.value.name]])]),e("div",null,[n[15]||(n[15]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Stream Key",-1)),X(e("input",{"onUpdate:modelValue":n[2]||(n[2]=d=>i.value.streamKey=d),type:"password",placeholder:(p=K(ve).find(d=>d.id===i.value.platformId))==null?void 0:p.streamKeyPlaceholder,class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,8,jn),[[ie,i.value.streamKey]]),n[16]||(n[16]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Your stream key is stored locally and never sent to our servers. ",-1))]),i.value.platformId==="custom"?(t(),o("div",Vn,[n[17]||(n[17]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"RTMP URL",-1)),X(e("input",{"onUpdate:modelValue":n[3]||(n[3]=d=>i.value.name=d),type:"text",placeholder:"rtmp://your-server.com/live/",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,512),[[ie,i.value.name]])])):O("",!0),e("div",Tn,[e("button",{onClick:E,class:"btn btn-primary"}," Save "),e("button",{onClick:n[4]||(n[4]=d=>i.value=null),class:"btn"}," Cancel ")])])])):O("",!0),e("section",Ln,[n[26]||(n[26]=e("h3",{class:"text-lg font-medium mb-4"},"Program Output URLs",-1)),n[27]||(n[27]=e("p",{class:"text-sm text-r58-text-secondary mb-4"}," Use these URLs to consume the program feed from MediaMTX: ",-1)),e("div",Pn,[e("div",On,[e("div",Un,[n[18]||(n[18]=e("span",{class:"font-medium"},"ðŸ”´ SRT Output",-1)),e("button",{onClick:n[5]||(n[5]=d=>w(v.value.srt,"SRT URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",An,_(v.value.srt),1),n[19]||(n[19]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Low-latency, reliable transport. Ideal for remote production. ",-1))]),e("div",Hn,[e("div",Nn,[n[20]||(n[20]=e("span",{class:"font-medium"},"ðŸ“º RTMP Output",-1)),e("button",{onClick:n[6]||(n[6]=d=>w(v.value.rtmp,"RTMP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Bn,_(v.value.rtmp),1)]),e("div",zn,[e("div",Fn,[n[21]||(n[21]=e("span",{class:"font-medium"},"ðŸŽ¬ RTSP Output",-1)),e("button",{onClick:n[7]||(n[7]=d=>w(v.value.rtsp,"RTSP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Gn,_(v.value.rtsp),1)]),e("div",Kn,[e("div",Wn,[n[22]||(n[22]=e("span",{class:"font-medium"},"ðŸŒ HLS Output",-1)),e("button",{onClick:n[8]||(n[8]=d=>w(v.value.hls,"HLS URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Yn,_(v.value.hls),1),n[23]||(n[23]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Browser-compatible streaming. Higher latency. ",-1))]),e("div",Jn,[e("div",qn,[n[24]||(n[24]=e("span",{class:"font-medium"},"âš¡ WebRTC (WHEP)",-1)),e("button",{onClick:n[9]||(n[9]=d=>w(v.value.whep,"WHEP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Xn,_(v.value.whep),1),n[25]||(n[25]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Ultra-low latency WebRTC. Best for interactive use. ",-1))])])]),e("section",null,[n[30]||(n[30]=e("h3",{class:"text-lg font-medium mb-4"},"SRT Configuration",-1)),e("div",Qn,[e("div",Zn,[e("button",{onClick:n[10]||(n[10]=d=>K(s).toggleSrtOutput(!K(s).srtOutput.enabled)),class:H(["w-10 h-6 rounded-full transition-colors relative",K(s).srtOutput.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:H(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",K(s).srtOutput.enabled?"left-5":"left-1"])},null,2)],2),n[28]||(n[28]=e("span",null,"Enable SRT Output",-1))]),n[29]||(n[29]=e("div",{class:"text-sm text-r58-text-secondary"},[e("p",{class:"mb-2"},"SRT (Secure Reliable Transport) provides:"),e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Low latency (typically 1-2 seconds)"),e("li",null,"Error correction for unreliable networks"),e("li",null,"AES encryption support"),e("li",null,"Compatible with OBS, vMix, and professional equipment")])],-1))])])]),e("div",{class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},[e("button",{onClick:c,class:"btn"},"Close")])])])):O("",!0)])}}}),ts={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},os={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-3xl max-h-[80vh] overflow-hidden shadow-2xl","data-testid":"hotkey-settings-modal"},ns={class:"flex border-b border-r58-bg-tertiary"},ss=["onClick"],rs={class:"p-6 overflow-y-auto max-h-[55vh]"},is={key:0,class:"text-center py-12 text-r58-text-secondary"},as={key:1,class:"space-y-6"},ls={class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},ds={class:"space-y-2"},cs={class:"flex-1"},us={class:"text-sm"},vs={key:0,class:"ml-2 text-xs text-r58-accent-primary"},ms={class:"flex items-center gap-2"},ps={key:0,class:"flex items-center gap-2"},gs={key:0,class:"px-3 py-1 bg-r58-accent-primary text-white rounded text-sm font-mono"},xs={key:1,class:"text-sm text-r58-text-secondary animate-pulse"},fs={class:"px-3 py-1 bg-r58-bg-secondary border border-r58-bg-tertiary rounded text-sm font-mono"},bs=["onClick"],ys=["onClick"],Oe="r58-hotkey-customizations",hs=ee({__name:"HotkeySettings",setup(M,{expose:r}){const s=[{id:"help",key:"?",modifiers:["shift"],description:"Show keyboard shortcuts",context:"global",category:"Navigation",editable:!1},{id:"goto-recorder",key:"r",modifiers:["alt"],description:"Go to Recorder",context:"global",category:"Navigation",editable:!0},{id:"goto-mixer",key:"m",modifiers:["alt"],description:"Go to Mixer",context:"global",category:"Navigation",editable:!0},{id:"escape",key:"Escape",description:"Close modal / Cancel",context:"global",category:"Navigation",editable:!1},{id:"scene-1",key:"1",description:"Select Scene 1 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-2",key:"2",description:"Select Scene 2 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-3",key:"3",description:"Select Scene 3 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-4",key:"4",description:"Select Scene 4 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-5",key:"5",description:"Select Scene 5 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-6",key:"6",description:"Select Scene 6 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-7",key:"7",description:"Select Scene 7 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-8",key:"8",description:"Select Scene 8 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"take",key:" ",description:"TAKE - Transition preview to program",context:"mixer",category:"Transitions",editable:!1},{id:"cut",key:"Escape",description:"CUT - Immediate switch to preview",context:"mixer",category:"Transitions",editable:!1},{id:"transition-cut",key:"t",description:"Set transition: Cut",context:"mixer",category:"Transitions",editable:!0},{id:"transition-fade",key:"f",description:"Set transition: Fade",context:"mixer",category:"Transitions",editable:!0},{id:"go-live",key:"g",description:"Toggle Go Live",context:"mixer",category:"Control",editable:!0},{id:"toggle-recording",key:"r",description:"Toggle recording",context:"mixer",category:"Control",editable:!0},{id:"mute-all",key:"m",modifiers:["ctrl"],description:"Mute all sources",context:"mixer",category:"Control",editable:!0},{id:"toggle-sidebar",key:"s",modifiers:["ctrl"],description:"Toggle sidebar",context:"mixer",category:"Control",editable:!0},{id:"mute-1",key:"F1",description:"Toggle mute: Source 1",context:"mixer",category:"Audio",editable:!0},{id:"mute-2",key:"F2",description:"Toggle mute: Source 2",context:"mixer",category:"Audio",editable:!0},{id:"mute-3",key:"F3",description:"Toggle mute: Source 3",context:"mixer",category:"Audio",editable:!0},{id:"mute-4",key:"F4",description:"Toggle mute: Source 4",context:"mixer",category:"Audio",editable:!0},{id:"start-stop-recording",key:" ",description:"Start/Stop recording",context:"recorder",category:"Recording",editable:!0},{id:"mark-chapter",key:"c",description:"Mark chapter point",context:"recorder",category:"Recording",editable:!0},{id:"select-all",key:"a",modifiers:["ctrl"],description:"Select all cameras",context:"recorder",category:"Recording",editable:!0}],m=I(!1),i=I("mixer"),g=I({}),$=I(null),a=I(null);function v(){try{const l=localStorage.getItem(Oe);l&&(g.value=JSON.parse(l))}catch(l){console.warn("[HotkeySettings] Failed to load customizations:",l)}}function j(){try{localStorage.setItem(Oe,JSON.stringify(g.value))}catch(l){console.warn("[HotkeySettings] Failed to save customizations:",l)}}function c(l){const k=g.value[l.id];return k?{...l,key:k.key,modifiers:k.modifiers}:l}const u=N(()=>{const l={global:{},mixer:{},recorder:{}};for(const k of s){const F=c(k);l[k.context][F.category]||(l[k.context][F.category]=[]),l[k.context][F.category].push(F)}return l}),E=N(()=>u.value[i.value]||{});function b(l){return Ee(l.key,l.modifiers)}function C(l){return!!g.value[l]}function w(l){const k=s.find(F=>F.id===l);k!=null&&k.editable&&($.value=l,a.value=null,document.addEventListener("keydown",f))}function f(l){if(l.preventDefault(),l.stopPropagation(),["Control","Alt","Shift","Meta"].includes(l.key))return;const k=[];l.ctrlKey&&k.push("ctrl"),l.altKey&&k.push("alt"),l.shiftKey&&k.push("shift"),l.metaKey&&k.push("meta"),a.value={key:l.key,modifiers:k},document.removeEventListener("keydown",f)}function T(){!$.value||!a.value||(g.value[$.value]={key:a.value.key,modifiers:a.value.modifiers.length>0?a.value.modifiers:void 0},j(),B.success("Hotkey updated"),$.value=null,a.value=null)}function V(){$.value=null,a.value=null,document.removeEventListener("keydown",f)}function n(l){delete g.value[l],j(),B.info("Hotkey reset to default")}function p(){confirm("Reset all hotkeys to defaults?")&&(g.value={},j(),B.info("All hotkeys reset to defaults"))}function d(){v(),m.value=!0}function A(){V(),m.value=!1}pe(()=>{v()});function S(){return{...g.value}}return r({open:d,getCustomBindings:S}),(l,k)=>(t(),ge(we,{to:"body"},[m.value?(t(),o("div",ts,[e("div",{class:"absolute inset-0 bg-black/60",onClick:A}),e("div",os,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[k[0]||(k[0]=e("h2",{class:"text-xl font-semibold"},"Keyboard Shortcuts",-1)),e("div",{class:"flex items-center gap-4"},[e("button",{onClick:p,class:"text-sm text-r58-text-secondary hover:text-r58-text-primary"}," Reset All "),e("button",{onClick:A,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")])]),e("div",ns,[(t(),o(Y,null,q(["mixer","global","recorder"],F=>e("button",{key:F,onClick:x=>i.value=F,class:H(["px-6 py-3 text-sm font-medium capitalize transition-colors",i.value===F?"text-r58-accent-primary border-b-2 border-r58-accent-primary":"text-r58-text-secondary hover:text-r58-text-primary"])},_(F),11,ss)),64))]),e("div",rs,[Object.keys(E.value).length===0?(t(),o("div",is," No shortcuts defined for this context. ")):(t(),o("div",as,[(t(!0),o(Y,null,q(E.value,(F,x)=>(t(),o("div",{key:x},[e("h3",ls,_(x),1),e("div",ds,[(t(!0),o(Y,null,q(F,h=>(t(),o("div",{key:h.id,class:H(["flex items-center justify-between p-3 bg-r58-bg-tertiary rounded-lg",{"ring-2 ring-r58-accent-primary":$.value===h.id}])},[e("div",cs,[e("span",us,_(h.description),1),C(h.id)?(t(),o("span",vs,"(customized)")):O("",!0)]),e("div",ms,[$.value===h.id?(t(),o("div",ps,[a.value?(t(),o("kbd",gs,_(K(Ee)(a.value.key,a.value.modifiers)),1)):(t(),o("span",xs," Press a key... ")),a.value?(t(),o("button",{key:2,onClick:T,class:"btn btn-sm btn-primary"}," Save ")):O("",!0),e("button",{onClick:V,class:"btn btn-sm"}," Cancel ")])):(t(),o(Y,{key:1},[e("kbd",fs,_(b(h)),1),h.editable?(t(),o("button",{key:0,onClick:D=>w(h.id),class:"text-xs text-r58-accent-primary hover:underline"}," Edit ",8,bs)):O("",!0),C(h.id)?(t(),o("button",{key:1,onClick:D=>n(h.id),class:"text-xs text-r58-text-secondary hover:text-r58-accent-danger"}," Reset ",8,ys)):O("",!0)],64))])],2))),128))])]))),128))]))]),e("div",{class:"flex items-center justify-between px-6 py-4 border-t border-r58-bg-tertiary"},[k[1]||(k[1]=e("div",{class:"text-sm text-r58-text-secondary"},' Click "Edit" to customize a shortcut. Press any key combination to set. ',-1)),e("button",{onClick:A,class:"btn"},"Close")])])])):O("",!0)]))}}),ws={class:"connection-status","data-testid":"connection-status"},ks={class:"text-xs text-r58-text-secondary"},Ss={key:0,class:"text-xs text-r58-accent-danger",title:"Click for details"},_s={key:0,class:"mt-2 p-3 bg-r58-bg-tertiary rounded-lg text-xs space-y-2"},$s={class:"grid grid-cols-2 gap-2"},Cs={class:"ml-1 font-medium"},Ms={class:"ml-1"},Is={class:"ml-1"},Ds={key:0,class:"p-2 bg-r58-accent-danger/10 border border-r58-accent-danger/30 rounded text-r58-accent-danger"},Rs={class:"flex gap-2 pt-2 border-t border-r58-bg-tertiary"},Es=["disabled"],js={key:1,class:"text-r58-text-secondary text-center"},Vs=ee({__name:"ConnectionStatus",props:{vdoEmbed:{}},setup(M){const r=M;ne();const s=I(!1),m=I("never"),i=I(0),g=I(!1),$=I(0),a=N(()=>{var n,p;return((p=(n=r.vdoEmbed)==null?void 0:n.connectionState)==null?void 0:p.value)||"disconnected"}),v=N(()=>{var n,p;return((p=(n=r.vdoEmbed)==null?void 0:n.isReady)==null?void 0:p.value)||!1}),j=N(()=>{var n,p;return((p=(n=r.vdoEmbed)==null?void 0:n.lastError)==null?void 0:p.value)||null}),c=N(()=>{var S,l,k,F;$.value;const n=(l=(S=window.__VDO_DEBUG__)==null?void 0:S.getStats)==null?void 0:l.call(S);if((n==null?void 0:n.lastActivity)&&Date.now()-n.lastActivity<3e4)return"healthy";const d=(F=(k=r.vdoEmbed)==null?void 0:k.getEventStats)==null?void 0:F.call(k);return(d==null?void 0:d.lastActivity)&&Date.now()-d.lastActivity<3e4?"healthy":a.value==="disconnected"||!v.value?"disconnected":j.value?"error":a.value==="connecting"?"degraded":"healthy"}),u=N(()=>{switch(c.value){case"healthy":return"bg-r58-accent-success";case"degraded":return"bg-amber-500";case"error":return"bg-r58-accent-danger";case"disconnected":return"bg-r58-text-secondary";default:return"bg-r58-text-secondary"}}),E=N(()=>{switch(c.value){case"healthy":return"Connected";case"degraded":return"Connecting...";case"error":return"Error";case"disconnected":return"Disconnected";default:return"Unknown"}});let b=null;function C(){if($.value++,r.vdoEmbed){const n=r.vdoEmbed.getEventStats();if(n.lastActivity){const p=Date.now()-n.lastActivity;p<1e3?m.value="just now":p<6e4?m.value=`${Math.floor(p/1e3)}s ago`:p<36e5?m.value=`${Math.floor(p/6e4)}m ago`:m.value="over 1h ago"}}}pe(()=>{C(),b=window.setInterval(C,1e3)}),be(()=>{b&&clearInterval(b)});async function w(){if(!g.value){g.value=!0,i.value++,B.info("Attempting to reconnect...");try{r.vdoEmbed&&r.vdoEmbed.sendCommand("ping"),await new Promise(n=>setTimeout(n,2e3)),v.value&&!j.value?(B.success("Reconnected successfully"),i.value=0):B.error("Reconnection failed. Try refreshing the page.")}catch(n){B.error("Reconnection error"),console.error("[ConnectionStatus] Reconnect error:",n)}finally{g.value=!1}}}function f(){confirm("This will refresh the page and may interrupt active streams. Continue?")&&window.location.reload()}function T(){s.value=!s.value}const V=N(()=>r.vdoEmbed?r.vdoEmbed.getEventStats():{total:0,incoming:0,outgoing:0,lastActivity:null});return(n,p)=>(t(),o("div",ws,[e("div",{class:"flex items-center gap-2 cursor-pointer",onClick:T},[e("span",{class:H(["w-2 h-2 rounded-full",[u.value,{"animate-pulse":c.value==="degraded"}]]),"data-testid":"status-indicator"},null,2),e("span",ks,_(E.value),1),j.value?(t(),o("span",Ss," âš ï¸ ")):O("",!0),(t(),o("svg",{class:H(["w-3 h-3 text-r58-text-secondary transition-transform",{"rotate-180":s.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...p[0]||(p[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),s.value?(t(),o("div",_s,[e("div",$s,[e("div",null,[p[1]||(p[1]=e("span",{class:"text-r58-text-secondary"},"VDO.ninja:",-1)),e("span",{class:H(["ml-1 font-medium",v.value?"text-r58-accent-success":"text-r58-accent-danger"])},_(v.value?"Ready":"Not Ready"),3)]),e("div",null,[p[2]||(p[2]=e("span",{class:"text-r58-text-secondary"},"State:",-1)),e("span",Cs,_(a.value),1)]),e("div",null,[p[3]||(p[3]=e("span",{class:"text-r58-text-secondary"},"Last activity:",-1)),e("span",Ms,_(m.value),1)]),e("div",null,[p[4]||(p[4]=e("span",{class:"text-r58-text-secondary"},"Events:",-1)),e("span",Is,_(V.value.total),1)])]),j.value?(t(),o("div",Ds,[p[5]||(p[5]=e("strong",null,"Error:",-1)),Z(" "+_(j.value),1)])):O("",!0),e("div",Rs,[e("button",{onClick:w,disabled:g.value,class:H(["btn btn-sm flex-1",{"opacity-50":g.value}])},_(g.value?"Reconnecting...":"ðŸ”„ Reconnect"),11,Es),e("button",{onClick:f,class:"btn btn-sm",title:"Refresh the page (last resort)"}," ðŸ”ƒ Refresh ")]),i.value>0?(t(),o("div",js," Reconnect attempts: "+_(i.value),1)):O("",!0)])):O("",!0)]))}}),Ts={class:"recording-controls space-y-3","data-testid":"recording-controls"},Ls={class:"flex items-center gap-3 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},Ps={class:"text-sm font-medium flex-1","data-testid":"recording-status"},Os={key:0,class:"text-lg font-mono font-bold text-r58-accent-danger","data-testid":"recording-duration"},Us=["disabled"],As={key:0,class:"px-3 py-2 bg-r58-accent-success/10 border border-r58-accent-success/30 rounded-lg"},Hs={class:"flex items-center justify-between"},Ns=["href"],Bs=ee({__name:"RecordingControls",props:{vdoEmbed:{}},setup(M){const r=M,s=I(!1),m=I(null),i=I(0),g=I(null),$=I(!1);ae(()=>{var f,T;return(T=(f=r.vdoEmbed)==null?void 0:f.isRecording)==null?void 0:T.value},f=>{f!==void 0&&(s.value=f,f&&!m.value?m.value=Date.now():!f&&m.value&&(m.value=null))});let a=null;function v(){a&&clearInterval(a),a=window.setInterval(()=>{m.value&&(i.value=Date.now()-m.value)},100)}function j(){a&&(clearInterval(a),a=null)}pe(()=>{v()}),be(()=>{j()});const c=N(()=>{const f=Math.floor(i.value/1e3),T=Math.floor(f/3600),V=Math.floor(f%3600/60),n=f%60;return T>0?`${T}:${V.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`:`${V}:${n.toString().padStart(2,"0")}`});async function u(){if(!r.vdoEmbed){B.error("VDO.ninja not connected");return}$.value=!0;try{r.vdoEmbed.startRecording(),s.value=!0,m.value=Date.now(),i.value=0,g.value=null,B.success("Recording started")}catch(f){B.error("Failed to start recording"),console.error("[RecordingControls] Start recording error:",f)}finally{$.value=!1}}async function E(){if(!r.vdoEmbed){B.error("VDO.ninja not connected");return}$.value=!0;try{r.vdoEmbed.stopRecording(),s.value=!1,m.value=null,B.success(`Recording stopped (${c.value})`)}catch(f){B.error("Failed to stop recording"),console.error("[RecordingControls] Stop recording error:",f)}finally{$.value=!1}}function b(){s.value?E():u()}function C(){return s.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"}function w(){return $.value?"Processing...":s.value?`Recording â€¢ ${c.value}`:"Ready to record"}return(f,T)=>(t(),o("div",Ts,[e("div",Ls,[e("span",{class:H(["w-3 h-3 rounded-full",C()]),"data-testid":"recording-indicator"},null,2),e("span",Ps,_(w()),1),s.value?(t(),o("span",Os,_(c.value),1)):O("",!0)]),e("div",null,[e("button",{onClick:b,disabled:$.value,class:H(["btn w-full justify-center",s.value?"btn-danger":"btn-primary"]),"data-testid":"recording-toggle-button"},[$.value?(t(),o(Y,{key:0},[T[0]||(T[0]=e("svg",{class:"animate-spin w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),T[1]||(T[1]=Z(" Processing... ",-1))],64)):s.value?(t(),o(Y,{key:1},[T[2]||(T[2]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("rect",{x:"6",y:"6",width:"12",height:"12",rx:"1"})],-1)),T[3]||(T[3]=Z(" Stop Recording ",-1))],64)):(t(),o(Y,{key:2},[T[4]||(T[4]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("circle",{cx:"12",cy:"12",r:"8"})],-1)),T[5]||(T[5]=Z(" Start Recording ",-1))],64))],10,Us)]),g.value?(t(),o("div",As,[e("div",Hs,[T[6]||(T[6]=e("span",{class:"text-sm text-r58-accent-success"},"Recording ready!",-1)),e("a",{href:g.value,download:"",class:"text-sm text-r58-accent-primary hover:underline"}," Download ",8,Ns)])])):O("",!0),T[7]||(T[7]=e("p",{class:"text-xs text-r58-text-secondary px-1"}," Records the mixed output locally in your browser. Recording is saved when stopped. ",-1))]))}}),zs=ce(Bs,[["__scopeId","data-v-14707e66"]]),Fs={class:"audio-mixer space-y-4","data-testid":"audio-mixer"},Gs={class:"master-volume p-3 bg-r58-bg-tertiary rounded-lg"},Ks={class:"flex items-center justify-between mb-2"},Ws={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ys={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Js=["value"],qs={class:"text-xs text-r58-text-secondary text-center mt-1"},Xs={key:0,class:"space-y-2"},Qs={class:"flex items-center gap-2 mb-2"},Zs={class:"text-xs font-medium truncate flex-1"},er=["onClick"],tr=["onClick"],or={class:"h-1.5 bg-r58-bg-secondary rounded-full overflow-hidden mb-2"},nr=["value","onInput","disabled"],sr={key:1,class:"text-center py-4 text-r58-text-secondary"},rr=ee({__name:"AudioMixer",props:{vdoEmbed:{},controller:{}},setup(M){const r=M,s=ne(),m=xe(),i={cam0:"HDMI 1",cam1:"HDMI 2",cam2:"HDMI 3",cam3:"HDMI 4"},g=N(()=>m.inputs.filter(b=>b.hasSignal).map(b=>({id:b.id,label:i[b.id]||b.label,type:"camera",hasVideo:!0,hasAudio:!0,muted:!1,audioLevel:0,volume:100,solo:!1}))),$=N(()=>{const b=new Map;for(const C of g.value)b.set(C.id,C);for(const C of s.connectedSources)if(C.hasAudio){const w=b.get(C.id);w?b.set(C.id,{...w,...C}):b.set(C.id,C)}return Array.from(b.values())});function a(b,C){var w,f;if(r.controller)r.controller.setVolume(b.id,C);else if(s.setSourceVolume(b.id,C),r.vdoEmbed){const T=Math.round(C*2);(f=(w=r.vdoEmbed).setVolume)==null||f.call(w,b.id,T)}}function v(b){var C,w;if(r.controller)r.controller.toggleMute(b.id);else{const f=!b.muted;s.setSourceMute(b.id,f),r.vdoEmbed&&((w=(C=r.vdoEmbed).setMute)==null||w.call(C,b.id,f))}}function j(b){var C,w;if(r.controller)r.controller.setSolo(b.id,!b.solo);else{const f=!b.solo;s.setSourceSolo(b.id,f),r.vdoEmbed&&f&&((w=(C=r.vdoEmbed).sendCommand)==null||w.call(C,"soloChat",b.id))}}function c(){s.setMasterMuted(!s.masterMuted)}function u(b){s.setMasterVolume(b)}function E(b){return b>80?"bg-red-500":b>60?"bg-amber-500":"bg-emerald-500"}return(b,C)=>(t(),o("div",Fs,[e("div",Gs,[e("div",Ks,[C[3]||(C[3]=e("span",{class:"text-xs font-medium"},"Master",-1)),e("button",{onClick:c,class:H(["p-1 rounded hover:bg-r58-bg-secondary transition-colors",{"text-red-400":K(s).masterMuted}])},[K(s).masterMuted?(t(),o("svg",Ws,[...C[1]||(C[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(t(),o("svg",Ys,[...C[2]||(C[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],2)]),e("input",{type:"range",value:K(s).masterVolume,onInput:C[0]||(C[0]=w=>u(w.target.valueAsNumber)),min:"0",max:"100",class:"w-full h-2 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary"},null,40,Js),e("div",qs,_(K(s).masterVolume)+"% ",1)]),$.value.length>0?(t(),o("div",Xs,[(t(!0),o(Y,null,q($.value,w=>(t(),o("div",{key:w.id,class:"source-channel p-2 bg-r58-bg-tertiary/50 rounded-lg"},[e("div",Qs,[e("span",Zs,_(w.label),1),e("button",{onClick:f=>j(w),class:H(["w-6 h-6 text-xs font-bold rounded transition-colors",w.solo?"bg-amber-500 text-black":"bg-r58-bg-secondary text-r58-text-secondary hover:text-r58-text-primary"]),title:"Solo"}," S ",10,er),e("button",{onClick:f=>v(w),class:H(["w-6 h-6 text-xs font-bold rounded transition-colors",w.muted?"bg-red-500 text-white":"bg-r58-bg-secondary text-r58-text-secondary hover:text-r58-text-primary"]),title:"Mute"}," M ",10,tr)]),e("div",or,[e("div",{class:H(["h-full transition-all duration-75 rounded-full",w.muted?"bg-r58-bg-tertiary":E(w.audioLevel)]),style:fe({width:`${w.audioLevel}%`})},null,6)]),e("input",{type:"range",value:w.volume||100,onInput:f=>a(w,f.target.valueAsNumber),min:"0",max:"100",disabled:w.muted,class:"w-full h-1.5 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary disabled:opacity-50"},null,40,nr)]))),128))])):(t(),o("div",sr,[...C[4]||(C[4]=[e("svg",{class:"w-6 h-6 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})],-1),e("p",{class:"text-xs"},"No audio sources",-1)])]))]))}}),ir=ce(rr,[["__scopeId","data-v-9f608237"]]),ar={class:"transition-settings space-y-3","data-testid":"transition-settings"},lr={class:"grid grid-cols-3 gap-1"},dr=["onClick"],cr={class:"block text-sm mb-0.5"},ur=["disabled"],vr=["value"],mr={class:"p-3 bg-r58-bg-tertiary rounded-lg"},pr={class:"flex items-center justify-between text-xs"},gr={class:"font-mono"},xr={key:0},fr=ee({__name:"TransitionSettings",setup(M){const r=ne(),s=N({get:()=>r.transition.type,set:a=>r.setTransition({type:a})}),m=N({get:()=>r.transition.duration,set:a=>r.setTransition({duration:a})}),i=[{value:"cut",label:"Cut",icon:"âš¡"},{value:"fade",label:"Fade",icon:"ðŸŒ«ï¸"},{value:"wipe-left",label:"Wipe L",icon:"â—€"},{value:"wipe-right",label:"Wipe R",icon:"â–¶"},{value:"wipe-up",label:"Wipe Up",icon:"â–²"},{value:"wipe-down",label:"Wipe Down",icon:"â–¼"}],g=[{value:0,label:"0ms"},{value:100,label:"100ms"},{value:300,label:"300ms"},{value:500,label:"500ms"},{value:750,label:"750ms"},{value:1e3,label:"1s"},{value:2e3,label:"2s"}];function $(a){r.setTransition({type:a})}return(a,v)=>{var j;return t(),o("div",ar,[e("div",lr,[(t(),o(Y,null,q(i,c=>e("button",{key:c.value,onClick:u=>$(c.value),class:H(["px-2 py-2 text-xs rounded transition-colors text-center",s.value===c.value?"bg-r58-accent-primary text-white":"bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 text-r58-text-secondary"])},[e("span",cr,_(c.icon),1),Z(" "+_(c.label),1)],10,dr)),64))]),e("div",null,[v[1]||(v[1]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Duration",-1)),X(e("select",{"onUpdate:modelValue":v[0]||(v[0]=c=>m.value=c),class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none",disabled:s.value==="cut"},[(t(),o(Y,null,q(g,c=>e("option",{key:c.value,value:c.value},_(c.label),9,vr)),64))],8,ur),[[$e,m.value,void 0,{number:!0}]])]),e("div",mr,[e("div",pr,[v[2]||(v[2]=e("span",{class:"text-r58-text-secondary"},"Current:",-1)),e("span",gr,[Z(_((j=i.find(c=>c.value===s.value))==null?void 0:j.label)+" ",1),s.value!=="cut"?(t(),o("span",xr," ("+_(m.value)+"ms)",1)):O("",!0)])])]),v[3]||(v[3]=e("p",{class:"text-xs text-r58-text-secondary"},[Z(" Press "),e("kbd",{class:"px-1 py-0.5 bg-r58-bg-tertiary rounded"},"Space"),Z(" to Take with transition ")],-1))])}}}),br={class:"invite-links space-y-3","data-testid":"invite-links"},yr={key:0,class:"space-y-2"},hr={class:"p-2 bg-r58-bg-tertiary rounded-lg"},wr={class:"text-xs text-r58-text-secondary break-all block"},kr={key:1,class:"space-y-2 p-3 bg-r58-bg-tertiary rounded-lg"},Sr={class:"flex items-center gap-2 text-xs"},_r={class:"flex items-center gap-2 text-xs"},$r={key:2,class:"text-center"},Cr={key:0,class:"mt-2 flex justify-center"},Mr=["src"],Ir={class:"text-xs text-r58-text-secondary text-center"},Dr={class:"font-mono"},Rr=ee({__name:"InviteLinks",setup(M){const r=I(""),s=I(!1),m=I(!0),i=I(!0),g=N(()=>r.value.trim()?et(r.value.trim()):"");function $(){if(!g.value){B.error("Enter a guest name first");return}navigator.clipboard.writeText(g.value),B.success("Invite link copied!")}function a(){if(!g.value){B.error("Enter a guest name first");return}window.open(g.value,"_blank")}async function v(){if(!g.value){B.error("Enter a guest name first");return}if(navigator.share)try{await navigator.share({title:`Join ${Te} as ${r.value}`,text:`Click to join the video call as ${r.value}`,url:g.value})}catch(c){c.name!=="AbortError"&&$()}else $()}const j=N(()=>g.value?`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(g.value)}`:"");return(c,u)=>(t(),o("div",br,[e("div",null,[u[5]||(u[5]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Guest Name",-1)),X(e("input",{"onUpdate:modelValue":u[0]||(u[0]=E=>r.value=E),type:"text",placeholder:"e.g., John Smith",class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ie,r.value]])]),g.value?(t(),o("div",yr,[e("div",hr,[e("code",wr,_(g.value),1)]),e("div",{class:"flex gap-2"},[e("button",{onClick:$,class:"flex-1 btn btn-sm btn-primary"},[...u[6]||(u[6]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})],-1),Z(" Copy ",-1)])]),e("button",{onClick:v,class:"btn btn-sm",title:"Share"},[...u[7]||(u[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})],-1)])]),e("button",{onClick:a,class:"btn btn-sm",title:"Open in new tab"},[...u[8]||(u[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)])])])])):O("",!0),e("button",{onClick:u[1]||(u[1]=E=>s.value=!s.value),class:"w-full text-xs text-r58-text-secondary hover:text-r58-text-primary flex items-center justify-center gap-1"},[e("span",null,_(s.value?"Hide":"Show")+" options",1),(t(),o("svg",{class:H(["w-3 h-3 transition-transform",{"rotate-180":s.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...u[9]||(u[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),s.value?(t(),o("div",kr,[e("label",Sr,[X(e("input",{type:"checkbox","onUpdate:modelValue":u[2]||(u[2]=E=>m.value=E),class:"rounded"},null,512),[[je,m.value]]),u[10]||(u[10]=e("span",null,"Enable video",-1))]),e("label",_r,[X(e("input",{type:"checkbox","onUpdate:modelValue":u[3]||(u[3]=E=>i.value=E),class:"rounded"},null,512),[[je,i.value]]),u[11]||(u[11]=e("span",null,"Enable audio",-1))])])):O("",!0),g.value&&j.value?(t(),o("div",$r,[e("button",{onClick:u[4]||(u[4]=E=>s.value=!s.value),class:"text-xs text-r58-text-secondary hover:text-r58-text-primary"}," Show QR Code "),s.value?(t(),o("div",Cr,[e("img",{src:j.value,alt:"QR Code",class:"w-32 h-32 bg-white p-2 rounded"},null,8,Mr)])):O("",!0)])):O("",!0),e("div",Ir,[u[12]||(u[12]=Z(" Room: ",-1)),e("span",Dr,_(K(Te)),1)])]))}}),Er={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},jr={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-2xl"},Vr={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},Tr={class:"text-xl font-semibold"},Lr={class:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},Pr={class:"flex gap-6"},Or={class:"flex-1"},Ur={class:"mb-4"},Ar={class:"mb-4"},Hr={class:"flex gap-2 flex-wrap"},Nr=["onClick"],Br={class:"mb-4"},zr={id:"scene-canvas",class:"relative aspect-video bg-black rounded-lg overflow-hidden border border-r58-bg-tertiary"},Fr=["onMousedown","onClick"],Gr={class:"absolute inset-0 flex items-center justify-center text-xs text-r58-text-secondary"},Kr=["onMousedown"],Wr=["onClick"],Yr={class:"w-64 flex-shrink-0"},Jr={key:0,class:"space-y-4"},qr=["value"],Xr=["value"],Qr={class:"grid grid-cols-2 gap-2"},Zr={key:1,class:"text-sm text-r58-text-secondary p-4 bg-r58-bg-tertiary rounded-lg"},ei={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},ti=ee({__name:"SceneEditor",setup(M,{expose:r}){const s=me(),m=ne(),i=I(!1),g=I(null),$=I(!1),a=I(""),v=I([]),j=I(null),c=I(!1),u=I(null),E=I({x:0,y:0}),b=I("move"),C=N(()=>m.connectedSources),w=[{id:"solo",name:"Solo",slots:[{x:0,y:0,w:100,h:100}]},{id:"split",name:"Split",slots:[{x:0,y:0,w:50,h:100},{x:50,y:0,w:50,h:100}]},{id:"pip",name:"PiP",slots:[{x:0,y:0,w:100,h:100},{x:65,y:60,w:30,h:35}]},{id:"quad",name:"Quad",slots:[{x:0,y:0,w:50,h:50},{x:50,y:0,w:50,h:50},{x:0,y:50,w:50,h:50},{x:50,y:50,w:50,h:50}]},{id:"three-up",name:"3-Up",slots:[{x:0,y:0,w:50,h:100},{x:50,y:0,w:50,h:50},{x:50,y:50,w:50,h:50}]}];function f(D){g.value=D,$.value=!1,a.value=D.name,v.value=JSON.parse(JSON.stringify(D.slots)),j.value=null,i.value=!0}function T(){g.value=null,$.value=!0,a.value="New Scene",v.value=[{id:"slot-1",sourceId:null,position:{x:0,y:0,w:100,h:100},zIndex:0}],j.value=null,i.value=!0}function V(){i.value=!1,g.value=null}function n(){if(!a.value.trim()){B.error("Scene name is required");return}if($.value){const D=s.createScene({name:a.value.trim(),resolution:{width:1920,height:1080},slots:v.value});B.success(`Created: ${D.name}`)}else g.value&&(s.updateScene(g.value.id,{name:a.value.trim(),slots:v.value}),B.success(`Updated: ${a.value}`));V()}function p(D){v.value=D.slots.map((y,R)=>{var U;return{id:`slot-${R+1}`,sourceId:((U=v.value[R])==null?void 0:U.sourceId)||null,position:{x:y.x,y:y.y,w:y.w,h:y.h},zIndex:R}}),B.info(`Applied: ${D.name}`)}function d(){const D={id:`slot-${Date.now()}`,sourceId:null,position:{x:10,y:10,w:30,h:30},zIndex:v.value.length};v.value.push(D),j.value=D.id}function A(D){const y=v.value.findIndex(R=>R.id===D);y!==-1&&(v.value.splice(y,1),j.value===D&&(j.value=null))}function S(D){j.value=D}const l=N(()=>v.value.find(D=>D.id===j.value));function k(D){if(!j.value)return;const y=v.value.find(R=>R.id===j.value);y&&(y.sourceId=D)}function F(D,y,R="move"){D.preventDefault(),c.value=!0,u.value=y,b.value=R,E.value={x:D.clientX,y:D.clientY},window.addEventListener("mousemove",x),window.addEventListener("mouseup",h)}function x(D){if(!c.value||!u.value)return;const y=v.value.find(ue=>ue.id===u.value);if(!y)return;const R=document.getElementById("scene-canvas");if(!R)return;const U=R.getBoundingClientRect(),L=(D.clientX-E.value.x)/U.width*100,Q=(D.clientY-E.value.y)/U.height*100;b.value==="move"?(y.position.x=Math.max(0,Math.min(100-y.position.w,y.position.x+L)),y.position.y=Math.max(0,Math.min(100-y.position.h,y.position.y+Q))):(y.position.w=Math.max(10,Math.min(100-y.position.x,y.position.w+L)),y.position.h=Math.max(10,Math.min(100-y.position.y,y.position.h+Q))),E.value={x:D.clientX,y:D.clientY}}function h(){c.value=!1,u.value=null,window.removeEventListener("mousemove",x),window.removeEventListener("mouseup",h)}return r({open:f,openNew:T}),(D,y)=>(t(),ge(we,{to:"body"},[i.value?(t(),o("div",Er,[e("div",{class:"absolute inset-0 bg-black/70",onClick:V}),e("div",jr,[e("div",Vr,[e("h2",Tr,_($.value?"Create Scene":"Edit Scene"),1),e("button",{onClick:V,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",Lr,[e("div",Pr,[e("div",Or,[e("div",Ur,[y[7]||(y[7]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Scene Name",-1)),X(e("input",{"onUpdate:modelValue":y[0]||(y[0]=R=>a.value=R),type:"text",class:"w-full px-3 py-2 bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ie,a.value]])]),e("div",Ar,[y[8]||(y[8]=e("label",{class:"block text-sm text-r58-text-secondary mb-2"},"Quick Layouts",-1)),e("div",Hr,[(t(),o(Y,null,q(w,R=>e("button",{key:R.id,onClick:U=>p(R),class:"px-3 py-1 text-xs bg-r58-bg-tertiary hover:bg-r58-accent-primary/20 rounded transition-colors"},_(R.name),9,Nr)),64))])]),e("div",Br,[y[9]||(y[9]=e("label",{class:"block text-sm text-r58-text-secondary mb-2"},"Layout",-1)),e("div",zr,[(t(!0),o(Y,null,q(v.value,R=>(t(),o("div",{key:R.id,onMousedown:U=>F(U,R.id,"move"),onClick:Se(U=>S(R.id),["stop"]),class:H(["absolute cursor-move transition-colors",[j.value===R.id?"border-2 border-r58-accent-primary":"border border-r58-bg-tertiary hover:border-r58-accent-primary/50"]]),style:fe({left:`${R.position.x}%`,top:`${R.position.y}%`,width:`${R.position.w}%`,height:`${R.position.h}%`,zIndex:R.zIndex,backgroundColor:R.sourceId?"var(--r58-bg-tertiary)":"var(--r58-bg-secondary)"})},[e("div",Gr,_(R.sourceId||"Empty"),1),j.value===R.id?(t(),o("div",{key:0,onMousedown:Se(U=>F(U,R.id,"resize"),["stop"]),class:"absolute bottom-0 right-0 w-4 h-4 bg-r58-accent-primary cursor-se-resize"},null,40,Kr)):O("",!0),j.value===R.id&&v.value.length>1?(t(),o("button",{key:1,onClick:Se(U=>A(R.id),["stop"]),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center hover:bg-red-400"}," Ã— ",8,Wr)):O("",!0)],46,Fr))),128))])]),e("button",{onClick:d,class:"btn btn-sm"}," + Add Slot ")]),e("div",Yr,[y[17]||(y[17]=e("h3",{class:"text-sm font-medium mb-3"},"Slot Properties",-1)),l.value?(t(),o("div",Jr,[e("div",null,[y[11]||(y[11]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Source",-1)),e("select",{value:l.value.sourceId||"",onChange:y[1]||(y[1]=R=>k(R.target.value||null)),class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg"},[y[10]||(y[10]=e("option",{value:""},"None (Empty)",-1)),(t(!0),o(Y,null,q(C.value,R=>(t(),o("option",{key:R.id,value:R.id},_(R.label),9,Xr))),128))],40,qr)]),e("div",Qr,[e("div",null,[y[12]||(y[12]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"X %",-1)),X(e("input",{"onUpdate:modelValue":y[2]||(y[2]=R=>l.value.position.x=R),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ie,l.value.position.x,void 0,{number:!0}]])]),e("div",null,[y[13]||(y[13]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Y %",-1)),X(e("input",{"onUpdate:modelValue":y[3]||(y[3]=R=>l.value.position.y=R),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ie,l.value.position.y,void 0,{number:!0}]])]),e("div",null,[y[14]||(y[14]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Width %",-1)),X(e("input",{"onUpdate:modelValue":y[4]||(y[4]=R=>l.value.position.w=R),type:"number",min:"1",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ie,l.value.position.w,void 0,{number:!0}]])]),e("div",null,[y[15]||(y[15]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Height %",-1)),X(e("input",{"onUpdate:modelValue":y[5]||(y[5]=R=>l.value.position.h=R),type:"number",min:"1",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ie,l.value.position.h,void 0,{number:!0}]])])]),e("div",null,[y[16]||(y[16]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Layer (z-index)",-1)),X(e("input",{"onUpdate:modelValue":y[6]||(y[6]=R=>l.value.zIndex=R),type:"number",min:"0",max:"10",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ie,l.value.zIndex,void 0,{number:!0}]])])])):(t(),o("div",Zr," Click a slot to edit its properties "))])])]),e("div",ei,[e("button",{onClick:V,class:"btn"},"Cancel"),e("button",{onClick:n,class:"btn btn-primary"},_($.value?"Create Scene":"Save Changes"),1)])])])):O("",!0)]))}}),oi={class:"h-full flex flex-col bg-r58-bg-primary"},ni={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},si={class:"flex items-center gap-4"},ri={class:"flex items-center gap-2"},ii={key:0,class:"badge badge-danger"},ai={class:"flex items-center gap-4"},li={class:"flex-1 p-6 overflow-auto"},di={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ci={class:"card p-6"},ui={class:"grid grid-cols-4 gap-3"},vi=["onClick"],mi={class:"card p-6"},pi={class:"text-lg font-semibold mb-4"},gi={class:"text-sm font-normal text-r58-text-secondary"},xi={class:"space-y-3"},fi={class:"flex items-center gap-3"},bi={class:"font-medium"},yi={key:0,class:"text-xs text-r58-text-secondary ml-2"},hi={key:0,class:"text-sm text-r58-text-secondary"},wi={class:"card p-6"},ki={class:"flex items-center gap-4"},Si={key:0,class:"w-2 h-2 rounded-full bg-white animate-pulse mr-2"},_i={key:0,class:"mt-3 text-sm text-r58-text-secondary"},$i={class:"card p-6"},Ci={class:"grid grid-cols-2 gap-4"},Mi={class:"text-2xl font-bold text-r58-text-primary"},Ii=ee({__name:"MixerLiteView",emits:["enable-full-mode"],setup(M,{emit:r}){const s=r,m=xe(),i=ne(),g=ke(),{register:$}=Ue(),a=N(()=>i.isLive),v=N(()=>m.inputs),j=N(()=>v.value.filter(w=>w.hasSignal));let c=null;pe(()=>{m.fetchInputs(),c=window.setInterval(()=>{m.fetchInputs()},5e3);for(let w=1;w<=4;w++)$({key:String(w),description:`Switch to scene ${w}`,action:()=>u(w),context:"mixer-lite"})}),be(()=>{c&&clearInterval(c)});function u(w){i.setScene(`scene-${w}`),B.info(`Scene ${w}`)}function E(){i.isLive?(i.toggleLive(),g.stopStreaming(),B.info("Session ended")):(i.toggleLive(),g.startStreaming(),B.success("Going live!"))}async function b(){try{m.isRecording?(await m.stopRecording(),B.info("Recording stopped")):(await m.startRecording(),B.success("Recording started"))}catch{B.error("Recording action failed")}}function C(){confirm("Full Mixer mode loads VDO.ninja which uses significant CPU/GPU resources. This may cause lag on the device. Continue?")&&s("enable-full-mode")}return(w,f)=>(t(),o("div",oi,[e("header",ni,[e("div",si,[e("div",ri,[e("span",{class:H(["w-3 h-3 rounded-full",a.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"])},null,2),f[0]||(f[0]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1)),f[1]||(f[1]=e("span",{class:"text-xs px-2 py-0.5 rounded bg-amber-500/20 text-amber-400 font-medium"}," LITE MODE ",-1))]),a.value?(t(),o("span",ii,"ON AIR")):O("",!0)]),e("div",ai,[e("button",{class:"btn btn-sm btn-secondary",onClick:C,title:"Enable full VDO.ninja mixer (high CPU usage)"},[...f[2]||(f[2]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1),Z(" Full Mode ",-1)])]),e("button",{class:H(["btn",a.value?"btn-danger":"btn-primary"]),onClick:E},_(a.value?"End Session":"Go Live"),3)])]),e("main",li,[f[10]||(f[10]=he('<div class="mb-6 p-4 rounded-lg bg-amber-500/10 border border-amber-500/30" data-v-6d9e9096><div class="flex items-start gap-3" data-v-6d9e9096><svg class="w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-6d9e9096><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-6d9e9096></path></svg><div data-v-6d9e9096><h3 class="font-medium text-amber-400" data-v-6d9e9096>Local Device Mode</h3><p class="text-sm text-r58-text-secondary mt-1" data-v-6d9e9096> VDO.ninja previews are disabled to save CPU. Scene switching and guest management should be done from a remote browser or the Electron app. </p></div></div></div>',1)),e("div",di,[e("div",ci,[f[3]||(f[3]=e("h2",{class:"text-lg font-semibold mb-4"},"Scene Control",-1)),e("div",ui,[(t(),o(Y,null,q(4,T=>e("button",{key:T,class:H(["aspect-video flex items-center justify-center text-2xl font-bold rounded-lg transition-all",K(i).currentScene===`scene-${T}`?"bg-r58-mixer text-white ring-2 ring-r58-mixer ring-offset-2 ring-offset-r58-bg-primary":"bg-r58-bg-tertiary hover:bg-r58-bg-secondary text-r58-text-primary"]),onClick:V=>u(T)},_(T),11,vi)),64))]),f[4]||(f[4]=e("p",{class:"text-xs text-r58-text-secondary mt-3"}," Press 1-4 to switch scenes. Full transitions require VDO.ninja (Full Mode). ",-1))]),e("div",mi,[e("h2",pi,[f[5]||(f[5]=Z(" Inputs ",-1)),e("span",gi,"("+_(j.value.length)+"/"+_(v.value.length)+" active)",1)]),e("div",xi,[(t(!0),o(Y,null,q(v.value,T=>(t(),o("div",{key:T.id,class:H(["flex items-center justify-between p-3 rounded-lg",T.hasSignal?"bg-r58-bg-tertiary":"bg-r58-bg-secondary opacity-50"])},[e("div",fi,[e("div",{class:H(["w-2 h-2 rounded-full",T.hasSignal?"bg-green-500":"bg-gray-500"])},null,2),e("div",null,[e("span",bi,_(T.name),1),T.resolution?(t(),o("span",yi,_(T.resolution),1)):O("",!0)])]),T.framerate?(t(),o("div",hi,_(T.framerate.toFixed(1))+" fps ",1)):O("",!0)],2))),128))])]),e("div",wi,[f[6]||(f[6]=e("h2",{class:"text-lg font-semibold mb-4"},"Device Recording",-1)),e("div",ki,[e("button",{class:H(["btn flex-1",K(m).isRecording?"btn-danger":"btn-primary"]),onClick:b},[K(m).isRecording?(t(),o("span",Si)):O("",!0),Z(" "+_(K(m).isRecording?"Stop Recording":"Start Recording"),1)],2)]),K(m).isRecording?(t(),o("div",_i," Duration: "+_(K(m).formattedDuration),1)):O("",!0)]),e("div",$i,[f[9]||(f[9]=e("h2",{class:"text-lg font-semibold mb-4"},"System Status",-1)),e("div",Ci,[e("div",null,[e("div",Mi,_(j.value.length),1),f[7]||(f[7]=e("div",{class:"text-sm text-r58-text-secondary"},"Active Inputs",-1))]),e("div",null,[e("div",{class:H(["text-2xl font-bold",a.value?"text-red-500":"text-r58-text-primary"])},_(a.value?"LIVE":"Offline"),3),f[8]||(f[8]=e("div",{class:"text-sm text-r58-text-secondary"},"Stream Status",-1))])])])])])]))}}),Di=ce(Ii,[["__scopeId","data-v-6d9e9096"]]),Ri={class:"h-full flex flex-col bg-r58-bg-primary"},Ei={class:"flex items-center justify-between px-6 py-3 border-b border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"mixer-header"},ji={class:"flex items-center gap-4"},Vi={class:"flex items-center gap-2"},Ti={key:0,class:"px-3 py-1 bg-red-600 text-white text-xs font-bold uppercase tracking-wider rounded"},Li={class:"text-sm text-r58-text-secondary"},Pi={key:1,class:"text-xs text-r58-text-secondary"},Oi={class:"flex items-center gap-3"},Ui={class:"flex items-center gap-1 bg-r58-bg-tertiary rounded-lg p-1"},Ai={class:"flex-1 flex overflow-hidden"},Hi={class:"flex-1 min-w-0"},Ni={key:0,class:"text-sm font-medium"},Bi={class:"p-4 space-y-6"},zi={class:"p-2 space-y-4"},Fi={class:"fixed -left-[9999px] -top-[9999px] w-[1px] h-[1px] overflow-hidden"},Gi=ee({__name:"MixerView",setup(M){const r=ne(),s=me(),m=xe(),i=ke(),{register:g}=Ue(),{isLiteMode:$}=Ge(),a=I(null),v=ot(a),j=I(null),c=I(null),u=I(null),E=I(!1),b=N(()=>!$.value||E.value),C=I(!0),w=I(!1),f=I(!1),T=N(()=>r.isLive),V=N(()=>i.enabledDestinations.length),n=N(()=>{const U=s.getScene(r.programSceneId||"");return(U==null?void 0:U.name)||"No Scene"});function p(){C.value=!1}ae(()=>{var U,L;return(L=(U=a.value)==null?void 0:U.isReady)==null?void 0:L.value},U=>{U&&(console.log("[Mixer] VDO.ninja ready"),w.value=!0)},{immediate:!0});let d=null;function A(){return m.isRecording?1e4:3e4}function S(){d&&clearInterval(d),d=window.setInterval(()=>{m.fetchInputs()},A())}ae(()=>m.isRecording,()=>{S()});const l=[];pe(async()=>{await m.fetchInputs(),S();for(let U=1;U<=8;U++){const L=U-1,Q=g({key:String(U),description:`Select scene ${U} for preview`,action:()=>{const ue=s.scenes[L];ue&&(r.setPreviewScene(ue.id),B.info(`Preview: ${ue.name}`))},context:"mixer"});l.push(Q)}l.push(g({key:" ",description:"Take (transition preview to program)",action:()=>{r.previewSceneId&&r.previewSceneId!==r.programSceneId&&(v.takeToProgram(),B.success("Take!"))},context:"mixer"})),l.push(g({key:"Escape",description:"Cut (immediate switch)",action:()=>{r.previewSceneId&&(v.cutToProgram(),B.info("Cut"))},context:"mixer"})),l.push(g({key:"g",description:"Toggle Go Live",action:k,context:"mixer"})),l.push(g({key:"r",description:"Toggle recording",action:F,context:"mixer"}))}),be(()=>{l.forEach(U=>U()),d&&(clearInterval(d),d=null)});function k(){if(r.isLive)r.toggleLive(),i.stopStreaming(),B.info("Session ended");else{r.toggleLive(),i.startStreaming();const U=i.enabledDestinations.length;U>0?B.success(`Live! Streaming to ${U} destination${U>1?"s":""}`):B.info("Live! (No streaming destinations configured)")}}function F(){var U,L;if(!v.isConnected.value){B.error("VDO.ninja not connected");return}(L=(U=a.value)==null?void 0:U.isRecording)!=null&&L.value?(v.stopRecording(),B.info("Recording stopped")):(v.startRecording(),B.success("Recording started"))}function x(){var U;(U=j.value)==null||U.open()}function h(){var U;(U=c.value)==null||U.open()}function D(U){var L;(L=u.value)==null||L.open(U)}function y(){var U;(U=u.value)==null||U.openNew()}function R(){f.value=!f.value}return(U,L)=>b.value?(t(),o(Y,{key:1},[oe(We,{name:"fade"},{default:Ke(()=>[C.value?(t(),ge(tt,{key:0,mode:"mixer","content-ready":w.value,"min-time":2e3,"max-time":15e3,onReady:p},null,8,["content-ready"])):O("",!0)]),_:1}),e("div",Ri,[e("header",Ei,[e("div",ji,[e("div",Vi,[e("span",{class:H(["w-3 h-3 rounded-full transition-colors",T.value?"bg-red-500 animate-pulse":"bg-r58-bg-tertiary"])},null,2),L[3]||(L[3]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1))]),T.value?(t(),o("span",Ti," ON AIR ")):O("",!0),e("span",Li,_(n.value),1),T.value&&V.value>0?(t(),o("span",Pi," â†’ "+_(V.value)+" platform"+_(V.value>1?"s":""),1)):O("",!0),oe(Vs,{"vdo-embed":a.value},null,8,["vdo-embed"])]),e("div",Oi,[e("div",Ui,[e("button",{onClick:L[1]||(L[1]=Q=>K(r).setMode("simple")),class:H(["px-3 py-1 text-xs rounded transition-colors",K(r).mode==="simple"?"bg-r58-accent-primary text-white":"text-r58-text-secondary hover:text-r58-text-primary"])}," Simple ",2),e("button",{onClick:L[2]||(L[2]=Q=>K(r).setMode("pvw-pgm")),class:H(["px-3 py-1 text-xs rounded transition-colors",K(r).mode==="pvw-pgm"?"bg-r58-accent-primary text-white":"text-r58-text-secondary hover:text-r58-text-primary"])}," PVW/PGM ",2)]),e("button",{class:"btn btn-sm",onClick:h,title:"Keyboard Shortcuts (Shift+?)"},[...L[4]||(L[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})],-1)])]),e("button",{class:"btn btn-sm",onClick:x,title:"Streaming Settings"},[...L[5]||(L[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])]),e("button",{class:H(["btn px-6",T.value?"btn-danger":"btn-primary"]),onClick:k},_(T.value?"End Session":"Go Live"),3)])]),e("div",Ai,[e("div",Hi,[oe(Do,{"vdo-embed":a.value,controller:K(v),onEditScene:D,onAddScene:y},null,8,["vdo-embed","controller"])]),e("aside",{class:H(["flex-shrink-0 border-l border-r58-bg-tertiary bg-r58-bg-secondary overflow-y-auto transition-all duration-300",f.value?"w-12":"w-72"])},[e("button",{onClick:R,class:"w-full p-3 flex items-center justify-between border-b border-r58-bg-tertiary hover:bg-r58-bg-tertiary/50 transition-colors"},[f.value?O("",!0):(t(),o("span",Ni,"Controls")),(t(),o("svg",{class:H(["w-4 h-4 transition-transform",{"rotate-180":f.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...L[6]||(L[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))]),X(e("div",Bi,[e("section",null,[L[7]||(L[7]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Transitions ",-1)),oe(fr)]),e("section",null,[L[8]||(L[8]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Audio ",-1)),oe(ir,{"vdo-embed":a.value,controller:K(v)},null,8,["vdo-embed","controller"])]),e("section",null,[L[9]||(L[9]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Program Output ",-1)),oe(cn)]),e("section",null,[L[10]||(L[10]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Recording ",-1)),oe(zs,{"vdo-embed":a.value},null,8,["vdo-embed"])]),e("section",null,[L[11]||(L[11]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Invite Guests ",-1)),oe(Rr)])],512),[[ye,!f.value]]),X(e("div",zi,[...L[12]||(L[12]=[he('<button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Transitions" data-v-c03e6b15><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c03e6b15><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" data-v-c03e6b15></path></svg></button><button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Audio" data-v-c03e6b15><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c03e6b15><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" data-v-c03e6b15></path></svg></button><button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Recording" data-v-c03e6b15><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c03e6b15><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" data-v-c03e6b15></path></svg></button>',3)])],512),[[ye,f.value]])],2)]),oe(Xo),e("div",Fi,[oe(Ao,{ref_key:"vdoEmbedRef",ref:a,profile:"director"},null,512)]),oe(es,{ref_key:"streamingSettingsRef",ref:j},null,512),oe(hs,{ref_key:"hotkeySettingsRef",ref:c},null,512),oe(ti,{ref_key:"sceneEditorRef",ref:u},null,512)])],64)):(t(),ge(Di,{key:0,onEnableFullMode:L[0]||(L[0]=Q=>E.value=!0)}))}}),Ji=ce(Gi,[["__scopeId","data-v-c03e6b15"]]);export{Ji as default};
