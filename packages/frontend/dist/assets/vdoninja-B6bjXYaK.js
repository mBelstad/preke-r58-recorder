const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-wGeF6xKQ.js","assets/index-CCN4pNz4.css"])))=>i.map(i=>d[i]);
import{a5 as O}from"./index-wGeF6xKQ.js";let g=null;async function d(){if(g)return g;try{const{getDeviceUrl:s}=await O(async()=>{const{getDeviceUrl:n}=await import("./index-wGeF6xKQ.js").then(t=>t.ac);return{getDeviceUrl:n}},__vite__mapDeps([0,1])),o=s();if(o){const n=new AbortController,t=setTimeout(()=>n.abort(),3e3),e=await fetch(`${o}/api/config`,{signal:n.signal,mode:"cors",cache:"no-cache"});if(clearTimeout(t),e.ok){const c=await e.json();if(c.vdo_host||c.vdoninja_host)return g=c.vdo_host||c.vdoninja_host,g}}}catch{console.log("[VDO.ninja] Device does not provide VDO.ninja host configuration")}const a="app.itagenten.no";return g=a,console.log(`[VDO.ninja] Using default host: ${a}`),a}function P(){return"https"}async function w(){return await d()==="app.itagenten.no"?"/vdo":""}const h="studio",m="preke-r58-2024";function b(){var s,o;const a=`
/* R58 VDO.ninja Theme - Colors Only */
:root {
  --r58-bg: #0f172a;
  --r58-bg2: #1e293b;
  --r58-bg3: #334155;
  --r58-text: #f8fafc;
  --r58-muted: #94a3b8;
  --r58-blue: #3b82f6;
  --r58-green: #22c55e;
  --r58-gold: #f59e0b;
  --r58-border: #475569;
}
body { background: var(--r58-bg); color: var(--r58-text); }
#mainmenu, .controlButtons, #guestFeatures { background: var(--r58-bg2); }
button, .button { background: var(--r58-bg3); color: var(--r58-text); border-color: var(--r58-border); }
button:hover { background: var(--r58-blue); }
input, select, textarea { background: var(--r58-bg3); color: var(--r58-text); border-color: var(--r58-border); }
a { color: var(--r58-blue); }
.vidcon { background: var(--r58-bg2); border-color: var(--r58-border); border-radius: 8px; }
video { border-radius: 6px; }
`;if(typeof window<"u"&&((o=(s=window.location)==null?void 0:s.origin)!=null&&o.startsWith("file://")))return"";try{return btoa(unescape(encodeURIComponent(a)))}catch{return""}}async function R(a,s,o,n={}){const t=await d();if(!t)return null;const e=P(),c=await w(),i=new URL(`${e}://${t}${c}/`);if(i.searchParams.set("whepplay",s),i.searchParams.set("push",a),i.searchParams.set("room",h),i.searchParams.set("password",m),i.searchParams.set("label",o),i.searchParams.set("autostart","true"),i.searchParams.set("stereo","2"),i.searchParams.set("whepwait","2000"),n.useMediamtx!==!1){const r=await v();r&&i.searchParams.set("mediamtx",r)}const u=b();u&&i.searchParams.set("b64css",u);const p=i.toString();return console.log(`[VDO.ninja] Camera contribution URL for ${a}: room=${h}, password=${m.substring(0,4)}...`),p}async function x(a){const s=await d();if(!s)return null;const o=P(),n=await w(),t=new URL(`${o}://${s}${n}/`);t.searchParams.set("scene",""),t.searchParams.set("room",h),t.searchParams.set("cover",""),t.searchParams.set("quality","0"),t.searchParams.set("width","1280"),t.searchParams.set("height","720"),t.searchParams.set("cleanoutput",""),t.searchParams.set("hideheader",""),t.searchParams.set("nologo",""),t.searchParams.set("whipout",a),t.searchParams.set("autostart",""),t.searchParams.set("videodevice","0"),t.searchParams.set("audiodevice","0");const e=b();return e&&t.searchParams.set("b64css",e),t.toString()}async function L(a){const s=await d();if(!s)return null;const o=P(),n=await w(),t=new URL(`${o}://${s}${n}/`);t.searchParams.set("scene","0"),t.searchParams.set("layout",""),t.searchParams.set("remote",""),t.searchParams.set("room",h),t.searchParams.set("password",m),t.searchParams.set("cleanviewer",""),t.searchParams.set("chroma","000"),t.searchParams.set("ssar","landscape"),t.searchParams.set("nosettings",""),t.searchParams.set("showlabels",""),t.searchParams.set("prefercurrenttab",""),t.searchParams.set("selfbrowsersurface","include"),t.searchParams.set("displaysurface","browser"),t.searchParams.set("np",""),t.searchParams.set("publish",""),t.searchParams.set("quality","1"),t.searchParams.set("screenshareaspectratio","1.7777777777777777"),t.searchParams.set("locked","1.7777777777777777"),t.searchParams.set("maxvideobitrate","2500"),t.searchParams.set("totalroombitrate","6000");const e=await v()||"app.itagenten.no";{let i=e;if(!e.includes("://")){const u=e==="localhost"||e==="127.0.0.1"||e.startsWith("192.168.")||e.startsWith("10.")||e.startsWith("172.")?"http":"https";i=e.includes(":")?`${u}://${e}`:`${u}://${e}:8889`}t.searchParams.set("mediamtx",i)}const c=b();return c&&t.searchParams.set("b64css",c),t.toString()}async function y(){var a;try{const{getDeviceUrl:s}=await O(async()=>{const{getDeviceUrl:n}=await import("./index-wGeF6xKQ.js").then(t=>t.ac);return{getDeviceUrl:n}},__vite__mapDeps([0,1])),o=s();if(o){const n=new AbortController,t=setTimeout(()=>n.abort(),3e3),e=await fetch(`${o}/api/config`,{signal:n.signal,mode:"cors",cache:"no-cache"});if(clearTimeout(t),e.ok){const c=await e.json();if((a=c.vdo_ninja)!=null&&a.api_key)return c.vdo_ninja.api_key}}}catch{console.log("[VDO.ninja] Could not fetch API key from config")}return"preke-r58-2024-secure-key"}async function j(a={}){const s=await d();if(!s)return null;const o=P(),n=await w(),t=new URL(`${o}://${s}${n}/mixer.html`),e=a.room||h;t.searchParams.set("room",e),t.searchParams.set("director",e),t.searchParams.set("password",m);const c=await y();c&&t.searchParams.set("api",c),a.useMediamtx!==!1&&a.mediamtxHost&&t.searchParams.set("mediamtx",a.mediamtxHost),t.searchParams.set("totalroombitrate","6000"),t.searchParams.set("maxvideobitrate","2000");const i=b();i&&t.searchParams.set("b64css",i);const l=t.toString();return console.log(`[VDO.ninja] Mixer URL: room=${e}, director=${e}, password=${m.substring(0,4)}...`),l}async function v(){try{const{getFrpUrl:a}=await O(async()=>{const{getFrpUrl:o}=await import("./index-wGeF6xKQ.js").then(n=>n.ac);return{getFrpUrl:o}},__vite__mapDeps([0,1])),s=await a();if(s)try{const o=new URL(s);return o.hostname.includes("itagenten.no")?"app.itagenten.no":o.hostname.replace("api","mediamtx")}catch{console.warn("[VDO.ninja] Failed to construct MediaMTX host from FRP URL")}}catch{}return null}async function T(a){const{getDeviceUrl:s,getFallbackUrl:o,getFrpUrl:n}=await O(async()=>{const{getDeviceUrl:r,getFallbackUrl:f,getFrpUrl:U}=await import("./index-wGeF6xKQ.js").then(_=>_.ac);return{getDeviceUrl:r,getFallbackUrl:f,getFrpUrl:U}},__vite__mapDeps([0,1])),t=r=>`${r.replace(/\/+$/,"")}/${a}/whep`,e=r=>`http://${r}:8889/${a}/whep`,c=r=>{if(r==="localhost"||r==="127.0.0.1"||r.endsWith(".local")||r.startsWith("192.168.")||r.startsWith("10."))return!0;if(r.startsWith("172.")){const f=Number(r.split(".")[1]);return f>=16&&f<=31}return!1},i=r=>r.startsWith("100.")||r.endsWith(".ts.net"),l=s();if(l)try{const r=new URL(l);if(c(r.hostname))return console.log(`[VDO.ninja] Using LAN WHEP for ${a}`),e(r.hostname)}catch{}if(l)try{const r=new URL(l);if(i(r.hostname))return console.log(`[VDO.ninja] Using Tailscale WHEP for ${a}`),e(r.hostname)}catch{}const u=o();if(u)try{const r=new URL(u);if(i(r.hostname))return console.log(`[VDO.ninja] Using Tailscale fallback WHEP for ${a}`),e(r.hostname)}catch{}const p=await n();if(p)try{const r=new URL(p);return r.hostname.includes("itagenten.no")?`https://app.itagenten.no/${a}/whep`:t(r.toString())}catch{console.warn("[VDO.ninja] Failed to construct MediaMTX WHEP URL")}if(l)try{const r=new URL(l);if(r.hostname.includes("itagenten.no"))return console.log(`[VDO.ninja] Using device URL as WHEP proxy for ${a}`),`https://app.itagenten.no/${a}/whep`;if(!c(r.hostname)&&!i(r.hostname))return console.log(`[VDO.ninja] Using public device URL for ${a}`),t(r.toString())}catch{}return console.log(`[VDO.ninja] Using hardcoded app.itagenten.no for ${a}`),`https://app.itagenten.no/${a}/whep`}async function D(a,s={}){const o=await d();if(!o)return null;const n=P(),t=await w(),e=new URL(`${n}://${o}${t}/`);a===0?e.searchParams.set("scene",""):e.searchParams.set("scene",a.toString()),e.searchParams.set("room",s.room||h),e.searchParams.set("password",m),e.searchParams.set("cover",""),e.searchParams.set("cleanoutput",""),e.searchParams.set("hideheader",""),e.searchParams.set("nologo",""),e.searchParams.set("quality",(s.quality??2).toString()),s.muted&&e.searchParams.set("muted","");const c=b();return c&&e.searchParams.set("b64css",c),e.toString()}async function $(a=0,s){return D(a,{muted:!1,quality:2,room:s})}async function H(a=1){const s=await $(a);if(!s)return console.warn("[VDO.ninja] Cannot open popup - VDO.ninja not configured"),null;const n=window.open(s,"R58_Program_Output","width=1280,height=720,menubar=no,toolbar=no,location=no,status=no");return n||console.warn("[VDO.ninja] Popup blocked - please allow popups for this site"),n}export{h as V,x as a,L as b,D as c,T as d,R as e,m as f,d as g,v as h,j as i,P as j,H as o};
