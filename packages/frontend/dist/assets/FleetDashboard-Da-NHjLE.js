import{d as S,r as x,j as w,o as $,l as B,c as n,a as t,e as d,F as C,y as M,w as H,A as I,t as a,H as N,n as c,x as D,g as V,i as o,_ as z}from"./index-CJUIpyp7.js";const A={class:"fleet-dashboard"},E={class:"flex items-center justify-between mb-6"},U={class:"flex items-center gap-3"},P=["disabled"],q={key:0},G={key:1},J={class:"grid grid-cols-5 gap-4 mb-6"},K=["onClick"],Q={class:"flex items-center gap-2"},O={class:"text-sm text-r58-text-secondary capitalize"},W={class:"text-2xl font-semibold text-r58-text-primary mt-1"},X={class:"flex items-center gap-4 mb-6"},Y={class:"flex-1 relative"},Z={key:0,class:"p-4 bg-r58-accent-danger/20 border border-r58-accent-danger rounded-r58 text-r58-accent-danger mb-6"},tt={key:1,class:"text-center py-12"},et={key:2,class:"text-center py-12"},st={class:"text-r58-text-secondary"},rt={key:3,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},nt=["onClick"],ot={class:"flex items-start justify-between mb-3"},at={class:"font-medium text-r58-text-primary group-hover:text-r58-accent-primary transition-colors"},it={class:"text-sm text-r58-text-secondary font-mono"},lt={class:"flex items-center gap-2"},ct={key:0,class:"badge badge-warning"},dt={class:"flex items-center gap-2 text-sm text-r58-text-secondary mb-3"},ut={key:0,class:"text-r58-accent-warning"},xt={key:0,class:"grid grid-cols-4 gap-2 text-center"},mt={class:"p-2 bg-r58-bg-tertiary rounded"},gt={class:"p-2 bg-r58-bg-tertiary rounded"},pt={class:"p-2 bg-r58-bg-tertiary rounded"},ft={class:"p-2 bg-r58-bg-tertiary rounded"},_t={key:1,class:"flex items-center gap-2 mt-3"},vt={key:0,class:"badge badge-danger flex items-center gap-1"},yt={key:1,class:"badge badge-success"},bt={class:"flex items-center justify-between mt-3 pt-3 border-t border-r58-bg-tertiary text-xs text-r58-text-secondary"},ht={key:0},kt={key:1},wt=S({__name:"FleetDashboard",setup(Ct){const F=V(),p=x([]),f=x(!0),_=x(null),m=x(""),g=x(""),v=x(null),h=w(()=>{let r=p.value;if(g.value&&(r=r.filter(s=>s.status===g.value)),m.value){const s=m.value.toLowerCase();r=r.filter(e=>{var i;return e.device_id.toLowerCase().includes(s)||e.name.toLowerCase().includes(s)||((i=e.location)==null?void 0:i.toLowerCase().includes(s))})}return r}),j=w(()=>{const r={online:0,offline:0,updating:0,error:0,maintenance:0};return p.value.forEach(s=>{s.status in r&&r[s.status]++}),r});async function y(){var r;try{const s=await((r=N.fleet)==null?void 0:r.devices())||{items:[]};p.value=s.items||[],_.value=null}catch(s){_.value="Failed to load devices",console.error("Fleet fetch error:",s)}finally{f.value=!1}}function k(r){return{online:"bg-r58-accent-success",offline:"bg-r58-text-muted",updating:"bg-r58-accent-warning",error:"bg-r58-accent-danger",maintenance:"bg-r58-accent-primary"}[r]||"bg-r58-text-muted"}function L(r){return{online:"text-r58-accent-success",offline:"text-r58-text-muted",updating:"text-r58-accent-warning",error:"text-r58-accent-danger",maintenance:"text-r58-accent-primary"}[r]||"text-r58-text-muted"}function T(r){if(!r)return"Never";const s=new Date(r),i=new Date().getTime()-s.getTime(),l=Math.floor(i/6e4);if(l<1)return"Just now";if(l<60)return`${l}m ago`;const u=Math.floor(l/60);return u<24?`${u}h ago`:`${Math.floor(u/24)}d ago`}function R(r){F.push(`/fleet/devices/${r}`)}return $(()=>{y(),v.value=window.setInterval(y,3e4)}),B(()=>{v.value&&clearInterval(v.value)}),(r,s)=>(o(),n("div",A,[t("div",E,[s[2]||(s[2]=t("div",null,[t("h1",{class:"text-2xl font-semibold text-r58-text-primary"},"Fleet Dashboard"),t("p",{class:"text-sm text-r58-text-secondary mt-1"},"Manage and monitor all R58 devices")],-1)),t("div",U,[t("button",{onClick:y,class:"btn",disabled:f.value},[f.value?(o(),n("span",q,"Refreshing...")):(o(),n("span",G,"Refresh"))],8,P),s[1]||(s[1]=t("button",{class:"btn btn-success"}," + Add Device ",-1))])]),t("div",J,[(o(!0),n(C,null,M(j.value,(e,i)=>(o(),n("button",{key:i,onClick:l=>g.value=g.value===i?"":i,class:c(["p-4 rounded-r58 border transition-colors",g.value===i?"bg-r58-bg-tertiary border-r58-accent-primary":"bg-r58-bg-secondary border-r58-bg-tertiary hover:border-r58-text-secondary"])},[t("div",Q,[t("div",{class:c(["w-2 h-2 rounded-full",k(i)])},null,2),t("span",O,a(i),1)]),t("div",W,a(e),1)],10,K))),128))]),t("div",X,[t("div",Y,[H(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>m.value=e),type:"text",placeholder:"Search devices...",class:"input w-full pl-10"},null,512),[[I,m.value]]),s[3]||(s[3]=t("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-r58-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),_.value?(o(),n("div",Z,a(_.value),1)):d("",!0),f.value&&p.value.length===0?(o(),n("div",tt,[...s[4]||(s[4]=[t("div",{class:"animate-spin w-8 h-8 border-2 border-r58-bg-tertiary border-t-r58-accent-primary rounded-full mx-auto"},null,-1),t("p",{class:"text-r58-text-secondary mt-4"},"Loading devices...",-1)])])):h.value.length===0?(o(),n("div",et,[s[5]||(s[5]=t("div",{class:"w-16 h-16 bg-r58-bg-secondary rounded-full flex items-center justify-center mx-auto mb-4"},[t("svg",{class:"w-8 h-8 text-r58-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2z"})])],-1)),s[6]||(s[6]=t("h3",{class:"text-lg font-medium text-r58-text-primary mb-2"},"No devices found",-1)),t("p",st,a(m.value?"Try adjusting your search or filters":"Register your first device to get started"),1)])):(o(),n("div",rt,[(o(!0),n(C,null,M(h.value,e=>{var i,l,u,b;return o(),n("div",{key:e.id,onClick:Mt=>R(e.device_id),class:"card hover:border-r58-text-secondary cursor-pointer transition-all group"},[t("div",ot,[t("div",null,[t("h3",at,a(e.name),1),t("p",it,a(e.device_id),1)]),t("div",lt,[e.pending_commands&&e.pending_commands>0?(o(),n("span",ct,a(e.pending_commands)+" pending ",1)):d("",!0),t("span",{class:c(["flex items-center gap-1 text-xs",L(e.status)])},[t("span",{class:c(["w-1.5 h-1.5 rounded-full",k(e.status)])},null,2),D(" "+a(e.status),1)],2)])]),t("div",dt,[t("span",null,"v"+a(e.current_version||"unknown"),1),e.target_version?(o(),n("span",ut," → v"+a(e.target_version),1)):d("",!0)]),e.status==="online"?(o(),n("div",xt,[t("div",mt,[s[7]||(s[7]=t("div",{class:"text-xs text-r58-text-secondary"},"CPU",-1)),t("div",{class:c(["text-sm font-medium",e.cpu_percent&&e.cpu_percent>80?"text-r58-accent-danger":"text-r58-text-primary"])},a(((i=e.cpu_percent)==null?void 0:i.toFixed(0))||"-")+"% ",3)]),t("div",gt,[s[8]||(s[8]=t("div",{class:"text-xs text-r58-text-secondary"},"MEM",-1)),t("div",{class:c(["text-sm font-medium",e.mem_percent&&e.mem_percent>80?"text-r58-accent-danger":"text-r58-text-primary"])},a(((l=e.mem_percent)==null?void 0:l.toFixed(0))||"-")+"% ",3)]),t("div",pt,[s[9]||(s[9]=t("div",{class:"text-xs text-r58-text-secondary"},"DISK",-1)),t("div",{class:c(["text-sm font-medium",e.disk_free_gb&&e.disk_free_gb<2?"text-r58-accent-danger":"text-r58-text-primary"])},a(((u=e.disk_free_gb)==null?void 0:u.toFixed(1))||"-")+"G ",3)]),t("div",ft,[s[10]||(s[10]=t("div",{class:"text-xs text-r58-text-secondary"},"TEMP",-1)),t("div",{class:c(["text-sm font-medium",e.temperature_c&&e.temperature_c>70?"text-r58-accent-danger":"text-r58-text-primary"])},a(((b=e.temperature_c)==null?void 0:b.toFixed(0))||"-")+"° ",3)])])):d("",!0),e.recording_active||e.mixer_active?(o(),n("div",_t,[e.recording_active?(o(),n("span",vt,[...s[11]||(s[11]=[t("span",{class:"w-1.5 h-1.5 bg-current rounded-full animate-pulse"},null,-1),D(" Recording ",-1)])])):d("",!0),e.mixer_active?(o(),n("span",yt," Mixer Active ")):d("",!0)])):d("",!0),t("div",bt,[e.location?(o(),n("span",ht,a(e.location),1)):(o(),n("span",kt,"-")),t("span",null,a(T(e.last_heartbeat)),1)])],8,nt)}),128))]))]))}}),Ft=z(wt,[["__scopeId","data-v-a065406c"]]);export{Ft as default};
