import{d as H,k as z,a6 as R,r as d,m as q,J as m,c as s,b as e,e as u,s as G,i as J,y as B,t as n,F as O,z as W,q as j,B as D,a as K,o as a,_ as Q}from"./index-Dkkjpo3l.js";const X={class:"min-h-screen bg-preke-bg-base p-4"},Y={class:"max-w-6xl mx-auto mb-6"},Z={key:0,class:"max-w-6xl mx-auto"},ee={key:1,class:"max-w-6xl mx-auto"},te={class:"alert-v2 alert-v2--danger"},se={key:2,class:"max-w-6xl mx-auto space-y-6"},ae={class:"flex items-center gap-4"},le={key:0,class:"badge-v2 badge-v2--success"},oe={key:1,class:"badge-v2 badge-v2--info"},ne={class:"glass-card"},ie={class:"flex items-start gap-6"},re={key:0,class:"flex-shrink-0"},de=["src","alt"],ue={class:"flex-1"},ce={class:"text-2xl font-bold mb-2"},ve={class:"grid grid-cols-2 gap-4 mt-4"},pe={class:"text-preke-text-primary font-medium"},me={class:"text-preke-text-primary font-medium"},be={key:0},ge={class:"text-preke-text-primary font-medium"},xe={key:0,class:"text-preke-text-muted text-sm"},ke={key:1},_e={class:"text-preke-text-primary font-medium"},fe={key:0,class:"mt-4 text-preke-text-dim"},ye={key:0,class:"glass-card"},he={class:"text-xl font-semibold mb-4"},we={class:"grid grid-cols-3 gap-4"},Ce=["src","alt"],Se={class:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center"},Be={class:"text-white text-sm px-2 text-center"},Me={key:1,class:"glass-card"},Te={class:"grid grid-cols-2 gap-4"},Ae={class:"bg-preke-bg-elevated p-4 rounded-lg"},ze={class:"text-xs text-preke-text-muted mb-2 break-all"},Le={class:"bg-preke-bg-elevated p-4 rounded-lg"},Ue={class:"text-xs text-preke-text-muted mb-2 break-all"},Ve={key:2,class:"glass-card"},je={class:"text-xl font-semibold mb-4"},De={key:0,class:"space-y-4"},Fe=["disabled"],$e={key:0},Ne={key:1},Pe={class:"block text-sm font-medium text-preke-text-dim mb-2"},Ie={class:"flex items-center gap-4"},Ee=["disabled"],He={key:0},Re={key:1},qe={key:1,class:"space-y-4"},Ge={key:2,class:"alert-v2 alert-v2--info"},Je={class:"glass-card"},Oe={class:"flex gap-4"},We=["disabled"],Ke={key:0,class:"flex items-center justify-center gap-2"},Qe={key:1},Xe=["disabled"],Ye={key:0,class:"flex items-center justify-center gap-2"},Ze={key:1},et=H({__name:"BookingView",setup(tt){const F=R(),$=J(),_=z(()=>parseInt(F.params.appointmentId)),l=d(null),f=d([]),M=d(!0),c=d(null),y=d(!1),h=d(!1),v=d(!1),r=d(""),b=d("podcast"),w=d(""),g=d(50),C=d(!1),S=d(!1);q(async()=>{await T()});async function T(){var o,t,x;M.value=!0,c.value=null;try{const p=await m.wordpress.getAppointment(_.value);l.value=p.booking,f.value=p.graphics||[];const i=await m.wordpress.getCurrentBooking();if(i.active&&((o=i.booking)==null?void 0:o.id)===_.value){v.value=!0;const A=(x=(t=i.booking)==null?void 0:t.message)==null?void 0:x.match(/Access token: (\S+)/);if(A){r.value=A[1];try{const k=await m.wordpress.getCustomerStatus(A[1]);b.value=k.display_mode||"podcast",w.value=k.teleprompter_script||"",g.value=k.teleprompter_scroll_speed||50}catch(k){console.error("Failed to load display mode:",k)}}}}catch(p){c.value=p.message||"Failed to load booking"}finally{M.value=!1}}async function N(){y.value=!0,c.value=null;try{const o=await m.wordpress.activateBooking(_.value,!0);v.value=!0;const t=o.message.match(/Access token: (\S+)/);t&&(r.value=t[1]),await T()}catch(o){c.value=o.message||"Failed to activate booking"}finally{y.value=!1}}async function P(){if(confirm("Complete this booking and upload recordings?")){h.value=!0,c.value=null;try{await m.wordpress.completeBooking(_.value,!0),v.value=!1,r.value="",await T()}catch(o){c.value=o.message||"Failed to complete booking"}finally{h.value=!1}}}const L=z(()=>r.value?`${window.location.origin}/#/customer/${r.value}`:""),U=z(()=>r.value?`${window.location.origin}/#/studio-display/${r.value}`:"");function V(o){navigator.clipboard.writeText(o)}async function I(){if(r.value){C.value=!0;try{await m.wordpress.updateTeleprompterScript(r.value,w.value)}catch(o){c.value=o.message||"Failed to save script"}finally{C.value=!1}}}async function E(){if(r.value){S.value=!0;try{await m.wordpress.setTeleprompterSpeed(r.value,g.value)}catch(o){c.value=o.message||"Failed to save speed"}finally{S.value=!1}}}return(o,t)=>{var x,p;return a(),s("div",X,[e("div",Y,[e("button",{onClick:t[0]||(t[0]=i=>G($).back()),class:"btn-v2 btn-v2--ghost mb-4"},[...t[5]||(t[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),e("span",{class:"ml-2"},"Back",-1)])]),t[6]||(t[6]=e("h1",{class:"text-3xl font-bold"},"Booking Details",-1))]),M.value?(a(),s("div",Z,[...t[7]||(t[7]=[e("div",{class:"glass-card text-center py-12"},[e("div",{class:"animate-spin w-8 h-8 border-4 border-preke-gold border-t-transparent rounded-full mx-auto mb-4"}),e("p",{class:"text-preke-text-dim"},"Loading booking...")],-1)])])):c.value?(a(),s("div",ee,[e("div",te,[t[8]||(t[8]=e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"})],-1)),B(" "+n(c.value),1)])])):l.value?(a(),s("div",se,[e("div",ae,[v.value?(a(),s("span",le,"Active Session")):(a(),s("span",oe,n(l.value.status),1))]),e("div",ne,[e("div",ie,[(x=l.value.client)!=null&&x.logo_url?(a(),s("div",re,[e("img",{src:l.value.client.logo_url,alt:l.value.client.name,class:"w-24 h-24 object-contain rounded-lg bg-preke-bg-elevated p-2"},null,8,de)])):u("",!0),e("div",ue,[e("h2",ce,n(((p=l.value.client)==null?void 0:p.name)||"Unknown Client"),1),e("div",ve,[e("div",null,[t[9]||(t[9]=e("p",{class:"text-preke-text-subtle text-sm"},"Date",-1)),e("p",pe,n(l.value.date),1)]),e("div",null,[t[10]||(t[10]=e("p",{class:"text-preke-text-subtle text-sm"},"Time",-1)),e("p",me,n(l.value.slot_start)+" - "+n(l.value.slot_end),1)]),l.value.customer?(a(),s("div",be,[t[11]||(t[11]=e("p",{class:"text-preke-text-subtle text-sm"},"Customer",-1)),e("p",ge,n(l.value.customer.name),1),l.value.customer.email?(a(),s("p",xe,n(l.value.customer.email),1)):u("",!0)])):u("",!0),l.value.service_name?(a(),s("div",ke,[t[12]||(t[12]=e("p",{class:"text-preke-text-subtle text-sm"},"Service",-1)),e("p",_e,n(l.value.service_name),1)])):u("",!0)]),l.value.notes?(a(),s("p",fe,[t[13]||(t[13]=e("strong",null,"Notes:",-1)),B(" "+n(l.value.notes),1)])):u("",!0)])])]),f.value.length>0?(a(),s("div",ye,[e("h3",he,"Project Graphics ("+n(f.value.length)+")",1),e("div",we,[(a(!0),s(O,null,W(f.value,i=>(a(),s("div",{key:i.id,class:"relative group"},[e("img",{src:i.url,alt:i.filename,class:"w-full h-32 object-cover rounded-lg"},null,8,Ce),e("div",Se,[e("p",Be,n(i.filename),1)])]))),128))])])):u("",!0),v.value&&r.value?(a(),s("div",Me,[t[16]||(t[16]=e("h3",{class:"text-xl font-semibold mb-4"},"Access Links",-1)),e("div",Te,[e("div",null,[t[14]||(t[14]=e("p",{class:"text-preke-text-dim text-sm mb-2"},"Customer Portal (Phone)",-1)),e("div",Ae,[e("p",ze,n(L.value),1),e("button",{onClick:t[1]||(t[1]=i=>V(L.value)),class:"btn-v2 btn-v2--glass btn-sm w-full"}," Copy Link ")])]),e("div",null,[t[15]||(t[15]=e("p",{class:"text-preke-text-dim text-sm mb-2"},"Studio Display (TV)",-1)),e("div",Le,[e("p",Ue,n(U.value),1),e("button",{onClick:t[2]||(t[2]=i=>V(U.value)),class:"btn-v2 btn-v2--glass btn-sm w-full"}," Copy Link ")])])])])):u("",!0),v.value&&r.value?(a(),s("div",Ve,[e("h3",je,"Display Mode: "+n(b.value),1),b.value==="teleprompter"?(a(),s("div",De,[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-preke-text-dim mb-2"},"Teleprompter Script",-1)),j(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=i=>w.value=i),rows:"8",class:"w-full px-4 py-3 bg-preke-bg-elevated border border-preke-border rounded-lg text-preke-text-primary focus:outline-none focus:ring-2 focus:ring-preke-gold resize-none",placeholder:"Enter script text here..."},null,512),[[D,w.value]]),e("button",{onClick:I,disabled:C.value,class:"btn-v2 btn-v2--primary mt-2"},[C.value?(a(),s("span",$e,"Saving...")):(a(),s("span",Ne,"Save Script"))],8,Fe)]),e("div",null,[e("label",Pe," Scroll Speed: "+n(g.value)+"% ",1),e("div",Ie,[j(e("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>g.value=i),type:"range",min:"1",max:"100",class:"flex-1"},null,512),[[D,g.value,void 0,{number:!0}]]),e("button",{onClick:E,disabled:S.value,class:"btn-v2 btn-v2--glass btn-sm"},[S.value?(a(),s("span",He,"Saving...")):(a(),s("span",Re,"Save"))],8,Ee)])])])):b.value==="webinar"?(a(),s("div",qe,[...t[18]||(t[18]=[K('<div class="alert-v2 alert-v2--info" data-v-b36902cb><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" data-v-b36902cb><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" data-v-b36902cb></path></svg><div data-v-b36902cb><p class="font-medium" data-v-b36902cb>Webinar Mode Active</p><p class="text-sm text-preke-text-muted" data-v-b36902cb>VDO.ninja is running at vdo.itagenten.no</p><p class="text-sm text-preke-text-muted mt-1" data-v-b36902cb>Layout controls are available on the customer portal and studio display.</p></div></div>',1)])])):b.value==="podcast"?(a(),s("div",Ge,[...t[19]||(t[19]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"})],-1),e("div",null,[e("p",{class:"font-medium"},"Podcast Mode Active"),e("p",{class:"text-sm text-preke-text-muted"},"Multi-camera setup with presentation graphics.")],-1)])])):u("",!0)])):u("",!0),e("div",Je,[e("div",Oe,[v.value?u("",!0):(a(),s("button",{key:0,onClick:N,disabled:y.value,class:"btn-v2 btn-v2--primary flex-1"},[y.value?(a(),s("span",Ke,[...t[20]||(t[20]=[e("span",{class:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"},null,-1),B(" Activating... ",-1)])])):(a(),s("span",Qe,"Activate Booking"))],8,We)),v.value?(a(),s("button",{key:1,onClick:P,disabled:h.value,class:"btn-v2 btn-v2--success flex-1"},[h.value?(a(),s("span",Ye,[...t[21]||(t[21]=[e("span",{class:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"},null,-1),B(" Completing... ",-1)])])):(a(),s("span",Ze,"Complete & Upload"))],8,Xe)):u("",!0)])])])):u("",!0)])}}}),at=Q(et,[["__scopeId","data-v-b36902cb"]]);export{at as default};
