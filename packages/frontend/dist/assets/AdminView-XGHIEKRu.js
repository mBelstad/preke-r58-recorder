const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CssX6Kh2.js","assets/index-fAvVKNv8.css"])))=>i.map(i=>d[i]);
import{J as ie,r as h,h as N,f as z,d as L,N as re,j as H,k as oe,c as a,a as e,I as d,t as v,b as M,n as R,p as q,F as V,q as T,e as de,o as s,_ as ce,B as Y,w as U,O as Z,P as ue,Q as le,y as ee,R as te,i as ve,x as G,S as pe,E as K,l as se}from"./index-CssX6Kh2.js";import{V as ae,g as me}from"./vdoninja-D8mLQF_b.js";const fe={cam0:"HDMI 1",cam1:"HDMI 2",cam2:"HDMI 3",cam3:"HDMI 4"},be=ie("capabilities",()=>{const S=h(null),m=h(!1),o=h(null),u=N(()=>{var l;return((l=S.value)==null?void 0:l.mixer_available)??!1}),f=N(()=>{var l;return((l=S.value)==null?void 0:l.recorder_available)??!0}),b=N(()=>{var l,i;return((i=(l=S.value)==null?void 0:l.vdoninja)==null?void 0:i.enabled)??!0}),x=N(()=>{if(!S.value||!S.value.storage_total_gb)return 0;const l=S.value.storage_total_gb-S.value.storage_available_gb;return Math.round(l/S.value.storage_total_gb*100)});async function p(){var l,i;m.value=!0,o.value=null;try{const[j,w,t]=await Promise.all([fetch(z("/health")),fetch(z("/api/mode/status")),fetch(z("/api/ingest/status"))]),n=j.ok?await j.json():{},_=w.ok?await w.json():{},O=t.ok?await t.json():{cameras:{}},F=Object.entries(O.cameras||{}).map(([I,P])=>{var E;return{id:I,type:"hdmi",label:fe[I]||I,max_resolution:((E=P.resolution)==null?void 0:E.formatted)||"4K",supports_audio:!0,device_path:P.device||null,status:P.status||"unknown",has_signal:P.has_signal||!1}});S.value={device_id:"r58-device",device_name:"Preke R58",platform:n.platform||"R58",api_version:"2.0",mixer_available:((l=_.available_modes)==null?void 0:l.includes("mixer"))??!0,recorder_available:((i=_.available_modes)==null?void 0:i.includes("recorder"))??!0,graphics_available:!0,fleet_agent_connected:!1,inputs:F,codecs:[{id:"h264",name:"H.264",hardware_accelerated:!0,max_bitrate_kbps:5e4}],preview_modes:[{id:"whep",protocol:"WebRTC",latency_ms:100,url_template:"/{cam_id}/whep"}],vdoninja:{enabled:!0,host:"r58-vdo.itagenten.no",port:443,room:"studio"},mediamtx_base_url:"rtsp://127.0.0.1:8554",max_simultaneous_recordings:4,max_output_resolution:"4K",storage_total_gb:0,storage_available_gb:0,current_mode:_.current_mode||"recorder"},o.value=null}catch(j){o.value=j instanceof Error?j.message:"Unknown error",console.error("Failed to fetch capabilities:",j)}finally{m.value=!1}}return{capabilities:S,loading:m,error:o,mixerEnabled:u,recorderEnabled:f,vdoNinjaEnabled:b,storagePercent:x,fetchCapabilities:p}}),xe={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},ye={class:"card"},_e={key:0,class:"text-r58-accent-danger"},ge={key:1,class:"space-y-3"},he={class:"flex justify-between items-center"},we={key:0,class:"skeleton w-24 h-5"},ke={key:1,class:"font-medium"},$e={class:"flex justify-between items-center"},Se={key:0,class:"skeleton w-16 h-5"},je={key:1,class:"capitalize"},Ce={class:"flex justify-between items-center"},De={key:0,class:"skeleton w-12 h-5"},Re={key:1},Ae={class:"flex justify-between items-center"},Ne={key:0,class:"skeleton w-20 h-5"},Pe={key:1,class:"badge badge-success"},Me={class:"card"},Ve={class:"space-y-4"},Ie={class:"flex items-center justify-between"},Ee={key:0,class:"skeleton w-20 h-5 rounded-full"},Te={class:"flex gap-2"},Oe=["disabled"],Fe={key:0,class:"inline-block animate-spin mr-1"},Ue=["disabled"],Le={key:0,class:"inline-block animate-spin mr-1"},He={key:0,class:"text-sm text-r58-accent-danger"},Be={class:"card"},qe={class:"space-y-3"},ze={class:"flex justify-between items-center"},Ge={key:0,class:"skeleton w-20 h-5 rounded-full"},Ke={class:"flex justify-between items-center"},Je={key:0,class:"skeleton w-20 h-5 rounded-full"},We={class:"flex justify-between items-center"},Qe={key:0,class:"skeleton w-20 h-5 rounded-full"},Xe={key:1,class:"badge badge-success"},Ye={class:"flex justify-between items-center"},Ze={key:0,class:"skeleton w-20 h-5 rounded-full"},et={key:1,class:"badge badge-success"},tt={class:"card md:col-span-2 lg:col-span-3"},st={class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4"},at={class:"flex items-center justify-between mb-3"},nt={class:"flex items-center gap-2"},ot={class:"font-medium"},lt={class:"space-y-1 text-sm text-r58-text-secondary"},it={class:"flex justify-between"},rt={class:"text-r58-text-primary"},dt={class:"flex justify-between"},ct={class:"text-r58-text-primary"},ut={class:"flex justify-between"},vt={class:"text-r58-text-primary font-mono text-xs"},pt={key:0,class:"col-span-full text-center text-r58-text-secondary py-8"},mt=L({__name:"DeviceStatus",setup(S){const m=be(),{capabilities:o,loading:u,error:f}=re(m),b=h(!1),x=h(null);let p=null;async function l(w){if(!b.value){b.value=!0,x.value=null;try{const t=await fetch(z(`/api/mode/${w}`),{method:"POST"});if(!t.ok){const n=await t.json().catch(()=>({}));throw new Error(n.detail||`Failed to switch to ${w} mode`)}await m.fetchCapabilities()}catch(t){x.value=t instanceof Error?t.message:"Failed to switch mode",console.error("Mode switch error:",t)}finally{b.value=!1}}}function i(w,t){if(!t)return"bg-r58-text-secondary";switch(w){case"streaming":case"recording":return"bg-r58-accent-success";case"preview":return"bg-r58-accent-info";case"idle":return"bg-r58-text-secondary";case"error":return"bg-r58-accent-danger";default:return"bg-r58-text-secondary"}}function j(w,t){if(!t)return"No Signal";switch(w){case"streaming":return"Streaming";case"recording":return"Recording";case"preview":return"Preview";case"idle":return"Idle";case"error":return"Error";default:return w}}return H(()=>{m.fetchCapabilities(),p=setInterval(()=>{m.fetchCapabilities()},1e4)}),oe(()=>{p&&clearInterval(p)}),(w,t)=>{var n,_,O,F,I,P,E,c,r,y,$,C,D,A;return s(),a("div",xe,[e("div",ye,[t[6]||(t[6]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Device Info",-1)),d(f)&&!d(o)?(s(),a("div",_e,v(d(f)),1)):(s(),a("div",ge,[e("div",he,[t[2]||(t[2]=e("span",{class:"text-r58-text-secondary"},"Device Name",-1)),d(u)&&!d(o)?(s(),a("div",we)):(s(),a("span",ke,v(((n=d(o))==null?void 0:n.device_name)||"R58 Device"),1))]),e("div",$e,[t[3]||(t[3]=e("span",{class:"text-r58-text-secondary"},"Platform",-1)),d(u)&&!d(o)?(s(),a("div",Se)):(s(),a("span",je,v(((_=d(o))==null?void 0:_.platform)||"-"),1))]),e("div",Ce,[t[4]||(t[4]=e("span",{class:"text-r58-text-secondary"},"API Version",-1)),d(u)&&!d(o)?(s(),a("div",De)):(s(),a("span",Re,v(((O=d(o))==null?void 0:O.api_version)||"-"),1))]),e("div",Ae,[t[5]||(t[5]=e("span",{class:"text-r58-text-secondary"},"GStreamer",-1)),d(u)&&!d(o)?(s(),a("div",Ne)):(s(),a("span",Pe,"Initialized"))])]))]),e("div",Me,[t[10]||(t[10]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Operating Mode",-1)),e("div",Ve,[e("div",Ie,[t[7]||(t[7]=e("span",{class:"text-r58-text-secondary"},"Current Mode",-1)),d(u)&&!d(o)?(s(),a("div",Ee)):(s(),a("span",{key:1,class:R(["badge",((F=d(o))==null?void 0:F.current_mode)==="mixer"?"badge-info":"badge-success"])},v(((I=d(o))==null?void 0:I.current_mode)==="mixer"?"Mixer":"Recorder"),3))]),e("div",Te,[e("button",{class:R(["btn btn-sm flex-1",((P=d(o))==null?void 0:P.current_mode)==="recorder"?"btn-primary":"btn-secondary"]),disabled:b.value||((E=d(o))==null?void 0:E.current_mode)==="recorder"||d(u)&&!d(o),onClick:t[0]||(t[0]=g=>l("recorder"))},[b.value&&((c=d(o))==null?void 0:c.current_mode)!=="recorder"?(s(),a("span",Fe,"⟳")):M("",!0),t[8]||(t[8]=q(" Recorder ",-1))],10,Oe),e("button",{class:R(["btn btn-sm flex-1",((r=d(o))==null?void 0:r.current_mode)==="mixer"?"btn-primary":"btn-secondary"]),disabled:b.value||((y=d(o))==null?void 0:y.current_mode)==="mixer"||d(u)&&!d(o),onClick:t[1]||(t[1]=g=>l("mixer"))},[b.value&&(($=d(o))==null?void 0:$.current_mode)!=="mixer"?(s(),a("span",Le,"⟳")):M("",!0),t[9]||(t[9]=q(" Mixer ",-1))],10,Ue)]),x.value?(s(),a("div",He,v(x.value),1)):M("",!0)])]),e("div",Be,[t[15]||(t[15]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Available Features",-1)),e("div",qe,[e("div",ze,[t[11]||(t[11]=e("div",null,[e("span",null,"Mixer"),e("span",{class:"text-xs text-r58-text-secondary ml-1"},"(VDO.ninja)")],-1)),d(u)&&!d(o)?(s(),a("div",Ge)):(s(),a("span",{key:1,class:R(["badge",d(m).mixerEnabled?"badge-success":"badge-warning"])},v(d(m).mixerEnabled?"Available":"Disabled"),3))]),e("div",Ke,[t[12]||(t[12]=e("span",null,"Recorder",-1)),d(u)&&!d(o)?(s(),a("div",Je)):(s(),a("span",{key:1,class:R(["badge",d(m).recorderEnabled?"badge-success":"badge-warning"])},v(d(m).recorderEnabled?"Available":"Disabled"),3))]),e("div",We,[t[13]||(t[13]=e("span",null,"Graphics Overlay",-1)),d(u)&&!d(o)?(s(),a("div",Qe)):(s(),a("span",Xe,"Available"))]),e("div",Ye,[t[14]||(t[14]=e("span",null,"WebRTC Preview",-1)),d(u)&&!d(o)?(s(),a("div",Ze)):(s(),a("span",et,"Available"))])])]),e("div",tt,[t[20]||(t[20]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Hardware Inputs",-1)),e("div",st,[d(u)&&!d(o)?(s(),a(V,{key:0},T(4,g=>e("div",{key:g,class:"p-4 rounded-lg bg-r58-bg-tertiary border border-r58-border"},[...t[16]||(t[16]=[de('<div class="flex items-center justify-between mb-3" data-v-dc425660><div class="flex items-center gap-2" data-v-dc425660><div class="skeleton w-2 h-2 rounded-full" data-v-dc425660></div><div class="skeleton w-16 h-5" data-v-dc425660></div></div><div class="skeleton w-16 h-4 rounded-full" data-v-dc425660></div></div><div class="space-y-2" data-v-dc425660><div class="flex justify-between" data-v-dc425660><div class="skeleton w-8 h-4" data-v-dc425660></div><div class="skeleton w-12 h-4" data-v-dc425660></div></div><div class="flex justify-between" data-v-dc425660><div class="skeleton w-16 h-4" data-v-dc425660></div><div class="skeleton w-20 h-4" data-v-dc425660></div></div><div class="flex justify-between" data-v-dc425660><div class="skeleton w-10 h-4" data-v-dc425660></div><div class="skeleton w-14 h-4" data-v-dc425660></div></div></div>',2)])])),64)):(s(),a(V,{key:1},[(s(!0),a(V,null,T(((C=d(o))==null?void 0:C.inputs)||[],g=>{var B;return s(),a("div",{key:g.id,class:R(["p-4 rounded-lg bg-r58-bg-tertiary border border-r58-border",{"border-r58-accent-success/50":g.has_signal}])},[e("div",at,[e("div",nt,[e("span",{class:R(["w-2 h-2 rounded-full animate-pulse",i(g.status,g.has_signal)])},null,2),e("span",ot,v(g.label),1)]),e("span",{class:R(["text-xs px-2 py-0.5 rounded-full",{"bg-r58-accent-success/20 text-r58-accent-success":g.has_signal&&(g.status==="streaming"||g.status==="recording"),"bg-r58-accent-info/20 text-r58-accent-info":g.has_signal&&g.status==="preview","bg-r58-bg-tertiary text-r58-text-secondary":!g.has_signal||g.status==="idle"}])},v(j(g.status,g.has_signal)),3)]),e("div",lt,[e("div",it,[t[17]||(t[17]=e("span",null,"Type",-1)),e("span",rt,v(g.type.toUpperCase()),1)]),e("div",dt,[t[18]||(t[18]=e("span",null,"Resolution",-1)),e("span",ct,v(g.max_resolution||"N/A"),1)]),e("div",ut,[t[19]||(t[19]=e("span",null,"Device",-1)),e("span",vt,v(((B=g.device_path)==null?void 0:B.split("/").pop())||"N/A"),1)])])],2)}),128)),(A=(D=d(o))==null?void 0:D.inputs)!=null&&A.length?M("",!0):(s(),a("div",pt," No inputs detected "))],64))])])])}}}),ft=ce(mt,[["__scopeId","data-v-dc425660"]]),bt={class:"space-y-4"},xt={class:"flex items-center gap-4 flex-wrap"},yt=["value"],_t={class:"flex items-center gap-2 cursor-pointer"},gt=["disabled"],ht={key:0},wt={key:1},kt={class:"bg-r58-bg-primary rounded-lg p-4 font-mono text-sm text-r58-text-secondary h-[500px] overflow-auto whitespace-pre-wrap"},$t=L({__name:"LogViewer",props:{service:{}},setup(S){const m=S,o=h(""),u=h(!1),f=h(m.service||"r58-api"),b=h(100),x=h(!1),p=[{id:"r58-api",label:"R58 API"},{id:"r58-pipeline",label:"Pipeline Manager"},{id:"mediamtx",label:"MediaMTX"}];let l=null;async function i(){u.value=!0;try{const n=await(await fetch(`/api/v1/support/logs?service=${f.value}&lines=${b.value}`)).json();o.value=n.logs||""}catch(t){o.value=`Error fetching logs: ${t}`}finally{u.value=!1}}function j(){l&&clearInterval(l),l=window.setInterval(i,5e3)}function w(){l&&(clearInterval(l),l=null)}return Y(x,t=>{t?j():w()}),Y([f,b],()=>{i()}),H(()=>{i()}),(t,n)=>(s(),a("div",bt,[e("div",xt,[U(e("select",{"onUpdate:modelValue":n[0]||(n[0]=_=>f.value=_),class:"input"},[(s(),a(V,null,T(p,_=>e("option",{key:_.id,value:_.id},v(_.label),9,yt)),64))],512),[[Z,f.value]]),U(e("select",{"onUpdate:modelValue":n[1]||(n[1]=_=>b.value=_),class:"input"},[...n[3]||(n[3]=[e("option",{value:50},"50 lines",-1),e("option",{value:100},"100 lines",-1),e("option",{value:250},"250 lines",-1),e("option",{value:500},"500 lines",-1)])],512),[[Z,b.value]]),e("label",_t,[U(e("input",{type:"checkbox","onUpdate:modelValue":n[2]||(n[2]=_=>x.value=_),class:"w-4 h-4 rounded"},null,512),[[ue,x.value]]),n[4]||(n[4]=e("span",{class:"text-sm"},"Auto-refresh",-1))]),e("button",{onClick:i,disabled:u.value,class:"btn"},[u.value?(s(),a("span",ht,"Loading...")):(s(),a("span",wt,"Refresh"))],8,gt)]),e("pre",kt,v(o.value||"No logs available"),1)]))}}),St={class:"space-y-6"},jt={class:"flex items-center justify-between"},Ct=["disabled"],Dt={key:0},Rt={key:1},At={key:0,class:"flex items-center justify-center py-12"},Nt={key:1,class:"text-center py-12 text-r58-text-secondary"},Pt={key:2,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Mt=["onClick"],Vt={class:"flex items-start justify-between mb-4"},It={class:"font-semibold"},Et={class:"text-sm text-r58-text-secondary"},Tt={class:"space-y-2 text-sm"},Ot={class:"flex justify-between"},Ft={class:"font-mono"},Ut={class:"flex justify-between"},Lt=L({__name:"FleetOverview",setup(S){const m=h([]),o=h(!0),u=h(!1);async function f(){o.value=!0;try{const p=await fetch("/api/v1/lan-devices");if(p.ok){const l=await p.json();m.value=l.map(i=>({id:i.id,name:i.name,ip:i.ip,status:i.status,lastSeen:i.last_seen,version:i.api_version||"unknown"}))}}catch(p){console.error("Failed to fetch LAN devices:",p)}finally{o.value=!1}}H(f);async function b(){u.value=!0;try{const p=await fetch("/api/v1/lan-devices/scan",{method:"POST"});if(p.ok){const l=await p.json();for(const i of l)m.value.find(w=>w.id===i.id)||m.value.push({id:i.id,name:i.name,ip:i.ip,status:i.status,lastSeen:i.last_seen,version:i.api_version||"unknown"})}}catch(p){console.error("LAN network scan failed:",p)}finally{u.value=!1}}async function x(p){try{const i=await(await fetch(`/api/v1/lan-devices/${p.id}/connect`,{method:"POST"})).json();i.connected?window.open(`http://${p.ip}:8000`,"_blank"):alert(`Failed to connect: ${i.error||"Unknown error"}`)}catch(l){console.error("Failed to connect to device:",l)}}return(p,l)=>(s(),a("div",St,[e("div",jt,[l[0]||(l[0]=e("h2",{class:"text-lg font-semibold"},"LAN Devices",-1)),e("button",{onClick:b,disabled:u.value,class:"btn"},[u.value?(s(),a("span",Dt,"Scanning...")):(s(),a("span",Rt,"Scan Network"))],8,Ct)]),o.value?(s(),a("div",At,[...l[1]||(l[1]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full"},null,-1)])])):m.value.length===0?(s(),a("div",Nt,[...l[2]||(l[2]=[e("p",null,"No devices found",-1),e("p",{class:"text-sm mt-2"},'Click "Scan Network" to discover R58 devices',-1)])])):(s(),a("div",Pt,[(s(!0),a(V,null,T(m.value,i=>(s(),a("div",{key:i.id,class:"card hover:border-r58-accent-primary/50 transition-colors cursor-pointer",onClick:j=>x(i)},[e("div",Vt,[e("div",null,[e("h3",It,v(i.name),1),e("p",Et,v(i.id),1)]),e("span",{class:R(["badge",{"badge-success":i.status==="online","badge-danger":i.status==="offline","badge-warning":i.status==="unknown"}])},v(i.status),3)]),e("div",Tt,[e("div",Ot,[l[3]||(l[3]=e("span",{class:"text-r58-text-secondary"},"IP Address",-1)),e("span",Ft,v(i.ip),1)]),e("div",Ut,[l[4]||(l[4]=e("span",{class:"text-r58-text-secondary"},"Version",-1)),e("span",null,v(i.version),1)])])],8,Mt))),128))]))]))}}),Ht={class:"space-y-6"},Bt={key:0,class:"flex items-center justify-center py-12"},qt={key:1,class:"card bg-r58-accent-danger/10 border border-r58-accent-danger/30"},zt={class:"text-r58-accent-danger"},Gt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},Kt={class:"card"},Jt={key:0,class:"space-y-3"},Wt={class:"relative w-full h-4 bg-r58-bg-tertiary rounded-full overflow-hidden"},Qt={class:"flex justify-between text-sm"},Xt={class:"font-mono"},Yt={key:1,class:"flex items-center justify-center py-4"},Zt={class:"card"},es={key:0,class:"space-y-3"},ts={class:"relative w-full h-4 bg-r58-bg-tertiary rounded-full overflow-hidden"},ss={class:"flex justify-between text-sm"},as={key:1,class:"flex items-center justify-center py-4"},ns={class:"card"},os={class:"flex items-center justify-center py-2"},ls={key:1,class:"text-r58-text-secondary"},is={key:0,class:"text-center text-xs text-r58-text-secondary"},rs={class:"card"},ds={class:"flex items-center justify-center py-2"},cs={key:0,class:"text-3xl font-bold text-r58-accent-primary"},us={key:1,class:"text-r58-text-secondary"},vs={class:"text-center text-xs text-r58-text-secondary"},ps={class:"card"},ms={class:"flex items-center justify-between mb-4"},fs={class:"flex gap-2"},bs={class:"grid gap-3 sm:grid-cols-3"},xs={class:"flex items-center gap-3"},ys={class:"font-medium"},_s={class:"text-xs text-r58-text-secondary"},gs={key:0},hs={class:"card"},ws={class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},ks={class:"ml-2 text-r58-accent-primary"},$s={key:0,class:"text-center py-8 text-r58-text-secondary"},Ss={key:1,class:"space-y-2"},js={class:"flex items-center gap-4"},Cs={class:"font-mono text-sm"},Ds={class:"text-xs text-r58-text-secondary"},Rs={key:0},As={class:"flex items-center gap-3"},Ns=["onClick"],Ps=L({__name:"SystemMonitor",setup(S){const m=le(),o=h(!0),u=h(null),f=h(null),b=h(null),x=N(()=>{var y,$,C;const c=((C=($=(y=f.value)==null?void 0:y.info)==null?void 0:$.load_average)==null?void 0:C[0])??0;return Math.min(100,c/8*100)}),p=N(()=>{var r,y;const c=(y=(r=f.value)==null?void 0:r.info)==null?void 0:y.memory_percent;return c!==void 0?c:0}),l=N(()=>{var y,$;const c=(($=(y=f.value)==null?void 0:y.info)==null?void 0:$.temperatures)??[];return c.length===0?null:c.find(C=>{var D;return(D=C.type)==null?void 0:D.toLowerCase().includes("cpu")})??c[0]}),i=N(()=>{var C,D;const c=((D=(C=f.value)==null?void 0:C.info)==null?void 0:D.uptime_seconds)??0,r=Math.floor(c/86400),y=Math.floor(c%86400/3600),$=Math.floor(c%3600/60);return r>0?`${r}d ${y}h`:y>0?`${y}h ${$}m`:`${$}m`}),j=N(()=>{var c;return((c=f.value)==null?void 0:c.services)??[]}),w=N(()=>{var c;return((c=f.value)==null?void 0:c.pipelines)??[]});async function t(){try{const{buildApiUrl:c}=await te(async()=>{const{buildApiUrl:D}=await import("./index-CssX6Kh2.js").then(A=>A.V);return{buildApiUrl:D}},__vite__mapDeps([0,1])),r=await fetch(c("/health"));if(!r.ok)throw new Error("Failed to fetch status");const y=await r.json(),$=await fetch(c("/api/ingest/status")),C=$.ok?await $.json():{cameras:{}};f.value={info:{hostname:"R58 Device",platform:y.platform||"R58",gstreamer:y.gstreamer,load_average:[0,0,0],memory_percent:0,uptime_seconds:0,temperatures:[]},services:[{name:"r58-recorder",active:y.status==="healthy",status:y.status},{name:"mediamtx",active:!0,status:"running"},{name:"vdo.ninja",active:!0,status:"running",note:"r58-vdo.itagenten.no"}],pipelines:Object.entries(C.cameras||{}).map(([D,A])=>({pipeline_id:D,pipeline_type:"ingest",device:A.device,state:A.status==="streaming"?"running":A.status}))},u.value=null}catch(c){u.value=c.message,console.error("Failed to fetch system status:",c)}finally{o.value=!1}}async function n(c){m.info("Service restart not available in this version")}async function _(){m.info("Device reboot not available in this version")}async function O(c){try{const{buildApiUrl:r}=await te(async()=>{const{buildApiUrl:C}=await import("./index-CssX6Kh2.js").then(D=>D.V);return{buildApiUrl:C}},__vite__mapDeps([0,1])),y=await fetch(r(`/api/ingest/stop/${c}`),{method:"POST"}),$=await y.json();y.ok?(m.success(`Stopped pipeline: ${c}`),await t()):m.error($.detail||"Stop failed")}catch(r){m.error(`Stop failed: ${r.message}`)}}function F(c){return c.active?"bg-r58-accent-success":"bg-r58-accent-danger"}function I(c){switch(c){case"running":return"text-r58-accent-success";case"starting":return"text-r58-accent-warning";case"stopping":return"text-r58-accent-warning";default:return"text-r58-text-secondary"}}function P(c){return c>90?"bg-r58-accent-danger":c>70?"bg-r58-accent-warning":"bg-r58-accent-success"}function E(c){return c>80?"text-r58-accent-danger":c>65?"text-r58-accent-warning":"text-r58-accent-success"}return H(()=>{t(),b.value=window.setInterval(t,1e4)}),oe(()=>{b.value&&clearInterval(b.value)}),(c,r)=>{var y,$,C,D,A,g,B,J,W,Q,X;return s(),a("div",Ht,[o.value?(s(),a("div",Bt,[...r[1]||(r[1]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full"},null,-1)])])):u.value?(s(),a("div",qt,[e("p",zt,"Error loading system status: "+v(u.value),1),e("button",{onClick:t,class:"btn btn-secondary mt-4"},"Retry")])):(s(),a(V,{key:2},[e("div",Gt,[e("div",Kt,[r[4]||(r[4]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"CPU Load",-1)),(C=($=(y=f.value)==null?void 0:y.info)==null?void 0:$.load_average)!=null&&C.some(k=>k>0)?(s(),a("div",Jt,[e("div",Wt,[e("div",{class:R(["absolute left-0 top-0 h-full rounded-full transition-all duration-500",P(x.value)]),style:ee({width:`${x.value}%`})},null,6)]),e("div",Qt,[r[2]||(r[2]=e("span",{class:"text-r58-text-secondary"},"Load Average",-1)),e("span",Xt,v((g=(A=(D=f.value)==null?void 0:D.info)==null?void 0:A.load_average)==null?void 0:g.map(k=>k.toFixed(2)).join(" / ")),1)])])):(s(),a("div",Yt,[...r[3]||(r[3]=[e("span",{class:"text-r58-text-secondary"},"N/A",-1)])]))]),e("div",Zt,[r[7]||(r[7]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Memory",-1)),p.value>0?(s(),a("div",es,[e("div",ts,[e("div",{class:R(["absolute left-0 top-0 h-full rounded-full transition-all duration-500",P(p.value)]),style:ee({width:`${p.value}%`})},null,6)]),e("div",ss,[r[5]||(r[5]=e("span",{class:"text-r58-text-secondary"},"Used",-1)),e("span",null,v(p.value.toFixed(1))+"%",1)])])):(s(),a("div",as,[...r[6]||(r[6]=[e("span",{class:"text-r58-text-secondary"},"N/A",-1)])]))]),e("div",ns,[r[8]||(r[8]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Temperature",-1)),e("div",os,[l.value?(s(),a("span",{key:0,class:R(["text-3xl font-bold",E(l.value.temp_celsius)])},v(l.value.temp_celsius.toFixed(1))+"°C ",3)):(s(),a("span",ls,"N/A"))]),(B=l.value)!=null&&B.type?(s(),a("p",is,v(l.value.type),1)):M("",!0)]),e("div",rs,[r[9]||(r[9]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Uptime",-1)),e("div",ds,[((W=(J=f.value)==null?void 0:J.info)==null?void 0:W.uptime_seconds)>0?(s(),a("span",cs,v(i.value),1)):(s(),a("span",us,"N/A"))]),e("p",vs,v(((X=(Q=f.value)==null?void 0:Q.info)==null?void 0:X.hostname)||"R58 Device"),1)])]),e("div",ps,[e("div",ms,[r[10]||(r[10]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide"},"Services",-1)),e("div",fs,[e("button",{onClick:r[0]||(r[0]=k=>n()),class:"btn btn-sm btn-secondary opacity-50 cursor-not-allowed",disabled:"",title:"Requires SSH access to device"}," Restart All "),e("button",{onClick:_,class:"btn btn-sm btn-danger opacity-50 cursor-not-allowed",disabled:"",title:"Requires SSH access to device"}," Reboot Device ")])]),e("div",bs,[(s(!0),a(V,null,T(j.value,k=>(s(),a("div",{key:k.name,class:"flex items-center justify-between p-3 rounded-lg bg-r58-bg-tertiary"},[e("div",xs,[e("span",{class:R(["w-2.5 h-2.5 rounded-full",F(k)])},null,2),e("div",null,[e("p",ys,v(k.name),1),e("p",_s,[q(v(k.status)+" ",1),k.memory_mb?(s(),a("span",gs," · "+v(k.memory_mb.toFixed(0))+" MB",1)):M("",!0)])])]),r[11]||(r[11]=e("button",{class:"text-r58-text-secondary opacity-50 cursor-not-allowed",disabled:"",title:"Requires SSH access"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})])],-1))]))),128))])]),e("div",hs,[e("h3",ws,[r[12]||(r[12]=q(" Active Pipelines ",-1)),e("span",ks,"("+v(w.value.length)+")",1)]),w.value.length===0?(s(),a("div",$s," No active pipelines ")):(s(),a("div",Ss,[(s(!0),a(V,null,T(w.value,k=>(s(),a("div",{key:k.pipeline_id,class:"flex items-center justify-between p-3 rounded-lg bg-r58-bg-tertiary"},[e("div",js,[e("div",null,[e("p",Cs,v(k.pipeline_id),1),e("p",Ds,[q(" Type: "+v(k.pipeline_type)+" ",1),k.device?(s(),a("span",Rs," · "+v(k.device),1)):M("",!0)])])]),e("div",As,[e("span",{class:R(["text-sm font-medium capitalize",I(k.state)])},v(k.state),3),k.state==="running"?(s(),a("button",{key:0,onClick:ta=>O(k.pipeline_id),class:"btn btn-sm btn-danger",title:"Stop pipeline"}," Stop ",8,Ns)):M("",!0)])]))),128))]))])],64))])}}}),Ms={class:"space-y-6"},Vs={class:"card"},Is={class:"space-y-4"},Es={class:"card"},Ts={class:"space-y-4"},Os=["value"],Fs={class:"card"},Us={class:"space-y-4"},Ls=["value"],Hs={class:"flex items-center justify-between"},Bs={key:0},qs={class:"card bg-r58-bg-tertiary/50"},zs={class:"space-y-2 text-sm"},Gs={class:"flex justify-between"},ne="preke-settings",Ks=L({__name:"SettingsPanel",setup(S){const m=le(),o=h("Preke Device"),u=h(ae),f=h(me()),b=h("/recordings"),x=h(!1),p=h(30),l=N(()=>ve());function i(){try{const t=localStorage.getItem(ne);if(t){const n=JSON.parse(t);o.value=n.deviceName||o.value,u.value=n.vdoRoom||u.value,x.value=n.autoCleanup||!1,p.value=n.cleanupDays||30}}catch{}}function j(){try{const t={deviceName:o.value,vdoRoom:u.value,autoCleanup:x.value,cleanupDays:p.value};localStorage.setItem(ne,JSON.stringify(t)),m.success("Settings saved")}catch(t){m.error("Failed to save settings"),console.error("Failed to save settings:",t)}}function w(){o.value="Preke Device",u.value=ae,x.value=!1,p.value=30,j(),m.info("Settings reset to defaults")}return H(()=>{i()}),(t,n)=>(s(),a("div",Ms,[e("div",Vs,[n[6]||(n[6]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Device",-1)),e("div",Is,[e("div",null,[n[4]||(n[4]=e("label",{class:"block text-sm font-medium mb-2"},"Device Name",-1)),U(e("input",{"onUpdate:modelValue":n[0]||(n[0]=_=>o.value=_),type:"text",class:"input w-full",placeholder:"My Preke Device"},null,512),[[G,o.value]]),n[5]||(n[5]=e("p",{class:"text-xs text-r58-text-secondary mt-1"},"Display name for this device in the app",-1))])])]),e("div",Es,[n[11]||(n[11]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"VDO.ninja / Mixer",-1)),e("div",Ts,[e("div",null,[n[7]||(n[7]=e("label",{class:"block text-sm font-medium mb-2"},"Room Name",-1)),U(e("input",{"onUpdate:modelValue":n[1]||(n[1]=_=>u.value=_),type:"text",class:"input w-full",placeholder:"r58studio"},null,512),[[G,u.value]]),n[8]||(n[8]=e("p",{class:"text-xs text-r58-text-secondary mt-1"},"VDO.ninja room for video mixing",-1))]),e("div",null,[n[9]||(n[9]=e("label",{class:"block text-sm font-medium mb-2"},"VDO Host",-1)),e("input",{value:f.value,type:"text",class:"input w-full bg-r58-bg-tertiary",readonly:"",disabled:""},null,8,Os),n[10]||(n[10]=e("p",{class:"text-xs text-r58-text-secondary mt-1"},"VDO.ninja server (read-only)",-1))])])]),e("div",Fs,[n[16]||(n[16]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Storage",-1)),e("div",Us,[e("div",null,[n[12]||(n[12]=e("label",{class:"block text-sm font-medium mb-2"},"Recording Path",-1)),e("input",{value:b.value,type:"text",class:"input w-full bg-r58-bg-tertiary",readonly:"",disabled:""},null,8,Ls),n[13]||(n[13]=e("p",{class:"text-xs text-r58-text-secondary mt-1"},"Location where recordings are saved on device",-1))]),e("div",Hs,[n[14]||(n[14]=e("div",null,[e("label",{class:"block text-sm font-medium"},"Auto-cleanup old recordings"),e("p",{class:"text-xs text-r58-text-secondary"},"Automatically delete recordings older than specified days")],-1)),e("button",{onClick:n[2]||(n[2]=_=>x.value=!x.value),class:R(["relative inline-flex h-6 w-11 items-center rounded-full transition-colors",x.value?"bg-r58-accent-primary":"bg-r58-bg-tertiary"])},[e("span",{class:R(["inline-block h-4 w-4 transform rounded-full bg-white transition-transform",x.value?"translate-x-6":"translate-x-1"])},null,2)],2)]),x.value?(s(),a("div",Bs,[n[15]||(n[15]=e("label",{class:"block text-sm font-medium mb-2"},"Keep recordings for (days)",-1)),U(e("input",{"onUpdate:modelValue":n[3]||(n[3]=_=>p.value=_),type:"number",min:"1",max:"365",class:"input w-24"},null,512),[[G,p.value,void 0,{number:!0}]])])):M("",!0)])]),e("div",{class:"flex items-center justify-between"},[e("button",{onClick:w,class:"btn btn-secondary"}," Reset to Defaults "),e("button",{onClick:j,class:"btn btn-primary"}," Save Settings ")]),e("div",qs,[n[19]||(n[19]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"About",-1)),e("div",zs,[n[18]||(n[18]=e("div",{class:"flex justify-between"},[e("span",{class:"text-r58-text-secondary"},"App Version"),e("span",null,"2.0.0")],-1)),e("div",Gs,[n[17]||(n[17]=e("span",{class:"text-r58-text-secondary"},"Platform",-1)),e("span",null,v(l.value?"Desktop (Electron)":"Web Browser"),1)])])])]))}}),Js={class:"h-full flex flex-col"},Ws={class:"px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},Qs={class:"flex gap-2"},Xs=["onClick"],Ys={class:"flex-1 p-6 overflow-y-auto"},Zs={key:2,class:"card"},ea={key:3,class:"card"},na=L({__name:"AdminView",setup(S){const m=pe(),o=h("system"),u=[{id:"system",label:"System"},{id:"status",label:"Device Status"},{id:"logs",label:"Logs"},{id:"fleet",label:"Fleet"},{id:"settings",label:"Settings"}];return H(()=>{const f=m.query.tab;f&&u.some(b=>b.id===f)&&(o.value=f)}),(f,b)=>(s(),a("div",Js,[e("header",Ws,[b[0]||(b[0]=e("h1",{class:"text-xl font-semibold mb-4"},"Admin",-1)),e("div",Qs,[(s(),a(V,null,T(u,x=>e("button",{key:x.id,onClick:p=>o.value=x.id,class:R(["px-4 py-2 rounded-t-lg transition-colors",[o.value===x.id?"bg-r58-bg-primary text-r58-text-primary":"text-r58-text-secondary hover:text-r58-text-primary"]])},v(x.label),11,Xs)),64))])]),e("div",Ys,[o.value==="system"?(s(),K(Ps,{key:0})):o.value==="status"?(s(),K(ft,{key:1})):o.value==="logs"?(s(),a("div",Zs,[b[1]||(b[1]=e("h2",{class:"text-lg font-semibold mb-4"},"System Logs",-1)),se($t)])):o.value==="fleet"?(s(),a("div",ea,[se(Lt)])):o.value==="settings"?(s(),K(Ks,{key:4})):M("",!0)])]))}});export{na as default};
