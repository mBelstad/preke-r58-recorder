import{d as R,r as m,h as k,j as S,k as $,c as o,a as e,b as c,F as w,q as C,w as B,x as I,t as i,D as N,n as d,p as M,u as V,o as r,_ as E}from"./index-DvETLSbw.js";const H={class:"fleet-dashboard"},A={class:"flex items-center justify-between mb-6"},U={class:"flex items-center gap-3"},q=["disabled"],P={key:0},G={key:1},J={class:"grid grid-cols-5 gap-4 mb-6"},K=["onClick"],Q={class:"flex items-center gap-2"},O={class:"text-sm text-zinc-400 capitalize"},W={class:"text-2xl font-semibold text-zinc-100 mt-1"},X={class:"flex items-center gap-4 mb-6"},Y={class:"flex-1 relative"},Z={key:0,class:"p-4 bg-red-900/20 border border-red-800 rounded-lg text-red-400 mb-6"},ee={key:1,class:"text-center py-12"},te={key:2,class:"text-center py-12"},se={class:"text-zinc-400"},ne={key:3,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},oe=["onClick"],re={class:"flex items-start justify-between mb-3"},ie={class:"font-medium text-zinc-100 group-hover:text-emerald-400 transition-colors"},le={class:"text-sm text-zinc-500 font-mono"},ae={class:"flex items-center gap-2"},de={key:0,class:"px-2 py-0.5 bg-amber-500/20 text-amber-400 text-xs rounded"},ce={class:"flex items-center gap-2 text-sm text-zinc-400 mb-3"},ue={key:0,class:"text-amber-400"},me={key:0,class:"grid grid-cols-4 gap-2 text-center"},xe={class:"p-2 bg-zinc-800/50 rounded"},pe={class:"p-2 bg-zinc-800/50 rounded"},fe={class:"p-2 bg-zinc-800/50 rounded"},_e={class:"p-2 bg-zinc-800/50 rounded"},ge={key:1,class:"flex items-center gap-2 mt-3"},ve={key:0,class:"px-2 py-0.5 bg-red-500/20 text-red-400 text-xs rounded flex items-center gap-1"},be={key:1,class:"px-2 py-0.5 bg-emerald-500/20 text-emerald-400 text-xs rounded"},he={class:"flex items-center justify-between mt-3 pt-3 border-t border-zinc-800 text-xs text-zinc-500"},ze={key:0},ye={key:1},ke=R({__name:"FleetDashboard",setup(we){const D=V(),f=m([]),_=m(!0),g=m(null),x=m(""),p=m(""),v=m(null),z=k(()=>{let n=f.value;if(p.value&&(n=n.filter(s=>s.status===p.value)),x.value){const s=x.value.toLowerCase();n=n.filter(t=>{var l;return t.device_id.toLowerCase().includes(s)||t.name.toLowerCase().includes(s)||((l=t.location)==null?void 0:l.toLowerCase().includes(s))})}return n}),F=k(()=>{const n={online:0,offline:0,updating:0,error:0,maintenance:0};return f.value.forEach(s=>{s.status in n&&n[s.status]++}),n});async function b(){var n;try{const s=await((n=N.fleet)==null?void 0:n.devices())||{items:[]};f.value=s.items||[],g.value=null}catch(s){g.value="Failed to load devices",console.error("Fleet fetch error:",s)}finally{_.value=!1}}function y(n){return{online:"bg-emerald-500",offline:"bg-zinc-500",updating:"bg-amber-500",error:"bg-red-500",maintenance:"bg-blue-500"}[n]||"bg-zinc-400"}function j(n){return{online:"text-emerald-400",offline:"text-zinc-400",updating:"text-amber-400",error:"text-red-400",maintenance:"text-blue-400"}[n]||"text-zinc-400"}function L(n){if(!n)return"Never";const s=new Date(n),l=new Date().getTime()-s.getTime(),a=Math.floor(l/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const u=Math.floor(a/60);return u<24?`${u}h ago`:`${Math.floor(u/24)}d ago`}function T(n){D.push(`/fleet/devices/${n}`)}return S(()=>{b(),v.value=window.setInterval(b,3e4)}),$(()=>{v.value&&clearInterval(v.value)}),(n,s)=>(r(),o("div",H,[e("div",A,[s[2]||(s[2]=e("div",null,[e("h1",{class:"text-2xl font-semibold text-zinc-100"},"Fleet Dashboard"),e("p",{class:"text-sm text-zinc-400 mt-1"},"Manage and monitor all R58 devices")],-1)),e("div",U,[e("button",{onClick:b,class:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-zinc-200 rounded-lg transition-colors",disabled:_.value},[_.value?(r(),o("span",P,"Refreshing...")):(r(),o("span",G,"Refresh"))],8,q),s[1]||(s[1]=e("button",{class:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg transition-colors"}," + Add Device ",-1))])]),e("div",J,[(r(!0),o(w,null,C(F.value,(t,l)=>(r(),o("button",{key:l,onClick:a=>p.value=p.value===l?"":l,class:d(["p-4 rounded-lg border transition-colors",p.value===l?"bg-zinc-800 border-zinc-600":"bg-zinc-900/50 border-zinc-800 hover:border-zinc-700"])},[e("div",Q,[e("div",{class:d(["w-2 h-2 rounded-full",y(l)])},null,2),e("span",O,i(l),1)]),e("div",W,i(t),1)],10,K))),128))]),e("div",X,[e("div",Y,[B(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>x.value=t),type:"text",placeholder:"Search devices...",class:"w-full px-4 py-2 pl-10 bg-zinc-900 border border-zinc-700 rounded-lg text-zinc-200 placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/50"},null,512),[[I,x.value]]),s[3]||(s[3]=e("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),g.value?(r(),o("div",Z,i(g.value),1)):c("",!0),_.value&&f.value.length===0?(r(),o("div",ee,[...s[4]||(s[4]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-zinc-600 border-t-emerald-500 rounded-full mx-auto"},null,-1),e("p",{class:"text-zinc-400 mt-4"},"Loading devices...",-1)])])):z.value.length===0?(r(),o("div",te,[s[5]||(s[5]=e("div",{class:"w-16 h-16 bg-zinc-800 rounded-full flex items-center justify-center mx-auto mb-4"},[e("svg",{class:"w-8 h-8 text-zinc-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2z"})])],-1)),s[6]||(s[6]=e("h3",{class:"text-lg font-medium text-zinc-200 mb-2"},"No devices found",-1)),e("p",se,i(x.value?"Try adjusting your search or filters":"Register your first device to get started"),1)])):(r(),o("div",ne,[(r(!0),o(w,null,C(z.value,t=>{var l,a,u,h;return r(),o("div",{key:t.id,onClick:Ce=>T(t.device_id),class:"p-4 bg-zinc-900/50 border border-zinc-800 rounded-lg hover:border-zinc-700 cursor-pointer transition-all group"},[e("div",re,[e("div",null,[e("h3",ie,i(t.name),1),e("p",le,i(t.device_id),1)]),e("div",ae,[t.pending_commands&&t.pending_commands>0?(r(),o("span",de,i(t.pending_commands)+" pending ",1)):c("",!0),e("span",{class:d(["flex items-center gap-1 text-xs",j(t.status)])},[e("span",{class:d(["w-1.5 h-1.5 rounded-full",y(t.status)])},null,2),M(" "+i(t.status),1)],2)])]),e("div",ce,[e("span",null,"v"+i(t.current_version||"unknown"),1),t.target_version?(r(),o("span",ue," → v"+i(t.target_version),1)):c("",!0)]),t.status==="online"?(r(),o("div",me,[e("div",xe,[s[7]||(s[7]=e("div",{class:"text-xs text-zinc-500"},"CPU",-1)),e("div",{class:d(["text-sm font-medium",t.cpu_percent&&t.cpu_percent>80?"text-red-400":"text-zinc-200"])},i(((l=t.cpu_percent)==null?void 0:l.toFixed(0))||"-")+"% ",3)]),e("div",pe,[s[8]||(s[8]=e("div",{class:"text-xs text-zinc-500"},"MEM",-1)),e("div",{class:d(["text-sm font-medium",t.mem_percent&&t.mem_percent>80?"text-red-400":"text-zinc-200"])},i(((a=t.mem_percent)==null?void 0:a.toFixed(0))||"-")+"% ",3)]),e("div",fe,[s[9]||(s[9]=e("div",{class:"text-xs text-zinc-500"},"DISK",-1)),e("div",{class:d(["text-sm font-medium",t.disk_free_gb&&t.disk_free_gb<2?"text-red-400":"text-zinc-200"])},i(((u=t.disk_free_gb)==null?void 0:u.toFixed(1))||"-")+"G ",3)]),e("div",_e,[s[10]||(s[10]=e("div",{class:"text-xs text-zinc-500"},"TEMP",-1)),e("div",{class:d(["text-sm font-medium",t.temperature_c&&t.temperature_c>70?"text-red-400":"text-zinc-200"])},i(((h=t.temperature_c)==null?void 0:h.toFixed(0))||"-")+"° ",3)])])):c("",!0),t.recording_active||t.mixer_active?(r(),o("div",ge,[t.recording_active?(r(),o("span",ve,[...s[11]||(s[11]=[e("span",{class:"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"},null,-1),M(" Recording ",-1)])])):c("",!0),t.mixer_active?(r(),o("span",be," Mixer Active ")):c("",!0)])):c("",!0),e("div",he,[t.location?(r(),o("span",ze,i(t.location),1)):(r(),o("span",ye,"-")),e("span",null,i(L(t.last_heartbeat)),1)])],8,oe)}),128))]))]))}}),De=E(ke,[["__scopeId","data-v-033e0fe2"]]);export{De as default};
