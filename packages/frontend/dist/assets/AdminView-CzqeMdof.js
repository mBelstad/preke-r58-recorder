const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C-UnMYRj.js","assets/index-BtJSUzyN.css"])))=>i.map(i=>d[i]);
import{d as z,u as ce,X as ue,r as y,o as L,b as Y,l as te,c as s,e,q as c,t as p,f as P,n as C,x as W,F as T,y as U,a as pe,i as t,_ as ie,E as se,w as B,U as ne,Y as ve,Z as re,j as F,B as oe,N as X,k as me,A as Z,$ as xe,I as Q,m as K,p as ee,a0 as fe}from"./index-C-UnMYRj.js";import{g as ke,V as ae}from"./vdoninja-G1aUSzt3.js";const ge={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},be={class:"card"},_e={key:0,class:"text-preke-red"},ye={key:1,class:"space-y-3"},he={class:"flex justify-between items-center"},we={key:0,class:"skeleton w-24 h-5"},$e={key:1,class:"font-medium"},je={class:"flex justify-between items-center"},Se={key:0,class:"skeleton w-16 h-5"},De={key:1,class:"capitalize"},Ce={class:"flex justify-between items-center"},Ae={key:0,class:"skeleton w-12 h-5"},Re={key:1},Pe={class:"flex justify-between items-center"},Ve={key:0,class:"skeleton w-20 h-5"},Me={key:1,class:"badge badge-success"},Ne={key:0,class:"flex flex-col gap-2 pt-2 border-t border-preke-border"},Te={class:"flex flex-col gap-1 text-xs"},Ee=["href"],Oe=["href"],Ue={class:"card"},Fe={class:"space-y-4"},Le={class:"flex items-center justify-between"},Ie={key:0,class:"skeleton w-20 h-5 rounded-full"},Be={class:"flex gap-2"},ze=["disabled"],Ge={key:0,class:"inline-block animate-spin mr-1"},He=["disabled"],qe={key:0,class:"inline-block animate-spin mr-1"},Je={key:0,class:"text-sm text-preke-red"},Ke={class:"card"},We={class:"space-y-3"},Xe={class:"flex justify-between items-center"},Ye={key:0,class:"skeleton w-20 h-5 rounded-full"},Ze={class:"flex justify-between items-center"},Qe={key:0,class:"skeleton w-20 h-5 rounded-full"},et={class:"flex justify-between items-center"},tt={key:0,class:"skeleton w-20 h-5 rounded-full"},st={key:1,class:"badge badge-success"},nt={class:"flex justify-between items-center"},ot={key:0,class:"skeleton w-20 h-5 rounded-full"},at={key:1,class:"badge badge-success"},lt={class:"card md:col-span-2 lg:col-span-3"},it={class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4"},rt={class:"flex items-center justify-between mb-3"},dt={class:"flex items-center gap-2"},ct={class:"font-medium"},ut={class:"space-y-1 text-sm text-preke-text-dim"},pt={class:"flex justify-between"},vt={class:"text-preke-text"},mt={class:"flex justify-between"},xt={class:"text-preke-text"},ft={class:"flex justify-between"},kt={class:"text-preke-text font-mono text-xs"},gt={key:0,class:"col-span-full text-center text-preke-text-dim py-8"},bt=z({__name:"DeviceStatus",setup(I){const m=ce(),{capabilities:a,loading:x,error:f}=ue(m),u=y(""),D=y("");L(async()=>{try{u.value=await Y("/reveal"),D.value=await Y("/reveal/graphics")}catch(k){console.error("Failed to build reveal.js URLs:",k)}});const v=y(!1),r=y(null);let d=null;async function M(k){if(!v.value){v.value=!0,r.value=null;try{const n=await fetch(await Y(`/api/mode/${k}`),{method:"POST"});if(!n.ok){const O=await n.json().catch(()=>({}));throw new Error(O.detail||`Failed to switch to ${k} mode`)}await m.fetchCapabilities()}catch(n){r.value=n instanceof Error?n.message:"Failed to switch mode",console.error("Mode switch error:",n)}finally{v.value=!1}}}function V(k,n){if(!n)return"bg-preke-text-dim";switch(k){case"streaming":case"recording":return"bg-preke-green";case"preview":return"bg-preke-blue";case"idle":return"bg-preke-text-dim";case"error":return"bg-preke-red";default:return"bg-preke-text-dim"}}function R(k,n){if(!n)return"No Signal";switch(k){case"streaming":return"Streaming";case"recording":return"Recording";case"preview":return"Preview";case"idle":return"Idle";case"error":return"Error";default:return k}}return L(()=>{m.fetchCapabilities(),d=setInterval(()=>{m.fetchCapabilities()},1e4)}),te(()=>{d&&clearInterval(d)}),(k,n)=>{var O,j,o,S,G,l,i,g,_,h,A,b,E,N,H,q;return t(),s("div",ge,[e("div",be,[n[7]||(n[7]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Device Info",-1)),c(f)&&!c(a)?(t(),s("div",_e,p(c(f)),1)):(t(),s("div",ye,[e("div",he,[n[2]||(n[2]=e("span",{class:"text-preke-text-dim"},"Device Name",-1)),c(x)&&!c(a)?(t(),s("div",we)):(t(),s("span",$e,p(((O=c(a))==null?void 0:O.device_name)||"R58 Device"),1))]),e("div",je,[n[3]||(n[3]=e("span",{class:"text-preke-text-dim"},"Platform",-1)),c(x)&&!c(a)?(t(),s("div",Se)):(t(),s("span",De,p(((j=c(a))==null?void 0:j.platform)||"-"),1))]),e("div",Ce,[n[4]||(n[4]=e("span",{class:"text-preke-text-dim"},"API Version",-1)),c(x)&&!c(a)?(t(),s("div",Ae)):(t(),s("span",Re,p(((o=c(a))==null?void 0:o.api_version)||"-"),1))]),e("div",Pe,[n[5]||(n[5]=e("span",{class:"text-preke-text-dim"},"GStreamer",-1)),c(x)&&!c(a)?(t(),s("div",Ve)):(t(),s("span",Me,"Initialized"))]),(G=(S=c(a))==null?void 0:S.reveal_js)!=null&&G.available?(t(),s("div",Ne,[n[6]||(n[6]=e("div",{class:"flex justify-between items-center"},[e("span",{class:"text-preke-text-dim text-xs"},"Reveal.js"),e("span",{class:"badge badge-success text-xs"},"Available")],-1)),e("div",Te,[u.value?(t(),s("a",{key:0,href:u.value,target:"_blank",class:"text-preke-blue hover:text-preke-gold transition-colors truncate",title:"Open Reveal.js Demo"}," Demo Presentation ",8,Ee)):P("",!0),D.value?(t(),s("a",{key:1,href:D.value,target:"_blank",class:"text-preke-blue hover:text-preke-gold transition-colors truncate",title:"Open Reveal.js Graphics"}," Graphics Presentation ",8,Oe)):P("",!0)])])):P("",!0)]))]),e("div",Ue,[n[11]||(n[11]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Operating Mode",-1)),e("div",Fe,[e("div",Le,[n[8]||(n[8]=e("span",{class:"text-preke-text-dim"},"Current Mode",-1)),c(x)&&!c(a)?(t(),s("div",Ie)):(t(),s("span",{key:1,class:C(["badge",((l=c(a))==null?void 0:l.current_mode)==="mixer"?"badge-info":"badge-success"])},p(((i=c(a))==null?void 0:i.current_mode)==="mixer"?"Mixer":"Recorder"),3))]),e("div",Be,[e("button",{class:C(["btn btn-sm flex-1",((g=c(a))==null?void 0:g.current_mode)==="recorder"?"btn-primary":"btn-secondary"]),disabled:v.value||((_=c(a))==null?void 0:_.current_mode)==="recorder"||c(x)&&!c(a),onClick:n[0]||(n[0]=w=>M("recorder"))},[v.value&&((h=c(a))==null?void 0:h.current_mode)!=="recorder"?(t(),s("span",Ge,"⟳")):P("",!0),n[9]||(n[9]=W(" Recorder ",-1))],10,ze),e("button",{class:C(["btn btn-sm flex-1",((A=c(a))==null?void 0:A.current_mode)==="mixer"?"btn-primary":"btn-secondary"]),disabled:v.value||((b=c(a))==null?void 0:b.current_mode)==="mixer"||c(x)&&!c(a),onClick:n[1]||(n[1]=w=>M("mixer"))},[v.value&&((E=c(a))==null?void 0:E.current_mode)!=="mixer"?(t(),s("span",qe,"⟳")):P("",!0),n[10]||(n[10]=W(" Mixer ",-1))],10,He)]),r.value?(t(),s("div",Je,p(r.value),1)):P("",!0)])]),e("div",Ke,[n[16]||(n[16]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Available Features",-1)),e("div",We,[e("div",Xe,[n[12]||(n[12]=e("div",null,[e("span",null,"Mixer"),e("span",{class:"text-xs text-preke-text-dim ml-1"},"(VDO.ninja)")],-1)),c(x)&&!c(a)?(t(),s("div",Ye)):(t(),s("span",{key:1,class:C(["badge",c(m).mixerEnabled?"badge-success":"badge-warning"])},p(c(m).mixerEnabled?"Available":"Disabled"),3))]),e("div",Ze,[n[13]||(n[13]=e("span",null,"Recorder",-1)),c(x)&&!c(a)?(t(),s("div",Qe)):(t(),s("span",{key:1,class:C(["badge",c(m).recorderEnabled?"badge-success":"badge-warning"])},p(c(m).recorderEnabled?"Available":"Disabled"),3))]),e("div",et,[n[14]||(n[14]=e("span",null,"Graphics Overlay",-1)),c(x)&&!c(a)?(t(),s("div",tt)):(t(),s("span",st,"Available"))]),e("div",nt,[n[15]||(n[15]=e("span",null,"WebRTC Preview",-1)),c(x)&&!c(a)?(t(),s("div",ot)):(t(),s("span",at,"Available"))])])]),e("div",lt,[n[21]||(n[21]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Hardware Inputs",-1)),e("div",it,[c(x)&&!c(a)?(t(),s(T,{key:0},U(4,w=>e("div",{key:w,class:"p-4 rounded-lg bg-preke-bg-surface border border-preke-border"},[...n[17]||(n[17]=[pe('<div class="flex items-center justify-between mb-3" data-v-60ba1c7a><div class="flex items-center gap-2" data-v-60ba1c7a><div class="skeleton w-2 h-2 rounded-full" data-v-60ba1c7a></div><div class="skeleton w-16 h-5" data-v-60ba1c7a></div></div><div class="skeleton w-16 h-4 rounded-full" data-v-60ba1c7a></div></div><div class="space-y-2" data-v-60ba1c7a><div class="flex justify-between" data-v-60ba1c7a><div class="skeleton w-8 h-4" data-v-60ba1c7a></div><div class="skeleton w-12 h-4" data-v-60ba1c7a></div></div><div class="flex justify-between" data-v-60ba1c7a><div class="skeleton w-16 h-4" data-v-60ba1c7a></div><div class="skeleton w-20 h-4" data-v-60ba1c7a></div></div><div class="flex justify-between" data-v-60ba1c7a><div class="skeleton w-10 h-4" data-v-60ba1c7a></div><div class="skeleton w-14 h-4" data-v-60ba1c7a></div></div></div>',2)])])),64)):(t(),s(T,{key:1},[(t(!0),s(T,null,U(((N=c(a))==null?void 0:N.inputs)||[],w=>{var J;return t(),s("div",{key:w.id,class:C(["p-4 rounded-lg bg-preke-bg-surface border border-preke-border",{"border-preke-green/50":w.has_signal}])},[e("div",rt,[e("div",dt,[e("span",{class:C(["w-2 h-2 rounded-full animate-pulse",V(w.status,w.has_signal)])},null,2),e("span",ct,p(w.label),1)]),e("span",{class:C(["text-xs px-2 py-0.5 rounded-full",{"bg-preke-green/20 text-preke-green":w.has_signal&&(w.status==="streaming"||w.status==="recording"),"bg-preke-blue/20 text-preke-blue":w.has_signal&&w.status==="preview","bg-preke-bg-surface text-preke-text-dim":!w.has_signal||w.status==="idle"}])},p(R(w.status,w.has_signal)),3)]),e("div",ut,[e("div",pt,[n[18]||(n[18]=e("span",null,"Type",-1)),e("span",vt,p(w.type.toUpperCase()),1)]),e("div",mt,[n[19]||(n[19]=e("span",null,"Resolution",-1)),e("span",xt,p(w.max_resolution||"N/A"),1)]),e("div",ft,[n[20]||(n[20]=e("span",null,"Device",-1)),e("span",kt,p(((J=w.device_path)==null?void 0:J.split("/").pop())||"N/A"),1)])])],2)}),128)),(q=(H=c(a))==null?void 0:H.inputs)!=null&&q.length?P("",!0):(t(),s("div",gt," No inputs detected "))],64))])])])}}}),_t=ie(bt,[["__scopeId","data-v-60ba1c7a"]]),yt={class:"space-y-4"},ht={class:"flex items-center gap-4 flex-wrap"},wt=["value"],$t={class:"flex items-center gap-2 cursor-pointer"},jt=["disabled"],St={key:0},Dt={key:1},Ct={class:"bg-preke-bg-base rounded-lg p-4 font-mono text-sm text-preke-text-dim h-[500px] overflow-auto whitespace-pre-wrap"},At=z({__name:"LogViewer",props:{service:{}},setup(I){const m=I,a=y(""),x=y(!1),f=y(m.service||"preke-recorder"),u=y(100),D=y(!1),v=[{id:"preke-recorder",label:"Preke Recorder"},{id:"mediamtx",label:"MediaMTX"}];let r=null;async function d(){x.value=!0;try{const k=await(await fetch(await Y(`/api/system/logs?service=${f.value}&lines=${u.value}`))).json();a.value=k.logs||"No logs available"}catch(R){a.value=`Error fetching logs: ${R}`}finally{x.value=!1}}function M(){r&&clearInterval(r),r=window.setInterval(d,5e3)}function V(){r&&(clearInterval(r),r=null)}return se(D,R=>{R?M():V()}),se([f,u],()=>{d()}),L(()=>{d()}),te(()=>{V()}),(R,k)=>(t(),s("div",yt,[e("div",ht,[B(e("select",{"onUpdate:modelValue":k[0]||(k[0]=n=>f.value=n),class:"input"},[(t(),s(T,null,U(v,n=>e("option",{key:n.id,value:n.id},p(n.label),9,wt)),64))],512),[[ne,f.value]]),B(e("select",{"onUpdate:modelValue":k[1]||(k[1]=n=>u.value=n),class:"input"},[...k[3]||(k[3]=[e("option",{value:50},"50 lines",-1),e("option",{value:100},"100 lines",-1),e("option",{value:250},"250 lines",-1),e("option",{value:500},"500 lines",-1)])],512),[[ne,u.value]]),e("label",$t,[B(e("input",{type:"checkbox","onUpdate:modelValue":k[2]||(k[2]=n=>D.value=n),class:"w-4 h-4 rounded"},null,512),[[ve,D.value]]),k[4]||(k[4]=e("span",{class:"text-sm"},"Auto-refresh",-1))]),e("button",{onClick:d,disabled:x.value,class:"btn"},[x.value?(t(),s("span",St,"Loading...")):(t(),s("span",Dt,"Refresh"))],8,jt)]),e("pre",Ct,p(a.value||"No logs available"),1)]))}}),Rt={class:"space-y-6"},Pt={class:"flex items-center justify-between"},Vt=["disabled"],Mt={key:0},Nt={key:1},Tt={key:0,class:"flex items-center justify-center py-12"},Et={key:1,class:"text-center py-12 text-preke-text-dim"},Ot={key:2,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Ut=["onClick"],Ft={class:"flex items-start justify-between mb-4"},Lt={class:"font-semibold"},It={class:"text-sm text-preke-text-dim"},Bt={class:"space-y-2 text-sm"},zt={class:"flex justify-between"},Gt={class:"font-mono"},Ht={class:"flex justify-between"},qt=z({__name:"FleetOverview",setup(I){const m=y([]),a=y(!0),x=y(!1);async function f(){a.value=!0;try{const v=await fetch("/api/v1/lan-devices");if(v.ok){const r=await v.json();m.value=r.map(d=>({id:d.id,name:d.name,ip:d.ip,status:d.status,lastSeen:d.last_seen,version:d.api_version||"unknown"}))}}catch(v){console.error("Failed to fetch LAN devices:",v)}finally{a.value=!1}}L(f);async function u(){x.value=!0;try{const v=await fetch("/api/v1/lan-devices/scan",{method:"POST"});if(v.ok){const r=await v.json();for(const d of r)m.value.find(V=>V.id===d.id)||m.value.push({id:d.id,name:d.name,ip:d.ip,status:d.status,lastSeen:d.last_seen,version:d.api_version||"unknown"})}}catch(v){console.error("LAN network scan failed:",v)}finally{x.value=!1}}async function D(v){try{const d=await(await fetch(`/api/v1/lan-devices/${v.id}/connect`,{method:"POST"})).json();d.connected?window.open(`http://${v.ip}:8000`,"_blank"):alert(`Failed to connect: ${d.error||"Unknown error"}`)}catch(r){console.error("Failed to connect to device:",r)}}return(v,r)=>(t(),s("div",Rt,[e("div",Pt,[r[0]||(r[0]=e("h2",{class:"text-lg font-semibold"},"LAN Devices",-1)),e("button",{onClick:u,disabled:x.value,class:"btn"},[x.value?(t(),s("span",Mt,"Scanning...")):(t(),s("span",Nt,"Scan Network"))],8,Vt)]),a.value?(t(),s("div",Tt,[...r[1]||(r[1]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-preke-gold border-t-transparent rounded-full"},null,-1)])])):m.value.length===0?(t(),s("div",Et,[...r[2]||(r[2]=[e("p",null,"No devices found",-1),e("p",{class:"text-sm mt-2"},'Click "Scan Network" to discover R58 devices',-1)])])):(t(),s("div",Ot,[(t(!0),s(T,null,U(m.value,d=>(t(),s("div",{key:d.id,class:"card hover:border-preke-gold/50 transition-colors cursor-pointer",onClick:M=>D(d)},[e("div",Ft,[e("div",null,[e("h3",Lt,p(d.name),1),e("p",It,p(d.id),1)]),e("span",{class:C(["badge",{"badge-success":d.status==="online","badge-danger":d.status==="offline","badge-warning":d.status==="unknown"}])},p(d.status),3)]),e("div",Bt,[e("div",zt,[r[3]||(r[3]=e("span",{class:"text-preke-text-dim"},"IP Address",-1)),e("span",Gt,p(d.ip),1)]),e("div",Ht,[r[4]||(r[4]=e("span",{class:"text-preke-text-dim"},"Version",-1)),e("span",null,p(d.version),1)])])],8,Ut))),128))]))]))}}),Jt={class:"space-y-6"},Kt={key:0,class:"flex items-center justify-center py-12"},Wt={key:1,class:"glass-card p-4 bg-preke-red/10 border border-preke-red/30 rounded-xl"},Xt={class:"text-preke-red"},Yt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},Zt={class:"glass-card p-4 rounded-xl"},Qt={key:0,class:"space-y-3"},es={class:"relative w-full h-3 bg-preke-bg rounded-full overflow-hidden"},ts={class:"flex justify-between text-sm"},ss={class:"font-mono text-preke-text"},ns={key:1,class:"flex items-center justify-center py-4"},os={class:"glass-card p-4 rounded-xl"},as={key:0,class:"space-y-3"},ls={class:"relative w-full h-3 bg-preke-bg rounded-full overflow-hidden"},is={class:"flex justify-between text-sm"},rs={class:"text-preke-text"},ds={key:1,class:"flex items-center justify-center py-4"},cs={class:"glass-card p-4 rounded-xl"},us={class:"flex items-center justify-center py-2"},ps={key:1,class:"text-preke-text-muted"},vs={key:0,class:"text-center text-xs text-preke-text-muted"},ms={class:"glass-card p-4 rounded-xl"},xs={class:"flex items-center justify-center py-2"},fs={key:0,class:"text-3xl font-bold text-preke-gold"},ks={key:1,class:"text-preke-text-muted"},gs={class:"text-center text-xs text-preke-text-muted"},bs={class:"glass-card p-4 rounded-xl"},_s={class:"flex items-center justify-between mb-4"},ys={class:"flex gap-2"},hs={class:"grid gap-3 sm:grid-cols-3"},ws={class:"flex items-center gap-3"},$s={class:"font-medium text-preke-text"},js={class:"text-xs text-preke-text-muted"},Ss={key:0},Ds=["onClick"],Cs={key:1,class:"text-xs text-preke-text-muted"},As={class:"glass-card p-4 rounded-xl"},Rs={class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},Ps={class:"ml-2 text-preke-gold"},Vs={key:0,class:"text-center py-8 text-preke-text-muted"},Ms={key:1,class:"space-y-2"},Ns={class:"flex items-center gap-4"},Ts={class:"font-mono text-sm text-preke-text"},Es={class:"text-xs text-preke-text-muted"},Os={key:0},Us={class:"flex items-center gap-3"},Fs=["onClick"],Ls=z({__name:"SystemMonitor",setup(I){const m=re(),a=y(!0),x=y(null),f=y(null),u=y(null),D=F(()=>{var g,_,h;const l=((h=(_=(g=f.value)==null?void 0:g.info)==null?void 0:_.load_average)==null?void 0:h[0])??0;return Math.min(100,l/8*100)}),v=F(()=>{var i,g;const l=(g=(i=f.value)==null?void 0:i.info)==null?void 0:g.memory_percent;return l!==void 0?l:0}),r=F(()=>{var g,_;const l=((_=(g=f.value)==null?void 0:g.info)==null?void 0:_.temperatures)??[];return l.length===0?null:l.find(h=>{var A;return(A=h.type)==null?void 0:A.toLowerCase().includes("cpu")})??l[0]}),d=F(()=>{var h,A;const l=((A=(h=f.value)==null?void 0:h.info)==null?void 0:A.uptime_seconds)??0,i=Math.floor(l/86400),g=Math.floor(l%86400/3600),_=Math.floor(l%3600/60);return i>0?`${i}d ${g}h`:g>0?`${g}h ${_}m`:`${_}m`}),M=F(()=>{var l;return((l=f.value)==null?void 0:l.services)??[]}),V=F(()=>{var l;return((l=f.value)==null?void 0:l.pipelines)??[]});async function R(){try{const{buildApiUrl:l}=await X(async()=>{const{buildApiUrl:E}=await import("./index-C-UnMYRj.js").then(N=>N.a3);return{buildApiUrl:E}},__vite__mapDeps([0,1])),[i,g,_]=await Promise.all([fetch(await l("/health")),fetch(await l("/api/ingest/status")),fetch(await l("/api/system/info"))]),h=i.ok?await i.json():{status:"unknown"},A=g.ok?await g.json():{cameras:{}},b=_.ok?await _.json():null;f.value={info:{hostname:(b==null?void 0:b.hostname)||"R58 Device",platform:h.platform||"R58",gstreamer:h.gstreamer,load_average:(b==null?void 0:b.load_average)||[0,0,0],memory_percent:(b==null?void 0:b.memory_percent)||0,memory_total_mb:(b==null?void 0:b.memory_total_mb)||0,memory_used_mb:(b==null?void 0:b.memory_used_mb)||0,uptime_seconds:(b==null?void 0:b.uptime_seconds)||0,temperatures:(b==null?void 0:b.temperatures)||[]},services:[{name:"r58-recorder",active:h.status==="healthy",status:h.status},{name:"mediamtx",active:!0,status:"running"},{name:"vdo.ninja",active:!0,status:"running",note:"r58-vdo.itagenten.no"}],pipelines:Object.entries(A.cameras||{}).map(([E,N])=>({pipeline_id:E,pipeline_type:"ingest",device:N.device,state:N.status==="streaming"?"running":N.status}))},x.value=null}catch(l){x.value=l.message,console.error("Failed to fetch system status:",l)}finally{a.value=!1}}async function k(l){try{const{buildApiUrl:i}=await X(async()=>{const{buildApiUrl:h}=await import("./index-C-UnMYRj.js").then(A=>A.a3);return{buildApiUrl:h}},__vite__mapDeps([0,1])),_=await(await fetch(await i(`/api/system/restart-service/${l}`),{method:"POST"})).json();_.success?(m.success(_.message||`Service ${l} restarted`),setTimeout(R,2e3)):m.error(_.message||`Failed to restart ${l}`)}catch(i){m.error(`Restart failed: ${i.message}`)}}async function n(){if(confirm("Are you sure you want to reboot the device? This will interrupt all recordings and streams."))try{const{buildApiUrl:l}=await X(async()=>{const{buildApiUrl:_}=await import("./index-C-UnMYRj.js").then(h=>h.a3);return{buildApiUrl:_}},__vite__mapDeps([0,1])),g=await(await fetch(await l("/api/system/reboot"),{method:"POST"})).json();g.success?m.success("Device is rebooting..."):m.error(g.message||"Failed to reboot device")}catch(l){m.error(`Reboot failed: ${l.message}`)}}async function O(l){try{const{buildApiUrl:i}=await X(async()=>{const{buildApiUrl:h}=await import("./index-C-UnMYRj.js").then(A=>A.a3);return{buildApiUrl:h}},__vite__mapDeps([0,1])),g=await fetch(await i(`/api/ingest/stop/${l}`),{method:"POST"}),_=await g.json();g.ok?(m.success(`Stopped pipeline: ${l}`),await R()):m.error(_.detail||"Stop failed")}catch(i){m.error(`Stop failed: ${i.message}`)}}function j(l){return l.active?"bg-preke-green":"bg-preke-red"}function o(l){switch(l){case"running":return"text-preke-green";case"starting":return"text-preke-gold";case"stopping":return"text-preke-gold";default:return"text-preke-text-muted"}}function S(l){return l>90?"bg-preke-red":l>70?"bg-preke-gold":"bg-preke-green"}function G(l){return l>80?"text-preke-red":l>65?"text-preke-gold":"text-preke-green"}return L(()=>{R(),u.value=window.setInterval(R,1e4)}),te(()=>{u.value&&clearInterval(u.value)}),(l,i)=>{var g,_,h,A,b,E,N,H,q,w,J;return t(),s("div",Jt,[a.value?(t(),s("div",Kt,[...i[1]||(i[1]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-preke-gold border-t-transparent rounded-full"},null,-1)])])):x.value?(t(),s("div",Wt,[e("p",Xt,"Error loading system status: "+p(x.value),1),e("button",{onClick:R,class:"btn-v2 btn-v2--secondary mt-4"},"Retry")])):(t(),s(T,{key:2},[e("div",Yt,[e("div",Zt,[i[4]||(i[4]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"CPU Load",-1)),(h=(_=(g=f.value)==null?void 0:g.info)==null?void 0:_.load_average)!=null&&h.some($=>$>0)?(t(),s("div",Qt,[e("div",es,[e("div",{class:C(["absolute left-0 top-0 h-full rounded-full transition-all duration-500",S(D.value)]),style:oe({width:`${D.value}%`})},null,6)]),e("div",ts,[i[2]||(i[2]=e("span",{class:"text-preke-text-muted"},"Load Average",-1)),e("span",ss,p((E=(b=(A=f.value)==null?void 0:A.info)==null?void 0:b.load_average)==null?void 0:E.map($=>$.toFixed(2)).join(" / ")),1)])])):(t(),s("div",ns,[...i[3]||(i[3]=[e("span",{class:"text-preke-text-muted"},"N/A",-1)])]))]),e("div",os,[i[7]||(i[7]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Memory",-1)),v.value>0?(t(),s("div",as,[e("div",ls,[e("div",{class:C(["absolute left-0 top-0 h-full rounded-full transition-all duration-500",S(v.value)]),style:oe({width:`${v.value}%`})},null,6)]),e("div",is,[i[5]||(i[5]=e("span",{class:"text-preke-text-muted"},"Used",-1)),e("span",rs,p(v.value.toFixed(1))+"%",1)])])):(t(),s("div",ds,[...i[6]||(i[6]=[e("span",{class:"text-preke-text-muted"},"N/A",-1)])]))]),e("div",cs,[i[8]||(i[8]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Temperature",-1)),e("div",us,[r.value?(t(),s("span",{key:0,class:C(["text-3xl font-bold",G(r.value.temp_celsius)])},p(r.value.temp_celsius.toFixed(1))+"°C ",3)):(t(),s("span",ps,"N/A"))]),(N=r.value)!=null&&N.type?(t(),s("p",vs,p(r.value.type),1)):P("",!0)]),e("div",ms,[i[9]||(i[9]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Uptime",-1)),e("div",xs,[((q=(H=f.value)==null?void 0:H.info)==null?void 0:q.uptime_seconds)>0?(t(),s("span",fs,p(d.value),1)):(t(),s("span",ks,"N/A"))]),e("p",gs,p(((J=(w=f.value)==null?void 0:w.info)==null?void 0:J.hostname)||"R58 Device"),1)])]),e("div",bs,[e("div",_s,[i[10]||(i[10]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide"},"Services",-1)),e("div",ys,[e("button",{onClick:i[0]||(i[0]=$=>k("preke-recorder")),class:"btn-v2 btn-v2--secondary text-sm",title:"Restart the main service"}," Restart Service "),e("button",{onClick:n,class:"btn-v2 btn-v2--danger text-sm",title:"Reboot the device"}," Reboot Device ")])]),e("div",hs,[(t(!0),s(T,null,U(M.value,$=>(t(),s("div",{key:$.name,class:"flex items-center justify-between p-3 rounded-lg bg-preke-surface border border-preke-surface-border"},[e("div",ws,[e("span",{class:C(["w-2.5 h-2.5 rounded-full",j($)])},null,2),e("div",null,[e("p",$s,p($.name),1),e("p",js,[W(p($.status)+" ",1),$.memory_mb?(t(),s("span",Ss," · "+p($.memory_mb.toFixed(0))+" MB",1)):P("",!0)])])]),$.name!=="vdo.ninja"?(t(),s("button",{key:0,onClick:de=>k($.name),class:"text-preke-text-muted hover:text-preke-gold transition-colors",title:"Restart service"},[...i[11]||(i[11]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])],8,Ds)):(t(),s("span",Cs,"External"))]))),128))])]),e("div",As,[e("h3",Rs,[i[12]||(i[12]=W(" Active Pipelines ",-1)),e("span",Ps,"("+p(V.value.length)+")",1)]),V.value.length===0?(t(),s("div",Vs," No active pipelines ")):(t(),s("div",Ms,[(t(!0),s(T,null,U(V.value,$=>(t(),s("div",{key:$.pipeline_id,class:"flex items-center justify-between p-3 rounded-lg bg-preke-surface border border-preke-surface-border"},[e("div",Ns,[e("div",null,[e("p",Ts,p($.pipeline_id),1),e("p",Es,[W(" Type: "+p($.pipeline_type)+" ",1),$.device?(t(),s("span",Os," · "+p($.device),1)):P("",!0)])])]),e("div",Us,[e("span",{class:C(["text-sm font-medium capitalize",o($.state)])},p($.state),3),$.state==="running"?(t(),s("button",{key:0,onClick:de=>O($.pipeline_id),class:"btn-v2 btn-v2--danger text-sm",title:"Stop pipeline"}," Stop ",8,Fs)):P("",!0)])]))),128))]))])],64))])}}}),Is={class:"space-y-6"},Bs={class:"glass-card p-4 rounded-xl"},zs={class:"space-y-4"},Gs={key:0,class:"glass-card p-4 rounded-xl"},Hs={class:"space-y-2"},qs={class:"flex-1 min-w-0"},Js={class:"flex items-center gap-2"},Ks={class:"text-sm font-medium text-preke-text"},Ws={key:0,class:"text-xs px-2 py-0.5 rounded bg-preke-gold/20 text-preke-gold"},Xs={class:"text-xs text-preke-text-muted truncate mt-1"},Ys=["onClick"],Zs={class:"glass-card p-4 rounded-xl"},Qs={class:"space-y-4"},en=["value"],tn={class:"glass-card p-4 rounded-xl"},sn={class:"space-y-4"},nn=["value"],on={class:"flex items-center justify-between"},an={key:0},ln={class:"glass-card p-4 rounded-xl bg-preke-surface/30"},rn={class:"space-y-2 text-sm"},dn={class:"flex justify-between"},cn={class:"text-preke-text"},le="preke-settings",un=z({__name:"SettingsPanel",setup(I){const m=re(),a=y([]),x=y(null),f=y("Preke Device"),u=y(ae),D=y(ke()),v=y("/opt/r58/recordings"),r=y(!1),d=y(30),M=F(()=>me());function V(){try{const j=localStorage.getItem(le);if(j){const o=JSON.parse(j);f.value=o.deviceName||f.value,u.value=o.vdoRoom||u.value,r.value=o.autoCleanup||!1,d.value=o.cleanupDays||30}}catch{}}function R(){try{const j={deviceName:f.value,vdoRoom:u.value,autoCleanup:r.value,cleanupDays:d.value};localStorage.setItem(le,JSON.stringify(j)),m.success("Settings saved")}catch(j){m.error("Failed to save settings"),console.error("Failed to save settings:",j)}}function k(){f.value="Preke Device",u.value=ae,r.value=!1,d.value=30,R(),m.info("Settings reset to defaults")}async function n(){if(window.electronAPI)try{a.value=await window.electronAPI.getDevices();const j=await window.electronAPI.getActiveDevice();x.value=(j==null?void 0:j.id)||null}catch(j){console.error("Failed to load devices:",j)}}async function O(j){if(!(!window.electronAPI||!confirm("Remove this device?")))try{await window.electronAPI.removeDevice(j),await n(),m.success("Device removed")}catch(o){console.error("Failed to remove device:",o),m.error("Failed to remove device")}}return L(()=>{V(),n()}),(j,o)=>(t(),s("div",Is,[e("div",Bs,[o[6]||(o[6]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Device",-1)),e("div",zs,[e("div",null,[o[4]||(o[4]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Device Name",-1)),B(e("input",{"onUpdate:modelValue":o[0]||(o[0]=S=>f.value=S),type:"text",class:"input w-full",placeholder:"My Preke Device"},null,512),[[Z,f.value]]),o[5]||(o[5]=e("p",{class:"text-xs text-preke-text-muted mt-1"},"Display name for this device in the app",-1))])])]),M.value&&a.value.length>0?(t(),s("div",Gs,[o[8]||(o[8]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Saved Devices",-1)),e("div",Hs,[(t(!0),s(T,null,U(a.value,S=>(t(),s("div",{key:S.id,class:C(["flex items-center justify-between p-3 rounded-lg border border-preke-surface-border",{"bg-preke-gold/10 border-preke-gold/30":S.id===x.value}])},[e("div",qs,[e("div",Js,[e("span",Ks,p(S.name),1),S.id===x.value?(t(),s("span",Ws," Active ")):P("",!0)]),e("p",Xs,p(S.url),1)]),e("button",{onClick:G=>O(S.id),class:"ml-3 p-2 rounded-lg text-preke-text-muted hover:text-red-400 hover:bg-red-500/10 transition-colors",title:"Remove device"},[...o[7]||(o[7]=[e("svg",{viewBox:"0 0 20 20",fill:"currentColor",class:"w-4 h-4"},[e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)])],8,Ys)],2))),128))])])):P("",!0),e("div",Zs,[o[13]||(o[13]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"VDO.ninja / Mixer",-1)),e("div",Qs,[e("div",null,[o[9]||(o[9]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Room Name",-1)),B(e("input",{"onUpdate:modelValue":o[1]||(o[1]=S=>u.value=S),type:"text",class:"input w-full",placeholder:"r58studio"},null,512),[[Z,u.value]]),o[10]||(o[10]=e("p",{class:"text-xs text-preke-text-muted mt-1"},"VDO.ninja room for video mixing",-1))]),e("div",null,[o[11]||(o[11]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"VDO Host",-1)),e("input",{value:D.value,type:"text",class:"input w-full bg-preke-surface opacity-60",readonly:"",disabled:""},null,8,en),o[12]||(o[12]=e("p",{class:"text-xs text-preke-text-muted mt-1"},"VDO.ninja server (read-only)",-1))])])]),e("div",tn,[o[18]||(o[18]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Storage",-1)),e("div",sn,[e("div",null,[o[14]||(o[14]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Recording Path",-1)),e("input",{value:v.value,type:"text",class:"input w-full bg-preke-surface opacity-60",readonly:"",disabled:""},null,8,nn),o[15]||(o[15]=e("p",{class:"text-xs text-preke-text-muted mt-1"}," Configured in config.yml on R58 device. Default: /opt/r58/recordings/ ",-1))]),e("div",on,[o[16]||(o[16]=e("div",null,[e("label",{class:"block text-sm font-medium text-preke-text"},"Auto-cleanup old recordings"),e("p",{class:"text-xs text-preke-text-muted"},"Automatically delete recordings older than specified days")],-1)),e("button",{onClick:o[2]||(o[2]=S=>r.value=!r.value),class:C(["relative inline-flex h-6 w-11 items-center rounded-full transition-colors",r.value?"bg-preke-gold":"bg-preke-surface-elevated"])},[e("span",{class:C(["inline-block h-4 w-4 transform rounded-full bg-white transition-transform",r.value?"translate-x-6":"translate-x-1"])},null,2)],2)]),r.value?(t(),s("div",an,[o[17]||(o[17]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Keep recordings for (days)",-1)),B(e("input",{"onUpdate:modelValue":o[3]||(o[3]=S=>d.value=S),type:"number",min:"1",max:"365",class:"input w-24"},null,512),[[Z,d.value,void 0,{number:!0}]])])):P("",!0),e("div",{class:"pt-4 border-t border-preke-surface-border"},[e("button",{onClick:k,class:"btn-v2 btn-v2--secondary w-full"}," Reset to Defaults ")])])]),e("div",{class:"flex items-center justify-end"},[e("button",{onClick:R,class:"btn-v2 btn-v2--primary"}," Save Settings ")]),e("div",ln,[o[21]||(o[21]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"About",-1)),e("div",rn,[o[20]||(o[20]=e("div",{class:"flex justify-between"},[e("span",{class:"text-preke-text-muted"},"App Version"),e("span",{class:"text-preke-text"},"2.0.0")],-1)),e("div",dn,[o[19]||(o[19]=e("span",{class:"text-preke-text-muted"},"Platform",-1)),e("span",cn,p(M.value?"Desktop (Electron)":"Web Browser"),1)])])])]))}}),pn={class:"h-full flex flex-col bg-preke-bg"},vn={class:"px-6 py-4 border-b border-preke-surface-border bg-preke-surface/50 backdrop-blur-sm"},mn={class:"flex gap-1"},xn=["onClick"],fn={class:"flex-1 p-6 overflow-y-auto"},kn={key:2,class:"glass-card p-6 rounded-xl"},gn={key:3,class:"glass-card p-6 rounded-xl"},bn={key:5,class:"design-panel"},_n={class:"design-links"},yn={class:"design-links__group"},hn=z({__name:"AdminView",setup(I){const m=xe(),a=y("system"),x=[{id:"system",label:"System"},{id:"status",label:"Device Status"},{id:"logs",label:"Logs"},{id:"fleet",label:"Fleet"},{id:"settings",label:"Settings"},{id:"design",label:"Design"}];return L(()=>{const f=m.query.tab;f&&x.some(u=>u.id===f)&&(a.value=f)}),(f,u)=>{const D=fe("router-link");return t(),s("div",pn,[e("header",vn,[u[0]||(u[0]=e("h1",{class:"text-xl font-semibold text-preke-text mb-4"},"Admin",-1)),e("div",mn,[(t(),s(T,null,U(x,v=>e("button",{key:v.id,onClick:r=>a.value=v.id,class:C(["px-4 py-2 rounded-lg transition-all duration-200 font-medium text-sm",[a.value===v.id?"bg-preke-gold/20 text-preke-gold border border-preke-gold/30":"text-preke-text-muted hover:text-preke-text hover:bg-preke-surface"]])},p(v.label),11,xn)),64))])]),e("div",fn,[a.value==="system"?(t(),Q(Ls,{key:0})):a.value==="status"?(t(),Q(_t,{key:1})):a.value==="logs"?(t(),s("div",kn,[u[1]||(u[1]=e("h2",{class:"text-lg font-semibold text-preke-text mb-4"},"System Logs",-1)),K(At)])):a.value==="fleet"?(t(),s("div",gn,[K(qt)])):a.value==="settings"?(t(),Q(un,{key:4})):a.value==="design"?(t(),s("div",bn,[u[6]||(u[6]=e("h2",{class:"text-lg font-semibold text-preke-text mb-4"},"Design Resources",-1)),u[7]||(u[7]=e("p",{class:"text-preke-text-muted mb-6"},"Access design documentation, proposals, experiments, and style guides.",-1)),e("div",_n,[K(D,{to:"/design-archive",class:"design-link design-link--primary"},{default:ee(()=>[...u[2]||(u[2]=[e("div",{class:"design-link__icon design-link__icon--gold"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})])],-1),e("div",{class:"design-link__content"},[e("h3",null,"Design Archive"),e("p",null,"Browse all designs with thumbnails, search, and filters")],-1),e("svg",{class:"design-link__arrow",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5l7 7-7 7"})],-1)])]),_:1}),e("div",yn,[u[5]||(u[5]=e("h4",{class:"design-links__group-title"},"Documentation",-1)),K(D,{to:"/styleguide-v2",class:"design-link"},{default:ee(()=>[...u[3]||(u[3]=[e("div",{class:"design-link__icon design-link__icon--gold"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1),e("div",{class:"design-link__content"},[e("h3",null,"Style Guide V2"),e("p",null,"Current design system")],-1),e("svg",{class:"design-link__arrow",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5l7 7-7 7"})],-1)])]),_:1}),K(D,{to:"/styleguide",class:"design-link"},{default:ee(()=>[...u[4]||(u[4]=[e("div",{class:"design-link__icon design-link__icon--gold"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})])],-1),e("div",{class:"design-link__content"},[e("h3",null,"Style Guide V1"),e("p",null,"Legacy reference")],-1),e("svg",{class:"design-link__arrow",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5l7 7-7 7"})],-1)])]),_:1})])])])):P("",!0)])])}}}),jn=ie(hn,[["__scopeId","data-v-2a8faf9e"]]);export{jn as default};
