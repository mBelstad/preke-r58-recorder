import{d as P,A as C,r as c,h as g,j as L,c as l,l as M,a as e,m as S,T as V,t as u,F as f,b as x,q as O,E as N,n as R,o as r,_ as $}from"./index-DSt97A8k.js";import{g as j,a as B,b as D}from"./vdoninja-Bq-VPStF.js";import{M as I}from"./ModeLoadingScreen-DCQzX3bx.js";const T={class:"h-full flex flex-col bg-r58-bg-primary"},U={class:"flex items-center justify-between px-4 py-2 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},E={class:"flex items-center gap-3"},H={class:"text-sm text-r58-text-secondary"},W={class:"flex-1 flex"},A={class:"flex-1 relative bg-black"},F=["src"],q={key:1,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},z={class:"w-80 bg-r58-bg-secondary border-l border-r58-bg-tertiary flex flex-col"},G={class:"flex-1 overflow-y-auto p-2 space-y-2"},J={key:0,class:"flex items-center justify-center h-32 text-r58-text-secondary text-sm"},K=["onClick"],Q=["src","onLoad"],X={class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-2"},Y={class:"text-white text-xs font-medium"},Z={key:0,class:"absolute top-1 right-1 px-1.5 py-0.5 bg-red-600 text-white text-[10px] font-bold rounded"},ee=P({__name:"MixerView",setup(te){const m=C(),p=c(!0),b=c({}),o=g(()=>m.inputs.filter(t=>t.hasSignal));function v(t,s){const a=B(),d=j(),k=D(t),i=new URL(`${d}://${a}/`);return i.searchParams.set("whepplay",k),i.searchParams.set("label",s),i.searchParams.set("cleanoutput",""),i.searchParams.set("hideheader",""),i.searchParams.set("nologo",""),i.searchParams.set("cover",""),i.toString()}function h(t){console.log(`[Mixer] Camera ${t} iframe loaded`),b.value[t]=!0}const y=g(()=>o.value.length===0?!1:o.value.every(t=>b.value[t.id]));function _(){p.value=!1}const n=c(null);function w(t){n.value=t,console.log(`[Mixer] Selected camera: ${t}`)}return L(async()=>{await m.fetchInputs(),o.value.length>0&&(n.value=o.value[0].id)}),(t,s)=>(r(),l(f,null,[M(V,{name:"fade"},{default:S(()=>[p.value?(r(),N(I,{key:0,mode:"mixer","content-ready":y.value||o.value.length===0,"min-time":1500,"max-time":8e3,onReady:_},null,8,["content-ready"])):x("",!0)]),_:1}),e("div",T,[e("header",U,[e("div",E,[s[0]||(s[0]=e("span",{class:"text-lg font-semibold text-r58-mixer"},"Mixer",-1)),e("span",H,u(o.value.length)+" camera"+u(o.value.length!==1?"s":"")+" connected ",1)]),s[1]||(s[1]=e("div",{class:"flex items-center gap-2 text-xs text-r58-text-secondary"},[e("span",{class:"px-2 py-1 bg-r58-bg-tertiary rounded"},"Direct WHEP Playback")],-1))]),e("div",W,[e("div",A,[n.value?(r(),l(f,{key:0},[(r(),l("iframe",{key:n.value,src:v(n.value,"Program"),class:"absolute inset-0 w-full h-full border-0",allow:"autoplay",allowfullscreen:""},null,8,F)),s[2]||(s[2]=e("div",{class:"absolute top-2 left-2 px-2 py-1 bg-red-600 text-white text-xs font-bold rounded"}," PGM ",-1))],64)):(r(),l("div",q," No camera selected "))]),e("div",z,[s[3]||(s[3]=e("div",{class:"px-3 py-2 border-b border-r58-bg-tertiary"},[e("span",{class:"text-sm font-medium text-r58-text-primary"},"Sources")],-1)),e("div",G,[o.value.length===0?(r(),l("div",J," No cameras detected ")):x("",!0),(r(!0),l(f,null,O(o.value,a=>(r(),l("div",{key:a.id,class:R(["relative aspect-video bg-black rounded overflow-hidden cursor-pointer transition-all",{"ring-2 ring-red-500":n.value===a.id}]),onClick:d=>w(a.id)},[e("iframe",{src:v(a.id,a.name),onLoad:d=>h(a.id),class:"absolute inset-0 w-full h-full border-0 pointer-events-none",allow:"autoplay"},null,40,Q),e("div",X,[e("span",Y,u(a.name),1)]),n.value===a.id?(r(),l("div",Z," ON AIR ")):x("",!0)],10,K))),128))])])])])],64))}}),re=$(ee,[["__scopeId","data-v-985a3818"]]);export{re as default};
