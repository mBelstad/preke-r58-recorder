import{J as Ue,r as C,h as H,K as oe,L as ue,A as ge,B as re,j as ve,V as Ae,d as Z,c as n,b as j,a as e,F as W,q as J,n as A,w as q,x as ne,M as Me,t as h,I as K,y as pe,o as t,_ as le,N as Se,e as be,E as me,p as Q,G as ye,g as B,v as fe,l as ee,k as xe,O as Ie,P as Re,s as ke,H as Ve,Q as He,m as Ne,T as Be}from"./index-DpWLrnAr.js";import{b as ze,a as Fe,g as Ke,c as Ge,d as Ee,e as We,f as Ye,h as Je,V as De}from"./vdoninja-Bb8RB2-n.js";import{M as qe}from"./ModeLoadingScreen-CDOGsHAk.js";const ce=[{id:"youtube",name:"YouTube Live",icon:"â–¶ï¸",rtmpBaseUrl:"rtmp://a.rtmp.youtube.com/live2/",streamKeyPlaceholder:"xxxx-xxxx-xxxx-xxxx-xxxx",helpUrl:"https://support.google.com/youtube/answer/2907883"},{id:"twitch",name:"Twitch",icon:"ðŸ“º",rtmpBaseUrl:"rtmp://live.twitch.tv/app/",streamKeyPlaceholder:"live_xxxxxxxxxx_xxxxxxxxxxxxxx",helpUrl:"https://help.twitch.tv/s/article/twitch-stream-key-faq"},{id:"facebook",name:"Facebook Live",icon:"ðŸ“˜",rtmpBaseUrl:"rtmps://live-api-s.facebook.com:443/rtmp/",streamKeyPlaceholder:"FB-xxxxxxxxxx-x",helpUrl:"https://www.facebook.com/help/587160588142067"},{id:"restream",name:"Restream",icon:"ðŸ”„",rtmpBaseUrl:"rtmp://live.restream.io/live/",streamKeyPlaceholder:"re_xxxxxx_xxxxxxxxxx",helpUrl:"https://support.restream.io/en/"},{id:"custom",name:"Custom RTMP",icon:"âš™ï¸",rtmpBaseUrl:"",streamKeyPlaceholder:"your-stream-key"}],he=Ue("streaming",()=>{const _=C([]),a=C(!1),s=C(null),m=C({enabled:!1,host:"",port:8890,streamId:"mixer_program"}),r=H(()=>_.value.find(I=>I.id===s.value)),p=H(()=>_.value.filter(I=>I.enabled)),f=H(()=>ce),d=H(()=>{const I=window.location.hostname,P=I==="localhost"||I==="127.0.0.1"?"localhost":I.replace("r58-api","r58-mediamtx");return{rtmp:`rtmp://${P}:1935/mixer_program`,rtsp:`rtsp://${P}:8554/mixer_program`,srt:`srt://${P}:8890?streamid=read:mixer_program`,hls:`https://${I}/hls/mixer_program/index.m3u8`,whep:`${window.location.origin}/api/v1/whep/mixer_program/whep`}});function l(I,u){const P=ce.find(v=>v.id===I);if(!P)throw new Error(`Unknown platform: ${I}`);const R={id:`dest-${Date.now()}`,platformId:I,name:u||P.name,streamKey:"",enabled:!1};return _.value.push(R),R}function M(I,u){const P=_.value.findIndex(R=>R.id===I);P!==-1&&(_.value[P]={..._.value[P],...u})}function g(I){const u=_.value.findIndex(P=>P.id===I);u!==-1&&_.value.splice(u,1),s.value===I&&(s.value=null)}function i(I){s.value=I}function x(I){m.value.enabled=I}function $(I){m.value={...m.value,...I}}function N(){a.value=!0}function T(){a.value=!1}function b(I){const u=ce.find(P=>P.id===I.platformId);return u?I.platformId==="custom"?`${I.name}${I.streamKey}`:`${u.rtmpBaseUrl}${I.streamKey}`:""}function E(){const I=window.location.hostname;return`srt://${I==="localhost"||I==="127.0.0.1"?"localhost":I.replace("r58-api","r58-mediamtx")}:${m.value.port}?streamid=read:${m.value.streamId}`}function y(){try{const I=localStorage.getItem("r58-streaming-destinations");if(I){const u=JSON.parse(I);_.value=u.destinations||[],u.srtOutput&&(m.value={...m.value,...u.srtOutput})}}catch(I){console.warn("Failed to load saved streaming destinations:",I)}}function o(){try{localStorage.setItem("r58-streaming-destinations",JSON.stringify({destinations:_.value,srtOutput:m.value}))}catch(I){console.warn("Failed to save streaming destinations:",I)}}return y(),{destinations:_,isStreaming:a,activeDestinationId:s,srtOutput:m,activeDestination:r,enabledDestinations:p,platforms:f,programOutputUrls:d,addDestination:l,updateDestination:M,removeDestination:g,setActiveDestination:i,toggleSrtOutput:x,updateSrtConfig:$,startStreaming:N,stopStreaming:T,buildRtmpUrl:b,getSrtOutputUrl:E,saveDestinations:o,loadSavedDestinations:y}});function Xe(_){const a=oe(),s=ue();ge();const m=C(!1),r=C(!1),p=C(null);function f(){return _.value}function d(){var S,U;const c=f();return c?((S=c.isReady)==null?void 0:S.value)===!0||((U=c.connectionState)==null?void 0:U.value)==="connected"?!0:r.value:!1}function l(c){return c.slots.filter(S=>S.sourceId).map(S=>S.sourceId)}function M(c){const S=f();if(!S){console.warn("[MixerController] VDO.ninja embed not available");return}d()||console.log("[MixerController] VDO.ninja may not be fully ready, attempting anyway"),console.log("[MixerController] Applying scene to VDO:",c.name,"- VDO Scene:",c.vdoSceneNumber,"- Layout:",Ae[c.layoutPreset]||c.layoutPreset);try{S.setLayout(c.layoutPreset);const U=l(c);for(const V of U)S.addToScene(V,c.vdoSceneNumber);p.value=c.id,console.log("[MixerController] Scene applied successfully:",c.name,"- Sources:",U.length)}catch(U){console.error("[MixerController] Error applying scene to VDO:",U)}}function g(c){const S=s.getScene(c);S&&M(S)}async function i(){const c=a.previewSceneId;if(!c)return;const S=s.getScene(c);S&&(M(S),await a.take())}function x(){const c=a.previewSceneId;if(!c)return;const S=s.getScene(c);S&&(M(S),a.cut())}function $(c,S){const U=f();if(!U||!d())return;const V=a.previewSceneId?s.getScene(a.previewSceneId):null,w=(V==null?void 0:V.vdoSceneNumber)||1;if(U.addToScene(c,w),a.previewSceneId&&V){const D=S??V.slots.findIndex(O=>!O.sourceId);if(D>=0&&D<V.slots.length){const O=V.slots[D].id;s.updateSlot(a.previewSceneId,O,{sourceId:c})}}}function N(c){const S=f();!S||!d()||S.removeFromScene(c)}function T(c){const S=f();!S||!d()||S.setProgram(c)}function b(c,S){const U=f();U&&d()&&U.setMute(c,S),a.setSourceMute(c,S)}function E(c){const S=f();S&&d()&&S.toggleMute(c);const U=a.sources.find(V=>V.id===c);U&&a.setSourceMute(c,!U.muted)}function y(c,S){const U=f();U&&d()&&U.setVolume(c,S*2),a.setSourceVolume(c,S)}function o(c,S){const U=f();U&&d()&&S&&U.sendCommand("soloChat",c),a.setSourceSolo(c,S)}function I(c){const S=f();S&&d()&&S.kickGuest(c),a.removeSource(c)}function u(c,S){const U=f();U&&d()&&U.sendCommand("sendChat",c,S)}function P(c){const S=f();if(S&&d()){const U=a.previewSceneId?s.getScene(a.previewSceneId):null,V=(U==null?void 0:U.vdoSceneNumber)||1;S.addToScene(c,V)}a.admitFromGreenroom(c)}function R(){const c=f();c&&d()&&c.startRecording()}function v(){const c=f();c&&d()&&c.stopRecording()}function k(c,S,U){const V=f();V&&d()&&V.sendCommand(c,S,U)}return re(()=>{var c,S;return(S=(c=_.value)==null?void 0:c.isReady)==null?void 0:S.value},c=>{if(m.value=c===!0,c){if(console.log("[MixerController] VDO.ninja connected"),a.setVdoConnected(!0),r.value=!0,a.programSceneId){const S=s.getScene(a.programSceneId);S&&S.id!==p.value&&M(S)}}else a.setVdoConnected(!1)},{immediate:!0}),ve(()=>{setTimeout(()=>{!r.value&&_.value&&(console.log("[MixerController] Fallback initialization (timeout)"),r.value=!0,m.value=!0,a.setVdoConnected(!0))},6e3)}),re(()=>a.programSceneId,c=>{if(c&&c!==p.value){const S=s.getScene(c);S&&d()&&M(S)}}),re(()=>{var c,S;return(S=(c=_.value)==null?void 0:c.lastError)==null?void 0:S.value},c=>{c&&a.setLastError(c)}),{isConnected:m,isInitialized:r,applySceneToVdo:M,switchToScene:g,takeToProgram:i,cutToProgram:x,addSourceToScene:$,removeSourceFromScene:N,setSourceAsProgram:T,setMute:b,toggleMute:E,setVolume:y,setSolo:o,kickGuest:I,sendMessage:u,admitFromGreenroom:P,startRecording:R,stopRecording:v,sendDirectorCommand:k}}const Qe={class:"source-panel space-y-4","data-testid":"source-panel"},Ze={key:0,class:"px-3 py-2 bg-amber-500/10 border border-amber-500/30 rounded-lg text-xs text-amber-400"},et={key:1,class:"text-center py-6 text-r58-text-secondary"},tt={key:2,class:"space-y-2"},ot={class:"flex items-center gap-3"},nt={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},st={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},rt={key:2,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},at={key:3,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},it={class:"flex-1 min-w-0"},lt={key:0,class:"flex items-center gap-1"},dt=["onDblclick"],ct={class:"flex items-center gap-2 text-xs text-r58-text-secondary"},ut={key:0,class:"text-red-400 font-bold"},vt={key:1,class:"text-amber-400"},mt={class:"flex items-center gap-1 flex-shrink-0"},pt=["onClick"],gt=["onClick","title"],xt={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ft={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},bt={key:0,class:"mt-2"},yt={class:"h-1 bg-r58-bg-primary rounded-full overflow-hidden"},je="preke-source-names",ht=Z({__name:"SourcePanel",props:{vdoEmbed:{},controller:{}},setup(_){function a(){try{const R=localStorage.getItem(je);return R?JSON.parse(R):{}}catch{return{}}}function s(R,v){const k=a();k[R]=v,localStorage.setItem(je,JSON.stringify(k))}const m=C(a()),r=C(null),p=C(""),f=_,d=oe(),l=ue(),M=ge(),g={cam0:{name:"HDMI 1",subtitle:"Connected to device"},cam1:{name:"HDMI 2",subtitle:"Connected to device"},cam2:{name:"HDMI 3",subtitle:"Connected to device"},cam3:{name:"HDMI 4",subtitle:"Connected to device"}},i=H(()=>d.sources.map(R=>{let v=R.label,k="VDO.ninja";const c=R.id.match(/cam(\d+)/i)||R.id.match(/hdmi[_-]?(\d+)/i);return c?(v=`HDMI ${parseInt(c[1])+1}`,k="Connected to device"):R.type==="guest"?(k="Remote guest",(!R.label||R.label.length>20||R.label.match(/^[a-z0-9]{8,}$/i))&&(v="Guest")):R.type==="screen"&&(k="Screen share"),{...R,label:v,subtitle:k}})),x=H(()=>M.inputs.filter(R=>R.hasSignal).map(R=>{const v=g[R.id]||{name:R.label,subtitle:"HDMI Input"};return{id:R.id,label:v.name,subtitle:v.subtitle,type:"camera",hasVideo:!0,hasAudio:!0,muted:!1,audioLevel:0}})),$=H(()=>i.value.length>0?i.value:x.value),N=H(()=>i.value.length===0&&x.value.length>0);function T(R){const v=l.getScene(d.previewSceneId||"");return(v==null?void 0:v.slots.some(k=>k.sourceId===R))||!1}function b(R){return d.liveSourceIds.includes(R)}function E(R){var v,k;f.controller?f.controller.toggleMute(R.id):(f.vdoEmbed&&((k=(v=f.vdoEmbed).toggleMute)==null||k.call(v,R.id)),d.setSourceMute(R.id,!R.muted))}function y(R){const v=l.getScene(d.previewSceneId||"");if(!v)return;f.controller&&f.controller.addSourceToScene(R.id);const k=v.slots.find(c=>!c.sourceId);k&&l.assignSourceToSlot(v.id,k.id,R.id)}function o(R){return m.value[R.id]||R.label}function I(R){r.value=R.id,p.value=m.value[R.id]||R.label}function u(){r.value&&p.value.trim()&&(s(r.value,p.value.trim()),m.value=a()),r.value=null}function P(){r.value=null,p.value=""}return(R,v)=>(t(),n("div",Qe,[N.value?(t(),n("div",Ze," Showing HDMI cameras. VDO.ninja sources will appear when connected. ")):j("",!0),$.value.length===0?(t(),n("div",et,[...v[1]||(v[1]=[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),e("p",{class:"text-sm"},"No sources connected",-1),e("p",{class:"text-xs mt-1 opacity-75"},"Connect HDMI or invite guests",-1)])])):(t(),n("div",tt,[(t(!0),n(W,null,J($.value,k=>(t(),n("div",{key:k.id,class:A(["source-card p-3 rounded-lg transition-all",[b(k.id)?"bg-red-500/10 border border-red-500/30":T(k.id)?"bg-amber-500/10 border border-amber-500/30":"bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 border border-transparent"]])},[e("div",ot,[e("div",{class:A(["w-10 h-10 rounded-lg bg-r58-bg-primary flex items-center justify-center flex-shrink-0",{"ring-2 ring-red-500":b(k.id),"ring-2 ring-amber-500":T(k.id)&&!b(k.id)}])},[k.type==="camera"?(t(),n("svg",nt,[...v[2]||(v[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])):k.type==="guest"?(t(),n("svg",st,[...v[3]||(v[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])])):k.type==="screen"?(t(),n("svg",rt,[...v[4]||(v[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},null,-1)])])):(t(),n("svg",at,[...v[5]||(v[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"},null,-1)])]))],2),e("div",it,[r.value===k.id?(t(),n("div",lt,[q(e("input",{"onUpdate:modelValue":v[0]||(v[0]=c=>p.value=c),onKeyup:[Me(u,["enter"]),Me(P,["escape"])],onBlur:u,class:"input text-sm py-0.5 px-1 w-full",autofocus:""},null,544),[[ne,p.value]])])):(t(),n("p",{key:1,onDblclick:c=>I(k),class:"font-medium text-sm truncate cursor-pointer hover:text-r58-accent-primary",title:"Double-click to rename"},h(o(k)),41,dt)),e("div",ct,[e("span",null,h(k.subtitle),1),b(k.id)?(t(),n("span",ut,"LIVE")):T(k.id)?(t(),n("span",vt,"PVW")):j("",!0)])]),e("div",mt,[K(d).previewSceneId&&!T(k.id)?(t(),n("button",{key:0,onClick:c=>y(k),class:"p-1.5 rounded hover:bg-r58-bg-primary transition-colors text-r58-text-secondary hover:text-r58-accent-primary",title:"Add to preview scene"},[...v[6]||(v[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,pt)):j("",!0),k.hasAudio?(t(),n("button",{key:1,onClick:c=>E(k),class:A(["p-1.5 rounded transition-colors",k.muted?"bg-red-500/20 text-red-400":"hover:bg-r58-bg-primary text-r58-text-secondary"]),title:k.muted?"Unmute":"Mute"},[k.muted?(t(),n("svg",xt,[...v[7]||(v[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(t(),n("svg",ft,[...v[8]||(v[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],10,gt)):j("",!0)])]),k.hasAudio?(t(),n("div",bt,[e("div",yt,[e("div",{class:A(["h-full transition-all duration-75 rounded-full",k.muted?"bg-r58-bg-tertiary":k.audioLevel>80?"bg-red-500":k.audioLevel>60?"bg-amber-500":"bg-emerald-500"]),style:pe({width:`${k.audioLevel||0}%`})},null,6)])])):j("",!0)],2))),128))]))]))}}),kt=le(ht,[["__scopeId","data-v-db1e4cd2"]]),wt={class:"preview-program-view h-full flex flex-col","data-testid":"preview-program-view"},St={class:"flex-1 flex gap-4 min-h-0"},_t={class:"flex-1 flex flex-col min-w-0"},$t={class:"flex items-center justify-between mb-2"},Ct={key:0,class:"text-xs text-r58-text-secondary"},Mt=["src"],It={key:1,class:"absolute bottom-2 left-2 right-2 flex items-center justify-between pointer-events-none"},Rt={class:"px-2 py-1 bg-black/70 rounded text-xs text-white"},Et={class:"px-2 py-1 bg-black/70 rounded text-xs text-amber-400"},Dt={key:2,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary"},jt={key:3,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},Lt={class:"flex flex-col items-center justify-center gap-3 px-2"},Tt=["disabled"],Vt={key:0,class:"animate-pulse"},Pt={key:1},Ot=["disabled"],Ut={class:"flex flex-col gap-1 mt-2"},At=["value"],Ht=["value"],Nt={class:"flex-1 flex flex-col min-w-0"},Bt={class:"flex items-center justify-between mb-2"},zt={class:"flex items-center gap-2"},Ft={key:0,class:"px-2 py-0.5 bg-red-600 text-white text-xs font-bold rounded animate-pulse"},Kt={key:0,class:"text-xs text-r58-text-secondary"},Gt=["src"],Wt={key:1,class:"absolute bottom-2 left-2 right-2 flex items-center justify-between pointer-events-none"},Yt={class:"px-2 py-1 bg-black/70 rounded text-xs text-white"},Jt={key:0,class:"px-2 py-1 bg-red-600/90 rounded text-xs text-white font-bold"},qt={key:2,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary"},Xt={key:3,class:"absolute top-2 left-2 flex items-center gap-2 pointer-events-none"},Qt={key:4,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},Zt=Z({__name:"PreviewProgramView",props:{vdoEmbed:{},controller:{}},emits:["take","cut"],setup(_,{emit:a}){const s=_,m=a,r=oe(),p=ue(),f=C(r.transition.type),d=C(r.transition.duration),l=C(!1),M=C(!1),g=H(()=>p.getScene(r.previewSceneId||"")),i=H(()=>p.getScene(r.programSceneId||"")),x=H(()=>r.previewSceneId!==null&&r.previewSceneId!==r.programSceneId&&!r.isTransitioning),$=H(()=>r.isLive),N=H(()=>g.value?ze(g.value.vdoSceneNumber):null),T=H(()=>Fe(1));re([f,d],([I,u])=>{r.setTransition({type:I,duration:u})});function b(){x.value&&(s.controller?s.controller.takeToProgram():r.take(),m("take"))}function E(){r.previewSceneId&&(s.controller?s.controller.cutToProgram():r.cut(),m("cut"))}const y=[{value:"cut",label:"CUT"},{value:"fade",label:"FADE"},{value:"wipe-left",label:"WIPE L"},{value:"wipe-right",label:"WIPE R"}],o=[{value:100,label:"0.1s"},{value:300,label:"0.3s"},{value:500,label:"0.5s"},{value:1e3,label:"1.0s"}];return(I,u)=>(t(),n("div",wt,[e("div",St,[e("div",_t,[e("div",$t,[u[4]||(u[4]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-xs font-bold uppercase tracking-wider text-amber-400"},"PVW"),e("span",{class:"text-xs text-r58-text-secondary"},"Preview")],-1)),g.value?(t(),n("span",Ct,h(g.value.name),1)):j("",!0)]),e("div",{class:A(["flex-1 bg-black rounded-lg overflow-hidden border-2 transition-colors relative",g.value?"border-amber-500/50":"border-r58-bg-tertiary"])},[N.value?(t(),n("iframe",{key:0,src:N.value,class:A(["absolute inset-0 w-full h-full border-0",{"opacity-0":!l.value}]),allow:"autoplay; fullscreen",onLoad:u[0]||(u[0]=P=>l.value=!0)},null,42,Mt)):j("",!0),g.value?(t(),n("div",It,[e("span",Rt," Scene "+h(g.value.vdoSceneNumber)+": "+h(g.value.name),1),e("span",Et,h(g.value.slots.filter(P=>P.sourceId).length)+"/"+h(g.value.slots.length)+" sources ",1)])):j("",!0),g.value&&!l.value?(t(),n("div",Dt,[...u[5]||(u[5]=[e("div",{class:"animate-spin w-6 h-6 border-2 border-amber-400 border-t-transparent rounded-full"},null,-1)])])):j("",!0),g.value?j("",!0):(t(),n("div",jt,[...u[6]||(u[6]=[e("div",{class:"text-center"},[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]),e("p",{class:"text-sm"},"Select a scene to preview")],-1)])]))],2)]),e("div",Lt,[e("button",{onClick:b,disabled:!x.value,class:A(["take-button w-20 h-16 rounded-lg font-bold text-lg transition-all",x.value?"bg-red-600 hover:bg-red-500 text-white shadow-lg shadow-red-500/30":"bg-r58-bg-tertiary text-r58-text-secondary cursor-not-allowed"]),"data-testid":"take-button"},[K(r).isTransitioning?(t(),n("span",Vt,"...")):(t(),n("span",Pt,"TAKE"))],10,Tt),e("button",{onClick:E,disabled:!K(r).previewSceneId,class:A(["w-20 h-10 rounded-lg font-bold text-sm transition-all",K(r).previewSceneId?"bg-r58-bg-tertiary hover:bg-r58-accent-primary text-r58-text-primary":"bg-r58-bg-tertiary/50 text-r58-text-secondary cursor-not-allowed"]),"data-testid":"cut-button"}," CUT ",10,Ot),e("div",Ut,[q(e("select",{"onUpdate:modelValue":u[1]||(u[1]=P=>f.value=P),class:"w-20 px-2 py-1 text-xs bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-center"},[(t(),n(W,null,J(y,P=>e("option",{key:P.value,value:P.value},h(P.label),9,At)),64))],512),[[Se,f.value]]),q(e("select",{"onUpdate:modelValue":u[2]||(u[2]=P=>d.value=P),class:"w-20 px-2 py-1 text-xs bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-center"},[(t(),n(W,null,J(o,P=>e("option",{key:P.value,value:P.value},h(P.label),9,Ht)),64))],512),[[Se,d.value,void 0,{number:!0}]])])]),e("div",Nt,[e("div",Bt,[e("div",zt,[e("span",{class:A(["text-xs font-bold uppercase tracking-wider",$.value?"text-red-500":"text-r58-text-secondary"])}," PGM ",2),u[7]||(u[7]=e("span",{class:"text-xs text-r58-text-secondary"},"Program",-1)),$.value?(t(),n("span",Ft," LIVE ")):j("",!0)]),i.value?(t(),n("span",Kt,h(i.value.name),1)):j("",!0)]),e("div",{class:A(["flex-1 bg-black rounded-lg overflow-hidden border-2 transition-colors relative",$.value?"border-red-500":i.value?"border-emerald-500/50":"border-r58-bg-tertiary"])},[T.value?(t(),n("iframe",{key:0,src:T.value,class:A(["absolute inset-0 w-full h-full border-0",{"opacity-0":!M.value}]),allow:"autoplay; fullscreen",onLoad:u[3]||(u[3]=P=>M.value=!0)},null,42,Gt)):j("",!0),i.value?(t(),n("div",Wt,[e("span",Yt,h(i.value.name),1),$.value?(t(),n("span",Jt," ON AIR ")):j("",!0)])):j("",!0),M.value?j("",!0):(t(),n("div",qt,[...u[8]||(u[8]=[e("div",{class:"animate-spin w-6 h-6 border-2 border-emerald-400 border-t-transparent rounded-full"},null,-1)])])),$.value?(t(),n("div",Xt,[...u[9]||(u[9]=[e("div",{class:"w-3 h-3 rounded-full bg-red-500 animate-recording"},null,-1)])])):j("",!0),!i.value&&!M.value?(t(),n("div",Qt,[...u[10]||(u[10]=[be('<div class="text-center" data-v-bb6944b4><svg class="w-8 h-8 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-bb6944b4><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" data-v-bb6944b4></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-bb6944b4></path></svg><p class="text-sm" data-v-bb6944b4>Waiting for program...</p></div>',1)])])):j("",!0)],2)])])]))}}),eo=le(Zt,[["__scopeId","data-v-bb6944b4"]]),to={class:"scene-strip","data-testid":"scene-strip"},oo={class:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin"},no=["onClick","onDblclick","onContextmenu","data-testid"],so={class:"relative aspect-video bg-r58-bg-tertiary rounded-lg overflow-hidden"},ro={class:"absolute inset-0"},ao={key:0,class:"absolute top-1 left-1 w-5 h-5 flex items-center justify-center bg-r58-bg-primary/80 rounded text-xs font-mono font-bold"},io={key:1,class:"absolute top-1 right-1 flex items-center gap-1 px-1.5 py-0.5 bg-red-600 rounded text-xs font-bold"},lo={key:2,class:"absolute top-1 right-1 px-1.5 py-0.5 bg-amber-500 rounded text-xs font-bold text-black"},co={class:"mt-1 text-xs text-center truncate text-r58-text-secondary"},uo=["disabled"],vo=Z({__name:"SceneStrip",emits:["edit-scene","add-scene"],setup(_,{emit:a}){const s=a,m=ue(),r=oe(),p=C(null),f=C({x:0,y:0}),d=C(!1),l=H(()=>m.scenes),M=H(()=>r.previewSceneId),g=H(()=>r.programSceneId);function i(y){r.mode==="simple"?r.setProgramScene(y.id):r.setPreviewScene(y.id)}function x(y){r.setProgramScene(y.id),B.info(`Scene: ${y.name}`)}function $(y,o){y.preventDefault(),p.value=o,f.value={x:y.clientX,y:y.clientY},d.value=!0;const I=()=>{d.value=!1,document.removeEventListener("click",I)};setTimeout(()=>document.addEventListener("click",I),0)}function N(y){d.value=!1,s("edit-scene",y)}function T(y){d.value=!1;const o=m.duplicateScene(y.id);o&&B.success(`Duplicated: ${o.name}`)}function b(y){if(d.value=!1,l.value.length<=1){B.error("Cannot delete the last scene");return}if(y.id===g.value){B.error("Cannot delete scene that is on program");return}m.deleteScene(y.id),B.info(`Deleted: ${y.name}`)}function E(y){return y.id===g.value?"ring-2 ring-red-500 ring-offset-2 ring-offset-r58-bg-primary":y.id===M.value?"ring-2 ring-amber-500 ring-offset-1 ring-offset-r58-bg-primary":"hover:ring-2 hover:ring-r58-accent-primary/50"}return(y,o)=>{var I;return t(),n("div",to,[e("div",oo,[(t(!0),n(W,null,J(l.value,(u,P)=>(t(),n("div",{key:u.id,class:A(["scene-thumbnail flex-shrink-0 w-28 cursor-pointer transition-all",E(u)]),onClick:R=>i(u),onDblclick:R=>x(u),onContextmenu:R=>$(R,u),"data-testid":`scene-${u.id}`},[e("div",so,[e("div",ro,[(t(!0),n(W,null,J(u.slots,R=>(t(),n("div",{key:R.id,class:"absolute bg-r58-bg-secondary border border-r58-bg-tertiary/30",style:pe({left:`${R.position.x}%`,top:`${R.position.y}%`,width:`${R.position.w}%`,height:`${R.position.h}%`})},null,4))),128))]),P<8?(t(),n("div",ao,h(P+1),1)):j("",!0),u.id===g.value?(t(),n("div",io,[...o[4]||(o[4]=[e("div",{class:"w-1.5 h-1.5 rounded-full bg-white animate-pulse"},null,-1),Q(" PGM ",-1)])])):u.id===M.value?(t(),n("div",lo," PVW ")):j("",!0)]),e("p",co,h(u.name),1)],42,no))),128)),e("button",{onClick:o[0]||(o[0]=u=>s("add-scene")),class:"flex-shrink-0 w-28 aspect-video bg-r58-bg-tertiary/50 hover:bg-r58-bg-tertiary rounded-lg border-2 border-dashed border-r58-bg-tertiary hover:border-r58-accent-primary/50 flex items-center justify-center transition-colors","data-testid":"add-scene-button"},[...o[5]||(o[5]=[e("div",{class:"text-center text-r58-text-secondary"},[e("svg",{class:"w-6 h-6 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs"},"Add Scene")],-1)])])]),(t(),me(ye,{to:"body"},[d.value&&p.value?(t(),n("div",{key:0,class:"fixed z-50 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg shadow-xl py-1 min-w-[140px]",style:pe({left:`${f.value.x}px`,top:`${f.value.y}px`})},[e("button",{onClick:o[1]||(o[1]=u=>N(p.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-r58-bg-tertiary flex items-center gap-2"},[...o[6]||(o[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),Q(" Edit ",-1)])]),e("button",{onClick:o[2]||(o[2]=u=>T(p.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-r58-bg-tertiary flex items-center gap-2"},[...o[7]||(o[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),Q(" Duplicate ",-1)])]),o[9]||(o[9]=e("div",{class:"border-t border-r58-bg-tertiary my-1"},null,-1)),e("button",{onClick:o[3]||(o[3]=u=>b(p.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-red-500/20 text-red-400 flex items-center gap-2",disabled:((I=p.value)==null?void 0:I.id)===g.value},[...o[8]||(o[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Q(" Delete ",-1)])],8,uo)],4)):j("",!0)]))])}}}),mo=le(vo,[["__scopeId","data-v-627912a1"]]),po={class:"mixer-workspace h-full flex flex-col","data-testid":"mixer-workspace"},go={class:"flex-1 flex gap-4 min-h-0 p-4"},xo={key:0,class:"text-sm font-medium"},fo={class:"h-[calc(100%-48px)] overflow-y-auto scrollbar-thin"},bo={class:"space-y-2"},yo=["title"],ho={class:"flex-1 flex flex-col min-w-0"},ko={class:"flex-1 min-h-0"},wo={class:"mt-4 pt-4 border-t border-r58-bg-tertiary"},So=Z({__name:"MixerWorkspace",props:{vdoEmbed:{},controller:{}},emits:["edit-scene","add-scene"],setup(_,{emit:a}){const s=a,m=oe();ue();const r=C(!1);function p(){r.value=!r.value}function f(g){s("edit-scene",g)}function d(){s("add-scene")}function l(){console.log("[Workspace] Take executed")}function M(){console.log("[Workspace] Cut executed")}return(g,i)=>(t(),n("div",po,[e("div",go,[e("aside",{class:A(["sources-panel flex-shrink-0 transition-all duration-300 overflow-hidden",r.value?"w-12":"w-64"])},[e("button",{onClick:p,class:"w-full mb-3 flex items-center justify-between px-3 py-2 bg-r58-bg-tertiary rounded-lg hover:bg-r58-bg-tertiary/80 transition-colors"},[r.value?j("",!0):(t(),n("span",xo,"Sources")),(t(),n("svg",{class:A(["w-4 h-4 transition-transform",{"rotate-180":r.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...i[0]||(i[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"},null,-1)])],2))]),q(e("div",fo,[ee(kt,{"vdo-embed":_.vdoEmbed,controller:_.controller},null,8,["vdo-embed","controller"])],512),[[fe,!r.value]]),q(e("div",bo,[(t(!0),n(W,null,J(K(m).connectedSources.slice(0,6),x=>(t(),n("div",{key:x.id,class:"w-8 h-8 mx-auto rounded bg-r58-bg-tertiary flex items-center justify-center text-xs",title:x.label},h(x.label.charAt(0)),9,yo))),128))],512),[[fe,r.value]])],2),e("div",ho,[e("div",ko,[ee(eo,{"vdo-embed":_.vdoEmbed,controller:_.controller,onTake:l,onCut:M},null,8,["vdo-embed","controller"])]),e("div",wo,[i[1]||(i[1]=be('<div class="flex items-center justify-between mb-2" data-v-87ccc636><h3 class="text-sm font-medium text-r58-text-secondary" data-v-87ccc636>Scenes</h3><div class="flex items-center gap-2 text-xs text-r58-text-secondary" data-v-87ccc636><span data-v-87ccc636>Click = Preview</span><span class="opacity-50" data-v-87ccc636>|</span><span data-v-87ccc636>Double-click = Live</span><span class="opacity-50" data-v-87ccc636>|</span><span data-v-87ccc636>Right-click = Menu</span></div></div>',1)),ee(mo,{onEditScene:f,onAddScene:d})])])])]))}}),_o=le(So,[["__scopeId","data-v-87ccc636"]]),_e="vdo-debug",$o=500,se=[];let $e=typeof localStorage<"u"&&localStorage.getItem(_e)==="true";function Le(_){$e=_,typeof localStorage<"u"&&(_?localStorage.setItem(_e,"true"):localStorage.removeItem(_e)),console.log(`[VDO.ninja Debug] ${_?"Enabled":"Disabled"}`)}function we(_){if(se.push(_),se.length>$o&&se.shift(),$e){const a=new Date(_.timestamp).toISOString().split("T")[1].slice(0,-1),s=_.direction==="outgoing"?"âž¡ï¸ OUT":"â¬…ï¸ IN",m=_.direction==="outgoing"?"color: #3b82f6; font-weight: bold":"color: #22c55e; font-weight: bold";console.groupCollapsed(`%c[VDO.ninja ${s}] %c${_.type}`,m,"color: inherit"),console.log("Time:",a),_.target&&console.log("Target:",_.target),console.log("Data:",_.data),_.raw&&_.raw!==_.data&&console.log("Raw:",_.raw),console.groupEnd()}}function Pe(){return[...se]}function Co(){se.length=0,console.log("[VDO.ninja Debug] Event history cleared")}function Oe(){const _={total:se.length,incoming:0,outgoing:0,byType:{},lastActivity:se.length>0?se[se.length-1].timestamp:null};for(const a of se)a.direction==="incoming"?_.incoming++:_.outgoing++,_.byType[a.type]=(_.byType[a.type]||0)+1;return _}typeof window<"u"&&(window.__VDO_DEBUG__={getHistory:Pe,clearHistory:Co,getStats:Oe,enable:()=>Le(!0),disable:()=>Le(!1),isEnabled:()=>$e});function Mo(_){const a=C(!1),s=C(new Map),m=C(null),r=C(!1),p=C("disconnected"),f=C(null),d=Ke();function l(L,F,G,ie){var Y;if(!((Y=_.value)!=null&&Y.contentWindow)){console.warn("[VDO.ninja] Cannot send command - iframe not ready"),f.value="iframe not ready";return}const X={action:L};F&&(X.target=F),G!==void 0&&(X.value=G),ie!==void 0&&(X.value2=ie),we({timestamp:Date.now(),direction:"outgoing",type:L,target:F,data:{action:L,target:F,value:G,value2:ie},raw:X});try{_.value.contentWindow.postMessage(X,"*")}catch(te){console.error("[VDO.ninja] Failed to send command:",te),f.value=String(te)}}function M(L,F){var ie;if(!((ie=_.value)!=null&&ie.contentWindow)){console.warn("[VDO.ninja] Cannot send DOM command - iframe not ready");return}const G={action:"",target:L,...F};we({timestamp:Date.now(),direction:"outgoing",type:"dom-manipulation",target:L,data:F,raw:G});try{_.value.contentWindow.postMessage(G,"*")}catch(X){console.error("[VDO.ninja] Failed to send DOM command:",X)}}function g(L,F=1){l("addScene",L,F),m.value=F}function i(L,F=1){l("addScene",L,0)}function x(L){M(L,{replace:!0})}function $(L){M(L,{add:!0})}function N(L){M(L,{remove:!0})}function T(L,F){l("mic",L,!F);const G=s.value.get(L);G&&(G.muted=F)}function b(L){l("mic",L,"toggle");const F=s.value.get(L);F&&(F.muted=!F.muted)}function E(L,F){l("volume",L,Math.max(0,Math.min(200,F)))}function y(L){l("soloChat",L)}function o(L){l("soloChatBidirectional",L)}function I(L,F){l("sendChat",L,F)}function u(L,F){l("sendDirectorChat",L,F)}function P(L){l("hangup",L),s.value.delete(L)}function R(L){L?l("togglescreenshare",L):l("togglescreenshare")}function v(L,F){l("forward",L,F)}function k(L="guests"){l("getGuestList",void 0,void 0)}function c(){l("record",void 0,!0),r.value=!0}function S(){l("record",void 0,!1),r.value=!1}function U(L){l("layout",void 0,L)}function V(L){L?l("reload",L):l("reload")}function w(L,F){l("mixorder",L,F==="up"?-1:1)}function D(L){l("camera",void 0,L)}function O(L,F){l("camera",L,F)}function z(L,F=!1){F?l("zoom",void 0,L,"abs"):l("zoom",void 0,L)}function ae(L){l("pan",void 0,L)}function de(L){l("tilt",void 0,L)}function Ce(L){const F=L.origin;if(!F.includes(d.split(":")[0])&&!F.includes("vdo.ninja")&&!F.includes("vdo.itagenten")&&!F.includes("localhost"))return;const G=L.data;if(!G||typeof G!="object")return;const ie=G.type||G.action||"unknown",X=G.streamID||G.UUID||G.streamId;switch(we({timestamp:Date.now(),direction:"incoming",type:ie,target:X,data:G.data||G.value,raw:G}),ie){case"director-ready":case"loaded":case"ready":case"started":a.value=!0,p.value="connected",f.value=null;break;case"new-guest":case"guest-connected":case"push":case"view":case"joined":{if(X){const Y=G.data,te={id:X,label:(Y==null?void 0:Y.label)||G.label||X,type:(Y==null?void 0:Y.type)||"guest",hasVideo:(Y==null?void 0:Y.video)!==!1,hasAudio:(Y==null?void 0:Y.audio)!==!1,muted:!1,audioLevel:0};s.value.set(X,te)}break}case"guest-left":case"guest-disconnected":case"left":case"disconnect":X&&s.value.delete(X);break;case"audio-level":case"loudness":{if(X){const Y=s.value.get(X);if(Y){const te=G.data;Y.audioLevel=(te==null?void 0:te.level)||G.value||0}}break}case"mute-state":case"muted":{if(X){const Y=s.value.get(X);if(Y){const te=G.data;Y.muted=(te==null?void 0:te.muted)??G.value??!1}}break}case"scene-changed":case"scene":{const Y=G.data,te=(Y==null?void 0:Y.scene)||G.value;m.value=typeof te=="number"?te:null;break}case"recording-started":r.value=!0;break;case"recording-stopped":r.value=!1;break;case"error":console.error("[VDO.ninja Error]",G.data),f.value=String(G.data);break}}return ve(()=>{p.value="connecting",window.addEventListener("message",Ce),setTimeout(()=>{!a.value&&_.value&&(a.value=!0,p.value="connected")},5e3)}),xe(()=>{window.removeEventListener("message",Ce),p.value="disconnected"}),{isReady:a,sources:s,activeScene:m,isRecording:r,connectionState:p,lastError:f,addToScene:g,removeFromScene:i,setProgram:x,addSource:$,removeSource:N,setLayout:U,changeMixOrder:w,setMute:T,toggleMute:b,setVolume:E,soloAudio:y,soloChatBidirectional:o,sendToGuest:I,sendDirectorMessage:u,kickGuest:P,toggleScreenShare:R,transferGuest:v,getGuestList:k,refreshSource:V,setCamera:D,setGuestCamera:O,zoom:z,pan:ae,tilt:de,startRecording:c,stopRecording:S,sendCommand:l,sendDomCommand:M,getEventHistory:Pe,getEventStats:Oe}}const Io={key:0,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary z-10","data-testid":"vdo-loading"},Ro={class:"text-center"},Eo={class:"text-xs text-r58-text-secondary mt-2"},Do={key:1,class:"absolute bottom-4 left-4 right-4 bg-red-500/90 text-white px-4 py-2 rounded-lg text-sm z-20"},jo=["src","title"],Lo=Z({__name:"VdoNinjaEmbed",props:{profile:{},sources:{},room:{},password:{}},setup(_,{expose:a}){const s=_,m=C(null),r=oe(),p=Mo(m),{isReady:f,sources:d,addToScene:l,removeFromScene:M,setMute:g,toggleMute:i,setVolume:x,sendCommand:$,sendDomCommand:N,isRecording:T,connectionState:b,lastError:E,startRecording:y,stopRecording:o,kickGuest:I,toggleScreenShare:u,setLayout:P,setProgram:R,addSource:v,removeSource:k,getEventHistory:c,getEventStats:S}=p,U=H(()=>{const w={};return s.sources&&(w.source_ids=s.sources.join(",")),s.room&&(w.room=s.room),s.password&&(w.password=s.password),Ge(s.profile,w)}),V=H(()=>s.profile==="mixer");return re(d,w=>{r.updateSourcesFromVdo(Array.from(w.values()))},{deep:!0}),a({isReady:f,isRecording:T,connectionState:b,lastError:E,addToScene:l,removeFromScene:M,setLayout:P,setProgram:R,addSource:v,removeSource:k,setMute:g,toggleMute:i,setVolume:x,startRecording:y,stopRecording:o,kickGuest:I,toggleScreenShare:u,sendCommand:$,sendDomCommand:N,getEventHistory:c,getEventStats:S}),(w,D)=>(t(),n("div",{class:A(["vdo-embed-container relative w-full h-full bg-black rounded-lg overflow-hidden",{"mixer-mode":V.value}]),"data-testid":"vdo-embed-container"},[K(f)?j("",!0):(t(),n("div",Io,[e("div",Ro,[D[0]||(D[0]=e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full mx-auto mb-4"},null,-1)),D[1]||(D[1]=e("p",{class:"text-r58-text-secondary"},"Connecting to VDO.ninja...",-1)),e("p",Eo,h(V.value?"Loading mixer controls...":"Local mixer on R58"),1)])])),K(E)?(t(),n("div",Do,[D[2]||(D[2]=e("strong",null,"Error:",-1)),Q(" "+h(K(E)),1)])):j("",!0),e("iframe",{ref_key:"iframeRef",ref:m,src:U.value,class:A(["w-full h-full border-0",{"opacity-0":!K(f)}]),allow:"camera; microphone; display-capture; autoplay; clipboard-write",allowfullscreen:"","data-testid":"vdo-iframe",title:V.value?"VDO.ninja Mixer":"VDO.ninja"},null,10,jo)],2))}}),To=le(Lo,[["__scopeId","data-v-4a9e915e"]]),Vo={class:"camera-push-bar border-t border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"camera-push-bar"},Po={class:"flex items-center gap-2"},Oo={class:"text-r58-text-secondary"},Uo={key:0,class:"px-4 pb-3"},Ao={key:0,class:"flex gap-3 flex-wrap"},Ho={class:"text-sm font-medium"},No={class:"text-xs text-r58-text-secondary"},Bo=["onClick"],zo={key:1,class:"text-sm text-r58-text-secondary py-2"},Fo={class:"hidden"},Ko=["src","onLoad","onError"],Go=Z({__name:"CameraPushBar",setup(_){const a=ge(),s=C(new Map),m=C(!0),r=H(()=>a.inputs.filter(i=>i.hasSignal));function p(i){return We(i)}re(r,i=>{for(const $ of i)if(!s.value.has($.id)){const N=p($.id),T=Ee($.id,N,$.label);s.value.set($.id,{cameraId:$.id,label:$.label,status:"connecting",iframeSrc:T})}const x=new Set(i.map($=>$.id));for(const[$]of s.value)x.has($)||s.value.delete($)},{immediate:!0});function f(i){const x=s.value.get(i);x&&(x.status="connected",console.log(`[CameraPush] ${i} connected to VDO.ninja`))}function d(i){const x=s.value.get(i);x&&(x.status="error",console.error(`[CameraPush] ${i} failed to connect`))}function l(i){const x=a.inputs.find(T=>T.id===i);if(!x||!x.hasSignal)return;const $=p(i),N=Ee(i,$,x.label);s.value.set(i,{cameraId:i,label:x.label,status:"connecting",iframeSrc:N+`&_t=${Date.now()}`})}function M(i){switch(i){case"connected":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function g(i){switch(i){case"connected":return"Live in VDO.ninja";case"connecting":return"Connecting...";case"error":return"Failed to connect";default:return"Idle"}}return(i,x)=>(t(),n("div",Vo,[e("button",{onClick:x[0]||(x[0]=$=>m.value=!m.value),class:"w-full px-4 py-2 flex items-center justify-between text-sm hover:bg-r58-bg-tertiary/50 transition-colors","data-testid":"camera-push-toggle","aria-expanded":"expanded"},[e("div",Po,[x[1]||(x[1]=e("span",{class:"font-medium"},"Camera Sources",-1)),e("span",Oo,"("+h(r.value.length)+" active)",1)]),(t(),n("svg",{class:A(["w-4 h-4 transition-transform",{"rotate-180":m.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...x[2]||(x[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),m.value?(t(),n("div",Uo,[s.value.size>0?(t(),n("div",Ao,[(t(!0),n(W,null,J(s.value,([$,N])=>(t(),n("div",{key:$,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},[e("span",{class:A(["w-2 h-2 rounded-full",M(N.status)])},null,2),e("span",Ho,h(N.label),1),e("span",No,h(g(N.status)),1),N.status==="error"?(t(),n("button",{key:0,onClick:T=>l($),class:"ml-2 text-xs text-r58-accent-primary hover:underline"}," Retry ",8,Bo)):j("",!0)]))),128))])):(t(),n("div",zo," No cameras connected. Connect HDMI sources to push them to the mixer. "))])):j("",!0),e("div",Fo,[(t(!0),n(W,null,J(s.value,([$,N])=>(t(),n("iframe",{key:$,src:N.iframeSrc,onLoad:T=>f($),onError:T=>d($),allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,Ko))),128))])]))}}),Wo={class:"program-output space-y-3","data-testid":"program-output"},Yo={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg","data-testid":"program-output-status"},Jo={class:"text-sm font-medium","data-testid":"program-output-text"},qo={key:0,class:"space-y-2"},Xo={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},Qo={class:"flex-1 text-xs truncate text-r58-text-secondary"},Zo={key:0,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},en={class:"text-xs text-r58-text-secondary"},tn={key:1,class:"text-xs text-r58-text-secondary px-3"},on={class:"hidden"},nn=["src"],sn=Z({__name:"ProgramOutput",setup(_){const a=oe(),s=he(),m=C(!1),r=C("idle"),p=C("");function f(){return`${window.location.origin}/api/v1/whip/program/whip`}function d(){m.value||(r.value="connecting",p.value=Ye(f()),m.value=!0,console.log("[ProgramOutput] Starting WHIP push to MediaMTX"))}function l(){m.value&&(m.value=!1,p.value="",r.value="idle",console.log("[ProgramOutput] Stopped WHIP push"))}function M(){m.value&&(r.value="live",console.log("[ProgramOutput] WHIP push connected"))}function g(){r.value="error",console.error("[ProgramOutput] WHIP push failed")}function i(){l(),setTimeout(()=>d(),500)}re(()=>a.isLive,T=>{T?d():l()});function x(){switch(r.value){case"live":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function $(){switch(r.value){case"live":return"MediaMTX connected";case"connecting":return"Connecting...";case"error":return"Connection failed";default:return"Inactive"}}function N(){const T=s.programOutputUrls.srt;navigator.clipboard.writeText(T),B.success("SRT URL copied")}return(T,b)=>(t(),n("div",Wo,[e("div",Yo,[e("span",{class:A(["w-2 h-2 rounded-full",x()]),"data-testid":"program-output-indicator"},null,2),e("span",Jo,h($()),1),r.value==="error"?(t(),n("button",{key:0,onClick:b[0]||(b[0]=E=>i()),class:"ml-auto text-xs text-r58-accent-primary hover:underline"}," Retry ")):j("",!0)]),r.value==="live"?(t(),n("div",qo,[e("div",Xo,[b[1]||(b[1]=e("span",{class:"text-xs text-r58-text-secondary"},"ðŸ”´ SRT:",-1)),e("code",Qo,h(K(s).programOutputUrls.srt),1),e("button",{onClick:N,class:"text-xs text-r58-accent-primary hover:underline"},"Copy")]),K(s).enabledDestinations.length>0?(t(),n("div",Zo,[b[2]||(b[2]=e("span",{class:"w-2 h-2 rounded-full bg-emerald-500"},null,-1)),e("span",en,h(K(s).enabledDestinations.length)+" streaming destination"+h(K(s).enabledDestinations.length>1?"s":"")+" active ",1)])):j("",!0)])):j("",!0),r.value==="idle"?(t(),n("p",tn," Program output will start automatically when you go live. ")):j("",!0),e("div",on,[m.value&&p.value?(t(),n("iframe",{key:0,src:p.value,onLoad:M,onError:g,allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,nn)):j("",!0)])]))}}),rn={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},an={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl"},ln={class:"p-6 overflow-y-auto max-h-[60vh]"},dn={class:"mb-8"},cn={class:"flex items-center justify-between mb-4"},un={key:0,class:"mb-4 p-4 bg-r58-bg-tertiary rounded-lg"},vn={class:"grid grid-cols-2 gap-2"},mn=["onClick"],pn={class:"text-xl"},gn={key:1,class:"space-y-3"},xn=["onClick"],fn={class:"text-xl"},bn={class:"flex-1"},yn={class:"font-medium"},hn={class:"text-xs text-r58-text-secondary"},kn=["onClick"],wn=["onClick"],Sn={key:2,class:"text-r58-text-secondary text-sm"},_n={key:0,class:"mb-8 p-4 bg-r58-bg-tertiary rounded-lg"},$n={class:"text-lg font-medium mb-4"},Cn={class:"space-y-4"},Mn=["placeholder"],In={key:0},Rn={class:"flex gap-2"},En={class:"mb-8"},Dn={class:"space-y-3"},jn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Ln={class:"flex items-center justify-between mb-1"},Tn={class:"text-xs text-r58-text-secondary break-all"},Vn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Pn={class:"flex items-center justify-between mb-1"},On={class:"text-xs text-r58-text-secondary break-all"},Un={class:"p-3 bg-r58-bg-tertiary rounded-lg"},An={class:"flex items-center justify-between mb-1"},Hn={class:"text-xs text-r58-text-secondary break-all"},Nn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Bn={class:"flex items-center justify-between mb-1"},zn={class:"text-xs text-r58-text-secondary break-all"},Fn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Kn={class:"flex items-center justify-between mb-1"},Gn={class:"text-xs text-r58-text-secondary break-all"},Wn={class:"p-4 bg-r58-bg-tertiary rounded-lg"},Yn={class:"flex items-center gap-3 mb-4"},Jn=Z({__name:"StreamingSettings",setup(_,{expose:a}){const s=he(),m=C(!1),r=C(null),p=C(!1);C(""),C("");const f=H(()=>s.destinations),d=H(()=>ce),l=H(()=>s.programOutputUrls);function M(){m.value=!0}function g(){m.value=!1,r.value=null,p.value=!1}function i(y){const o=s.addDestination(y);r.value=o,p.value=!1,s.saveDestinations()}function x(){r.value&&(s.updateDestination(r.value.id,r.value),s.saveDestinations(),r.value=null,B.success("Streaming destination saved"))}function $(y){s.removeDestination(y),s.saveDestinations(),B.info("Destination removed")}function N(y){s.updateDestination(y.id,{enabled:!y.enabled}),s.saveDestinations()}function T(y,o){navigator.clipboard.writeText(y),B.success(`${o} copied to clipboard`)}function b(y){const o=ce.find(I=>I.id===y);return(o==null?void 0:o.icon)||"ðŸ“¡"}function E(y){const o=ce.find(I=>I.id===y);return(o==null?void 0:o.name)||"Unknown"}return a({open:M}),(y,o)=>{var I;return t(),me(ye,{to:"body"},[m.value?(t(),n("div",rn,[e("div",{class:"absolute inset-0 bg-black/60",onClick:g}),e("div",an,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[o[11]||(o[11]=e("h2",{class:"text-xl font-semibold"},"Streaming Settings",-1)),e("button",{onClick:g,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",ln,[e("section",dn,[e("div",cn,[o[12]||(o[12]=e("h3",{class:"text-lg font-medium"},"Streaming Destinations",-1)),e("button",{onClick:o[0]||(o[0]=u=>p.value=!p.value),class:"btn btn-sm btn-primary"}," + Add Platform ")]),p.value?(t(),n("div",un,[o[13]||(o[13]=e("p",{class:"text-sm text-r58-text-secondary mb-3"},"Select a streaming platform:",-1)),e("div",vn,[(t(!0),n(W,null,J(d.value,u=>(t(),n("button",{key:u.id,onClick:P=>i(u.id),class:"flex items-center gap-2 p-3 bg-r58-bg-secondary hover:bg-r58-accent-primary/20 rounded-lg transition-colors text-left"},[e("span",pn,h(u.icon),1),e("span",null,h(u.name),1)],8,mn))),128))])])):j("",!0),f.value.length>0?(t(),n("div",gn,[(t(!0),n(W,null,J(f.value,u=>(t(),n("div",{key:u.id,class:"flex items-center gap-3 p-3 bg-r58-bg-tertiary rounded-lg"},[e("button",{onClick:P=>N(u),class:A(["w-10 h-6 rounded-full transition-colors relative",u.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:A(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",u.enabled?"left-5":"left-1"])},null,2)],10,xn),e("span",fn,h(b(u.platformId)),1),e("div",bn,[e("div",yn,h(u.name),1),e("div",hn,h(u.streamKey?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"+u.streamKey.slice(-4):"No stream key"),1)]),e("button",{onClick:P=>r.value={...u},class:"text-r58-accent-primary hover:underline text-sm"}," Edit ",8,kn),e("button",{onClick:P=>$(u.id),class:"text-r58-accent-danger hover:underline text-sm"}," Remove ",8,wn)]))),128))])):(t(),n("p",Sn," No streaming destinations configured. Add a platform above. "))]),r.value?(t(),n("section",_n,[e("h3",$n," Edit "+h(E(r.value.platformId)),1),e("div",Cn,[e("div",null,[o[14]||(o[14]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Display Name",-1)),q(e("input",{"onUpdate:modelValue":o[1]||(o[1]=u=>r.value.name=u),type:"text",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ne,r.value.name]])]),e("div",null,[o[15]||(o[15]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Stream Key",-1)),q(e("input",{"onUpdate:modelValue":o[2]||(o[2]=u=>r.value.streamKey=u),type:"password",placeholder:(I=K(ce).find(u=>u.id===r.value.platformId))==null?void 0:I.streamKeyPlaceholder,class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,8,Mn),[[ne,r.value.streamKey]]),o[16]||(o[16]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Your stream key is stored locally and never sent to our servers. ",-1))]),r.value.platformId==="custom"?(t(),n("div",In,[o[17]||(o[17]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"RTMP URL",-1)),q(e("input",{"onUpdate:modelValue":o[3]||(o[3]=u=>r.value.name=u),type:"text",placeholder:"rtmp://your-server.com/live/",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,512),[[ne,r.value.name]])])):j("",!0),e("div",Rn,[e("button",{onClick:x,class:"btn btn-primary"}," Save "),e("button",{onClick:o[4]||(o[4]=u=>r.value=null),class:"btn"}," Cancel ")])])])):j("",!0),e("section",En,[o[26]||(o[26]=e("h3",{class:"text-lg font-medium mb-4"},"Program Output URLs",-1)),o[27]||(o[27]=e("p",{class:"text-sm text-r58-text-secondary mb-4"}," Use these URLs to consume the program feed from MediaMTX: ",-1)),e("div",Dn,[e("div",jn,[e("div",Ln,[o[18]||(o[18]=e("span",{class:"font-medium"},"ðŸ”´ SRT Output",-1)),e("button",{onClick:o[5]||(o[5]=u=>T(l.value.srt,"SRT URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Tn,h(l.value.srt),1),o[19]||(o[19]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Low-latency, reliable transport. Ideal for remote production. ",-1))]),e("div",Vn,[e("div",Pn,[o[20]||(o[20]=e("span",{class:"font-medium"},"ðŸ“º RTMP Output",-1)),e("button",{onClick:o[6]||(o[6]=u=>T(l.value.rtmp,"RTMP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",On,h(l.value.rtmp),1)]),e("div",Un,[e("div",An,[o[21]||(o[21]=e("span",{class:"font-medium"},"ðŸŽ¬ RTSP Output",-1)),e("button",{onClick:o[7]||(o[7]=u=>T(l.value.rtsp,"RTSP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Hn,h(l.value.rtsp),1)]),e("div",Nn,[e("div",Bn,[o[22]||(o[22]=e("span",{class:"font-medium"},"ðŸŒ HLS Output",-1)),e("button",{onClick:o[8]||(o[8]=u=>T(l.value.hls,"HLS URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",zn,h(l.value.hls),1),o[23]||(o[23]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Browser-compatible streaming. Higher latency. ",-1))]),e("div",Fn,[e("div",Kn,[o[24]||(o[24]=e("span",{class:"font-medium"},"âš¡ WebRTC (WHEP)",-1)),e("button",{onClick:o[9]||(o[9]=u=>T(l.value.whep,"WHEP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Gn,h(l.value.whep),1),o[25]||(o[25]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Ultra-low latency WebRTC. Best for interactive use. ",-1))])])]),e("section",null,[o[30]||(o[30]=e("h3",{class:"text-lg font-medium mb-4"},"SRT Configuration",-1)),e("div",Wn,[e("div",Yn,[e("button",{onClick:o[10]||(o[10]=u=>K(s).toggleSrtOutput(!K(s).srtOutput.enabled)),class:A(["w-10 h-6 rounded-full transition-colors relative",K(s).srtOutput.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:A(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",K(s).srtOutput.enabled?"left-5":"left-1"])},null,2)],2),o[28]||(o[28]=e("span",null,"Enable SRT Output",-1))]),o[29]||(o[29]=e("div",{class:"text-sm text-r58-text-secondary"},[e("p",{class:"mb-2"},"SRT (Secure Reliable Transport) provides:"),e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Low latency (typically 1-2 seconds)"),e("li",null,"Error correction for unreliable networks"),e("li",null,"AES encryption support"),e("li",null,"Compatible with OBS, vMix, and professional equipment")])],-1))])])]),e("div",{class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},[e("button",{onClick:g,class:"btn"},"Close")])])])):j("",!0)])}}}),qn={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Xn={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-3xl max-h-[80vh] overflow-hidden shadow-2xl","data-testid":"hotkey-settings-modal"},Qn={class:"flex border-b border-r58-bg-tertiary"},Zn=["onClick"],es={class:"p-6 overflow-y-auto max-h-[55vh]"},ts={key:0,class:"text-center py-12 text-r58-text-secondary"},os={key:1,class:"space-y-6"},ns={class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},ss={class:"space-y-2"},rs={class:"flex-1"},as={class:"text-sm"},is={key:0,class:"ml-2 text-xs text-r58-accent-primary"},ls={class:"flex items-center gap-2"},ds={key:0,class:"flex items-center gap-2"},cs={key:0,class:"px-3 py-1 bg-r58-accent-primary text-white rounded text-sm font-mono"},us={key:1,class:"text-sm text-r58-text-secondary animate-pulse"},vs={class:"px-3 py-1 bg-r58-bg-secondary border border-r58-bg-tertiary rounded text-sm font-mono"},ms=["onClick"],ps=["onClick"],Te="r58-hotkey-customizations",gs=Z({__name:"HotkeySettings",setup(_,{expose:a}){const s=[{id:"help",key:"?",modifiers:["shift"],description:"Show keyboard shortcuts",context:"global",category:"Navigation",editable:!1},{id:"goto-recorder",key:"r",modifiers:["alt"],description:"Go to Recorder",context:"global",category:"Navigation",editable:!0},{id:"goto-mixer",key:"m",modifiers:["alt"],description:"Go to Mixer",context:"global",category:"Navigation",editable:!0},{id:"escape",key:"Escape",description:"Close modal / Cancel",context:"global",category:"Navigation",editable:!1},{id:"scene-1",key:"1",description:"Select Scene 1 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-2",key:"2",description:"Select Scene 2 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-3",key:"3",description:"Select Scene 3 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-4",key:"4",description:"Select Scene 4 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-5",key:"5",description:"Select Scene 5 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-6",key:"6",description:"Select Scene 6 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-7",key:"7",description:"Select Scene 7 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-8",key:"8",description:"Select Scene 8 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"take",key:" ",description:"TAKE - Transition preview to program",context:"mixer",category:"Transitions",editable:!1},{id:"cut",key:"Escape",description:"CUT - Immediate switch to preview",context:"mixer",category:"Transitions",editable:!1},{id:"transition-cut",key:"t",description:"Set transition: Cut",context:"mixer",category:"Transitions",editable:!0},{id:"transition-fade",key:"f",description:"Set transition: Fade",context:"mixer",category:"Transitions",editable:!0},{id:"go-live",key:"g",description:"Toggle Go Live",context:"mixer",category:"Control",editable:!0},{id:"toggle-recording",key:"r",description:"Toggle recording",context:"mixer",category:"Control",editable:!0},{id:"mute-all",key:"m",modifiers:["ctrl"],description:"Mute all sources",context:"mixer",category:"Control",editable:!0},{id:"toggle-sidebar",key:"s",modifiers:["ctrl"],description:"Toggle sidebar",context:"mixer",category:"Control",editable:!0},{id:"mute-1",key:"F1",description:"Toggle mute: Source 1",context:"mixer",category:"Audio",editable:!0},{id:"mute-2",key:"F2",description:"Toggle mute: Source 2",context:"mixer",category:"Audio",editable:!0},{id:"mute-3",key:"F3",description:"Toggle mute: Source 3",context:"mixer",category:"Audio",editable:!0},{id:"mute-4",key:"F4",description:"Toggle mute: Source 4",context:"mixer",category:"Audio",editable:!0},{id:"start-stop-recording",key:" ",description:"Start/Stop recording",context:"recorder",category:"Recording",editable:!0},{id:"mark-chapter",key:"c",description:"Mark chapter point",context:"recorder",category:"Recording",editable:!0},{id:"select-all",key:"a",modifiers:["ctrl"],description:"Select all cameras",context:"recorder",category:"Recording",editable:!0}],m=C(!1),r=C("mixer"),p=C({}),f=C(null),d=C(null);function l(){try{const v=localStorage.getItem(Te);v&&(p.value=JSON.parse(v))}catch(v){console.warn("[HotkeySettings] Failed to load customizations:",v)}}function M(){try{localStorage.setItem(Te,JSON.stringify(p.value))}catch(v){console.warn("[HotkeySettings] Failed to save customizations:",v)}}function g(v){const k=p.value[v.id];return k?{...v,key:k.key,modifiers:k.modifiers}:v}const i=H(()=>{const v={global:{},mixer:{},recorder:{}};for(const k of s){const c=g(k);v[k.context][c.category]||(v[k.context][c.category]=[]),v[k.context][c.category].push(c)}return v}),x=H(()=>i.value[r.value]||{});function $(v){return Ie(v.key,v.modifiers)}function N(v){return!!p.value[v]}function T(v){const k=s.find(c=>c.id===v);k!=null&&k.editable&&(f.value=v,d.value=null,document.addEventListener("keydown",b))}function b(v){if(v.preventDefault(),v.stopPropagation(),["Control","Alt","Shift","Meta"].includes(v.key))return;const k=[];v.ctrlKey&&k.push("ctrl"),v.altKey&&k.push("alt"),v.shiftKey&&k.push("shift"),v.metaKey&&k.push("meta"),d.value={key:v.key,modifiers:k},document.removeEventListener("keydown",b)}function E(){!f.value||!d.value||(p.value[f.value]={key:d.value.key,modifiers:d.value.modifiers.length>0?d.value.modifiers:void 0},M(),B.success("Hotkey updated"),f.value=null,d.value=null)}function y(){f.value=null,d.value=null,document.removeEventListener("keydown",b)}function o(v){delete p.value[v],M(),B.info("Hotkey reset to default")}function I(){confirm("Reset all hotkeys to defaults?")&&(p.value={},M(),B.info("All hotkeys reset to defaults"))}function u(){l(),m.value=!0}function P(){y(),m.value=!1}ve(()=>{l()});function R(){return{...p.value}}return a({open:u,getCustomBindings:R}),(v,k)=>(t(),me(ye,{to:"body"},[m.value?(t(),n("div",qn,[e("div",{class:"absolute inset-0 bg-black/60",onClick:P}),e("div",Xn,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[k[0]||(k[0]=e("h2",{class:"text-xl font-semibold"},"Keyboard Shortcuts",-1)),e("div",{class:"flex items-center gap-4"},[e("button",{onClick:I,class:"text-sm text-r58-text-secondary hover:text-r58-text-primary"}," Reset All "),e("button",{onClick:P,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")])]),e("div",Qn,[(t(),n(W,null,J(["mixer","global","recorder"],c=>e("button",{key:c,onClick:S=>r.value=c,class:A(["px-6 py-3 text-sm font-medium capitalize transition-colors",r.value===c?"text-r58-accent-primary border-b-2 border-r58-accent-primary":"text-r58-text-secondary hover:text-r58-text-primary"])},h(c),11,Zn)),64))]),e("div",es,[Object.keys(x.value).length===0?(t(),n("div",ts," No shortcuts defined for this context. ")):(t(),n("div",os,[(t(!0),n(W,null,J(x.value,(c,S)=>(t(),n("div",{key:S},[e("h3",ns,h(S),1),e("div",ss,[(t(!0),n(W,null,J(c,U=>(t(),n("div",{key:U.id,class:A(["flex items-center justify-between p-3 bg-r58-bg-tertiary rounded-lg",{"ring-2 ring-r58-accent-primary":f.value===U.id}])},[e("div",rs,[e("span",as,h(U.description),1),N(U.id)?(t(),n("span",is,"(customized)")):j("",!0)]),e("div",ls,[f.value===U.id?(t(),n("div",ds,[d.value?(t(),n("kbd",cs,h(K(Ie)(d.value.key,d.value.modifiers)),1)):(t(),n("span",us," Press a key... ")),d.value?(t(),n("button",{key:2,onClick:E,class:"btn btn-sm btn-primary"}," Save ")):j("",!0),e("button",{onClick:y,class:"btn btn-sm"}," Cancel ")])):(t(),n(W,{key:1},[e("kbd",vs,h($(U)),1),U.editable?(t(),n("button",{key:0,onClick:V=>T(U.id),class:"text-xs text-r58-accent-primary hover:underline"}," Edit ",8,ms)):j("",!0),N(U.id)?(t(),n("button",{key:1,onClick:V=>o(U.id),class:"text-xs text-r58-text-secondary hover:text-r58-accent-danger"}," Reset ",8,ps)):j("",!0)],64))])],2))),128))])]))),128))]))]),e("div",{class:"flex items-center justify-between px-6 py-4 border-t border-r58-bg-tertiary"},[k[1]||(k[1]=e("div",{class:"text-sm text-r58-text-secondary"},' Click "Edit" to customize a shortcut. Press any key combination to set. ',-1)),e("button",{onClick:P,class:"btn"},"Close")])])])):j("",!0)]))}}),xs={class:"connection-status","data-testid":"connection-status"},fs={class:"text-xs text-r58-text-secondary"},bs={key:0,class:"text-xs text-r58-accent-danger",title:"Click for details"},ys={key:0,class:"mt-2 p-3 bg-r58-bg-tertiary rounded-lg text-xs space-y-2"},hs={class:"grid grid-cols-2 gap-2"},ks={class:"ml-1 font-medium"},ws={class:"ml-1"},Ss={class:"ml-1"},_s={key:0,class:"p-2 bg-r58-accent-danger/10 border border-r58-accent-danger/30 rounded text-r58-accent-danger"},$s={class:"flex gap-2 pt-2 border-t border-r58-bg-tertiary"},Cs=["disabled"],Ms={key:1,class:"text-r58-text-secondary text-center"},Is=Z({__name:"ConnectionStatus",props:{vdoEmbed:{}},setup(_){const a=_;oe();const s=C(!1),m=C("never"),r=C(0),p=C(!1),f=H(()=>{var y,o;return((o=(y=a.vdoEmbed)==null?void 0:y.connectionState)==null?void 0:o.value)||"disconnected"}),d=H(()=>{var y,o;return((o=(y=a.vdoEmbed)==null?void 0:y.isReady)==null?void 0:o.value)||!1}),l=H(()=>{var y,o;return((o=(y=a.vdoEmbed)==null?void 0:y.lastError)==null?void 0:o.value)||null}),M=H(()=>f.value==="disconnected"||!d.value?"disconnected":l.value?"error":f.value==="connecting"?"degraded":"healthy"),g=H(()=>{switch(M.value){case"healthy":return"bg-r58-accent-success";case"degraded":return"bg-amber-500";case"error":return"bg-r58-accent-danger";case"disconnected":return"bg-r58-text-secondary";default:return"bg-r58-text-secondary"}}),i=H(()=>{switch(M.value){case"healthy":return"Connected";case"degraded":return"Connecting...";case"error":return"Error";case"disconnected":return"Disconnected";default:return"Unknown"}});let x=null;function $(){if(a.vdoEmbed){const y=a.vdoEmbed.getEventStats();if(y.lastActivity){const o=Date.now()-y.lastActivity;o<1e3?m.value="just now":o<6e4?m.value=`${Math.floor(o/1e3)}s ago`:o<36e5?m.value=`${Math.floor(o/6e4)}m ago`:m.value="over 1h ago"}}}ve(()=>{$(),x=window.setInterval($,1e3)}),xe(()=>{x&&clearInterval(x)});async function N(){if(!p.value){p.value=!0,r.value++,B.info("Attempting to reconnect...");try{a.vdoEmbed&&a.vdoEmbed.sendCommand("ping"),await new Promise(y=>setTimeout(y,2e3)),d.value&&!l.value?(B.success("Reconnected successfully"),r.value=0):B.error("Reconnection failed. Try refreshing the page.")}catch(y){B.error("Reconnection error"),console.error("[ConnectionStatus] Reconnect error:",y)}finally{p.value=!1}}}function T(){confirm("This will refresh the page and may interrupt active streams. Continue?")&&window.location.reload()}function b(){s.value=!s.value}const E=H(()=>a.vdoEmbed?a.vdoEmbed.getEventStats():{total:0,incoming:0,outgoing:0,lastActivity:null});return(y,o)=>(t(),n("div",xs,[e("div",{class:"flex items-center gap-2 cursor-pointer",onClick:b},[e("span",{class:A(["w-2 h-2 rounded-full",[g.value,{"animate-pulse":M.value==="degraded"}]]),"data-testid":"status-indicator"},null,2),e("span",fs,h(i.value),1),l.value?(t(),n("span",bs," âš ï¸ ")):j("",!0),(t(),n("svg",{class:A(["w-3 h-3 text-r58-text-secondary transition-transform",{"rotate-180":s.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...o[0]||(o[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),s.value?(t(),n("div",ys,[e("div",hs,[e("div",null,[o[1]||(o[1]=e("span",{class:"text-r58-text-secondary"},"VDO.ninja:",-1)),e("span",{class:A(["ml-1 font-medium",d.value?"text-r58-accent-success":"text-r58-accent-danger"])},h(d.value?"Ready":"Not Ready"),3)]),e("div",null,[o[2]||(o[2]=e("span",{class:"text-r58-text-secondary"},"State:",-1)),e("span",ks,h(f.value),1)]),e("div",null,[o[3]||(o[3]=e("span",{class:"text-r58-text-secondary"},"Last activity:",-1)),e("span",ws,h(m.value),1)]),e("div",null,[o[4]||(o[4]=e("span",{class:"text-r58-text-secondary"},"Events:",-1)),e("span",Ss,h(E.value.total),1)])]),l.value?(t(),n("div",_s,[o[5]||(o[5]=e("strong",null,"Error:",-1)),Q(" "+h(l.value),1)])):j("",!0),e("div",$s,[e("button",{onClick:N,disabled:p.value,class:A(["btn btn-sm flex-1",{"opacity-50":p.value}])},h(p.value?"Reconnecting...":"ðŸ”„ Reconnect"),11,Cs),e("button",{onClick:T,class:"btn btn-sm",title:"Refresh the page (last resort)"}," ðŸ”ƒ Refresh ")]),r.value>0?(t(),n("div",Ms," Reconnect attempts: "+h(r.value),1)):j("",!0)])):j("",!0)]))}}),Rs={class:"recording-controls space-y-3","data-testid":"recording-controls"},Es={class:"flex items-center gap-3 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},Ds={class:"text-sm font-medium flex-1","data-testid":"recording-status"},js={key:0,class:"text-lg font-mono font-bold text-r58-accent-danger","data-testid":"recording-duration"},Ls=["disabled"],Ts={key:0,class:"px-3 py-2 bg-r58-accent-success/10 border border-r58-accent-success/30 rounded-lg"},Vs={class:"flex items-center justify-between"},Ps=["href"],Os=Z({__name:"RecordingControls",props:{vdoEmbed:{}},setup(_){const a=_,s=C(!1),m=C(null),r=C(0),p=C(null),f=C(!1);re(()=>{var b,E;return(E=(b=a.vdoEmbed)==null?void 0:b.isRecording)==null?void 0:E.value},b=>{b!==void 0&&(s.value=b,b&&!m.value?m.value=Date.now():!b&&m.value&&(m.value=null))});let d=null;function l(){d&&clearInterval(d),d=window.setInterval(()=>{m.value&&(r.value=Date.now()-m.value)},100)}function M(){d&&(clearInterval(d),d=null)}ve(()=>{l()}),xe(()=>{M()});const g=H(()=>{const b=Math.floor(r.value/1e3),E=Math.floor(b/3600),y=Math.floor(b%3600/60),o=b%60;return E>0?`${E}:${y.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`:`${y}:${o.toString().padStart(2,"0")}`});async function i(){if(!a.vdoEmbed){B.error("VDO.ninja not connected");return}f.value=!0;try{a.vdoEmbed.startRecording(),s.value=!0,m.value=Date.now(),r.value=0,p.value=null,B.success("Recording started")}catch(b){B.error("Failed to start recording"),console.error("[RecordingControls] Start recording error:",b)}finally{f.value=!1}}async function x(){if(!a.vdoEmbed){B.error("VDO.ninja not connected");return}f.value=!0;try{a.vdoEmbed.stopRecording(),s.value=!1,m.value=null,B.success(`Recording stopped (${g.value})`)}catch(b){B.error("Failed to stop recording"),console.error("[RecordingControls] Stop recording error:",b)}finally{f.value=!1}}function $(){s.value?x():i()}function N(){return s.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"}function T(){return f.value?"Processing...":s.value?`Recording â€¢ ${g.value}`:"Ready to record"}return(b,E)=>(t(),n("div",Rs,[e("div",Es,[e("span",{class:A(["w-3 h-3 rounded-full",N()]),"data-testid":"recording-indicator"},null,2),e("span",Ds,h(T()),1),s.value?(t(),n("span",js,h(g.value),1)):j("",!0)]),e("div",null,[e("button",{onClick:$,disabled:f.value,class:A(["btn w-full justify-center",s.value?"btn-danger":"btn-primary"]),"data-testid":"recording-toggle-button"},[f.value?(t(),n(W,{key:0},[E[0]||(E[0]=e("svg",{class:"animate-spin w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),E[1]||(E[1]=Q(" Processing... ",-1))],64)):s.value?(t(),n(W,{key:1},[E[2]||(E[2]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("rect",{x:"6",y:"6",width:"12",height:"12",rx:"1"})],-1)),E[3]||(E[3]=Q(" Stop Recording ",-1))],64)):(t(),n(W,{key:2},[E[4]||(E[4]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("circle",{cx:"12",cy:"12",r:"8"})],-1)),E[5]||(E[5]=Q(" Start Recording ",-1))],64))],10,Ls)]),p.value?(t(),n("div",Ts,[e("div",Vs,[E[6]||(E[6]=e("span",{class:"text-sm text-r58-accent-success"},"Recording ready!",-1)),e("a",{href:p.value,download:"",class:"text-sm text-r58-accent-primary hover:underline"}," Download ",8,Ps)])])):j("",!0),E[7]||(E[7]=e("p",{class:"text-xs text-r58-text-secondary px-1"}," Records the mixed output locally in your browser. Recording is saved when stopped. ",-1))]))}}),Us=le(Os,[["__scopeId","data-v-14707e66"]]),As={class:"audio-mixer space-y-4","data-testid":"audio-mixer"},Hs={class:"master-volume p-3 bg-r58-bg-tertiary rounded-lg"},Ns={class:"flex items-center justify-between mb-2"},Bs={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},zs={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Fs=["value"],Ks={class:"text-xs text-r58-text-secondary text-center mt-1"},Gs={key:0,class:"space-y-2"},Ws={class:"flex items-center gap-2 mb-2"},Ys={class:"text-xs font-medium truncate flex-1"},Js=["onClick"],qs=["onClick"],Xs={class:"h-1.5 bg-r58-bg-secondary rounded-full overflow-hidden mb-2"},Qs=["value","onInput","disabled"],Zs={key:1,class:"text-center py-4 text-r58-text-secondary"},er=Z({__name:"AudioMixer",props:{vdoEmbed:{},controller:{}},setup(_){const a=_,s=oe(),m=H(()=>s.connectedSources.filter(g=>g.hasAudio));function r(g,i){var x,$;if(a.controller)a.controller.setVolume(g.id,i);else if(s.setSourceVolume(g.id,i),a.vdoEmbed){const N=Math.round(i*2);($=(x=a.vdoEmbed).setVolume)==null||$.call(x,g.id,N)}}function p(g){var i,x;if(a.controller)a.controller.toggleMute(g.id);else{const $=!g.muted;s.setSourceMute(g.id,$),a.vdoEmbed&&((x=(i=a.vdoEmbed).setMute)==null||x.call(i,g.id,$))}}function f(g){var i,x;if(a.controller)a.controller.setSolo(g.id,!g.solo);else{const $=!g.solo;s.setSourceSolo(g.id,$),a.vdoEmbed&&$&&((x=(i=a.vdoEmbed).sendCommand)==null||x.call(i,"soloChat",g.id))}}function d(){s.setMasterMuted(!s.masterMuted)}function l(g){s.setMasterVolume(g)}function M(g){return g>80?"bg-red-500":g>60?"bg-amber-500":"bg-emerald-500"}return(g,i)=>(t(),n("div",As,[e("div",Hs,[e("div",Ns,[i[3]||(i[3]=e("span",{class:"text-xs font-medium"},"Master",-1)),e("button",{onClick:d,class:A(["p-1 rounded hover:bg-r58-bg-secondary transition-colors",{"text-red-400":K(s).masterMuted}])},[K(s).masterMuted?(t(),n("svg",Bs,[...i[1]||(i[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(t(),n("svg",zs,[...i[2]||(i[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],2)]),e("input",{type:"range",value:K(s).masterVolume,onInput:i[0]||(i[0]=x=>l(x.target.valueAsNumber)),min:"0",max:"100",class:"w-full h-2 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary"},null,40,Fs),e("div",Ks,h(K(s).masterVolume)+"% ",1)]),m.value.length>0?(t(),n("div",Gs,[(t(!0),n(W,null,J(m.value,x=>(t(),n("div",{key:x.id,class:"source-channel p-2 bg-r58-bg-tertiary/50 rounded-lg"},[e("div",Ws,[e("span",Ys,h(x.label),1),e("button",{onClick:$=>f(x),class:A(["w-6 h-6 text-xs font-bold rounded transition-colors",x.solo?"bg-amber-500 text-black":"bg-r58-bg-secondary text-r58-text-secondary hover:text-r58-text-primary"]),title:"Solo"}," S ",10,Js),e("button",{onClick:$=>p(x),class:A(["w-6 h-6 text-xs font-bold rounded transition-colors",x.muted?"bg-red-500 text-white":"bg-r58-bg-secondary text-r58-text-secondary hover:text-r58-text-primary"]),title:"Mute"}," M ",10,qs)]),e("div",Xs,[e("div",{class:A(["h-full transition-all duration-75 rounded-full",x.muted?"bg-r58-bg-tertiary":M(x.audioLevel)]),style:pe({width:`${x.audioLevel}%`})},null,6)]),e("input",{type:"range",value:x.volume||100,onInput:$=>r(x,$.target.valueAsNumber),min:"0",max:"100",disabled:x.muted,class:"w-full h-1.5 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary disabled:opacity-50"},null,40,Qs)]))),128))])):(t(),n("div",Zs,[...i[4]||(i[4]=[e("svg",{class:"w-6 h-6 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})],-1),e("p",{class:"text-xs"},"No audio sources",-1)])]))]))}}),tr=le(er,[["__scopeId","data-v-5db44082"]]),or={class:"transition-settings space-y-3","data-testid":"transition-settings"},nr={class:"grid grid-cols-3 gap-1"},sr=["onClick"],rr={class:"block text-sm mb-0.5"},ar=["disabled"],ir=["value"],lr={class:"p-3 bg-r58-bg-tertiary rounded-lg"},dr={class:"flex items-center justify-between text-xs"},cr={class:"font-mono"},ur={key:0},vr=Z({__name:"TransitionSettings",setup(_){const a=oe(),s=H({get:()=>a.transition.type,set:d=>a.setTransition({type:d})}),m=H({get:()=>a.transition.duration,set:d=>a.setTransition({duration:d})}),r=[{value:"cut",label:"Cut",icon:"âš¡"},{value:"fade",label:"Fade",icon:"ðŸŒ«ï¸"},{value:"wipe-left",label:"Wipe L",icon:"â—€"},{value:"wipe-right",label:"Wipe R",icon:"â–¶"},{value:"wipe-up",label:"Wipe Up",icon:"â–²"},{value:"wipe-down",label:"Wipe Down",icon:"â–¼"}],p=[{value:0,label:"0ms"},{value:100,label:"100ms"},{value:300,label:"300ms"},{value:500,label:"500ms"},{value:750,label:"750ms"},{value:1e3,label:"1s"},{value:2e3,label:"2s"}];function f(d){a.setTransition({type:d})}return(d,l)=>{var M;return t(),n("div",or,[e("div",nr,[(t(),n(W,null,J(r,g=>e("button",{key:g.value,onClick:i=>f(g.value),class:A(["px-2 py-2 text-xs rounded transition-colors text-center",s.value===g.value?"bg-r58-accent-primary text-white":"bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 text-r58-text-secondary"])},[e("span",rr,h(g.icon),1),Q(" "+h(g.label),1)],10,sr)),64))]),e("div",null,[l[1]||(l[1]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Duration",-1)),q(e("select",{"onUpdate:modelValue":l[0]||(l[0]=g=>m.value=g),class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none",disabled:s.value==="cut"},[(t(),n(W,null,J(p,g=>e("option",{key:g.value,value:g.value},h(g.label),9,ir)),64))],8,ar),[[Se,m.value,void 0,{number:!0}]])]),e("div",lr,[e("div",dr,[l[2]||(l[2]=e("span",{class:"text-r58-text-secondary"},"Current:",-1)),e("span",cr,[Q(h((M=r.find(g=>g.value===s.value))==null?void 0:M.label)+" ",1),s.value!=="cut"?(t(),n("span",ur," ("+h(m.value)+"ms)",1)):j("",!0)])])]),l[3]||(l[3]=e("p",{class:"text-xs text-r58-text-secondary"},[Q(" Press "),e("kbd",{class:"px-1 py-0.5 bg-r58-bg-tertiary rounded"},"Space"),Q(" to Take with transition ")],-1))])}}}),mr={class:"invite-links space-y-3","data-testid":"invite-links"},pr={key:0,class:"space-y-2"},gr={class:"p-2 bg-r58-bg-tertiary rounded-lg"},xr={class:"text-xs text-r58-text-secondary break-all block"},fr={key:1,class:"space-y-2 p-3 bg-r58-bg-tertiary rounded-lg"},br={class:"flex items-center gap-2 text-xs"},yr={class:"flex items-center gap-2 text-xs"},hr={key:2,class:"text-center"},kr={key:0,class:"mt-2 flex justify-center"},wr=["src"],Sr={class:"text-xs text-r58-text-secondary text-center"},_r={class:"font-mono"},$r=Z({__name:"InviteLinks",setup(_){const a=C(""),s=C(!1),m=C(!0),r=C(!0),p=H(()=>a.value.trim()?Je(a.value.trim()):"");function f(){if(!p.value){B.error("Enter a guest name first");return}navigator.clipboard.writeText(p.value),B.success("Invite link copied!")}function d(){if(!p.value){B.error("Enter a guest name first");return}window.open(p.value,"_blank")}async function l(){if(!p.value){B.error("Enter a guest name first");return}if(navigator.share)try{await navigator.share({title:`Join ${De} as ${a.value}`,text:`Click to join the video call as ${a.value}`,url:p.value})}catch(g){g.name!=="AbortError"&&f()}else f()}const M=H(()=>p.value?`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(p.value)}`:"");return(g,i)=>(t(),n("div",mr,[e("div",null,[i[5]||(i[5]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Guest Name",-1)),q(e("input",{"onUpdate:modelValue":i[0]||(i[0]=x=>a.value=x),type:"text",placeholder:"e.g., John Smith",class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ne,a.value]])]),p.value?(t(),n("div",pr,[e("div",gr,[e("code",xr,h(p.value),1)]),e("div",{class:"flex gap-2"},[e("button",{onClick:f,class:"flex-1 btn btn-sm btn-primary"},[...i[6]||(i[6]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})],-1),Q(" Copy ",-1)])]),e("button",{onClick:l,class:"btn btn-sm",title:"Share"},[...i[7]||(i[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})],-1)])]),e("button",{onClick:d,class:"btn btn-sm",title:"Open in new tab"},[...i[8]||(i[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)])])])])):j("",!0),e("button",{onClick:i[1]||(i[1]=x=>s.value=!s.value),class:"w-full text-xs text-r58-text-secondary hover:text-r58-text-primary flex items-center justify-center gap-1"},[e("span",null,h(s.value?"Hide":"Show")+" options",1),(t(),n("svg",{class:A(["w-3 h-3 transition-transform",{"rotate-180":s.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...i[9]||(i[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),s.value?(t(),n("div",fr,[e("label",br,[q(e("input",{type:"checkbox","onUpdate:modelValue":i[2]||(i[2]=x=>m.value=x),class:"rounded"},null,512),[[Re,m.value]]),i[10]||(i[10]=e("span",null,"Enable video",-1))]),e("label",yr,[q(e("input",{type:"checkbox","onUpdate:modelValue":i[3]||(i[3]=x=>r.value=x),class:"rounded"},null,512),[[Re,r.value]]),i[11]||(i[11]=e("span",null,"Enable audio",-1))])])):j("",!0),p.value&&M.value?(t(),n("div",hr,[e("button",{onClick:i[4]||(i[4]=x=>s.value=!s.value),class:"text-xs text-r58-text-secondary hover:text-r58-text-primary"}," Show QR Code "),s.value?(t(),n("div",kr,[e("img",{src:M.value,alt:"QR Code",class:"w-32 h-32 bg-white p-2 rounded"},null,8,wr)])):j("",!0)])):j("",!0),e("div",Sr,[i[12]||(i[12]=Q(" Room: ",-1)),e("span",_r,h(K(De)),1)])]))}}),Cr={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Mr={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-2xl"},Ir={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},Rr={class:"text-xl font-semibold"},Er={class:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},Dr={class:"flex gap-6"},jr={class:"flex-1"},Lr={class:"mb-4"},Tr={class:"mb-4"},Vr={class:"flex gap-2 flex-wrap"},Pr=["onClick"],Or={class:"mb-4"},Ur={id:"scene-canvas",class:"relative aspect-video bg-black rounded-lg overflow-hidden border border-r58-bg-tertiary"},Ar=["onMousedown","onClick"],Hr={class:"absolute inset-0 flex items-center justify-center text-xs text-r58-text-secondary"},Nr=["onMousedown"],Br=["onClick"],zr={class:"w-64 flex-shrink-0"},Fr={key:0,class:"space-y-4"},Kr=["value"],Gr=["value"],Wr={class:"grid grid-cols-2 gap-2"},Yr={key:1,class:"text-sm text-r58-text-secondary p-4 bg-r58-bg-tertiary rounded-lg"},Jr={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},qr=Z({__name:"SceneEditor",setup(_,{expose:a}){const s=ue(),m=oe(),r=C(!1),p=C(null),f=C(!1),d=C(""),l=C([]),M=C(null),g=C(!1),i=C(null),x=C({x:0,y:0}),$=C("move"),N=H(()=>m.connectedSources),T=[{id:"solo",name:"Solo",slots:[{x:0,y:0,w:100,h:100}]},{id:"split",name:"Split",slots:[{x:0,y:0,w:50,h:100},{x:50,y:0,w:50,h:100}]},{id:"pip",name:"PiP",slots:[{x:0,y:0,w:100,h:100},{x:65,y:60,w:30,h:35}]},{id:"quad",name:"Quad",slots:[{x:0,y:0,w:50,h:50},{x:50,y:0,w:50,h:50},{x:0,y:50,w:50,h:50},{x:50,y:50,w:50,h:50}]},{id:"three-up",name:"3-Up",slots:[{x:0,y:0,w:50,h:100},{x:50,y:0,w:50,h:50},{x:50,y:50,w:50,h:50}]}];function b(V){p.value=V,f.value=!1,d.value=V.name,l.value=JSON.parse(JSON.stringify(V.slots)),M.value=null,r.value=!0}function E(){p.value=null,f.value=!0,d.value="New Scene",l.value=[{id:"slot-1",sourceId:null,position:{x:0,y:0,w:100,h:100},zIndex:0}],M.value=null,r.value=!0}function y(){r.value=!1,p.value=null}function o(){if(!d.value.trim()){B.error("Scene name is required");return}if(f.value){const V=s.createScene({name:d.value.trim(),resolution:{width:1920,height:1080},slots:l.value});B.success(`Created: ${V.name}`)}else p.value&&(s.updateScene(p.value.id,{name:d.value.trim(),slots:l.value}),B.success(`Updated: ${d.value}`));y()}function I(V){l.value=V.slots.map((w,D)=>{var O;return{id:`slot-${D+1}`,sourceId:((O=l.value[D])==null?void 0:O.sourceId)||null,position:{x:w.x,y:w.y,w:w.w,h:w.h},zIndex:D}}),B.info(`Applied: ${V.name}`)}function u(){const V={id:`slot-${Date.now()}`,sourceId:null,position:{x:10,y:10,w:30,h:30},zIndex:l.value.length};l.value.push(V),M.value=V.id}function P(V){const w=l.value.findIndex(D=>D.id===V);w!==-1&&(l.value.splice(w,1),M.value===V&&(M.value=null))}function R(V){M.value=V}const v=H(()=>l.value.find(V=>V.id===M.value));function k(V){if(!M.value)return;const w=l.value.find(D=>D.id===M.value);w&&(w.sourceId=V)}function c(V,w,D="move"){V.preventDefault(),g.value=!0,i.value=w,$.value=D,x.value={x:V.clientX,y:V.clientY},window.addEventListener("mousemove",S),window.addEventListener("mouseup",U)}function S(V){if(!g.value||!i.value)return;const w=l.value.find(de=>de.id===i.value);if(!w)return;const D=document.getElementById("scene-canvas");if(!D)return;const O=D.getBoundingClientRect(),z=(V.clientX-x.value.x)/O.width*100,ae=(V.clientY-x.value.y)/O.height*100;$.value==="move"?(w.position.x=Math.max(0,Math.min(100-w.position.w,w.position.x+z)),w.position.y=Math.max(0,Math.min(100-w.position.h,w.position.y+ae))):(w.position.w=Math.max(10,Math.min(100-w.position.x,w.position.w+z)),w.position.h=Math.max(10,Math.min(100-w.position.y,w.position.h+ae))),x.value={x:V.clientX,y:V.clientY}}function U(){g.value=!1,i.value=null,window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",U)}return a({open:b,openNew:E}),(V,w)=>(t(),me(ye,{to:"body"},[r.value?(t(),n("div",Cr,[e("div",{class:"absolute inset-0 bg-black/70",onClick:y}),e("div",Mr,[e("div",Ir,[e("h2",Rr,h(f.value?"Create Scene":"Edit Scene"),1),e("button",{onClick:y,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",Er,[e("div",Dr,[e("div",jr,[e("div",Lr,[w[7]||(w[7]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Scene Name",-1)),q(e("input",{"onUpdate:modelValue":w[0]||(w[0]=D=>d.value=D),type:"text",class:"w-full px-3 py-2 bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ne,d.value]])]),e("div",Tr,[w[8]||(w[8]=e("label",{class:"block text-sm text-r58-text-secondary mb-2"},"Quick Layouts",-1)),e("div",Vr,[(t(),n(W,null,J(T,D=>e("button",{key:D.id,onClick:O=>I(D),class:"px-3 py-1 text-xs bg-r58-bg-tertiary hover:bg-r58-accent-primary/20 rounded transition-colors"},h(D.name),9,Pr)),64))])]),e("div",Or,[w[9]||(w[9]=e("label",{class:"block text-sm text-r58-text-secondary mb-2"},"Layout",-1)),e("div",Ur,[(t(!0),n(W,null,J(l.value,D=>(t(),n("div",{key:D.id,onMousedown:O=>c(O,D.id,"move"),onClick:ke(O=>R(D.id),["stop"]),class:A(["absolute cursor-move transition-colors",[M.value===D.id?"border-2 border-r58-accent-primary":"border border-r58-bg-tertiary hover:border-r58-accent-primary/50"]]),style:pe({left:`${D.position.x}%`,top:`${D.position.y}%`,width:`${D.position.w}%`,height:`${D.position.h}%`,zIndex:D.zIndex,backgroundColor:D.sourceId?"var(--r58-bg-tertiary)":"var(--r58-bg-secondary)"})},[e("div",Hr,h(D.sourceId||"Empty"),1),M.value===D.id?(t(),n("div",{key:0,onMousedown:ke(O=>c(O,D.id,"resize"),["stop"]),class:"absolute bottom-0 right-0 w-4 h-4 bg-r58-accent-primary cursor-se-resize"},null,40,Nr)):j("",!0),M.value===D.id&&l.value.length>1?(t(),n("button",{key:1,onClick:ke(O=>P(D.id),["stop"]),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center hover:bg-red-400"}," Ã— ",8,Br)):j("",!0)],46,Ar))),128))])]),e("button",{onClick:u,class:"btn btn-sm"}," + Add Slot ")]),e("div",zr,[w[17]||(w[17]=e("h3",{class:"text-sm font-medium mb-3"},"Slot Properties",-1)),v.value?(t(),n("div",Fr,[e("div",null,[w[11]||(w[11]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Source",-1)),e("select",{value:v.value.sourceId||"",onChange:w[1]||(w[1]=D=>k(D.target.value||null)),class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg"},[w[10]||(w[10]=e("option",{value:""},"None (Empty)",-1)),(t(!0),n(W,null,J(N.value,D=>(t(),n("option",{key:D.id,value:D.id},h(D.label),9,Gr))),128))],40,Kr)]),e("div",Wr,[e("div",null,[w[12]||(w[12]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"X %",-1)),q(e("input",{"onUpdate:modelValue":w[2]||(w[2]=D=>v.value.position.x=D),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,v.value.position.x,void 0,{number:!0}]])]),e("div",null,[w[13]||(w[13]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Y %",-1)),q(e("input",{"onUpdate:modelValue":w[3]||(w[3]=D=>v.value.position.y=D),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,v.value.position.y,void 0,{number:!0}]])]),e("div",null,[w[14]||(w[14]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Width %",-1)),q(e("input",{"onUpdate:modelValue":w[4]||(w[4]=D=>v.value.position.w=D),type:"number",min:"1",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,v.value.position.w,void 0,{number:!0}]])]),e("div",null,[w[15]||(w[15]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Height %",-1)),q(e("input",{"onUpdate:modelValue":w[5]||(w[5]=D=>v.value.position.h=D),type:"number",min:"1",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,v.value.position.h,void 0,{number:!0}]])])]),e("div",null,[w[16]||(w[16]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Layer (z-index)",-1)),q(e("input",{"onUpdate:modelValue":w[6]||(w[6]=D=>v.value.zIndex=D),type:"number",min:"0",max:"10",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,v.value.zIndex,void 0,{number:!0}]])])])):(t(),n("div",Yr," Click a slot to edit its properties "))])])]),e("div",Jr,[e("button",{onClick:y,class:"btn"},"Cancel"),e("button",{onClick:o,class:"btn btn-primary"},h(f.value?"Create Scene":"Save Changes"),1)])])])):j("",!0)]))}}),Xr={class:"h-full flex flex-col bg-r58-bg-primary"},Qr={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},Zr={class:"flex items-center gap-4"},ea={class:"flex items-center gap-2"},ta={key:0,class:"badge badge-danger"},oa={class:"flex items-center gap-4"},na={class:"flex-1 p-6 overflow-auto"},sa={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ra={class:"card p-6"},aa={class:"grid grid-cols-4 gap-3"},ia=["onClick"],la={class:"card p-6"},da={class:"text-lg font-semibold mb-4"},ca={class:"text-sm font-normal text-r58-text-secondary"},ua={class:"space-y-3"},va={class:"flex items-center gap-3"},ma={class:"font-medium"},pa={key:0,class:"text-xs text-r58-text-secondary ml-2"},ga={key:0,class:"text-sm text-r58-text-secondary"},xa={class:"card p-6"},fa={class:"flex items-center gap-4"},ba={key:0,class:"w-2 h-2 rounded-full bg-white animate-pulse mr-2"},ya={key:0,class:"mt-3 text-sm text-r58-text-secondary"},ha={class:"card p-6"},ka={class:"grid grid-cols-2 gap-4"},wa={class:"text-2xl font-bold text-r58-text-primary"},Sa=Z({__name:"MixerLiteView",emits:["enable-full-mode"],setup(_,{emit:a}){const s=a,m=ge(),r=oe(),p=he(),{register:f}=Ve(),d=H(()=>r.isLive),l=H(()=>m.inputs),M=H(()=>l.value.filter(T=>T.hasSignal));let g=null;ve(()=>{m.fetchInputs(),g=window.setInterval(()=>{m.fetchInputs()},5e3);for(let T=1;T<=4;T++)f({key:String(T),description:`Switch to scene ${T}`,action:()=>i(T),context:"mixer-lite"})}),xe(()=>{g&&clearInterval(g)});function i(T){r.setScene(`scene-${T}`),B.info(`Scene ${T}`)}function x(){r.isLive?(r.toggleLive(),p.stopStreaming(),B.info("Session ended")):(r.toggleLive(),p.startStreaming(),B.success("Going live!"))}async function $(){try{m.isRecording?(await m.stopRecording(),B.info("Recording stopped")):(await m.startRecording(),B.success("Recording started"))}catch{B.error("Recording action failed")}}function N(){confirm("Full Mixer mode loads VDO.ninja which uses significant CPU/GPU resources. This may cause lag on the device. Continue?")&&s("enable-full-mode")}return(T,b)=>(t(),n("div",Xr,[e("header",Qr,[e("div",Zr,[e("div",ea,[e("span",{class:A(["w-3 h-3 rounded-full",d.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"])},null,2),b[0]||(b[0]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1)),b[1]||(b[1]=e("span",{class:"text-xs px-2 py-0.5 rounded bg-amber-500/20 text-amber-400 font-medium"}," LITE MODE ",-1))]),d.value?(t(),n("span",ta,"ON AIR")):j("",!0)]),e("div",oa,[e("button",{class:"btn btn-sm btn-secondary",onClick:N,title:"Enable full VDO.ninja mixer (high CPU usage)"},[...b[2]||(b[2]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1),Q(" Full Mode ",-1)])]),e("button",{class:A(["btn",d.value?"btn-danger":"btn-primary"]),onClick:x},h(d.value?"End Session":"Go Live"),3)])]),e("main",na,[b[10]||(b[10]=be('<div class="mb-6 p-4 rounded-lg bg-amber-500/10 border border-amber-500/30" data-v-6d9e9096><div class="flex items-start gap-3" data-v-6d9e9096><svg class="w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-6d9e9096><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-6d9e9096></path></svg><div data-v-6d9e9096><h3 class="font-medium text-amber-400" data-v-6d9e9096>Local Device Mode</h3><p class="text-sm text-r58-text-secondary mt-1" data-v-6d9e9096> VDO.ninja previews are disabled to save CPU. Scene switching and guest management should be done from a remote browser or the Electron app. </p></div></div></div>',1)),e("div",sa,[e("div",ra,[b[3]||(b[3]=e("h2",{class:"text-lg font-semibold mb-4"},"Scene Control",-1)),e("div",aa,[(t(),n(W,null,J(4,E=>e("button",{key:E,class:A(["aspect-video flex items-center justify-center text-2xl font-bold rounded-lg transition-all",K(r).currentScene===`scene-${E}`?"bg-r58-mixer text-white ring-2 ring-r58-mixer ring-offset-2 ring-offset-r58-bg-primary":"bg-r58-bg-tertiary hover:bg-r58-bg-secondary text-r58-text-primary"]),onClick:y=>i(E)},h(E),11,ia)),64))]),b[4]||(b[4]=e("p",{class:"text-xs text-r58-text-secondary mt-3"}," Press 1-4 to switch scenes. Full transitions require VDO.ninja (Full Mode). ",-1))]),e("div",la,[e("h2",da,[b[5]||(b[5]=Q(" Inputs ",-1)),e("span",ca,"("+h(M.value.length)+"/"+h(l.value.length)+" active)",1)]),e("div",ua,[(t(!0),n(W,null,J(l.value,E=>(t(),n("div",{key:E.id,class:A(["flex items-center justify-between p-3 rounded-lg",E.hasSignal?"bg-r58-bg-tertiary":"bg-r58-bg-secondary opacity-50"])},[e("div",va,[e("div",{class:A(["w-2 h-2 rounded-full",E.hasSignal?"bg-green-500":"bg-gray-500"])},null,2),e("div",null,[e("span",ma,h(E.name),1),E.resolution?(t(),n("span",pa,h(E.resolution),1)):j("",!0)])]),E.framerate?(t(),n("div",ga,h(E.framerate.toFixed(1))+" fps ",1)):j("",!0)],2))),128))])]),e("div",xa,[b[6]||(b[6]=e("h2",{class:"text-lg font-semibold mb-4"},"Device Recording",-1)),e("div",fa,[e("button",{class:A(["btn flex-1",K(m).isRecording?"btn-danger":"btn-primary"]),onClick:$},[K(m).isRecording?(t(),n("span",ba)):j("",!0),Q(" "+h(K(m).isRecording?"Stop Recording":"Start Recording"),1)],2)]),K(m).isRecording?(t(),n("div",ya," Duration: "+h(K(m).formattedDuration),1)):j("",!0)]),e("div",ha,[b[9]||(b[9]=e("h2",{class:"text-lg font-semibold mb-4"},"System Status",-1)),e("div",ka,[e("div",null,[e("div",wa,h(M.value.length),1),b[7]||(b[7]=e("div",{class:"text-sm text-r58-text-secondary"},"Active Inputs",-1))]),e("div",null,[e("div",{class:A(["text-2xl font-bold",d.value?"text-red-500":"text-r58-text-primary"])},h(d.value?"LIVE":"Offline"),3),b[8]||(b[8]=e("div",{class:"text-sm text-r58-text-secondary"},"Stream Status",-1))])])])])])]))}}),_a=le(Sa,[["__scopeId","data-v-6d9e9096"]]),$a={class:"h-full flex flex-col bg-r58-bg-primary"},Ca={class:"flex items-center justify-between px-6 py-3 border-b border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"mixer-header"},Ma={class:"flex items-center gap-4"},Ia={class:"flex items-center gap-2"},Ra={key:0,class:"px-3 py-1 bg-red-600 text-white text-xs font-bold uppercase tracking-wider rounded"},Ea={class:"text-sm text-r58-text-secondary"},Da={key:1,class:"text-xs text-r58-text-secondary"},ja={class:"flex items-center gap-3"},La={class:"flex items-center gap-1 bg-r58-bg-tertiary rounded-lg p-1"},Ta={class:"flex-1 flex overflow-hidden"},Va={class:"flex-1 min-w-0"},Pa={key:0,class:"text-sm font-medium"},Oa={class:"p-4 space-y-6"},Ua={class:"p-2 space-y-4"},Aa={class:"hidden"},Ha=Z({__name:"MixerView",setup(_){const a=oe(),s=ue(),m=ge(),r=he(),{register:p}=Ve(),{isLiteMode:f}=He(),d=C(null),l=Xe(d),M=C(null),g=C(null),i=C(null),x=C(!1),$=H(()=>!f.value||x.value),N=C(!0),T=C(!1),b=C(!1),E=H(()=>a.isLive),y=H(()=>r.enabledDestinations.length),o=H(()=>{const O=s.getScene(a.programSceneId||"");return(O==null?void 0:O.name)||"No Scene"});function I(){N.value=!1}re(()=>{var O,z;return(z=(O=d.value)==null?void 0:O.isReady)==null?void 0:z.value},O=>{O&&(console.log("[Mixer] VDO.ninja ready"),T.value=!0)},{immediate:!0});let u=null;function P(){return m.isRecording?1e4:3e4}function R(){u&&clearInterval(u),u=window.setInterval(()=>{m.fetchInputs()},P())}re(()=>m.isRecording,()=>{R()});const v=[];ve(async()=>{await m.fetchInputs(),R();for(let O=1;O<=8;O++){const z=O-1,ae=p({key:String(O),description:`Select scene ${O} for preview`,action:()=>{const de=s.scenes[z];de&&(a.setPreviewScene(de.id),B.info(`Preview: ${de.name}`))},context:"mixer"});v.push(ae)}v.push(p({key:" ",description:"Take (transition preview to program)",action:()=>{a.previewSceneId&&a.previewSceneId!==a.programSceneId&&(l.takeToProgram(),B.success("Take!"))},context:"mixer"})),v.push(p({key:"Escape",description:"Cut (immediate switch)",action:()=>{a.previewSceneId&&(l.cutToProgram(),B.info("Cut"))},context:"mixer"})),v.push(p({key:"g",description:"Toggle Go Live",action:k,context:"mixer"})),v.push(p({key:"r",description:"Toggle recording",action:c,context:"mixer"}))}),xe(()=>{v.forEach(O=>O()),u&&(clearInterval(u),u=null)});function k(){if(a.isLive)a.toggleLive(),r.stopStreaming(),B.info("Session ended");else{a.toggleLive(),r.startStreaming();const O=r.enabledDestinations.length;O>0?B.success(`Live! Streaming to ${O} destination${O>1?"s":""}`):B.info("Live! (No streaming destinations configured)")}}function c(){var O,z;if(!l.isConnected.value){B.error("VDO.ninja not connected");return}(z=(O=d.value)==null?void 0:O.isRecording)!=null&&z.value?(l.stopRecording(),B.info("Recording stopped")):(l.startRecording(),B.success("Recording started"))}function S(){var O;(O=M.value)==null||O.open()}function U(){var O;(O=g.value)==null||O.open()}function V(O){var z;(z=i.value)==null||z.open(O)}function w(){var O;(O=i.value)==null||O.openNew()}function D(){b.value=!b.value}return(O,z)=>$.value?(t(),n(W,{key:1},[ee(Be,{name:"fade"},{default:Ne(()=>[N.value?(t(),me(qe,{key:0,mode:"mixer","content-ready":T.value,"min-time":2e3,"max-time":15e3,onReady:I},null,8,["content-ready"])):j("",!0)]),_:1}),e("div",$a,[e("header",Ca,[e("div",Ma,[e("div",Ia,[e("span",{class:A(["w-3 h-3 rounded-full transition-colors",E.value?"bg-red-500 animate-pulse":"bg-r58-bg-tertiary"])},null,2),z[3]||(z[3]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1))]),E.value?(t(),n("span",Ra," ON AIR ")):j("",!0),e("span",Ea,h(o.value),1),E.value&&y.value>0?(t(),n("span",Da," â†’ "+h(y.value)+" platform"+h(y.value>1?"s":""),1)):j("",!0),ee(Is,{"vdo-embed":d.value},null,8,["vdo-embed"])]),e("div",ja,[e("div",La,[e("button",{onClick:z[1]||(z[1]=ae=>K(a).setMode("simple")),class:A(["px-3 py-1 text-xs rounded transition-colors",K(a).mode==="simple"?"bg-r58-accent-primary text-white":"text-r58-text-secondary hover:text-r58-text-primary"])}," Simple ",2),e("button",{onClick:z[2]||(z[2]=ae=>K(a).setMode("pvw-pgm")),class:A(["px-3 py-1 text-xs rounded transition-colors",K(a).mode==="pvw-pgm"?"bg-r58-accent-primary text-white":"text-r58-text-secondary hover:text-r58-text-primary"])}," PVW/PGM ",2)]),e("button",{class:"btn btn-sm",onClick:U,title:"Keyboard Shortcuts (Shift+?)"},[...z[4]||(z[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})],-1)])]),e("button",{class:"btn btn-sm",onClick:S,title:"Streaming Settings"},[...z[5]||(z[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])]),e("button",{class:A(["btn px-6",E.value?"btn-danger":"btn-primary"]),onClick:k},h(E.value?"End Session":"Go Live"),3)])]),e("div",Ta,[e("div",Va,[ee(_o,{"vdo-embed":d.value,controller:K(l),onEditScene:V,onAddScene:w},null,8,["vdo-embed","controller"])]),e("aside",{class:A(["flex-shrink-0 border-l border-r58-bg-tertiary bg-r58-bg-secondary overflow-y-auto transition-all duration-300",b.value?"w-12":"w-72"])},[e("button",{onClick:D,class:"w-full p-3 flex items-center justify-between border-b border-r58-bg-tertiary hover:bg-r58-bg-tertiary/50 transition-colors"},[b.value?j("",!0):(t(),n("span",Pa,"Controls")),(t(),n("svg",{class:A(["w-4 h-4 transition-transform",{"rotate-180":b.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...z[6]||(z[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))]),q(e("div",Oa,[e("section",null,[z[7]||(z[7]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Transitions ",-1)),ee(vr)]),e("section",null,[z[8]||(z[8]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Audio ",-1)),ee(tr,{"vdo-embed":d.value,controller:K(l)},null,8,["vdo-embed","controller"])]),e("section",null,[z[9]||(z[9]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Program Output ",-1)),ee(sn)]),e("section",null,[z[10]||(z[10]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Recording ",-1)),ee(Us,{"vdo-embed":d.value},null,8,["vdo-embed"])]),e("section",null,[z[11]||(z[11]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Invite Guests ",-1)),ee($r)])],512),[[fe,!b.value]]),q(e("div",Ua,[...z[12]||(z[12]=[be('<button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Transitions" data-v-8aa77e12><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8aa77e12><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" data-v-8aa77e12></path></svg></button><button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Audio" data-v-8aa77e12><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8aa77e12><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" data-v-8aa77e12></path></svg></button><button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Recording" data-v-8aa77e12><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8aa77e12><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" data-v-8aa77e12></path></svg></button>',3)])],512),[[fe,b.value]])],2)]),ee(Go),e("div",Aa,[ee(To,{ref_key:"vdoEmbedRef",ref:d,profile:"director"},null,512)]),ee(Jn,{ref_key:"streamingSettingsRef",ref:M},null,512),ee(gs,{ref_key:"hotkeySettingsRef",ref:g},null,512),ee(qr,{ref_key:"sceneEditorRef",ref:i},null,512)])],64)):(t(),me(_a,{key:0,onEnableFullMode:z[0]||(z[0]=ae=>x.value=!0)}))}}),Fa=le(Ha,[["__scopeId","data-v-8aa77e12"]]);export{Fa as default};
