import{C as Se,r as w,h as L,e as se,f as ae,d as F,w as ie,c as o,p as M,a as e,A as H,n as j,o as s,j as ne,F as A,B as K,s as Z,v as Q,D as ce,t as x,m as oe,y as U,E as Pe,k as W,G as ue,q as re,z as G,_ as $e,H as fe,x as Re}from"./index-fukhFeMC.js";import{u as me}from"./recorder-CCtS4OFG.js";const ee=Se("mixer",()=>{const h=w(!1),m=w(null),a=w(null),i=w(null),c=w([]),n=L(()=>c.value.filter(f=>f.hasVideo||f.hasAudio));function v(){h.value=!h.value}function g(f){m.value=f}function r(f){a.value=f}function $(f){i.value=f}function T(f){c.value=f}function k(f,O){const R=c.value.find(P=>P.id===f);R&&(R.muted=O)}function C(f,O){const R=c.value.find(P=>P.id===f);R&&(R.audioLevel=O)}return{isLive:h,activeScene:m,programSource:a,previewSource:i,sources:c,activeSources:n,toggleLive:v,setScene:g,setProgram:r,setPreview:$,updateSourcesFromVdo:T,setSourceMute:k,updateAudioLevel:C}}),te=[{id:"youtube",name:"YouTube Live",icon:"â–¶ï¸",rtmpBaseUrl:"rtmp://a.rtmp.youtube.com/live2/",streamKeyPlaceholder:"xxxx-xxxx-xxxx-xxxx-xxxx",helpUrl:"https://support.google.com/youtube/answer/2907883"},{id:"twitch",name:"Twitch",icon:"ðŸ“º",rtmpBaseUrl:"rtmp://live.twitch.tv/app/",streamKeyPlaceholder:"live_xxxxxxxxxx_xxxxxxxxxxxxxx",helpUrl:"https://help.twitch.tv/s/article/twitch-stream-key-faq"},{id:"facebook",name:"Facebook Live",icon:"ðŸ“˜",rtmpBaseUrl:"rtmps://live-api-s.facebook.com:443/rtmp/",streamKeyPlaceholder:"FB-xxxxxxxxxx-x",helpUrl:"https://www.facebook.com/help/587160588142067"},{id:"restream",name:"Restream",icon:"ðŸ”„",rtmpBaseUrl:"rtmp://live.restream.io/live/",streamKeyPlaceholder:"re_xxxxxx_xxxxxxxxxx",helpUrl:"https://support.restream.io/en/"},{id:"custom",name:"Custom RTMP",icon:"âš™ï¸",rtmpBaseUrl:"",streamKeyPlaceholder:"your-stream-key"}],pe=Se("streaming",()=>{const h=w([]),m=w(!1),a=w(null),i=w({enabled:!1,host:"",port:8890,streamId:"mixer_program"}),c=L(()=>h.value.find(_=>_.id===a.value)),n=L(()=>h.value.filter(_=>_.enabled)),v=L(()=>te),g=L(()=>{const _=window.location.hostname,b=_==="localhost"||_==="127.0.0.1"?"localhost":_.replace("r58-api","r58-mediamtx");return{rtmp:`rtmp://${b}:1935/mixer_program`,rtsp:`rtsp://${b}:8554/mixer_program`,srt:`srt://${b}:8890?streamid=read:mixer_program`,hls:`https://${_}/hls/mixer_program/index.m3u8`,whep:`${window.location.origin}/api/v1/whep/mixer_program/whep`}});function r(_,p){const b=te.find(u=>u.id===_);if(!b)throw new Error(`Unknown platform: ${_}`);const l={id:`dest-${Date.now()}`,platformId:_,name:p||b.name,streamKey:"",enabled:!1};return h.value.push(l),l}function $(_,p){const b=h.value.findIndex(l=>l.id===_);b!==-1&&(h.value[b]={...h.value[b],...p})}function T(_){const p=h.value.findIndex(b=>b.id===_);p!==-1&&h.value.splice(p,1),a.value===_&&(a.value=null)}function k(_){a.value=_}function C(_){i.value.enabled=_}function f(_){i.value={...i.value,..._}}function O(){m.value=!0}function R(){m.value=!1}function P(_){const p=te.find(b=>b.id===_.platformId);return p?_.platformId==="custom"?`${_.name}${_.streamKey}`:`${p.rtmpBaseUrl}${_.streamKey}`:""}function E(){const _=window.location.hostname;return`srt://${_==="localhost"||_==="127.0.0.1"?"localhost":_.replace("r58-api","r58-mediamtx")}:${i.value.port}?streamid=read:${i.value.streamId}`}function S(){try{const _=localStorage.getItem("r58-streaming-destinations");if(_){const p=JSON.parse(_);h.value=p.destinations||[],p.srtOutput&&(i.value={...i.value,...p.srtOutput})}}catch(_){console.warn("Failed to load saved streaming destinations:",_)}}function t(){try{localStorage.setItem("r58-streaming-destinations",JSON.stringify({destinations:h.value,srtOutput:i.value}))}catch(_){console.warn("Failed to save streaming destinations:",_)}}return S(),{destinations:h,isStreaming:m,activeDestinationId:a,srtOutput:i,activeDestination:c,enabledDestinations:n,platforms:v,programOutputUrls:g,addDestination:r,updateDestination:$,removeDestination:T,setActiveDestination:k,toggleSrtOutput:C,updateSrtConfig:f,startStreaming:O,stopStreaming:R,buildRtmpUrl:P,getSrtOutputUrl:E,saveDestinations:t,loadSavedDestinations:S}});function le(){return"r58-vdo.itagenten.no"}function ve(){return"https"}const X="studio",De={director:{params:{director:X,hidesolo:!0,hideheader:!0,cleanoutput:!0,darkmode:!0,nologo:!0}},scene:{params:{scene:!0,room:X,cover:!0,fadein:500,animated:!0,quality:2,cleanoutput:!0,hideheader:!0,nologo:!0}},multiview:{params:{room:X,scene:!0,grid:!0,autoadd:"*",cleanoutput:!0,hideheader:!0,nologo:!0}},cameraContribution:{params:{room:X,videodevice:0,audiodevice:0,autostart:!0,noaudio:!1}},guestInvite:{params:{room:X,webcam:!0,mic:!0,quality:1,effects:!0}},soloView:{params:{room:X,cover:!0,cleanoutput:!0}},programOutput:{params:{scene:!0,room:X,cover:!0,quality:2,cleanoutput:!0,hideheader:!0,nologo:!0,autostart:!0}}};function ge(){return`${window.location.origin}/static/css/vdo-theme.css`}function Te(h,m={}){const a=le(),i=ve(),c=De[h],n=new URL(`${i}://${a}/`);n.searchParams.set("css",ge());for(const[v,g]of Object.entries(c.params))if(typeof g=="boolean")g&&n.searchParams.set(v,"");else if(typeof g=="number")n.searchParams.set(v,g.toString());else if(typeof g=="string"){let r=g;for(const[$,T]of Object.entries(m))r=r.replace(`{${$}}`,T);r.includes("{")||n.searchParams.set(v,r)}return m.push_id&&n.searchParams.set("push",m.push_id),m.view_id&&n.searchParams.set("view",m.view_id),m.source_ids&&n.searchParams.set("autoadd",m.source_ids),m.whep_url&&n.searchParams.set("whepshare",encodeURIComponent(m.whep_url)),m.label&&n.searchParams.set("label",m.label),n.toString()}function xe(h,m,a){const i=le(),c=ve(),n=new URL(`${c}://${i}/`);return n.searchParams.set("push",h),n.searchParams.set("room",X),n.searchParams.set("whepshare",m),n.searchParams.set("label",a),n.searchParams.set("videodevice","0"),n.searchParams.set("audiodevice","0"),n.searchParams.set("autostart",""),n.searchParams.set("css",ge()),n.toString()}function Oe(h){const m=le(),a=ve(),i=new URL(`${a}://${m}/`);return i.searchParams.set("scene",""),i.searchParams.set("room",X),i.searchParams.set("cover",""),i.searchParams.set("quality","2"),i.searchParams.set("cleanoutput",""),i.searchParams.set("hideheader",""),i.searchParams.set("nologo",""),i.searchParams.set("whipout",h),i.searchParams.set("autostart",""),i.searchParams.set("videodevice","0"),i.searchParams.set("audiodevice","0"),i.searchParams.set("css",ge()),i.toString()}const de="vdo-debug",Me=500,Y=[];let be=typeof localStorage<"u"&&localStorage.getItem(de)==="true";function ye(h){be=h,typeof localStorage<"u"&&(h?localStorage.setItem(de,"true"):localStorage.removeItem(de)),console.log(`[VDO.ninja Debug] ${h?"Enabled":"Disabled"}`)}function he(h){if(Y.push(h),Y.length>Me&&Y.shift(),be){const m=new Date(h.timestamp).toISOString().split("T")[1].slice(0,-1),a=h.direction==="outgoing"?"âž¡ï¸ OUT":"â¬…ï¸ IN",i=h.direction==="outgoing"?"color: #3b82f6; font-weight: bold":"color: #22c55e; font-weight: bold";console.groupCollapsed(`%c[VDO.ninja ${a}] %c${h.type}`,i,"color: inherit"),console.log("Time:",m),h.target&&console.log("Target:",h.target),console.log("Data:",h.data),h.raw&&h.raw!==h.data&&console.log("Raw:",h.raw),console.groupEnd()}}function Ce(){return[...Y]}function Ie(){Y.length=0,console.log("[VDO.ninja Debug] Event history cleared")}function Ee(){const h={total:Y.length,incoming:0,outgoing:0,byType:{},lastActivity:Y.length>0?Y[Y.length-1].timestamp:null};for(const m of Y)m.direction==="incoming"?h.incoming++:h.outgoing++,h.byType[m.type]=(h.byType[m.type]||0)+1;return h}typeof window<"u"&&(window.__VDO_DEBUG__={getHistory:Ce,clearHistory:Ie,getStats:Ee,enable:()=>ye(!0),disable:()=>ye(!1),isEnabled:()=>be});function Le(h){const m=w(!1),a=w(new Map),i=w(null),c=w(!1),n=w("disconnected"),v=w(null),g=le();function r(d,y,D){var N;if(!((N=h.value)!=null&&N.contentWindow)){console.warn("[VDO.ninja] Cannot send command - iframe not ready"),v.value="iframe not ready";return}const B={action:d};y&&(B.target=y),D!==void 0&&(B.value=D),he({timestamp:Date.now(),direction:"outgoing",type:d,target:y,data:{action:d,target:y,value:D},raw:B});try{h.value.contentWindow.postMessage(B,"*")}catch(I){console.error("[VDO.ninja] Failed to send command:",I),v.value=String(I)}}function $(d){r("changeScene",void 0,d),i.value=d}function T(d){r("soloVideo",d)}function k(d,y){r("pip",d,y?"enable":"disable")}function C(d,y){r("mute",d,y);const D=a.value.get(d);D&&(D.muted=y)}function f(d,y){r("volume",d,Math.max(0,Math.min(100,y)))}function O(d){r("soloChat",d)}function R(d){r("highlight",d)}function P(d,y){r("sendChat",d,y)}function E(d){r("hangup",d),a.value.delete(d)}function S(d){r("requestScreen",d)}function t(d){r("addToScene",d)}function _(d){r("removeFromScene",d)}function p(){r("record",void 0,!0),c.value=!0}function b(){r("record",void 0,!1),c.value=!1}function l(d){r("layout",void 0,d)}function u(d){r("reload",d)}function V(d){r("setSlots",void 0,d)}function z(d){r("fullscreen",d)}function q(d){const y=d.origin;if(!y.includes(g.split(":")[0])&&!y.includes("vdo.ninja")&&!y.includes("vdo.itagenten")&&!y.includes("localhost"))return;const D=d.data;if(!D||typeof D!="object")return;const B=D.type||D.action||"unknown",N=D.streamID||D.UUID||D.streamId;switch(he({timestamp:Date.now(),direction:"incoming",type:B,target:N,data:D.data||D.value,raw:D}),B){case"director-ready":case"loaded":case"ready":case"started":m.value=!0,n.value="connected",v.value=null;break;case"new-guest":case"guest-connected":case"push":case"view":case"joined":{if(N){const I=D.data,J={id:N,label:(I==null?void 0:I.label)||D.label||N,type:(I==null?void 0:I.type)||"guest",hasVideo:(I==null?void 0:I.video)!==!1,hasAudio:(I==null?void 0:I.audio)!==!1,muted:!1,audioLevel:0};a.value.set(N,J)}break}case"guest-left":case"guest-disconnected":case"left":case"disconnect":N&&a.value.delete(N);break;case"audio-level":case"loudness":{if(N){const I=a.value.get(N);if(I){const J=D.data;I.audioLevel=(J==null?void 0:J.level)||D.value||0}}break}case"mute-state":case"muted":{if(N){const I=a.value.get(N);if(I){const J=D.data;I.muted=(J==null?void 0:J.muted)??D.value??!1}}break}case"scene-changed":case"scene":{const I=D.data;i.value=(I==null?void 0:I.scene)||D.value||null;break}case"recording-started":c.value=!0;break;case"recording-stopped":c.value=!1;break;case"error":console.error("[VDO.ninja Error]",D.data),v.value=String(D.data);break}}return se(()=>{n.value="connecting",window.addEventListener("message",q),setTimeout(()=>{!m.value&&h.value&&(m.value=!0,n.value="connected")},5e3)}),ae(()=>{window.removeEventListener("message",q),n.value="disconnected"}),{isReady:m,sources:a,activeScene:i,isRecording:c,connectionState:n,lastError:v,setScene:$,setProgram:T,togglePiP:k,setLayout:l,setSlots:V,toggleFullscreen:z,setMute:C,setVolume:f,soloAudio:O,highlightSource:R,sendToGuest:P,kickGuest:E,requestScreenShare:S,acceptGuest:t,removeFromScene:_,refreshSource:u,startRecording:p,stopRecording:b,sendCommand:r,getEventHistory:Ce,getEventStats:Ee}}const je={class:"vdo-embed-container relative w-full h-full bg-black rounded-lg overflow-hidden","data-testid":"vdo-embed-container"},Ue={key:0,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary z-10","data-testid":"vdo-loading"},Ve=["src"],ze=F({__name:"VdoNinjaEmbed",props:{profile:{},sources:{}},setup(h,{expose:m}){const a=h,i=w(null),c=ee(),n=Le(i),{isReady:v,sources:g,setScene:r,setMute:$,setVolume:T,sendCommand:k,isRecording:C,connectionState:f,startRecording:O,stopRecording:R,kickGuest:P,requestScreenShare:E,acceptGuest:S,removeFromScene:t,getEventHistory:_,getEventStats:p}=n,b=L(()=>{const l={};return a.sources&&(l.source_ids=a.sources.join(",")),Te(a.profile,l)});return ie(g,l=>{c.updateSourcesFromVdo(Array.from(l.values()))},{deep:!0}),m({isReady:v,isRecording:C,connectionState:f,setScene:r,setMute:$,setVolume:T,sendCommand:k,startRecording:O,stopRecording:R,kickGuest:P,requestScreenShare:E,acceptGuest:S,removeFromScene:t,getEventHistory:_,getEventStats:p}),(l,u)=>(s(),o("div",je,[H(v)?M("",!0):(s(),o("div",Ue,[...u[0]||(u[0]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full mx-auto mb-4"}),e("p",{class:"text-r58-text-secondary"},"Connecting to VDO.ninja..."),e("p",{class:"text-xs text-r58-text-secondary mt-2"},"Local mixer on R58")],-1)])])),e("iframe",{ref_key:"iframeRef",ref:i,src:b.value,class:j(["w-full h-full border-0",{"opacity-0":!H(v)}]),allow:"camera; microphone; display-capture; autoplay; clipboard-write",allowfullscreen:"","data-testid":"vdo-iframe",title:"VDO.ninja Mixer"},null,10,Ve)]))}}),He={class:"scene-presets","data-testid":"scene-presets"},Ae={class:"space-y-2"},Be={key:0,class:"grid grid-cols-2 gap-2"},Ne=["onClick","title"],Ke={key:1,class:"text-xs text-r58-text-secondary py-2"},Ge={class:"flex gap-2"},Fe=["disabled"],We={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},qe={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl"},Ye={class:"p-6 overflow-y-auto max-h-[60vh]"},Je={class:"mb-6 p-4 bg-r58-bg-tertiary rounded-lg"},Xe={class:"flex gap-2"},Ze=["disabled"],Qe={key:0,class:"text-center py-12 text-r58-text-secondary"},et={key:1,class:"space-y-3"},tt={key:0,class:"flex-1 space-y-3"},st={class:"flex gap-2"},nt=["value"],ot={class:"flex items-center gap-4"},rt={class:"w-10 h-10 rounded bg-r58-bg-secondary flex items-center justify-center text-lg"},at={class:"font-medium"},it={class:"text-xs text-r58-text-secondary"},lt={class:"flex items-center gap-2"},ct=["onClick"],dt=["onClick"],ut=["onClick"],mt=["onClick"],pt={class:"flex items-center justify-between px-6 py-4 border-t border-r58-bg-tertiary"},vt={class:"text-sm text-r58-text-secondary"},_e="r58-scene-presets",ke=1,gt=F({__name:"ScenePresets",props:{vdoEmbed:{}},setup(h,{expose:m}){const a=h,i=ee(),c=w([]),n=w(!1),v=w(null),g=w(""),r=[{id:"grid",name:"Grid",icon:"âŠž"},{id:"solo",name:"Solo",icon:"â—»"},{id:"pip",name:"Picture-in-Picture",icon:"â–«â—»"},{id:"custom",name:"Custom",icon:"âŠ¡"}];function $(){try{const b=localStorage.getItem(_e);if(b){const l=JSON.parse(b);l.version===ke&&(c.value=l.presets)}}catch(b){console.warn("[ScenePresets] Failed to load presets:",b)}}function T(){try{const b={version:ke,presets:c.value};localStorage.setItem(_e,JSON.stringify(b))}catch(b){console.warn("[ScenePresets] Failed to save presets:",b)}}function k(){if(!g.value.trim()){U.error("Please enter a preset name");return}const b={id:`preset-${Date.now()}`,name:g.value.trim(),sceneId:i.activeScene||"scene-1",layoutType:"grid",sourceOrder:i.sources.map(l=>l.id),createdAt:new Date().toISOString()};c.value.push(b),T(),U.success(`Preset "${b.name}" saved`),g.value=""}function C(b){b.lastUsedAt=new Date().toISOString(),T(),a.vdoEmbed&&(a.vdoEmbed.setScene(b.sceneId),a.vdoEmbed.sendCommand("layout",void 0,b.layoutType),b.slots&&a.vdoEmbed.sendCommand("setSlots",void 0,b.slots)),i.setScene(b.sceneId),U.info(`Applied "${b.name}"`)}function f(b){confirm(`Delete preset "${b.name}"?`)&&(c.value=c.value.filter(l=>l.id!==b.id),T(),U.info("Preset deleted"))}function O(b){v.value={...b}}function R(){if(!v.value)return;const b=c.value.findIndex(l=>l.id===v.value.id);b!==-1&&(c.value[b]=v.value,T(),U.success("Preset updated")),v.value=null}function P(){v.value=null}function E(b){b.sceneId=i.activeScene||"scene-1",b.sourceOrder=i.sources.map(l=>l.id),T(),U.success(`Updated "${b.name}" with current scene`)}const S=L(()=>c.value.slice(0,4));function t(){n.value=!0}function _(){n.value=!1,v.value=null}function p(b){return new Date(b).toLocaleDateString()}return se(()=>{$()}),m({openModal:t}),(b,l)=>(s(),o("div",He,[e("div",Ae,[S.value.length>0?(s(),o("div",Be,[(s(!0),o(A,null,K(S.value,u=>(s(),o("button",{key:u.id,onClick:V=>C(u),class:j(["btn btn-sm text-left truncate",{"btn-primary":H(i).activeScene===u.sceneId}]),title:u.name},x(u.name),11,Ne))),128))])):(s(),o("div",Ke," No presets saved yet. ")),e("div",Ge,[Z(e("input",{"onUpdate:modelValue":l[0]||(l[0]=u=>g.value=u),type:"text",placeholder:"Preset name...",class:"flex-1 px-2 py-1 bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-sm focus:border-r58-accent-primary focus:outline-none",onKeyup:ce(k,["enter"])},null,544),[[Q,g.value]]),e("button",{onClick:k,class:"btn btn-sm btn-primary",disabled:!g.value.trim(),title:"Save current scene as preset"}," + ",8,Fe)]),c.value.length>0?(s(),o("button",{key:2,onClick:t,class:"text-xs text-r58-accent-primary hover:underline w-full text-left"}," Manage all presets ("+x(c.value.length)+") ",1)):M("",!0)]),(s(),ne(oe,{to:"body"},[n.value?(s(),o("div",We,[e("div",{class:"absolute inset-0 bg-black/60",onClick:_}),e("div",qe,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[l[4]||(l[4]=e("h2",{class:"text-xl font-semibold"},"Scene Presets",-1)),e("button",{onClick:_,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",Ye,[e("div",Je,[l[5]||(l[5]=e("h3",{class:"text-sm font-semibold mb-3"},"Save Current Scene",-1)),e("div",Xe,[Z(e("input",{"onUpdate:modelValue":l[1]||(l[1]=u=>g.value=u),type:"text",placeholder:"Enter preset name...",class:"flex-1 px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none",onKeyup:ce(k,["enter"])},null,544),[[Q,g.value]]),e("button",{onClick:k,class:"btn btn-primary",disabled:!g.value.trim()}," Save Preset ",8,Ze)])]),c.value.length===0?(s(),o("div",Qe,[...l[6]||(l[6]=[e("div",{class:"text-4xl mb-4"},"ðŸŽ¬",-1),e("p",null,"No presets saved yet.",-1),e("p",{class:"text-sm"},"Save your current scene configuration to quickly switch between layouts.",-1)])])):(s(),o("div",et,[(s(!0),o(A,null,K(c.value,u=>{var V,z,q;return s(),o("div",{key:u.id,class:"flex items-center justify-between p-4 bg-r58-bg-tertiary rounded-lg"},[((V=v.value)==null?void 0:V.id)===u.id?(s(),o("div",tt,[Z(e("input",{"onUpdate:modelValue":l[2]||(l[2]=d=>v.value.name=d),type:"text",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[Q,v.value.name]]),e("div",st,[Z(e("select",{"onUpdate:modelValue":l[3]||(l[3]=d=>v.value.layoutType=d),class:"px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},[(s(),o(A,null,K(r,d=>e("option",{key:d.id,value:d.id},x(d.icon)+" "+x(d.name),9,nt)),64))],512),[[Pe,v.value.layoutType]]),e("button",{onClick:R,class:"btn btn-sm btn-primary"},"Save"),e("button",{onClick:P,class:"btn btn-sm"},"Cancel")])])):(s(),o(A,{key:1},[e("div",ot,[e("div",rt,x(((z=r.find(d=>d.id===u.layoutType))==null?void 0:z.icon)||"âŠ¡"),1),e("div",null,[e("div",at,x(u.name),1),e("div",it,x(((q=r.find(d=>d.id===u.layoutType))==null?void 0:q.name)||"Custom")+" â€¢ Created "+x(p(u.createdAt)),1)])]),e("div",lt,[e("button",{onClick:d=>C(u),class:"btn btn-sm btn-primary"}," Apply ",8,ct),e("button",{onClick:d=>E(u),class:"btn btn-sm",title:"Update with current scene"}," Update ",8,dt),e("button",{onClick:d=>O(u),class:"text-xs text-r58-accent-primary hover:underline"}," Edit ",8,ut),e("button",{onClick:d=>f(u),class:"text-xs text-r58-accent-danger hover:underline"}," Delete ",8,mt)])],64))])}),128))]))]),e("div",pt,[e("div",vt,x(c.value.length)+" preset"+x(c.value.length!==1?"s":"")+" saved ",1),e("button",{onClick:_,class:"btn"},"Close")])])])):M("",!0)]))]))}}),bt={class:"transition-picker","data-testid":"transition-picker"},ft={class:"flex items-center gap-2"},xt={key:0,class:"mt-3 p-3 bg-r58-bg-tertiary rounded-lg space-y-4"},yt={class:"grid grid-cols-3 gap-2"},ht=["onClick","title"],_t={class:"text-lg"},kt={key:0},wt={class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-2"},St={class:"flex gap-2 mb-2"},$t=["onClick"],Ct=F({__name:"TransitionPicker",props:{vdoEmbed:{}},emits:["transition"],setup(h,{expose:m,emit:a}){const i=h,c=a,n=w("cut"),v=w(500),g=w(!1),r=[{type:"cut",name:"Cut",icon:"â¹",description:"Instant switch",hasDuration:!1},{type:"fade",name:"Fade",icon:"ðŸŒ«ï¸",description:"Cross-dissolve",hasDuration:!0},{type:"wipe-left",name:"Wipe Left",icon:"â—€ï¸",description:"Wipe from right to left",hasDuration:!0},{type:"wipe-right",name:"Wipe Right",icon:"â–¶ï¸",description:"Wipe from left to right",hasDuration:!0},{type:"wipe-up",name:"Wipe Up",icon:"ðŸ”¼",description:"Wipe from bottom to top",hasDuration:!0},{type:"wipe-down",name:"Wipe Down",icon:"ðŸ”½",description:"Wipe from top to bottom",hasDuration:!0},{type:"slide-left",name:"Slide Left",icon:"â¬…ï¸",description:"Slide in from right",hasDuration:!0},{type:"slide-right",name:"Slide Right",icon:"âž¡ï¸",description:"Slide in from left",hasDuration:!0},{type:"zoom",name:"Zoom",icon:"ðŸ”",description:"Zoom in/out",hasDuration:!0}],$=[{value:200,label:"0.2s"},{value:500,label:"0.5s"},{value:1e3,label:"1s"},{value:2e3,label:"2s"}],T=L(()=>({type:n.value,duration:v.value})),k=L(()=>r.find(E=>E.type===n.value)||r[0]);function C(E){n.value=E,E==="cut"&&(g.value=!1)}function f(){const E=T.value;i.vdoEmbed&&(E.type==="cut"?i.vdoEmbed.sendCommand("cut"):i.vdoEmbed.sendCommand("transition",void 0,E)),c("transition",E),U.info(`${k.value.name}${E.type!=="cut"?` (${E.duration}ms)`:""}`)}function O(){n.value="cut",f()}function R(){n.value==="cut"&&(n.value="fade"),f()}function P(){g.value=!g.value}return m({executeTransition:f,quickCut:O,quickAuto:R}),(E,S)=>(s(),o("div",bt,[e("div",ft,[e("button",{onClick:O,class:j(["btn btn-sm flex-1 justify-center",{"btn-primary":n.value==="cut"}]),title:"Instant cut (T)","data-testid":"cut-button"}," â¹ Cut ",2),e("button",{onClick:R,class:j(["btn btn-sm flex-1 justify-center",{"btn-primary":n.value!=="cut"}]),title:"Auto-transition (A)","data-testid":"auto-button"},x(k.value.icon)+" "+x(n.value==="cut"?"Auto":k.value.name),3),e("button",{onClick:P,class:j(["btn btn-sm",{"btn-primary":g.value}]),title:"More transition options"},[(s(),o("svg",{class:j(["w-4 h-4 transition-transform",{"rotate-180":g.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...S[1]||(S[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],2)]),g.value?(s(),o("div",xt,[e("div",null,[S[2]||(S[2]=e("h4",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-2"},"Transition Type",-1)),e("div",yt,[(s(),o(A,null,K(r,t=>e("button",{key:t.type,onClick:_=>C(t.type),class:j(["flex flex-col items-center gap-1 p-2 rounded-lg transition-colors text-xs",n.value===t.type?"bg-r58-accent-primary text-white":"bg-r58-bg-secondary hover:bg-r58-accent-primary/20"]),title:t.description},[e("span",_t,x(t.icon),1),e("span",null,x(t.name),1)],10,ht)),64))])]),k.value.hasDuration?(s(),o("div",kt,[e("h4",wt," Duration: "+x(v.value)+"ms ",1),e("div",St,[(s(),o(A,null,K($,t=>e("button",{key:t.value,onClick:_=>v.value=t.value,class:j(["btn btn-sm flex-1",{"btn-primary":v.value===t.value}])},x(t.label),11,$t)),64))]),Z(e("input",{"onUpdate:modelValue":S[0]||(S[0]=t=>v.value=t),type:"range",min:"100",max:"3000",step:"100",class:"w-full h-2 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary"},null,512),[[Q,v.value,void 0,{number:!0}]])])):M("",!0),e("button",{onClick:f,class:"btn btn-primary w-full justify-center","data-testid":"execute-transition-button"},x(k.value.icon)+" Execute "+x(k.value.name)+" "+x(k.value.hasDuration?`(${v.value}ms)`:""),1)])):M("",!0)]))}}),Et={class:"space-y-6","data-testid":"source-panel"},Pt={class:"card"},Rt={key:0,class:"mb-3 px-3 py-2 bg-amber-500/10 border border-amber-500/30 rounded-lg text-xs text-amber-400"},Dt={key:1,class:"text-center py-8 text-r58-text-secondary"},Tt={key:2,class:"space-y-2"},Ot={class:"flex items-center gap-3"},Mt={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},It={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Lt={key:2,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},jt={class:"font-medium"},Ut={class:"text-xs text-r58-text-secondary capitalize"},Vt={class:"flex items-center gap-2"},zt={class:"w-16 h-2 bg-r58-bg-primary rounded-full overflow-hidden"},Ht=["onClick","data-testid","aria-label"],At={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Bt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Nt={class:"card"},Kt={class:"card","data-testid":"scenes-panel"},Gt={class:"grid grid-cols-2 gap-2 mb-4"},Ft={class:"pt-3 border-t border-r58-bg-tertiary"},Wt=F({__name:"SourcePanel",props:{vdoEmbed:{}},setup(h){const m=ee(),a=me(),i=L(()=>m.sources),c=L(()=>a.inputs.filter(g=>g.hasSignal).map(g=>({id:g.id,label:g.label,type:"camera",hasVideo:!0,hasAudio:!0,muted:!1,audioLevel:0}))),n=L(()=>i.value.length>0?i.value:c.value);L(()=>n.value.filter(g=>g.hasVideo||g.hasAudio));const v=L(()=>i.value.length===0&&c.value.length>0);return(g,r)=>(s(),o("div",Et,[e("div",Pt,[r[10]||(r[10]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3","data-testid":"sources-heading"},"Sources",-1)),v.value?(s(),o("div",Rt," Showing HDMI cameras. VDO.ninja sources will appear when guests join. ")):M("",!0),n.value.length===0?(s(),o("div",Dt,[...r[4]||(r[4]=[e("p",null,"No sources connected",-1),e("p",{class:"text-sm mt-1"},"Connect HDMI sources or have guests join the room",-1)])])):(s(),o("div",Tt,[(s(!0),o(A,null,K(n.value,$=>(s(),o("div",{key:$.id,class:"flex items-center justify-between p-3 rounded-lg bg-r58-bg-tertiary"},[e("div",Ot,[e("div",{class:j(["w-10 h-10 rounded bg-r58-bg-primary flex items-center justify-center",{"ring-2 ring-r58-accent-primary":H(m).programSource===$.id}])},[$.type==="camera"?(s(),o("svg",Mt,[...r[5]||(r[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])):$.type==="guest"?(s(),o("svg",It,[...r[6]||(r[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])])):(s(),o("svg",Lt,[...r[7]||(r[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},null,-1)])]))],2),e("div",null,[e("p",jt,x($.label),1),e("p",Ut,x($.type),1)])]),e("div",Vt,[e("div",zt,[e("div",{class:"h-full bg-r58-accent-success rounded-full transition-all duration-100",style:ue({width:`${$.audioLevel}%`})},null,4)]),e("button",{onClick:T=>H(m).setSourceMute($.id,!$.muted),class:j(["p-2 rounded hover:bg-r58-bg-primary transition-colors",{"text-r58-accent-danger":$.muted}]),"data-testid":`mute-button-${$.id}`,"aria-label":$.muted?"Unmute "+$.label:"Mute "+$.label},[$.muted?(s(),o("svg",At,[...r[8]||(r[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(s(),o("svg",Bt,[...r[9]||(r[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],10,Ht)])]))),128))]))]),e("div",Nt,[r[11]||(r[11]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Transitions",-1)),W(Ct,{"vdo-embed":h.vdoEmbed},null,8,["vdo-embed"])]),r[14]||(r[14]=e("div",{class:"card"},[e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Guest Invite"),e("button",{class:"btn w-full justify-center"}," Generate Invite Link ")],-1)),e("div",Kt,[r[13]||(r[13]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Scenes",-1)),e("div",Gt,[e("button",{onClick:r[0]||(r[0]=$=>H(m).setScene("scene1")),class:j(["btn",{"btn-primary":H(m).activeScene==="scene1"}]),"data-testid":"scene-button-1"}," Scene 1 ",2),e("button",{onClick:r[1]||(r[1]=$=>H(m).setScene("scene2")),class:j(["btn",{"btn-primary":H(m).activeScene==="scene2"}]),"data-testid":"scene-button-2"}," Scene 2 ",2),e("button",{onClick:r[2]||(r[2]=$=>H(m).setScene("pip")),class:j(["btn",{"btn-primary":H(m).activeScene==="pip"}]),"data-testid":"scene-button-pip"}," PiP ",2),e("button",{onClick:r[3]||(r[3]=$=>H(m).setScene("grid")),class:j(["btn",{"btn-primary":H(m).activeScene==="grid"}]),"data-testid":"scene-button-grid"}," Grid ",2)]),e("div",Ft,[r[12]||(r[12]=e("h4",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-2"},"Presets",-1)),W(gt,{"vdo-embed":h.vdoEmbed},null,8,["vdo-embed"])])])]))}}),qt={class:"camera-push-bar border-t border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"camera-push-bar"},Yt={class:"flex items-center gap-2"},Jt={class:"text-r58-text-secondary"},Xt={key:0,class:"px-4 pb-3"},Zt={key:0,class:"flex gap-3 flex-wrap"},Qt={class:"text-sm font-medium"},es={class:"text-xs text-r58-text-secondary"},ts=["onClick"],ss={key:1,class:"text-sm text-r58-text-secondary py-2"},ns={class:"hidden"},os=["src","onLoad","onError"],rs=F({__name:"CameraPushBar",setup(h){const m=me(),a=w(new Map),i=w(!0),c=L(()=>m.inputs.filter(k=>k.hasSignal));function n(k){return`${window.location.origin}/api/v1/whep/${k}/whep`}ie(c,k=>{for(const f of k)if(!a.value.has(f.id)){const O=n(f.id),R=xe(f.id,O,f.label);a.value.set(f.id,{cameraId:f.id,label:f.label,status:"connecting",iframeSrc:R})}const C=new Set(k.map(f=>f.id));for(const[f]of a.value)C.has(f)||a.value.delete(f)},{immediate:!0});function v(k){const C=a.value.get(k);C&&(C.status="connected",console.log(`[CameraPush] ${k} connected to VDO.ninja`))}function g(k){const C=a.value.get(k);C&&(C.status="error",console.error(`[CameraPush] ${k} failed to connect`))}function r(k){const C=m.inputs.find(R=>R.id===k);if(!C||!C.hasSignal)return;const f=n(k),O=xe(k,f,C.label);a.value.set(k,{cameraId:k,label:C.label,status:"connecting",iframeSrc:O+`&_t=${Date.now()}`})}function $(k){switch(k){case"connected":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function T(k){switch(k){case"connected":return"Live in VDO.ninja";case"connecting":return"Connecting...";case"error":return"Failed to connect";default:return"Idle"}}return(k,C)=>(s(),o("div",qt,[e("button",{onClick:C[0]||(C[0]=f=>i.value=!i.value),class:"w-full px-4 py-2 flex items-center justify-between text-sm hover:bg-r58-bg-tertiary/50 transition-colors","data-testid":"camera-push-toggle","aria-expanded":"expanded"},[e("div",Yt,[C[1]||(C[1]=e("span",{class:"font-medium"},"Camera Sources",-1)),e("span",Jt,"("+x(c.value.length)+" active)",1)]),(s(),o("svg",{class:j(["w-4 h-4 transition-transform",{"rotate-180":i.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...C[2]||(C[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),i.value?(s(),o("div",Xt,[a.value.size>0?(s(),o("div",Zt,[(s(!0),o(A,null,K(a.value,([f,O])=>(s(),o("div",{key:f,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},[e("span",{class:j(["w-2 h-2 rounded-full",$(O.status)])},null,2),e("span",Qt,x(O.label),1),e("span",es,x(T(O.status)),1),O.status==="error"?(s(),o("button",{key:0,onClick:R=>r(f),class:"ml-2 text-xs text-r58-accent-primary hover:underline"}," Retry ",8,ts)):M("",!0)]))),128))])):(s(),o("div",ss," No cameras connected. Connect HDMI sources to push them to the mixer. "))])):M("",!0),e("div",ns,[(s(!0),o(A,null,K(a.value,([f,O])=>(s(),o("iframe",{key:f,src:O.iframeSrc,onLoad:R=>v(f),onError:R=>g(f),allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,os))),128))])]))}}),as={class:"program-output space-y-3","data-testid":"program-output"},is={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg","data-testid":"program-output-status"},ls={class:"text-sm font-medium","data-testid":"program-output-text"},cs={key:0,class:"space-y-2"},ds={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},us={class:"flex-1 text-xs truncate text-r58-text-secondary"},ms={key:0,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},ps={class:"text-xs text-r58-text-secondary"},vs={key:1,class:"text-xs text-r58-text-secondary px-3"},gs={class:"hidden"},bs=["src"],fs=F({__name:"ProgramOutput",setup(h){const m=ee(),a=pe(),i=w(!1),c=w("idle"),n=w("");function v(){return`${window.location.origin}/api/v1/whip/program/whip`}function g(){i.value||(c.value="connecting",n.value=Oe(v()),i.value=!0,console.log("[ProgramOutput] Starting WHIP push to MediaMTX"))}function r(){i.value&&(i.value=!1,n.value="",c.value="idle",console.log("[ProgramOutput] Stopped WHIP push"))}function $(){i.value&&(c.value="live",console.log("[ProgramOutput] WHIP push connected"))}function T(){c.value="error",console.error("[ProgramOutput] WHIP push failed")}function k(){r(),setTimeout(()=>g(),500)}ie(()=>m.isLive,R=>{R?g():r()});function C(){switch(c.value){case"live":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function f(){switch(c.value){case"live":return"MediaMTX connected";case"connecting":return"Connecting...";case"error":return"Connection failed";default:return"Inactive"}}function O(){const R=a.programOutputUrls.srt;navigator.clipboard.writeText(R),U.success("SRT URL copied")}return(R,P)=>(s(),o("div",as,[e("div",is,[e("span",{class:j(["w-2 h-2 rounded-full",C()]),"data-testid":"program-output-indicator"},null,2),e("span",ls,x(f()),1),c.value==="error"?(s(),o("button",{key:0,onClick:P[0]||(P[0]=E=>k()),class:"ml-auto text-xs text-r58-accent-primary hover:underline"}," Retry ")):M("",!0)]),c.value==="live"?(s(),o("div",cs,[e("div",ds,[P[1]||(P[1]=e("span",{class:"text-xs text-r58-text-secondary"},"ðŸ”´ SRT:",-1)),e("code",us,x(H(a).programOutputUrls.srt),1),e("button",{onClick:O,class:"text-xs text-r58-accent-primary hover:underline"},"Copy")]),H(a).enabledDestinations.length>0?(s(),o("div",ms,[P[2]||(P[2]=e("span",{class:"w-2 h-2 rounded-full bg-emerald-500"},null,-1)),e("span",ps,x(H(a).enabledDestinations.length)+" streaming destination"+x(H(a).enabledDestinations.length>1?"s":"")+" active ",1)])):M("",!0)])):M("",!0),c.value==="idle"?(s(),o("p",vs," Program output will start automatically when you go live. ")):M("",!0),e("div",gs,[i.value&&n.value?(s(),o("iframe",{key:0,src:n.value,onLoad:$,onError:T,allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,bs)):M("",!0)])]))}}),xs={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},ys={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl"},hs={class:"p-6 overflow-y-auto max-h-[60vh]"},_s={class:"mb-8"},ks={class:"flex items-center justify-between mb-4"},ws={key:0,class:"mb-4 p-4 bg-r58-bg-tertiary rounded-lg"},Ss={class:"grid grid-cols-2 gap-2"},$s=["onClick"],Cs={class:"text-xl"},Es={key:1,class:"space-y-3"},Ps=["onClick"],Rs={class:"text-xl"},Ds={class:"flex-1"},Ts={class:"font-medium"},Os={class:"text-xs text-r58-text-secondary"},Ms=["onClick"],Is=["onClick"],Ls={key:2,class:"text-r58-text-secondary text-sm"},js={key:0,class:"mb-8 p-4 bg-r58-bg-tertiary rounded-lg"},Us={class:"text-lg font-medium mb-4"},Vs={class:"space-y-4"},zs=["placeholder"],Hs={key:0},As={class:"flex gap-2"},Bs={class:"mb-8"},Ns={class:"space-y-3"},Ks={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Gs={class:"flex items-center justify-between mb-1"},Fs={class:"text-xs text-r58-text-secondary break-all"},Ws={class:"p-3 bg-r58-bg-tertiary rounded-lg"},qs={class:"flex items-center justify-between mb-1"},Ys={class:"text-xs text-r58-text-secondary break-all"},Js={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Xs={class:"flex items-center justify-between mb-1"},Zs={class:"text-xs text-r58-text-secondary break-all"},Qs={class:"p-3 bg-r58-bg-tertiary rounded-lg"},en={class:"flex items-center justify-between mb-1"},tn={class:"text-xs text-r58-text-secondary break-all"},sn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},nn={class:"flex items-center justify-between mb-1"},on={class:"text-xs text-r58-text-secondary break-all"},rn={class:"p-4 bg-r58-bg-tertiary rounded-lg"},an={class:"flex items-center gap-3 mb-4"},ln=F({__name:"StreamingSettings",setup(h,{expose:m}){const a=pe(),i=w(!1),c=w(null),n=w(!1);w(""),w("");const v=L(()=>a.destinations),g=L(()=>te),r=L(()=>a.programOutputUrls);function $(){i.value=!0}function T(){i.value=!1,c.value=null,n.value=!1}function k(S){const t=a.addDestination(S);c.value=t,n.value=!1,a.saveDestinations()}function C(){c.value&&(a.updateDestination(c.value.id,c.value),a.saveDestinations(),c.value=null,U.success("Streaming destination saved"))}function f(S){a.removeDestination(S),a.saveDestinations(),U.info("Destination removed")}function O(S){a.updateDestination(S.id,{enabled:!S.enabled}),a.saveDestinations()}function R(S,t){navigator.clipboard.writeText(S),U.success(`${t} copied to clipboard`)}function P(S){const t=te.find(_=>_.id===S);return(t==null?void 0:t.icon)||"ðŸ“¡"}function E(S){const t=te.find(_=>_.id===S);return(t==null?void 0:t.name)||"Unknown"}return m({open:$}),(S,t)=>{var _;return s(),ne(oe,{to:"body"},[i.value?(s(),o("div",xs,[e("div",{class:"absolute inset-0 bg-black/60",onClick:T}),e("div",ys,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[t[11]||(t[11]=e("h2",{class:"text-xl font-semibold"},"Streaming Settings",-1)),e("button",{onClick:T,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",hs,[e("section",_s,[e("div",ks,[t[12]||(t[12]=e("h3",{class:"text-lg font-medium"},"Streaming Destinations",-1)),e("button",{onClick:t[0]||(t[0]=p=>n.value=!n.value),class:"btn btn-sm btn-primary"}," + Add Platform ")]),n.value?(s(),o("div",ws,[t[13]||(t[13]=e("p",{class:"text-sm text-r58-text-secondary mb-3"},"Select a streaming platform:",-1)),e("div",Ss,[(s(!0),o(A,null,K(g.value,p=>(s(),o("button",{key:p.id,onClick:b=>k(p.id),class:"flex items-center gap-2 p-3 bg-r58-bg-secondary hover:bg-r58-accent-primary/20 rounded-lg transition-colors text-left"},[e("span",Cs,x(p.icon),1),e("span",null,x(p.name),1)],8,$s))),128))])])):M("",!0),v.value.length>0?(s(),o("div",Es,[(s(!0),o(A,null,K(v.value,p=>(s(),o("div",{key:p.id,class:"flex items-center gap-3 p-3 bg-r58-bg-tertiary rounded-lg"},[e("button",{onClick:b=>O(p),class:j(["w-10 h-6 rounded-full transition-colors relative",p.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:j(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",p.enabled?"left-5":"left-1"])},null,2)],10,Ps),e("span",Rs,x(P(p.platformId)),1),e("div",Ds,[e("div",Ts,x(p.name),1),e("div",Os,x(p.streamKey?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"+p.streamKey.slice(-4):"No stream key"),1)]),e("button",{onClick:b=>c.value={...p},class:"text-r58-accent-primary hover:underline text-sm"}," Edit ",8,Ms),e("button",{onClick:b=>f(p.id),class:"text-r58-accent-danger hover:underline text-sm"}," Remove ",8,Is)]))),128))])):(s(),o("p",Ls," No streaming destinations configured. Add a platform above. "))]),c.value?(s(),o("section",js,[e("h3",Us," Edit "+x(E(c.value.platformId)),1),e("div",Vs,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Display Name",-1)),Z(e("input",{"onUpdate:modelValue":t[1]||(t[1]=p=>c.value.name=p),type:"text",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[Q,c.value.name]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Stream Key",-1)),Z(e("input",{"onUpdate:modelValue":t[2]||(t[2]=p=>c.value.streamKey=p),type:"password",placeholder:(_=H(te).find(p=>p.id===c.value.platformId))==null?void 0:_.streamKeyPlaceholder,class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,8,zs),[[Q,c.value.streamKey]]),t[16]||(t[16]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Your stream key is stored locally and never sent to our servers. ",-1))]),c.value.platformId==="custom"?(s(),o("div",Hs,[t[17]||(t[17]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"RTMP URL",-1)),Z(e("input",{"onUpdate:modelValue":t[3]||(t[3]=p=>c.value.name=p),type:"text",placeholder:"rtmp://your-server.com/live/",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,512),[[Q,c.value.name]])])):M("",!0),e("div",As,[e("button",{onClick:C,class:"btn btn-primary"}," Save "),e("button",{onClick:t[4]||(t[4]=p=>c.value=null),class:"btn"}," Cancel ")])])])):M("",!0),e("section",Bs,[t[26]||(t[26]=e("h3",{class:"text-lg font-medium mb-4"},"Program Output URLs",-1)),t[27]||(t[27]=e("p",{class:"text-sm text-r58-text-secondary mb-4"}," Use these URLs to consume the program feed from MediaMTX: ",-1)),e("div",Ns,[e("div",Ks,[e("div",Gs,[t[18]||(t[18]=e("span",{class:"font-medium"},"ðŸ”´ SRT Output",-1)),e("button",{onClick:t[5]||(t[5]=p=>R(r.value.srt,"SRT URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Fs,x(r.value.srt),1),t[19]||(t[19]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Low-latency, reliable transport. Ideal for remote production. ",-1))]),e("div",Ws,[e("div",qs,[t[20]||(t[20]=e("span",{class:"font-medium"},"ðŸ“º RTMP Output",-1)),e("button",{onClick:t[6]||(t[6]=p=>R(r.value.rtmp,"RTMP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Ys,x(r.value.rtmp),1)]),e("div",Js,[e("div",Xs,[t[21]||(t[21]=e("span",{class:"font-medium"},"ðŸŽ¬ RTSP Output",-1)),e("button",{onClick:t[7]||(t[7]=p=>R(r.value.rtsp,"RTSP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Zs,x(r.value.rtsp),1)]),e("div",Qs,[e("div",en,[t[22]||(t[22]=e("span",{class:"font-medium"},"ðŸŒ HLS Output",-1)),e("button",{onClick:t[8]||(t[8]=p=>R(r.value.hls,"HLS URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",tn,x(r.value.hls),1),t[23]||(t[23]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Browser-compatible streaming. Higher latency. ",-1))]),e("div",sn,[e("div",nn,[t[24]||(t[24]=e("span",{class:"font-medium"},"âš¡ WebRTC (WHEP)",-1)),e("button",{onClick:t[9]||(t[9]=p=>R(r.value.whep,"WHEP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",on,x(r.value.whep),1),t[25]||(t[25]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Ultra-low latency WebRTC. Best for interactive use. ",-1))])])]),e("section",null,[t[30]||(t[30]=e("h3",{class:"text-lg font-medium mb-4"},"SRT Configuration",-1)),e("div",rn,[e("div",an,[e("button",{onClick:t[10]||(t[10]=p=>H(a).toggleSrtOutput(!H(a).srtOutput.enabled)),class:j(["w-10 h-6 rounded-full transition-colors relative",H(a).srtOutput.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:j(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",H(a).srtOutput.enabled?"left-5":"left-1"])},null,2)],2),t[28]||(t[28]=e("span",null,"Enable SRT Output",-1))]),t[29]||(t[29]=e("div",{class:"text-sm text-r58-text-secondary"},[e("p",{class:"mb-2"},"SRT (Secure Reliable Transport) provides:"),e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Low latency (typically 1-2 seconds)"),e("li",null,"Error correction for unreliable networks"),e("li",null,"AES encryption support"),e("li",null,"Compatible with OBS, vMix, and professional equipment")])],-1))])])]),e("div",{class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},[e("button",{onClick:T,class:"btn"},"Close")])])])):M("",!0)])}}}),cn={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},dn={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl","data-testid":"guest-manager-modal"},un={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},mn={class:"flex items-center gap-4"},pn={class:"flex gap-2 text-sm text-r58-text-secondary"},vn={class:"px-2 py-1 bg-r58-bg-tertiary rounded"},gn={class:"px-2 py-1 bg-r58-bg-tertiary rounded"},bn={class:"px-2 py-1 bg-r58-bg-tertiary rounded"},fn={class:"p-6 overflow-y-auto max-h-[60vh]"},xn={key:0,class:"text-center py-12"},yn={key:1,class:"space-y-3"},hn=["onClick"],_n={class:"flex items-center gap-3"},kn={class:"w-10 h-10 rounded-full bg-r58-bg-tertiary flex items-center justify-center text-lg"},wn={class:"flex items-center gap-2"},Sn={class:"font-medium"},$n={key:0,class:"text-xs px-1.5 py-0.5 bg-r58-accent-danger/20 text-r58-accent-danger rounded"},Cn={class:"text-xs text-r58-text-secondary"},En={class:"flex items-center gap-2"},Pn={class:"w-16 h-2 bg-r58-bg-primary rounded-full overflow-hidden"},Rn={class:"flex gap-1 text-xs"},Dn={key:0,class:"text-r58-accent-success"},Tn={key:1,class:"text-r58-accent-success"},On={key:0,class:"px-4 pb-4 space-y-4 border-t border-r58-bg-tertiary"},Mn={class:"flex flex-wrap gap-2 pt-4"},In=["onClick"],Ln=["onClick"],jn=["onClick"],Un={key:0,class:"flex gap-2"},Vn=["onKeyup"],zn=["onClick","disabled"],Hn={class:"text-xs text-r58-text-secondary"},An={class:"bg-r58-bg-tertiary px-1 rounded"},Bn={class:"flex items-center justify-between px-6 py-4 border-t border-r58-bg-tertiary"},Nn={class:"text-sm text-r58-text-secondary"},Kn=F({__name:"GuestManager",props:{vdoEmbed:{}},setup(h,{expose:m}){const a=h,i=ee(),c=w(!1),n=w(null),v=w(""),g=L(()=>i.sources.filter(p=>p.type==="guest")),r=L(()=>i.sources),$=L(()=>i.sources.filter(p=>p.type==="camera").length),T=L(()=>g.value.length),k=L(()=>i.sources.filter(p=>p.type==="screen").length);function C(){c.value=!0}function f(){c.value=!1,n.value=null,v.value=""}function O(p){a.vdoEmbed&&(a.vdoEmbed.setMute(p.id,!p.muted),i.setSourceMute(p.id,!p.muted),U.info(p.muted?`Unmuted ${p.label}`:`Muted ${p.label}`))}function R(p){a.vdoEmbed&&confirm(`Are you sure you want to remove ${p.label} from the room?`)&&(a.vdoEmbed.kickGuest(p.id),U.info(`Removed ${p.label} from room`))}function P(p){a.vdoEmbed&&(a.vdoEmbed.requestScreenShare(p.id),U.info(`Requested screen share from ${p.label}`))}function E(p){a.vdoEmbed&&v.value.trim()&&(a.vdoEmbed.sendCommand("sendChat",p.id,v.value),U.success(`Message sent to ${p.label}`),v.value="")}function S(p){n.value=n.value===p?null:p}function t(p){switch(p){case"camera":return"ðŸ“¹";case"guest":return"ðŸ‘¤";case"screen":return"ðŸ–¥ï¸";case"media":return"ðŸŽ¬";default:return"ðŸ“º"}}function _(p){switch(p){case"camera":return"Camera";case"guest":return"Guest";case"screen":return"Screen Share";case"media":return"Media";default:return"Source"}}return m({open:C}),(p,b)=>(s(),ne(oe,{to:"body"},[c.value?(s(),o("div",cn,[e("div",{class:"absolute inset-0 bg-black/60",onClick:f}),e("div",dn,[e("div",un,[e("div",mn,[b[1]||(b[1]=e("h2",{class:"text-xl font-semibold"},"Source Manager",-1)),e("div",pn,[e("span",vn,"ðŸ‘¤ "+x(T.value),1),e("span",gn,"ðŸ“¹ "+x($.value),1),e("span",bn,"ðŸ–¥ï¸ "+x(k.value),1)])]),e("button",{onClick:f,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",fn,[r.value.length===0?(s(),o("div",xn,[...b[2]||(b[2]=[e("div",{class:"text-4xl mb-4"},"ðŸ‘¥",-1),e("h3",{class:"text-lg font-medium mb-2"},"No Sources Connected",-1),e("p",{class:"text-r58-text-secondary"}," Guests and cameras will appear here when they join the room. ",-1)])])):(s(),o("div",yn,[(s(!0),o(A,null,K(r.value,l=>(s(),o("div",{key:l.id,class:j(["border border-r58-bg-tertiary rounded-lg overflow-hidden transition-colors",{"border-r58-accent-primary bg-r58-accent-primary/5":n.value===l.id}]),"data-testid":"source-card"},[e("div",{class:"flex items-center justify-between p-4 cursor-pointer hover:bg-r58-bg-tertiary/50",onClick:u=>S(l.id)},[e("div",_n,[e("div",kn,x(t(l.type)),1),e("div",null,[e("div",wn,[e("span",Sn,x(l.label),1),l.muted?(s(),o("span",$n," Muted ")):M("",!0)]),e("span",Cn,x(_(l.type)),1)])]),e("div",En,[e("div",Pn,[e("div",{class:"h-full bg-r58-accent-success rounded-full transition-all duration-100",style:ue({width:`${l.audioLevel||0}%`})},null,4)]),e("div",Rn,[l.hasVideo?(s(),o("span",Dn,"ðŸ“¹")):M("",!0),l.hasAudio?(s(),o("span",Tn,"ðŸŽ¤")):M("",!0)]),(s(),o("svg",{class:j(["w-4 h-4 text-r58-text-secondary transition-transform",{"rotate-180":n.value===l.id}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...b[3]||(b[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])],8,hn),n.value===l.id?(s(),o("div",On,[e("div",Mn,[e("button",{onClick:re(u=>O(l),["stop"]),class:j(["btn btn-sm",l.muted?"btn-primary":""]),"data-testid":"mute-guest-button"},x(l.muted?"ðŸ”Š Unmute":"ðŸ”‡ Mute"),11,In),l.type==="guest"?(s(),o("button",{key:0,onClick:re(u=>P(l),["stop"]),class:"btn btn-sm","data-testid":"request-screen-button"}," ðŸ–¥ï¸ Request Screen ",8,Ln)):M("",!0),l.type==="guest"?(s(),o("button",{key:1,onClick:re(u=>R(l),["stop"]),class:"btn btn-sm btn-danger","data-testid":"kick-guest-button"}," âŒ Remove ",8,jn)):M("",!0)]),l.type==="guest"?(s(),o("div",Un,[Z(e("input",{"onUpdate:modelValue":b[0]||(b[0]=u=>v.value=u),type:"text",placeholder:"Send a message to this guest...",class:"flex-1 px-3 py-2 bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none text-sm",onKeyup:ce(u=>E(l),["enter"])},null,40,Vn),[[Q,v.value]]),e("button",{onClick:re(u=>E(l),["stop"]),class:"btn btn-sm btn-primary",disabled:!v.value.trim()}," Send ",8,zn)])):M("",!0),e("div",Hn,[b[4]||(b[4]=G(" ID: ",-1)),e("code",An,x(l.id),1)])])):M("",!0)],2))),128))]))]),e("div",Bn,[e("div",Nn,x(r.value.length)+" source"+x(r.value.length!==1?"s":"")+" connected ",1),e("button",{onClick:f,class:"btn"},"Close")])])])):M("",!0)]))}}),Gn=$e(Kn,[["__scopeId","data-v-f92299a9"]]),Fn={class:"recording-controls space-y-3","data-testid":"recording-controls"},Wn={class:"flex items-center gap-3 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},qn={class:"text-sm font-medium flex-1","data-testid":"recording-status"},Yn={key:0,class:"text-lg font-mono font-bold text-r58-accent-danger","data-testid":"recording-duration"},Jn={class:"flex gap-2"},Xn=["disabled"],Zn={key:0,class:"px-3 py-2 bg-r58-accent-success/10 border border-r58-accent-success/30 rounded-lg"},Qn={class:"flex items-center justify-between"},eo=["href"],to=F({__name:"RecordingControls",props:{vdoEmbed:{}},setup(h){const m=h,a=w(!1),i=w(null),c=w(0),n=w(null),v=w(!1);ie(()=>{var P,E;return(E=(P=m.vdoEmbed)==null?void 0:P.isRecording)==null?void 0:E.value},P=>{P!==void 0&&(a.value=P,P&&!i.value?i.value=Date.now():!P&&i.value&&(i.value=null))});let g=null;function r(){g&&clearInterval(g),g=window.setInterval(()=>{i.value&&(c.value=Date.now()-i.value)},100)}function $(){g&&(clearInterval(g),g=null)}se(()=>{r()}),ae(()=>{$()});const T=L(()=>{const P=Math.floor(c.value/1e3),E=Math.floor(P/3600),S=Math.floor(P%3600/60),t=P%60;return E>0?`${E}:${S.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`:`${S}:${t.toString().padStart(2,"0")}`});async function k(){if(!m.vdoEmbed){U.error("VDO.ninja not connected");return}v.value=!0;try{m.vdoEmbed.startRecording(),a.value=!0,i.value=Date.now(),c.value=0,n.value=null,U.success("Recording started")}catch(P){U.error("Failed to start recording"),console.error("[RecordingControls] Start recording error:",P)}finally{v.value=!1}}async function C(){if(!m.vdoEmbed){U.error("VDO.ninja not connected");return}v.value=!0;try{m.vdoEmbed.stopRecording(),a.value=!1,i.value=null,U.success(`Recording stopped (${T.value})`)}catch(P){U.error("Failed to stop recording"),console.error("[RecordingControls] Stop recording error:",P)}finally{v.value=!1}}function f(){a.value?C():k()}function O(){return a.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"}function R(){return v.value?"Processing...":a.value?`Recording â€¢ ${T.value}`:"Ready to record"}return(P,E)=>(s(),o("div",Fn,[e("div",Wn,[e("span",{class:j(["w-3 h-3 rounded-full",O()]),"data-testid":"recording-indicator"},null,2),e("span",qn,x(R()),1),a.value?(s(),o("span",Yn,x(T.value),1)):M("",!0)]),e("div",Jn,[e("button",{onClick:f,disabled:v.value,class:j(["btn flex-1 justify-center",a.value?"btn-danger":"btn-primary"]),"data-testid":"recording-toggle-button"},[v.value?(s(),o(A,{key:0},[E[0]||(E[0]=e("svg",{class:"animate-spin w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),E[1]||(E[1]=G(" Processing... ",-1))],64)):a.value?(s(),o(A,{key:1},[E[2]||(E[2]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("rect",{x:"6",y:"6",width:"12",height:"12",rx:"1"})],-1)),E[3]||(E[3]=G(" Stop Recording ",-1))],64)):(s(),o(A,{key:2},[E[4]||(E[4]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("circle",{cx:"12",cy:"12",r:"8"})],-1)),E[5]||(E[5]=G(" Start Recording ",-1))],64))],10,Xn)]),n.value?(s(),o("div",Zn,[e("div",Qn,[E[6]||(E[6]=e("span",{class:"text-sm text-r58-accent-success"},"Recording ready!",-1)),e("a",{href:n.value,download:"",class:"text-sm text-r58-accent-primary hover:underline"}," Download ",8,eo)])])):M("",!0),E[7]||(E[7]=e("p",{class:"text-xs text-r58-text-secondary px-1"}," Records the mixed output locally in your browser. Recording is saved when stopped. ",-1))]))}}),so=$e(to,[["__scopeId","data-v-30421222"]]),no={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},oo={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-3xl max-h-[80vh] overflow-hidden shadow-2xl","data-testid":"hotkey-settings-modal"},ro={class:"flex border-b border-r58-bg-tertiary"},ao=["onClick"],io={class:"p-6 overflow-y-auto max-h-[55vh]"},lo={key:0,class:"text-center py-12 text-r58-text-secondary"},co={key:1,class:"space-y-6"},uo={class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},mo={class:"space-y-2"},po={class:"flex-1"},vo={class:"text-sm"},go={key:0,class:"ml-2 text-xs text-r58-accent-primary"},bo={class:"flex items-center gap-2"},fo={key:0,class:"flex items-center gap-2"},xo={key:0,class:"px-3 py-1 bg-r58-accent-primary text-white rounded text-sm font-mono"},yo={key:1,class:"text-sm text-r58-text-secondary animate-pulse"},ho={class:"px-3 py-1 bg-r58-bg-secondary border border-r58-bg-tertiary rounded text-sm font-mono"},_o=["onClick"],ko=["onClick"],we="r58-hotkey-customizations",wo=F({__name:"HotkeySettings",setup(h,{expose:m}){const a=[{id:"help",key:"?",modifiers:["shift"],description:"Show keyboard shortcuts",context:"global",category:"Navigation",editable:!1},{id:"goto-recorder",key:"r",description:"Go to Recorder",context:"global",category:"Navigation",editable:!0},{id:"goto-mixer",key:"m",description:"Go to Mixer",context:"global",category:"Navigation",editable:!0},{id:"escape",key:"Escape",description:"Close modal / Cancel",context:"global",category:"Navigation",editable:!1},{id:"scene-1",key:"1",description:"Switch to Scene 1",context:"mixer",category:"Scenes",editable:!0},{id:"scene-2",key:"2",description:"Switch to Scene 2",context:"mixer",category:"Scenes",editable:!0},{id:"scene-3",key:"3",description:"Switch to Scene 3",context:"mixer",category:"Scenes",editable:!0},{id:"scene-4",key:"4",description:"Switch to Scene 4",context:"mixer",category:"Scenes",editable:!0},{id:"scene-5",key:"5",description:"Switch to Scene 5",context:"mixer",category:"Scenes",editable:!0},{id:"scene-6",key:"6",description:"Switch to Scene 6",context:"mixer",category:"Scenes",editable:!0},{id:"scene-7",key:"7",description:"Switch to Scene 7",context:"mixer",category:"Scenes",editable:!0},{id:"scene-8",key:"8",description:"Switch to Scene 8",context:"mixer",category:"Scenes",editable:!0},{id:"scene-9",key:"9",description:"Switch to Scene 9",context:"mixer",category:"Scenes",editable:!0},{id:"cut",key:"t",description:"Cut transition",context:"mixer",category:"Transitions",editable:!0},{id:"fade",key:"a",description:"Auto-transition (fade)",context:"mixer",category:"Transitions",editable:!0},{id:"cycle-sources",key:"Tab",description:"Cycle through sources",context:"mixer",category:"Transitions",editable:!0},{id:"go-live",key:"g",description:"Toggle Go Live",context:"mixer",category:"Control",editable:!0},{id:"toggle-recording",key:"r",modifiers:["ctrl"],description:"Toggle local recording",context:"mixer",category:"Control",editable:!0},{id:"mute-all",key:"m",modifiers:["ctrl"],description:"Mute all sources",context:"mixer",category:"Control",editable:!0},{id:"source-1",key:"F1",description:"Select source 1",context:"mixer",category:"Sources",editable:!0},{id:"source-2",key:"F2",description:"Select source 2",context:"mixer",category:"Sources",editable:!0},{id:"source-3",key:"F3",description:"Select source 3",context:"mixer",category:"Sources",editable:!0},{id:"source-4",key:"F4",description:"Select source 4",context:"mixer",category:"Sources",editable:!0},{id:"start-stop-recording",key:" ",description:"Start/Stop recording",context:"recorder",category:"Recording",editable:!0},{id:"mark-chapter",key:"c",description:"Mark chapter point",context:"recorder",category:"Recording",editable:!0}],i=w(!1),c=w("mixer"),n=w({}),v=w(null),g=w(null);function r(){try{const u=localStorage.getItem(we);u&&(n.value=JSON.parse(u))}catch(u){console.warn("[HotkeySettings] Failed to load customizations:",u)}}function $(){try{localStorage.setItem(we,JSON.stringify(n.value))}catch(u){console.warn("[HotkeySettings] Failed to save customizations:",u)}}function T(u){const V=n.value[u.id];return V?{...u,key:V.key,modifiers:V.modifiers}:u}const k=L(()=>{const u={global:{},mixer:{},recorder:{}};for(const V of a){const z=T(V);u[V.context][z.category]||(u[V.context][z.category]=[]),u[V.context][z.category].push(z)}return u}),C=L(()=>k.value[c.value]||{});function f(u){return fe(u.key,u.modifiers)}function O(u){return!!n.value[u]}function R(u){const V=a.find(z=>z.id===u);V!=null&&V.editable&&(v.value=u,g.value=null,document.addEventListener("keydown",P))}function P(u){if(u.preventDefault(),u.stopPropagation(),["Control","Alt","Shift","Meta"].includes(u.key))return;const V=[];u.ctrlKey&&V.push("ctrl"),u.altKey&&V.push("alt"),u.shiftKey&&V.push("shift"),u.metaKey&&V.push("meta"),g.value={key:u.key,modifiers:V},document.removeEventListener("keydown",P)}function E(){!v.value||!g.value||(n.value[v.value]={key:g.value.key,modifiers:g.value.modifiers.length>0?g.value.modifiers:void 0},$(),U.success("Hotkey updated"),v.value=null,g.value=null)}function S(){v.value=null,g.value=null,document.removeEventListener("keydown",P)}function t(u){delete n.value[u],$(),U.info("Hotkey reset to default")}function _(){confirm("Reset all hotkeys to defaults?")&&(n.value={},$(),U.info("All hotkeys reset to defaults"))}function p(){r(),i.value=!0}function b(){S(),i.value=!1}se(()=>{r()});function l(){return{...n.value}}return m({open:p,getCustomBindings:l}),(u,V)=>(s(),ne(oe,{to:"body"},[i.value?(s(),o("div",no,[e("div",{class:"absolute inset-0 bg-black/60",onClick:b}),e("div",oo,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[V[0]||(V[0]=e("h2",{class:"text-xl font-semibold"},"Keyboard Shortcuts",-1)),e("div",{class:"flex items-center gap-4"},[e("button",{onClick:_,class:"text-sm text-r58-text-secondary hover:text-r58-text-primary"}," Reset All "),e("button",{onClick:b,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")])]),e("div",ro,[(s(),o(A,null,K(["mixer","global","recorder"],z=>e("button",{key:z,onClick:q=>c.value=z,class:j(["px-6 py-3 text-sm font-medium capitalize transition-colors",c.value===z?"text-r58-accent-primary border-b-2 border-r58-accent-primary":"text-r58-text-secondary hover:text-r58-text-primary"])},x(z),11,ao)),64))]),e("div",io,[Object.keys(C.value).length===0?(s(),o("div",lo," No shortcuts defined for this context. ")):(s(),o("div",co,[(s(!0),o(A,null,K(C.value,(z,q)=>(s(),o("div",{key:q},[e("h3",uo,x(q),1),e("div",mo,[(s(!0),o(A,null,K(z,d=>(s(),o("div",{key:d.id,class:j(["flex items-center justify-between p-3 bg-r58-bg-tertiary rounded-lg",{"ring-2 ring-r58-accent-primary":v.value===d.id}])},[e("div",po,[e("span",vo,x(d.description),1),O(d.id)?(s(),o("span",go,"(customized)")):M("",!0)]),e("div",bo,[v.value===d.id?(s(),o("div",fo,[g.value?(s(),o("kbd",xo,x(H(fe)(g.value.key,g.value.modifiers)),1)):(s(),o("span",yo," Press a key... ")),g.value?(s(),o("button",{key:2,onClick:E,class:"btn btn-sm btn-primary"}," Save ")):M("",!0),e("button",{onClick:S,class:"btn btn-sm"}," Cancel ")])):(s(),o(A,{key:1},[e("kbd",ho,x(f(d)),1),d.editable?(s(),o("button",{key:0,onClick:y=>R(d.id),class:"text-xs text-r58-accent-primary hover:underline"}," Edit ",8,_o)):M("",!0),O(d.id)?(s(),o("button",{key:1,onClick:y=>t(d.id),class:"text-xs text-r58-text-secondary hover:text-r58-accent-danger"}," Reset ",8,ko)):M("",!0)],64))])],2))),128))])]))),128))]))]),e("div",{class:"flex items-center justify-between px-6 py-4 border-t border-r58-bg-tertiary"},[V[1]||(V[1]=e("div",{class:"text-sm text-r58-text-secondary"},' Click "Edit" to customize a shortcut. Press any key combination to set. ',-1)),e("button",{onClick:b,class:"btn"},"Close")])])])):M("",!0)]))}}),So={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},$o={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-4xl max-h-[85vh] overflow-hidden shadow-2xl","data-testid":"layout-editor-modal"},Co={class:"flex h-[60vh]"},Eo={class:"w-64 border-r border-r58-bg-tertiary p-4 overflow-y-auto"},Po={key:0,class:"text-sm text-r58-text-secondary py-4"},Ro={key:1,class:"space-y-2"},Do=["onDragstart"],To={class:"text-lg"},Oo={class:"text-sm truncate"},Mo={class:"space-y-2"},Io=["onClick"],Lo={class:"flex-1 p-6"},jo={class:"mb-4 flex items-center justify-between"},Uo={class:"flex gap-2"},Vo={class:"text-xs text-r58-text-secondary px-2 py-1 bg-r58-bg-tertiary rounded"},zo={class:"relative w-full bg-black rounded-lg overflow-hidden",style:{"aspect-ratio":"16/9"}},Ho=["onDragover","onDrop"],Ao={class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary text-sm"},Bo={class:"bg-r58-bg-secondary/80 px-2 py-1 rounded"},No={key:0,class:"absolute right-0 bottom-0 w-4 h-4 bg-r58-accent-primary cursor-se-resize rounded-tl"},Ko={key:0,class:"absolute inset-0 flex items-center justify-center pointer-events-none"},Go={key:0,class:"mt-4"},Fo={class:"grid grid-cols-2 gap-4"},Wo={class:"text-sm font-medium mb-2"},qo={class:"grid grid-cols-2 gap-2 text-xs"},Yo={class:"flex items-center gap-1"},Jo=["value","onInput"],Xo={class:"flex items-center gap-1"},Zo=["value","onInput"],Qo={class:"flex items-center gap-1"},er=["value","onInput"],tr={class:"flex items-center gap-1"},sr=["value","onInput"],nr=F({__name:"LayoutEditor",props:{vdoEmbed:{}},setup(h,{expose:m}){const a=h,i=ee(),c=w(!1),n=w("grid"),v=w({}),g=w(!1),r=w(null),$=w(null),T=[{id:"grid-2",name:"2 Sources",type:"grid",slots:2},{id:"grid-4",name:"4 Sources",type:"grid",slots:4},{id:"solo",name:"Solo",type:"solo",slots:1},{id:"pip",name:"Picture-in-Picture",type:"pip",slots:2},{id:"split-h",name:"Split Horizontal",type:"split",slots:2},{id:"split-v",name:"Split Vertical",type:"split",slots:2}],k={slot0:{x:0,y:0,width:100,height:100,zIndex:0},slot1:{x:70,y:70,width:28,height:28,zIndex:1,borderRadius:8}},C={slot0:{x:0,y:0,width:50,height:100,zIndex:0},slot1:{x:50,y:0,width:50,height:100,zIndex:0}},f={slot0:{x:0,y:0,width:100,height:50,zIndex:0},slot1:{x:0,y:50,width:100,height:50,zIndex:0}},O={slot0:{x:0,y:0,width:50,height:50,zIndex:0},slot1:{x:50,y:0,width:50,height:50,zIndex:0},slot2:{x:0,y:50,width:50,height:50,zIndex:0},slot3:{x:50,y:50,width:50,height:50,zIndex:0}},R=L(()=>i.sources),P=L(()=>{if(n.value==="custom")return v.value;switch(n.value){case"pip":return k;case"split":return C;case"grid":return O;case"solo":return{slot0:{x:0,y:0,width:100,height:100,zIndex:0}};default:return{}}});function E(d){let y;switch(d.id){case"pip":y=k,n.value="pip";break;case"split-h":y=C,n.value="split";break;case"split-v":y=f,n.value="split";break;case"grid-4":y=O,n.value="grid";break;case"grid-2":y={slot0:{x:0,y:0,width:50,height:100,zIndex:0},slot1:{x:50,y:0,width:50,height:100,zIndex:0}},n.value="grid";break;case"solo":default:y={slot0:{x:0,y:0,width:100,height:100,zIndex:0}},n.value="solo"}a.vdoEmbed&&(a.vdoEmbed.setLayout(d.type),a.vdoEmbed.setSlots(y)),U.success(`Applied ${d.name} layout`)}function S(d,y){g.value=!0,r.value=y,d.dataTransfer&&(d.dataTransfer.effectAllowed="move",d.dataTransfer.setData("text/plain",y))}function t(){g.value=!1,r.value=null,$.value=null}function _(d,y){d.preventDefault(),$.value=y}function p(d,y){var B;d.preventDefault();const D=(B=d.dataTransfer)==null?void 0:B.getData("text/plain");D&&b(D,y),$.value=null,g.value=!1,r.value=null}function b(d,y){a.vdoEmbed&&a.vdoEmbed.sendCommand("addToScene",d,{slot:y}),U.info(`Assigned source to slot ${y+1}`)}function l(){n.value="custom",v.value={...P.value}}function u(d,y){v.value[d]&&(v.value[d]={...v.value[d],...y},a.vdoEmbed&&a.vdoEmbed.setSlots(v.value))}function V(){c.value=!0}function z(){c.value=!1}function q(d){return{left:`${d.x}%`,top:`${d.y}%`,width:`${d.width}%`,height:`${d.height}%`,zIndex:d.zIndex||0,borderRadius:d.borderRadius?`${d.borderRadius}px`:void 0}}return m({open:V}),(d,y)=>(s(),ne(oe,{to:"body"},[c.value?(s(),o("div",So,[e("div",{class:"absolute inset-0 bg-black/60",onClick:z}),e("div",$o,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[y[0]||(y[0]=e("h2",{class:"text-xl font-semibold"},"Layout Editor",-1)),e("button",{onClick:z,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",Co,[e("div",Eo,[y[1]||(y[1]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Sources",-1)),R.value.length===0?(s(),o("div",Po," No sources available. Connect cameras or guests. ")):(s(),o("div",Ro,[(s(!0),o(A,null,K(R.value,D=>(s(),o("div",{key:D.id,draggable:"true",onDragstart:B=>S(B,D.id),onDragend:t,class:j(["flex items-center gap-2 p-3 bg-r58-bg-tertiary rounded-lg cursor-grab active:cursor-grabbing hover:bg-r58-accent-primary/20 transition-colors",{"opacity-50":r.value===D.id}])},[e("span",To,x(D.type==="camera"?"ðŸ“¹":D.type==="guest"?"ðŸ‘¤":"ðŸ–¥ï¸"),1),e("span",Oo,x(D.label),1)],42,Do))),128))])),y[2]||(y[2]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mt-6 mb-3"},"Presets",-1)),e("div",Mo,[(s(),o(A,null,K(T,D=>e("button",{key:D.id,onClick:B=>E(D),class:"w-full text-left px-3 py-2 bg-r58-bg-tertiary rounded-lg hover:bg-r58-accent-primary/20 transition-colors text-sm"},x(D.name),9,Io)),64))])]),e("div",Lo,[e("div",jo,[y[3]||(y[3]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide"}," Layout Preview ",-1)),e("div",Uo,[e("span",Vo,x(n.value),1),n.value!=="custom"?(s(),o("button",{key:0,onClick:l,class:"text-xs text-r58-accent-primary hover:underline"}," Customize ")):M("",!0)])]),e("div",zo,[(s(!0),o(A,null,K(P.value,(D,B,N)=>(s(),o("div",{key:B,class:j(["absolute transition-all duration-200 border-2",[$.value===N?"border-r58-accent-primary bg-r58-accent-primary/20":"border-r58-bg-tertiary border-dashed",g.value?"hover:border-r58-accent-primary hover:bg-r58-accent-primary/10":""]]),style:ue(q(D)),onDragover:I=>_(I,N),onDrop:I=>p(I,N)},[e("div",Ao,[e("span",Bo," Slot "+x(N+1),1)]),n.value==="custom"?(s(),o("div",No)):M("",!0)],46,Ho))),128)),g.value?(s(),o("div",Ko,[...y[4]||(y[4]=[e("div",{class:"bg-r58-bg-secondary/90 px-4 py-2 rounded-lg text-sm"}," Drop source in a slot ",-1)])])):M("",!0)]),n.value==="custom"?(s(),o("div",Go,[y[13]||(y[13]=e("h4",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-2"}," Slot Positions ",-1)),e("div",Fo,[(s(!0),o(A,null,K(v.value,(D,B,N)=>(s(),o("div",{key:B,class:"p-3 bg-r58-bg-tertiary rounded-lg"},[e("div",Wo,"Slot "+x(N+1),1),e("div",qo,[e("label",Yo,[y[5]||(y[5]=G(" X: ",-1)),e("input",{type:"number",value:D.x,onInput:I=>u(B,{x:Number(I.target.value)}),class:"w-14 px-1 py-0.5 bg-r58-bg-secondary rounded",min:"0",max:"100"},null,40,Jo),y[6]||(y[6]=G("% ",-1))]),e("label",Xo,[y[7]||(y[7]=G(" Y: ",-1)),e("input",{type:"number",value:D.y,onInput:I=>u(B,{y:Number(I.target.value)}),class:"w-14 px-1 py-0.5 bg-r58-bg-secondary rounded",min:"0",max:"100"},null,40,Zo),y[8]||(y[8]=G("% ",-1))]),e("label",Qo,[y[9]||(y[9]=G(" W: ",-1)),e("input",{type:"number",value:D.width,onInput:I=>u(B,{width:Number(I.target.value)}),class:"w-14 px-1 py-0.5 bg-r58-bg-secondary rounded",min:"1",max:"100"},null,40,er),y[10]||(y[10]=G("% ",-1))]),e("label",tr,[y[11]||(y[11]=G(" H: ",-1)),e("input",{type:"number",value:D.height,onInput:I=>u(B,{height:Number(I.target.value)}),class:"w-14 px-1 py-0.5 bg-r58-bg-secondary rounded",min:"1",max:"100"},null,40,sr),y[12]||(y[12]=G("% ",-1))])])]))),128))])])):M("",!0)])]),e("div",{class:"flex items-center justify-between px-6 py-4 border-t border-r58-bg-tertiary"},[y[14]||(y[14]=e("div",{class:"text-sm text-r58-text-secondary"}," Drag sources from the left panel to layout slots ",-1)),e("div",{class:"flex gap-2"},[e("button",{onClick:z,class:"btn"},"Close")])])])])):M("",!0)]))}}),or={class:"connection-status","data-testid":"connection-status"},rr={class:"text-xs text-r58-text-secondary"},ar={key:0,class:"text-xs text-r58-accent-danger",title:"Click for details"},ir={key:0,class:"mt-2 p-3 bg-r58-bg-tertiary rounded-lg text-xs space-y-2"},lr={class:"grid grid-cols-2 gap-2"},cr={class:"ml-1 font-medium"},dr={class:"ml-1"},ur={class:"ml-1"},mr={key:0,class:"p-2 bg-r58-accent-danger/10 border border-r58-accent-danger/30 rounded text-r58-accent-danger"},pr={class:"flex gap-2 pt-2 border-t border-r58-bg-tertiary"},vr=["disabled"],gr={key:1,class:"text-r58-text-secondary text-center"},br=F({__name:"ConnectionStatus",props:{vdoEmbed:{}},setup(h){const m=h;ee();const a=w(!1),i=w("never"),c=w(0),n=w(!1),v=L(()=>{var S,t;return((t=(S=m.vdoEmbed)==null?void 0:S.connectionState)==null?void 0:t.value)||"disconnected"}),g=L(()=>{var S,t;return((t=(S=m.vdoEmbed)==null?void 0:S.isReady)==null?void 0:t.value)||!1}),r=L(()=>{var S,t;return((t=(S=m.vdoEmbed)==null?void 0:S.lastError)==null?void 0:t.value)||null}),$=L(()=>v.value==="disconnected"||!g.value?"disconnected":r.value?"error":v.value==="connecting"?"degraded":"healthy"),T=L(()=>{switch($.value){case"healthy":return"bg-r58-accent-success";case"degraded":return"bg-amber-500";case"error":return"bg-r58-accent-danger";case"disconnected":return"bg-r58-text-secondary";default:return"bg-r58-text-secondary"}}),k=L(()=>{switch($.value){case"healthy":return"Connected";case"degraded":return"Connecting...";case"error":return"Error";case"disconnected":return"Disconnected";default:return"Unknown"}});let C=null;function f(){if(m.vdoEmbed){const S=m.vdoEmbed.getEventStats();if(S.lastActivity){const t=Date.now()-S.lastActivity;t<1e3?i.value="just now":t<6e4?i.value=`${Math.floor(t/1e3)}s ago`:t<36e5?i.value=`${Math.floor(t/6e4)}m ago`:i.value="over 1h ago"}}}se(()=>{f(),C=window.setInterval(f,1e3)}),ae(()=>{C&&clearInterval(C)});async function O(){if(!n.value){n.value=!0,c.value++,U.info("Attempting to reconnect...");try{m.vdoEmbed&&m.vdoEmbed.sendCommand("ping"),await new Promise(S=>setTimeout(S,2e3)),g.value&&!r.value?(U.success("Reconnected successfully"),c.value=0):U.error("Reconnection failed. Try refreshing the page.")}catch(S){U.error("Reconnection error"),console.error("[ConnectionStatus] Reconnect error:",S)}finally{n.value=!1}}}function R(){confirm("This will refresh the page and may interrupt active streams. Continue?")&&window.location.reload()}function P(){a.value=!a.value}const E=L(()=>m.vdoEmbed?m.vdoEmbed.getEventStats():{total:0,incoming:0,outgoing:0,lastActivity:null});return(S,t)=>(s(),o("div",or,[e("div",{class:"flex items-center gap-2 cursor-pointer",onClick:P},[e("span",{class:j(["w-2 h-2 rounded-full",[T.value,{"animate-pulse":$.value==="degraded"}]]),"data-testid":"status-indicator"},null,2),e("span",rr,x(k.value),1),r.value?(s(),o("span",ar," âš ï¸ ")):M("",!0),(s(),o("svg",{class:j(["w-3 h-3 text-r58-text-secondary transition-transform",{"rotate-180":a.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[0]||(t[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),a.value?(s(),o("div",ir,[e("div",lr,[e("div",null,[t[1]||(t[1]=e("span",{class:"text-r58-text-secondary"},"VDO.ninja:",-1)),e("span",{class:j(["ml-1 font-medium",g.value?"text-r58-accent-success":"text-r58-accent-danger"])},x(g.value?"Ready":"Not Ready"),3)]),e("div",null,[t[2]||(t[2]=e("span",{class:"text-r58-text-secondary"},"State:",-1)),e("span",cr,x(v.value),1)]),e("div",null,[t[3]||(t[3]=e("span",{class:"text-r58-text-secondary"},"Last activity:",-1)),e("span",dr,x(i.value),1)]),e("div",null,[t[4]||(t[4]=e("span",{class:"text-r58-text-secondary"},"Events:",-1)),e("span",ur,x(E.value.total),1)])]),r.value?(s(),o("div",mr,[t[5]||(t[5]=e("strong",null,"Error:",-1)),G(" "+x(r.value),1)])):M("",!0),e("div",pr,[e("button",{onClick:O,disabled:n.value,class:j(["btn btn-sm flex-1",{"opacity-50":n.value}])},x(n.value?"Reconnecting...":"ðŸ”„ Reconnect"),11,vr),e("button",{onClick:R,class:"btn btn-sm",title:"Refresh the page (last resort)"}," ðŸ”ƒ Refresh ")]),c.value>0?(s(),o("div",gr," Reconnect attempts: "+x(c.value),1)):M("",!0)])):M("",!0)]))}}),fr={class:"h-full flex flex-col"},xr={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"mixer-header"},yr={class:"flex items-center gap-4"},hr={class:"flex items-center gap-2"},_r={key:0,class:"badge badge-danger","data-testid":"on-air-badge"},kr={key:1,class:"text-xs text-r58-text-secondary"},wr={class:"flex items-center gap-4"},Sr={class:"flex-1 flex overflow-hidden"},$r={class:"flex-1 p-4"},Cr={class:"w-80 border-l border-r58-bg-tertiary bg-r58-bg-secondary p-4 overflow-y-auto"},Er={class:"mt-6 pt-4 border-t border-r58-bg-tertiary"},Pr={class:"mt-6 pt-4 border-t border-r58-bg-tertiary"},Tr=F({__name:"MixerView",setup(h){const m=ee(),a=me(),i=pe(),{register:c}=Re(),n=w(null),v=w(null),g=w(null),r=w(null),$=w(null),T=L(()=>m.isLive),k=L(()=>i.enabledDestinations.length);let C=null;const f=[];se(()=>{a.fetchInputs(),C=window.setInterval(()=>{a.fetchInputs()},5e3);for(let l=1;l<=9;l++){const u=c({key:String(l),description:`Switch to scene ${l}`,action:()=>O(l),context:"mixer"});f.push(u)}f.push(c({key:"t",description:"Cut to preview (transition)",action:()=>R(),context:"mixer"})),f.push(c({key:"a",description:"Auto-transition with fade",action:()=>P(),context:"mixer"})),f.push(c({key:"Tab",description:"Cycle through sources",action:()=>E(),context:"mixer"})),f.push(c({key:"g",description:"Toggle Go Live",action:()=>S(),context:"mixer"}))}),ae(()=>{f.forEach(l=>l()),C&&(clearInterval(C),C=null)});function O(l){const u=`scene-${l}`;m.setScene(u),n.value&&n.value.sendCommand("changeScene",{scene:l}),U.info(`Scene ${l}`)}function R(){m.previewSource&&(m.setProgram(m.previewSource),U.info("Cut"))}function P(){m.previewSource&&(n.value&&n.value.sendCommand("transition",{type:"fade",duration:500}),m.setProgram(m.previewSource),U.info("Fade"))}function E(){const l=m.activeSources;if(l.length===0)return;const V=(l.findIndex(z=>z.id===m.previewSource)+1)%l.length;m.setPreview(l[V].id)}function S(){if(m.isLive)m.toggleLive(),i.stopStreaming(),U.info("Session ended");else{m.toggleLive(),i.startStreaming();const l=i.enabledDestinations.length;l>0?U.success(`Live! Streaming to ${l} destination${l>1?"s":""}`):U.info("Live! (No streaming destinations configured)")}}function t(){var l;(l=v.value)==null||l.open()}function _(){var l;(l=g.value)==null||l.open()}function p(){var l;(l=r.value)==null||l.open()}function b(){var l;(l=$.value)==null||l.open()}return(l,u)=>(s(),o("div",fr,[e("header",xr,[e("div",yr,[e("div",hr,[e("span",{class:j(["w-3 h-3 rounded-full",T.value?"bg-r58-accent-danger animate-recording":"bg-r58-bg-tertiary"]),"data-testid":"live-indicator"},null,2),u[0]||(u[0]=e("span",{class:"text-xl font-semibold text-r58-mixer","data-testid":"mixer-title"},"Mixer",-1))]),T.value?(s(),o("span",_r,"ON AIR")):M("",!0),T.value&&k.value>0?(s(),o("span",kr," Streaming to "+x(k.value)+" platform"+x(k.value>1?"s":""),1)):M("",!0),W(br,{"vdo-embed":n.value},null,8,["vdo-embed"])]),e("div",wr,[e("button",{class:"btn btn-sm",onClick:b,title:"Edit Layout","data-testid":"layout-editor-button"},[...u[1]||(u[1]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})],-1)])]),e("button",{class:"btn btn-sm",onClick:p,title:"Keyboard Shortcuts (Shift+?)","data-testid":"hotkey-settings-button"},[...u[2]||(u[2]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})],-1)])]),e("button",{class:"btn btn-sm",onClick:_,title:"Manage Guests & Sources","data-testid":"guest-manager-button"},[...u[3]||(u[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)])]),e("button",{class:"btn btn-sm",onClick:t,title:"Streaming Settings","data-testid":"streaming-settings-button"},[...u[4]||(u[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])]),e("button",{class:j(["btn",T.value?"btn-danger":"btn-primary"]),onClick:S,"data-testid":"go-live-button"},x(T.value?"End Session":"Go Live"),3)])]),e("div",Sr,[e("div",$r,[W(ze,{ref_key:"vdoEmbedRef",ref:n,profile:"director",class:"h-full"},null,512)]),e("aside",Cr,[W(Wt,{"vdo-embed":n.value},null,8,["vdo-embed"]),e("div",Er,[u[5]||(u[5]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Program Output",-1)),W(fs)]),e("div",Pr,[u[6]||(u[6]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Local Recording",-1)),W(so,{"vdo-embed":n.value},null,8,["vdo-embed"])])])]),W(rs),W(ln,{ref_key:"streamingSettingsRef",ref:v},null,512),W(Gn,{ref_key:"guestManagerRef",ref:g,"vdo-embed":n.value},null,8,["vdo-embed"]),W(wo,{ref_key:"hotkeySettingsRef",ref:r},null,512),W(nr,{ref_key:"layoutEditorRef",ref:$,"vdo-embed":n.value},null,8,["vdo-embed"])]))}});export{Tr as default};
