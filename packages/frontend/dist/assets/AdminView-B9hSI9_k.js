const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DxPuJKr5.js","assets/index-CJIb-06t.css"])))=>i.map(i=>d[i]);
import{d as I,u as ce,W as ue,r as w,o as z,l as X,c as s,e,q as d,t as p,f as V,n as A,x as W,F as T,y as E,a as pe,b as ie,i as t,_ as ae,E as te,w as U,S as se,X as ve,Y as re,j as F,B as ne,Z as q,k as me,A as J,$ as xe,I as K,m as O,p as G,a0 as fe}from"./index-DxPuJKr5.js";import{V as oe,a as ke}from"./vdoninja-CEXRmajt.js";const ge={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},_e={class:"card"},be={key:0,class:"text-preke-red"},ye={key:1,class:"space-y-3"},he={class:"flex justify-between items-center"},we={key:0,class:"skeleton w-24 h-5"},$e={key:1,class:"font-medium"},Se={class:"flex justify-between items-center"},Ce={key:0,class:"skeleton w-16 h-5"},je={key:1,class:"capitalize"},De={class:"flex justify-between items-center"},Ae={key:0,class:"skeleton w-12 h-5"},Me={key:1},Re={class:"flex justify-between items-center"},Ve={key:0,class:"skeleton w-20 h-5"},Pe={key:1,class:"badge badge-success"},Ne={class:"card"},Te={class:"space-y-4"},Ee={class:"flex items-center justify-between"},Oe={key:0,class:"skeleton w-20 h-5 rounded-full"},Fe={class:"flex gap-2"},Le=["disabled"],Be={key:0,class:"inline-block animate-spin mr-1"},Ue=["disabled"],Ie={key:0,class:"inline-block animate-spin mr-1"},ze={key:0,class:"text-sm text-preke-red"},He={class:"card"},Ge={class:"space-y-3"},We={class:"flex justify-between items-center"},qe={key:0,class:"skeleton w-20 h-5 rounded-full"},Je={class:"flex justify-between items-center"},Ke={key:0,class:"skeleton w-20 h-5 rounded-full"},Xe={class:"flex justify-between items-center"},Ye={key:0,class:"skeleton w-20 h-5 rounded-full"},Ze={key:1,class:"badge badge-success"},Qe={class:"flex justify-between items-center"},et={key:0,class:"skeleton w-20 h-5 rounded-full"},tt={key:1,class:"badge badge-success"},st={class:"card md:col-span-2 lg:col-span-3"},nt={class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4"},ot={class:"flex items-center justify-between mb-3"},lt={class:"flex items-center gap-2"},it={class:"font-medium"},at={class:"space-y-1 text-sm text-preke-text-dim"},rt={class:"flex justify-between"},dt={class:"text-preke-text"},ct={class:"flex justify-between"},ut={class:"text-preke-text"},pt={class:"flex justify-between"},vt={class:"text-preke-text font-mono text-xs"},mt={key:0,class:"col-span-full text-center text-preke-text-dim py-8"},xt=I({__name:"DeviceStatus",setup(L){const v=ce(),{capabilities:l,loading:m,error:x}=ue(v),i=w(!1),S=w(null);let f=null;async function c(j){if(!i.value){i.value=!0,S.value=null;try{const n=await fetch(ie(`/api/mode/${j}`),{method:"POST"});if(!n.ok){const $=await n.json().catch(()=>({}));throw new Error($.detail||`Failed to switch to ${j} mode`)}await v.fetchCapabilities()}catch(n){S.value=n instanceof Error?n.message:"Failed to switch mode",console.error("Mode switch error:",n)}finally{i.value=!1}}}function u(j,n){if(!n)return"bg-preke-text-dim";switch(j){case"streaming":case"recording":return"bg-preke-green";case"preview":return"bg-preke-blue";case"idle":return"bg-preke-text-dim";case"error":return"bg-preke-red";default:return"bg-preke-text-dim"}}function N(j,n){if(!n)return"No Signal";switch(j){case"streaming":return"Streaming";case"recording":return"Recording";case"preview":return"Preview";case"idle":return"Idle";case"error":return"Error";default:return j}}return z(()=>{v.fetchCapabilities(),f=setInterval(()=>{v.fetchCapabilities()},1e4)}),X(()=>{f&&clearInterval(f)}),(j,n)=>{var $,M,B,C,o,D,H,a,r,k,b,y,R,_;return t(),s("div",ge,[e("div",_e,[n[6]||(n[6]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Device Info",-1)),d(x)&&!d(l)?(t(),s("div",be,p(d(x)),1)):(t(),s("div",ye,[e("div",he,[n[2]||(n[2]=e("span",{class:"text-preke-text-dim"},"Device Name",-1)),d(m)&&!d(l)?(t(),s("div",we)):(t(),s("span",$e,p((($=d(l))==null?void 0:$.device_name)||"R58 Device"),1))]),e("div",Se,[n[3]||(n[3]=e("span",{class:"text-preke-text-dim"},"Platform",-1)),d(m)&&!d(l)?(t(),s("div",Ce)):(t(),s("span",je,p(((M=d(l))==null?void 0:M.platform)||"-"),1))]),e("div",De,[n[4]||(n[4]=e("span",{class:"text-preke-text-dim"},"API Version",-1)),d(m)&&!d(l)?(t(),s("div",Ae)):(t(),s("span",Me,p(((B=d(l))==null?void 0:B.api_version)||"-"),1))]),e("div",Re,[n[5]||(n[5]=e("span",{class:"text-preke-text-dim"},"GStreamer",-1)),d(m)&&!d(l)?(t(),s("div",Ve)):(t(),s("span",Pe,"Initialized"))])]))]),e("div",Ne,[n[10]||(n[10]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Operating Mode",-1)),e("div",Te,[e("div",Ee,[n[7]||(n[7]=e("span",{class:"text-preke-text-dim"},"Current Mode",-1)),d(m)&&!d(l)?(t(),s("div",Oe)):(t(),s("span",{key:1,class:A(["badge",((C=d(l))==null?void 0:C.current_mode)==="mixer"?"badge-info":"badge-success"])},p(((o=d(l))==null?void 0:o.current_mode)==="mixer"?"Mixer":"Recorder"),3))]),e("div",Fe,[e("button",{class:A(["btn btn-sm flex-1",((D=d(l))==null?void 0:D.current_mode)==="recorder"?"btn-primary":"btn-secondary"]),disabled:i.value||((H=d(l))==null?void 0:H.current_mode)==="recorder"||d(m)&&!d(l),onClick:n[0]||(n[0]=g=>c("recorder"))},[i.value&&((a=d(l))==null?void 0:a.current_mode)!=="recorder"?(t(),s("span",Be,"⟳")):V("",!0),n[8]||(n[8]=W(" Recorder ",-1))],10,Le),e("button",{class:A(["btn btn-sm flex-1",((r=d(l))==null?void 0:r.current_mode)==="mixer"?"btn-primary":"btn-secondary"]),disabled:i.value||((k=d(l))==null?void 0:k.current_mode)==="mixer"||d(m)&&!d(l),onClick:n[1]||(n[1]=g=>c("mixer"))},[i.value&&((b=d(l))==null?void 0:b.current_mode)!=="mixer"?(t(),s("span",Ie,"⟳")):V("",!0),n[9]||(n[9]=W(" Mixer ",-1))],10,Ue)]),S.value?(t(),s("div",ze,p(S.value),1)):V("",!0)])]),e("div",He,[n[15]||(n[15]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Available Features",-1)),e("div",Ge,[e("div",We,[n[11]||(n[11]=e("div",null,[e("span",null,"Mixer"),e("span",{class:"text-xs text-preke-text-dim ml-1"},"(VDO.ninja)")],-1)),d(m)&&!d(l)?(t(),s("div",qe)):(t(),s("span",{key:1,class:A(["badge",d(v).mixerEnabled?"badge-success":"badge-warning"])},p(d(v).mixerEnabled?"Available":"Disabled"),3))]),e("div",Je,[n[12]||(n[12]=e("span",null,"Recorder",-1)),d(m)&&!d(l)?(t(),s("div",Ke)):(t(),s("span",{key:1,class:A(["badge",d(v).recorderEnabled?"badge-success":"badge-warning"])},p(d(v).recorderEnabled?"Available":"Disabled"),3))]),e("div",Xe,[n[13]||(n[13]=e("span",null,"Graphics Overlay",-1)),d(m)&&!d(l)?(t(),s("div",Ye)):(t(),s("span",Ze,"Available"))]),e("div",Qe,[n[14]||(n[14]=e("span",null,"WebRTC Preview",-1)),d(m)&&!d(l)?(t(),s("div",et)):(t(),s("span",tt,"Available"))])])]),e("div",st,[n[20]||(n[20]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Hardware Inputs",-1)),e("div",nt,[d(m)&&!d(l)?(t(),s(T,{key:0},E(4,g=>e("div",{key:g,class:"p-4 rounded-lg bg-preke-bg-surface border border-preke-border"},[...n[16]||(n[16]=[pe('<div class="flex items-center justify-between mb-3" data-v-4100f3e3><div class="flex items-center gap-2" data-v-4100f3e3><div class="skeleton w-2 h-2 rounded-full" data-v-4100f3e3></div><div class="skeleton w-16 h-5" data-v-4100f3e3></div></div><div class="skeleton w-16 h-4 rounded-full" data-v-4100f3e3></div></div><div class="space-y-2" data-v-4100f3e3><div class="flex justify-between" data-v-4100f3e3><div class="skeleton w-8 h-4" data-v-4100f3e3></div><div class="skeleton w-12 h-4" data-v-4100f3e3></div></div><div class="flex justify-between" data-v-4100f3e3><div class="skeleton w-16 h-4" data-v-4100f3e3></div><div class="skeleton w-20 h-4" data-v-4100f3e3></div></div><div class="flex justify-between" data-v-4100f3e3><div class="skeleton w-10 h-4" data-v-4100f3e3></div><div class="skeleton w-14 h-4" data-v-4100f3e3></div></div></div>',2)])])),64)):(t(),s(T,{key:1},[(t(!0),s(T,null,E(((y=d(l))==null?void 0:y.inputs)||[],g=>{var P;return t(),s("div",{key:g.id,class:A(["p-4 rounded-lg bg-preke-bg-surface border border-preke-border",{"border-preke-green/50":g.has_signal}])},[e("div",ot,[e("div",lt,[e("span",{class:A(["w-2 h-2 rounded-full animate-pulse",u(g.status,g.has_signal)])},null,2),e("span",it,p(g.label),1)]),e("span",{class:A(["text-xs px-2 py-0.5 rounded-full",{"bg-preke-green/20 text-preke-green":g.has_signal&&(g.status==="streaming"||g.status==="recording"),"bg-preke-blue/20 text-preke-blue":g.has_signal&&g.status==="preview","bg-preke-bg-surface text-preke-text-dim":!g.has_signal||g.status==="idle"}])},p(N(g.status,g.has_signal)),3)]),e("div",at,[e("div",rt,[n[17]||(n[17]=e("span",null,"Type",-1)),e("span",dt,p(g.type.toUpperCase()),1)]),e("div",ct,[n[18]||(n[18]=e("span",null,"Resolution",-1)),e("span",ut,p(g.max_resolution||"N/A"),1)]),e("div",pt,[n[19]||(n[19]=e("span",null,"Device",-1)),e("span",vt,p(((P=g.device_path)==null?void 0:P.split("/").pop())||"N/A"),1)])])],2)}),128)),(_=(R=d(l))==null?void 0:R.inputs)!=null&&_.length?V("",!0):(t(),s("div",mt," No inputs detected "))],64))])])])}}}),ft=ae(xt,[["__scopeId","data-v-4100f3e3"]]),kt={class:"space-y-4"},gt={class:"flex items-center gap-4 flex-wrap"},_t=["value"],bt={class:"flex items-center gap-2 cursor-pointer"},yt=["disabled"],ht={key:0},wt={key:1},$t={class:"bg-preke-bg-base rounded-lg p-4 font-mono text-sm text-preke-text-dim h-[500px] overflow-auto whitespace-pre-wrap"},St=I({__name:"LogViewer",props:{service:{}},setup(L){const v=L,l=w(""),m=w(!1),x=w(v.service||"preke-recorder"),i=w(100),S=w(!1),f=[{id:"preke-recorder",label:"Preke Recorder"},{id:"mediamtx",label:"MediaMTX"}];let c=null;async function u(){m.value=!0;try{const $=await(await fetch(ie(`/api/system/logs?service=${x.value}&lines=${i.value}`))).json();l.value=$.logs||"No logs available"}catch(n){l.value=`Error fetching logs: ${n}`}finally{m.value=!1}}function N(){c&&clearInterval(c),c=window.setInterval(u,5e3)}function j(){c&&(clearInterval(c),c=null)}return te(S,n=>{n?N():j()}),te([x,i],()=>{u()}),z(()=>{u()}),X(()=>{j()}),(n,$)=>(t(),s("div",kt,[e("div",gt,[U(e("select",{"onUpdate:modelValue":$[0]||($[0]=M=>x.value=M),class:"input"},[(t(),s(T,null,E(f,M=>e("option",{key:M.id,value:M.id},p(M.label),9,_t)),64))],512),[[se,x.value]]),U(e("select",{"onUpdate:modelValue":$[1]||($[1]=M=>i.value=M),class:"input"},[...$[3]||($[3]=[e("option",{value:50},"50 lines",-1),e("option",{value:100},"100 lines",-1),e("option",{value:250},"250 lines",-1),e("option",{value:500},"500 lines",-1)])],512),[[se,i.value]]),e("label",bt,[U(e("input",{type:"checkbox","onUpdate:modelValue":$[2]||($[2]=M=>S.value=M),class:"w-4 h-4 rounded"},null,512),[[ve,S.value]]),$[4]||($[4]=e("span",{class:"text-sm"},"Auto-refresh",-1))]),e("button",{onClick:u,disabled:m.value,class:"btn"},[m.value?(t(),s("span",ht,"Loading...")):(t(),s("span",wt,"Refresh"))],8,yt)]),e("pre",$t,p(l.value||"No logs available"),1)]))}}),Ct={class:"space-y-6"},jt={class:"flex items-center justify-between"},Dt=["disabled"],At={key:0},Mt={key:1},Rt={key:0,class:"flex items-center justify-center py-12"},Vt={key:1,class:"text-center py-12 text-preke-text-dim"},Pt={key:2,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Nt=["onClick"],Tt={class:"flex items-start justify-between mb-4"},Et={class:"font-semibold"},Ot={class:"text-sm text-preke-text-dim"},Ft={class:"space-y-2 text-sm"},Lt={class:"flex justify-between"},Bt={class:"font-mono"},Ut={class:"flex justify-between"},It=I({__name:"FleetOverview",setup(L){const v=w([]),l=w(!0),m=w(!1);async function x(){l.value=!0;try{const f=await fetch("/api/v1/lan-devices");if(f.ok){const c=await f.json();v.value=c.map(u=>({id:u.id,name:u.name,ip:u.ip,status:u.status,lastSeen:u.last_seen,version:u.api_version||"unknown"}))}}catch(f){console.error("Failed to fetch LAN devices:",f)}finally{l.value=!1}}z(x);async function i(){m.value=!0;try{const f=await fetch("/api/v1/lan-devices/scan",{method:"POST"});if(f.ok){const c=await f.json();for(const u of c)v.value.find(j=>j.id===u.id)||v.value.push({id:u.id,name:u.name,ip:u.ip,status:u.status,lastSeen:u.last_seen,version:u.api_version||"unknown"})}}catch(f){console.error("LAN network scan failed:",f)}finally{m.value=!1}}async function S(f){try{const u=await(await fetch(`/api/v1/lan-devices/${f.id}/connect`,{method:"POST"})).json();u.connected?window.open(`http://${f.ip}:8000`,"_blank"):alert(`Failed to connect: ${u.error||"Unknown error"}`)}catch(c){console.error("Failed to connect to device:",c)}}return(f,c)=>(t(),s("div",Ct,[e("div",jt,[c[0]||(c[0]=e("h2",{class:"text-lg font-semibold"},"LAN Devices",-1)),e("button",{onClick:i,disabled:m.value,class:"btn"},[m.value?(t(),s("span",At,"Scanning...")):(t(),s("span",Mt,"Scan Network"))],8,Dt)]),l.value?(t(),s("div",Rt,[...c[1]||(c[1]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-preke-gold border-t-transparent rounded-full"},null,-1)])])):v.value.length===0?(t(),s("div",Vt,[...c[2]||(c[2]=[e("p",null,"No devices found",-1),e("p",{class:"text-sm mt-2"},'Click "Scan Network" to discover R58 devices',-1)])])):(t(),s("div",Pt,[(t(!0),s(T,null,E(v.value,u=>(t(),s("div",{key:u.id,class:"card hover:border-preke-gold/50 transition-colors cursor-pointer",onClick:N=>S(u)},[e("div",Tt,[e("div",null,[e("h3",Et,p(u.name),1),e("p",Ot,p(u.id),1)]),e("span",{class:A(["badge",{"badge-success":u.status==="online","badge-danger":u.status==="offline","badge-warning":u.status==="unknown"}])},p(u.status),3)]),e("div",Ft,[e("div",Lt,[c[3]||(c[3]=e("span",{class:"text-preke-text-dim"},"IP Address",-1)),e("span",Bt,p(u.ip),1)]),e("div",Ut,[c[4]||(c[4]=e("span",{class:"text-preke-text-dim"},"Version",-1)),e("span",null,p(u.version),1)])])],8,Nt))),128))]))]))}}),zt={class:"space-y-6"},Ht={key:0,class:"flex items-center justify-center py-12"},Gt={key:1,class:"glass-card p-4 bg-preke-red/10 border border-preke-red/30 rounded-xl"},Wt={class:"text-preke-red"},qt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},Jt={class:"glass-card p-4 rounded-xl"},Kt={key:0,class:"space-y-3"},Xt={class:"relative w-full h-3 bg-preke-bg rounded-full overflow-hidden"},Yt={class:"flex justify-between text-sm"},Zt={class:"font-mono text-preke-text"},Qt={key:1,class:"flex items-center justify-center py-4"},es={class:"glass-card p-4 rounded-xl"},ts={key:0,class:"space-y-3"},ss={class:"relative w-full h-3 bg-preke-bg rounded-full overflow-hidden"},ns={class:"flex justify-between text-sm"},os={class:"text-preke-text"},ls={key:1,class:"flex items-center justify-center py-4"},is={class:"glass-card p-4 rounded-xl"},as={class:"flex items-center justify-center py-2"},rs={key:1,class:"text-preke-text-muted"},ds={key:0,class:"text-center text-xs text-preke-text-muted"},cs={class:"glass-card p-4 rounded-xl"},us={class:"flex items-center justify-center py-2"},ps={key:0,class:"text-3xl font-bold text-preke-gold"},vs={key:1,class:"text-preke-text-muted"},ms={class:"text-center text-xs text-preke-text-muted"},xs={class:"glass-card p-4 rounded-xl"},fs={class:"flex items-center justify-between mb-4"},ks={class:"flex gap-2"},gs={class:"grid gap-3 sm:grid-cols-3"},_s={class:"flex items-center gap-3"},bs={class:"font-medium text-preke-text"},ys={class:"text-xs text-preke-text-muted"},hs={key:0},ws=["onClick"],$s={key:1,class:"text-xs text-preke-text-muted"},Ss={class:"glass-card p-4 rounded-xl"},Cs={class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},js={class:"ml-2 text-preke-gold"},Ds={key:0,class:"text-center py-8 text-preke-text-muted"},As={key:1,class:"space-y-2"},Ms={class:"flex items-center gap-4"},Rs={class:"font-mono text-sm text-preke-text"},Vs={class:"text-xs text-preke-text-muted"},Ps={key:0},Ns={class:"flex items-center gap-3"},Ts=["onClick"],Es=I({__name:"SystemMonitor",setup(L){const v=re(),l=w(!0),m=w(null),x=w(null),i=w(null),S=F(()=>{var k,b,y;const a=((y=(b=(k=x.value)==null?void 0:k.info)==null?void 0:b.load_average)==null?void 0:y[0])??0;return Math.min(100,a/8*100)}),f=F(()=>{var r,k;const a=(k=(r=x.value)==null?void 0:r.info)==null?void 0:k.memory_percent;return a!==void 0?a:0}),c=F(()=>{var k,b;const a=((b=(k=x.value)==null?void 0:k.info)==null?void 0:b.temperatures)??[];return a.length===0?null:a.find(y=>{var R;return(R=y.type)==null?void 0:R.toLowerCase().includes("cpu")})??a[0]}),u=F(()=>{var y,R;const a=((R=(y=x.value)==null?void 0:y.info)==null?void 0:R.uptime_seconds)??0,r=Math.floor(a/86400),k=Math.floor(a%86400/3600),b=Math.floor(a%3600/60);return r>0?`${r}d ${k}h`:k>0?`${k}h ${b}m`:`${b}m`}),N=F(()=>{var a;return((a=x.value)==null?void 0:a.services)??[]}),j=F(()=>{var a;return((a=x.value)==null?void 0:a.pipelines)??[]});async function n(){try{const{buildApiUrl:a}=await q(async()=>{const{buildApiUrl:g}=await import("./index-DxPuJKr5.js").then(P=>P.a3);return{buildApiUrl:g}},__vite__mapDeps([0,1])),[r,k,b]=await Promise.all([fetch(a("/health")),fetch(a("/api/ingest/status")),fetch(a("/api/system/info"))]),y=r.ok?await r.json():{status:"unknown"},R=k.ok?await k.json():{cameras:{}},_=b.ok?await b.json():null;x.value={info:{hostname:(_==null?void 0:_.hostname)||"R58 Device",platform:y.platform||"R58",gstreamer:y.gstreamer,load_average:(_==null?void 0:_.load_average)||[0,0,0],memory_percent:(_==null?void 0:_.memory_percent)||0,memory_total_mb:(_==null?void 0:_.memory_total_mb)||0,memory_used_mb:(_==null?void 0:_.memory_used_mb)||0,uptime_seconds:(_==null?void 0:_.uptime_seconds)||0,temperatures:(_==null?void 0:_.temperatures)||[]},services:[{name:"r58-recorder",active:y.status==="healthy",status:y.status},{name:"mediamtx",active:!0,status:"running"},{name:"vdo.ninja",active:!0,status:"running",note:"r58-vdo.itagenten.no"}],pipelines:Object.entries(R.cameras||{}).map(([g,P])=>({pipeline_id:g,pipeline_type:"ingest",device:P.device,state:P.status==="streaming"?"running":P.status}))},m.value=null}catch(a){m.value=a.message,console.error("Failed to fetch system status:",a)}finally{l.value=!1}}async function $(a){try{const{buildApiUrl:r}=await q(async()=>{const{buildApiUrl:y}=await import("./index-DxPuJKr5.js").then(R=>R.a3);return{buildApiUrl:y}},__vite__mapDeps([0,1])),b=await(await fetch(r(`/api/system/restart-service/${a}`),{method:"POST"})).json();b.success?(v.success(b.message||`Service ${a} restarted`),setTimeout(n,2e3)):v.error(b.message||`Failed to restart ${a}`)}catch(r){v.error(`Restart failed: ${r.message}`)}}async function M(){if(confirm("Are you sure you want to reboot the device? This will interrupt all recordings and streams."))try{const{buildApiUrl:a}=await q(async()=>{const{buildApiUrl:b}=await import("./index-DxPuJKr5.js").then(y=>y.a3);return{buildApiUrl:b}},__vite__mapDeps([0,1])),k=await(await fetch(a("/api/system/reboot"),{method:"POST"})).json();k.success?v.success("Device is rebooting..."):v.error(k.message||"Failed to reboot device")}catch(a){v.error(`Reboot failed: ${a.message}`)}}async function B(a){try{const{buildApiUrl:r}=await q(async()=>{const{buildApiUrl:y}=await import("./index-DxPuJKr5.js").then(R=>R.a3);return{buildApiUrl:y}},__vite__mapDeps([0,1])),k=await fetch(r(`/api/ingest/stop/${a}`),{method:"POST"}),b=await k.json();k.ok?(v.success(`Stopped pipeline: ${a}`),await n()):v.error(b.detail||"Stop failed")}catch(r){v.error(`Stop failed: ${r.message}`)}}function C(a){return a.active?"bg-preke-green":"bg-preke-red"}function o(a){switch(a){case"running":return"text-preke-green";case"starting":return"text-preke-gold";case"stopping":return"text-preke-gold";default:return"text-preke-text-muted"}}function D(a){return a>90?"bg-preke-red":a>70?"bg-preke-gold":"bg-preke-green"}function H(a){return a>80?"text-preke-red":a>65?"text-preke-gold":"text-preke-green"}return z(()=>{n(),i.value=window.setInterval(n,1e4)}),X(()=>{i.value&&clearInterval(i.value)}),(a,r)=>{var k,b,y,R,_,g,P,Y,Z,Q,ee;return t(),s("div",zt,[l.value?(t(),s("div",Ht,[...r[1]||(r[1]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-preke-gold border-t-transparent rounded-full"},null,-1)])])):m.value?(t(),s("div",Gt,[e("p",Wt,"Error loading system status: "+p(m.value),1),e("button",{onClick:n,class:"btn-v2 btn-v2--secondary mt-4"},"Retry")])):(t(),s(T,{key:2},[e("div",qt,[e("div",Jt,[r[4]||(r[4]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"CPU Load",-1)),(y=(b=(k=x.value)==null?void 0:k.info)==null?void 0:b.load_average)!=null&&y.some(h=>h>0)?(t(),s("div",Kt,[e("div",Xt,[e("div",{class:A(["absolute left-0 top-0 h-full rounded-full transition-all duration-500",D(S.value)]),style:ne({width:`${S.value}%`})},null,6)]),e("div",Yt,[r[2]||(r[2]=e("span",{class:"text-preke-text-muted"},"Load Average",-1)),e("span",Zt,p((g=(_=(R=x.value)==null?void 0:R.info)==null?void 0:_.load_average)==null?void 0:g.map(h=>h.toFixed(2)).join(" / ")),1)])])):(t(),s("div",Qt,[...r[3]||(r[3]=[e("span",{class:"text-preke-text-muted"},"N/A",-1)])]))]),e("div",es,[r[7]||(r[7]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Memory",-1)),f.value>0?(t(),s("div",ts,[e("div",ss,[e("div",{class:A(["absolute left-0 top-0 h-full rounded-full transition-all duration-500",D(f.value)]),style:ne({width:`${f.value}%`})},null,6)]),e("div",ns,[r[5]||(r[5]=e("span",{class:"text-preke-text-muted"},"Used",-1)),e("span",os,p(f.value.toFixed(1))+"%",1)])])):(t(),s("div",ls,[...r[6]||(r[6]=[e("span",{class:"text-preke-text-muted"},"N/A",-1)])]))]),e("div",is,[r[8]||(r[8]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Temperature",-1)),e("div",as,[c.value?(t(),s("span",{key:0,class:A(["text-3xl font-bold",H(c.value.temp_celsius)])},p(c.value.temp_celsius.toFixed(1))+"°C ",3)):(t(),s("span",rs,"N/A"))]),(P=c.value)!=null&&P.type?(t(),s("p",ds,p(c.value.type),1)):V("",!0)]),e("div",cs,[r[9]||(r[9]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Uptime",-1)),e("div",us,[((Z=(Y=x.value)==null?void 0:Y.info)==null?void 0:Z.uptime_seconds)>0?(t(),s("span",ps,p(u.value),1)):(t(),s("span",vs,"N/A"))]),e("p",ms,p(((ee=(Q=x.value)==null?void 0:Q.info)==null?void 0:ee.hostname)||"R58 Device"),1)])]),e("div",xs,[e("div",fs,[r[10]||(r[10]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide"},"Services",-1)),e("div",ks,[e("button",{onClick:r[0]||(r[0]=h=>$("preke-recorder")),class:"btn-v2 btn-v2--secondary text-sm",title:"Restart the main service"}," Restart Service "),e("button",{onClick:M,class:"btn-v2 btn-v2--danger text-sm",title:"Reboot the device"}," Reboot Device ")])]),e("div",gs,[(t(!0),s(T,null,E(N.value,h=>(t(),s("div",{key:h.name,class:"flex items-center justify-between p-3 rounded-lg bg-preke-surface border border-preke-surface-border"},[e("div",_s,[e("span",{class:A(["w-2.5 h-2.5 rounded-full",C(h)])},null,2),e("div",null,[e("p",bs,p(h.name),1),e("p",ys,[W(p(h.status)+" ",1),h.memory_mb?(t(),s("span",hs," · "+p(h.memory_mb.toFixed(0))+" MB",1)):V("",!0)])])]),h.name!=="vdo.ninja"?(t(),s("button",{key:0,onClick:de=>$(h.name),class:"text-preke-text-muted hover:text-preke-gold transition-colors",title:"Restart service"},[...r[11]||(r[11]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])],8,ws)):(t(),s("span",$s,"External"))]))),128))])]),e("div",Ss,[e("h3",Cs,[r[12]||(r[12]=W(" Active Pipelines ",-1)),e("span",js,"("+p(j.value.length)+")",1)]),j.value.length===0?(t(),s("div",Ds," No active pipelines ")):(t(),s("div",As,[(t(!0),s(T,null,E(j.value,h=>(t(),s("div",{key:h.pipeline_id,class:"flex items-center justify-between p-3 rounded-lg bg-preke-surface border border-preke-surface-border"},[e("div",Ms,[e("div",null,[e("p",Rs,p(h.pipeline_id),1),e("p",Vs,[W(" Type: "+p(h.pipeline_type)+" ",1),h.device?(t(),s("span",Ps," · "+p(h.device),1)):V("",!0)])])]),e("div",Ns,[e("span",{class:A(["text-sm font-medium capitalize",o(h.state)])},p(h.state),3),h.state==="running"?(t(),s("button",{key:0,onClick:de=>B(h.pipeline_id),class:"btn-v2 btn-v2--danger text-sm",title:"Stop pipeline"}," Stop ",8,Ts)):V("",!0)])]))),128))]))])],64))])}}}),Os={class:"space-y-6"},Fs={class:"glass-card p-4 rounded-xl"},Ls={class:"space-y-4"},Bs={key:0,class:"glass-card p-4 rounded-xl"},Us={class:"space-y-2"},Is={class:"flex-1 min-w-0"},zs={class:"flex items-center gap-2"},Hs={class:"text-sm font-medium text-preke-text"},Gs={key:0,class:"text-xs px-2 py-0.5 rounded bg-preke-gold/20 text-preke-gold"},Ws={class:"text-xs text-preke-text-muted truncate mt-1"},qs=["onClick"],Js={class:"glass-card p-4 rounded-xl"},Ks={class:"space-y-4"},Xs=["value"],Ys={class:"glass-card p-4 rounded-xl"},Zs={class:"space-y-4"},Qs=["value"],en={class:"flex items-center justify-between"},tn={key:0},sn={class:"glass-card p-4 rounded-xl bg-preke-surface/30"},nn={class:"space-y-2 text-sm"},on={class:"flex justify-between"},ln={class:"text-preke-text"},le="preke-settings",an=I({__name:"SettingsPanel",setup(L){const v=re(),l=w([]),m=w(null),x=w("Preke Device"),i=w(oe),S=w(ke()),f=w("/opt/r58/recordings"),c=w(!1),u=w(30),N=F(()=>me());function j(){try{const C=localStorage.getItem(le);if(C){const o=JSON.parse(C);x.value=o.deviceName||x.value,i.value=o.vdoRoom||i.value,c.value=o.autoCleanup||!1,u.value=o.cleanupDays||30}}catch{}}function n(){try{const C={deviceName:x.value,vdoRoom:i.value,autoCleanup:c.value,cleanupDays:u.value};localStorage.setItem(le,JSON.stringify(C)),v.success("Settings saved")}catch(C){v.error("Failed to save settings"),console.error("Failed to save settings:",C)}}function $(){x.value="Preke Device",i.value=oe,c.value=!1,u.value=30,n(),v.info("Settings reset to defaults")}async function M(){if(window.electronAPI)try{l.value=await window.electronAPI.getDevices();const C=await window.electronAPI.getActiveDevice();m.value=(C==null?void 0:C.id)||null}catch(C){console.error("Failed to load devices:",C)}}async function B(C){if(!(!window.electronAPI||!confirm("Remove this device?")))try{await window.electronAPI.removeDevice(C),await M(),v.success("Device removed")}catch(o){console.error("Failed to remove device:",o),v.error("Failed to remove device")}}return z(()=>{j(),M()}),(C,o)=>(t(),s("div",Os,[e("div",Fs,[o[6]||(o[6]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Device",-1)),e("div",Ls,[e("div",null,[o[4]||(o[4]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Device Name",-1)),U(e("input",{"onUpdate:modelValue":o[0]||(o[0]=D=>x.value=D),type:"text",class:"input w-full",placeholder:"My Preke Device"},null,512),[[J,x.value]]),o[5]||(o[5]=e("p",{class:"text-xs text-preke-text-muted mt-1"},"Display name for this device in the app",-1))])])]),N.value&&l.value.length>0?(t(),s("div",Bs,[o[8]||(o[8]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Saved Devices",-1)),e("div",Us,[(t(!0),s(T,null,E(l.value,D=>(t(),s("div",{key:D.id,class:A(["flex items-center justify-between p-3 rounded-lg border border-preke-surface-border",{"bg-preke-gold/10 border-preke-gold/30":D.id===m.value}])},[e("div",Is,[e("div",zs,[e("span",Hs,p(D.name),1),D.id===m.value?(t(),s("span",Gs," Active ")):V("",!0)]),e("p",Ws,p(D.url),1)]),e("button",{onClick:H=>B(D.id),class:"ml-3 p-2 rounded-lg text-preke-text-muted hover:text-red-400 hover:bg-red-500/10 transition-colors",title:"Remove device"},[...o[7]||(o[7]=[e("svg",{viewBox:"0 0 20 20",fill:"currentColor",class:"w-4 h-4"},[e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)])],8,qs)],2))),128))])])):V("",!0),e("div",Js,[o[13]||(o[13]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"VDO.ninja / Mixer",-1)),e("div",Ks,[e("div",null,[o[9]||(o[9]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Room Name",-1)),U(e("input",{"onUpdate:modelValue":o[1]||(o[1]=D=>i.value=D),type:"text",class:"input w-full",placeholder:"r58studio"},null,512),[[J,i.value]]),o[10]||(o[10]=e("p",{class:"text-xs text-preke-text-muted mt-1"},"VDO.ninja room for video mixing",-1))]),e("div",null,[o[11]||(o[11]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"VDO Host",-1)),e("input",{value:S.value,type:"text",class:"input w-full bg-preke-surface opacity-60",readonly:"",disabled:""},null,8,Xs),o[12]||(o[12]=e("p",{class:"text-xs text-preke-text-muted mt-1"},"VDO.ninja server (read-only)",-1))])])]),e("div",Ys,[o[18]||(o[18]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Storage",-1)),e("div",Zs,[e("div",null,[o[14]||(o[14]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Recording Path",-1)),e("input",{value:f.value,type:"text",class:"input w-full bg-preke-surface opacity-60",readonly:"",disabled:""},null,8,Qs),o[15]||(o[15]=e("p",{class:"text-xs text-preke-text-muted mt-1"}," Configured in config.yml on R58 device. Default: /opt/r58/recordings/ ",-1))]),e("div",en,[o[16]||(o[16]=e("div",null,[e("label",{class:"block text-sm font-medium text-preke-text"},"Auto-cleanup old recordings"),e("p",{class:"text-xs text-preke-text-muted"},"Automatically delete recordings older than specified days")],-1)),e("button",{onClick:o[2]||(o[2]=D=>c.value=!c.value),class:A(["relative inline-flex h-6 w-11 items-center rounded-full transition-colors",c.value?"bg-preke-gold":"bg-preke-surface-elevated"])},[e("span",{class:A(["inline-block h-4 w-4 transform rounded-full bg-white transition-transform",c.value?"translate-x-6":"translate-x-1"])},null,2)],2)]),c.value?(t(),s("div",tn,[o[17]||(o[17]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Keep recordings for (days)",-1)),U(e("input",{"onUpdate:modelValue":o[3]||(o[3]=D=>u.value=D),type:"number",min:"1",max:"365",class:"input w-24"},null,512),[[J,u.value,void 0,{number:!0}]])])):V("",!0)])]),e("div",{class:"flex items-center justify-between"},[e("button",{onClick:$,class:"btn-v2 btn-v2--secondary"}," Reset to Defaults "),e("button",{onClick:n,class:"btn-v2 btn-v2--primary"}," Save Settings ")]),e("div",sn,[o[21]||(o[21]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"About",-1)),e("div",nn,[o[20]||(o[20]=e("div",{class:"flex justify-between"},[e("span",{class:"text-preke-text-muted"},"App Version"),e("span",{class:"text-preke-text"},"2.0.0")],-1)),e("div",on,[o[19]||(o[19]=e("span",{class:"text-preke-text-muted"},"Platform",-1)),e("span",ln,p(N.value?"Desktop (Electron)":"Web Browser"),1)])])])]))}}),rn={class:"h-full flex flex-col bg-preke-bg"},dn={class:"px-6 py-4 border-b border-preke-surface-border bg-preke-surface/50 backdrop-blur-sm"},cn={class:"flex gap-1"},un=["onClick"],pn={class:"flex-1 p-6 overflow-y-auto"},vn={key:2,class:"glass-card p-6 rounded-xl"},mn={key:3,class:"glass-card p-6 rounded-xl"},xn={key:5,class:"design-panel"},fn={class:"design-links"},kn={class:"design-links__group"},gn={class:"design-links__group"},_n=I({__name:"AdminView",setup(L){const v=xe(),l=w("system"),m=[{id:"system",label:"System"},{id:"status",label:"Device Status"},{id:"logs",label:"Logs"},{id:"fleet",label:"Fleet"},{id:"settings",label:"Settings"},{id:"design",label:"Design"}];return z(()=>{const x=v.query.tab;x&&m.some(i=>i.id===x)&&(l.value=x)}),(x,i)=>{const S=fe("router-link");return t(),s("div",rn,[e("header",dn,[i[0]||(i[0]=e("h1",{class:"text-xl font-semibold text-preke-text mb-4"},"Settings",-1)),e("div",cn,[(t(),s(T,null,E(m,f=>e("button",{key:f.id,onClick:c=>l.value=f.id,class:A(["px-4 py-2 rounded-lg transition-all duration-200 font-medium text-sm",[l.value===f.id?"bg-preke-gold/20 text-preke-gold border border-preke-gold/30":"text-preke-text-muted hover:text-preke-text hover:bg-preke-surface"]])},p(f.label),11,un)),64))])]),e("div",pn,[l.value==="system"?(t(),K(Es,{key:0})):l.value==="status"?(t(),K(ft,{key:1})):l.value==="logs"?(t(),s("div",vn,[i[1]||(i[1]=e("h2",{class:"text-lg font-semibold text-preke-text mb-4"},"System Logs",-1)),O(St)])):l.value==="fleet"?(t(),s("div",mn,[O(It)])):l.value==="settings"?(t(),K(an,{key:4})):l.value==="design"?(t(),s("div",xn,[i[9]||(i[9]=e("h2",{class:"text-lg font-semibold text-preke-text mb-4"},"Design Resources",-1)),i[10]||(i[10]=e("p",{class:"text-preke-text-muted mb-6"},"Access design documentation, proposals, experiments, and style guides.",-1)),e("div",fn,[O(S,{to:"/design-archive",class:"design-link design-link--primary"},{default:G(()=>[...i[2]||(i[2]=[e("div",{class:"design-link__icon design-link__icon--gold"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})])],-1),e("div",{class:"design-link__content"},[e("h3",null,"Design Archive"),e("p",null,"Browse all designs with thumbnails, search, and filters")],-1),e("svg",{class:"design-link__arrow",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5l7 7-7 7"})],-1)])]),_:1}),e("div",kn,[i[5]||(i[5]=e("h4",{class:"design-links__group-title"},"Interactive Views",-1)),O(S,{to:"/proposals",class:"design-link"},{default:G(()=>[...i[3]||(i[3]=[e("div",{class:"design-link__icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})])],-1),e("div",{class:"design-link__content"},[e("h3",null,"Design Proposals"),e("p",null,"Live interactive previews")],-1),e("svg",{class:"design-link__arrow",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5l7 7-7 7"})],-1)])]),_:1}),O(S,{to:"/experiments",class:"design-link"},{default:G(()=>[...i[4]||(i[4]=[e("div",{class:"design-link__icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})])],-1),e("div",{class:"design-link__content"},[e("h3",null,"Background Experiments"),e("p",null,"Sci-fi animation tests")],-1),e("svg",{class:"design-link__arrow",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5l7 7-7 7"})],-1)])]),_:1})]),e("div",gn,[i[8]||(i[8]=e("h4",{class:"design-links__group-title"},"Documentation",-1)),O(S,{to:"/styleguide-v2",class:"design-link"},{default:G(()=>[...i[6]||(i[6]=[e("div",{class:"design-link__icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1),e("div",{class:"design-link__content"},[e("h3",null,"Style Guide V2"),e("p",null,"Current design system")],-1),e("svg",{class:"design-link__arrow",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5l7 7-7 7"})],-1)])]),_:1}),O(S,{to:"/styleguide",class:"design-link"},{default:G(()=>[...i[7]||(i[7]=[e("div",{class:"design-link__icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})])],-1),e("div",{class:"design-link__content"},[e("h3",null,"Style Guide V1"),e("p",null,"Legacy reference")],-1),e("svg",{class:"design-link__arrow",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5l7 7-7 7"})],-1)])]),_:1})])])])):V("",!0)])])}}}),hn=ae(_n,[["__scopeId","data-v-af03ce7e"]]);export{hn as default};
