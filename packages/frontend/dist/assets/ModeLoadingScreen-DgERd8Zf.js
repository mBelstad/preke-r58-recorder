import{r as g,l as L,I as Z,d as q,o as K,c as u,e,f as w,y as W,t as y,F as j,z as H,n as S,s as $,k as c,_ as Q,G as se,J as xe,w as ie,q as G,B as O,g as re,U as we,p as le,R as ke,j as D,a as ce,C as ae}from"./index-D2HQAR3o.js";function ne(){const m=g([]),P=g(!1),f=g(null),v=g(null);async function B(){P.value=!0,f.value=null;try{const i=await Z.cameras.list();m.value=await Promise.all(i.map(async d=>{try{const s=await Z.cameras.getStatus(d);return{name:s.name,type:s.type,connected:s.connected,settings:s.settings}}catch{return{name:d,type:"blackmagic",connected:!1}}}))}catch(i){f.value=i.message||"Failed to load cameras",console.error("[CameraControls] Failed to load cameras:",i)}finally{P.value=!1}}const N=L(()=>i=>m.value.find(d=>d.name===i));function r(i,d){const s=N.value(i);if(!s)return!1;const t=["focus","iris","whiteBalance","gain","iso","shutter","colorCorrection"],n=["focus","exposure","whiteBalance","ptz"],E=["focus","exposure","whiteBalance","iso","shutter","ptz"];return s.type==="blackmagic"?t.includes(d):s.type==="obsbot_tail2"?n.includes(d):s.type==="sony_fx30"?E.includes(d):!1}async function x(i,d,s){try{await Z.cameras.setFocus(i,d,s),await k(i)}catch(t){throw new Error(t.message||"Failed to set focus")}}async function _(i,d,s){try{await Z.cameras.setWhiteBalance(i,d,s),await k(i)}catch(t){throw new Error(t.message||"Failed to set white balance")}}async function p(i,d,s){try{await Z.cameras.setExposure(i,d,s),await k(i)}catch(t){throw new Error(t.message||"Failed to set exposure")}}async function o(i,d){try{await Z.cameras.setISO(i,d),await k(i)}catch(s){throw new Error(s.message||"Failed to set ISO")}}async function l(i,d){try{await Z.cameras.setShutter(i,d),await k(i)}catch(s){throw new Error(s.message||"Failed to set shutter")}}async function h(i,d,s){try{await Z.cameras.setIris(i,d,s),await k(i)}catch(t){throw new Error(t.message||"Failed to set iris")}}async function F(i,d){try{await Z.cameras.setGain(i,d),await k(i)}catch(s){throw new Error(s.message||"Failed to set gain")}}async function M(i,d,s,t){try{await Z.cameras.setPTZ(i,d,s,t)}catch(n){throw new Error(n.message||"Failed to move PTZ")}}async function z(i,d){try{await Z.cameras.recallPTZPreset(i,d)}catch(s){throw new Error(s.message||"Failed to recall preset")}}async function I(i,d){try{await Z.cameras.setColorCorrection(i,d),await k(i)}catch(s){throw new Error(s.message||"Failed to set color correction")}}async function k(i){try{const d=await Z.cameras.getStatus(i),s=m.value.findIndex(t=>t.name===i);s>=0&&(m.value[s]={name:d.name,type:d.type,connected:d.connected,settings:d.settings})}catch(d){console.error(`[CameraControls] Failed to refresh status for ${i}:`,d)}}return{cameras:m,loading:P,error:f,selectedCamera:v,getCamera:N,supportsFeature:r,loadCameras:B,setFocus:x,setWhiteBalance:_,setExposure:p,setISO:o,setShutter:l,setIris:h,setGain:F,setPTZ:M,recallPTZPreset:z,setColorCorrection:I,refreshCameraStatus:k}}const $e={class:"companion-panel"},Te={class:"panel-header"},ze=["aria-label"],Se={key:0,class:"help-section"},Pe={class:"help-text"},Be={class:"camera-list"},Ne={class:"camera-header"},Fe={class:"camera-info"},Me={class:"camera-name"},Ie={class:"camera-type"},Ue={class:"endpoints-section"},Ze={class:"endpoint-group"},Ge={class:"endpoint-path"},Oe=["onClick"],Ee={class:"quick-actions"},Ve={class:"action-buttons"},Ae=["onClick"],Le={key:1,class:"empty-state"},Je=q({__name:"CompanionIntegrationPanel",setup(m){const{cameras:P,loadCameras:f}=ne(),v=g(!1),B=L(()=>typeof window<"u"?window.location.origin:"https://app.itagenten.no");function N(p){return{blackmagic:"Blackmagic Studio 4K Pro",obsbot_tail2:"OBSbot Tail 2",sony_fx30:"Sony FX30"}[p]||p}function r(p){const o=`${B.value}/api/v1/cameras/${p.name}`,l=[];return l.push({method:"PUT",path:`${o}/settings/focus`,example:JSON.stringify({mode:"auto"},null,2)}),l.push({method:"PUT",path:`${o}/settings/focus`,example:JSON.stringify({mode:"manual",value:.5},null,2)}),l.push({method:"PUT",path:`${o}/settings/whiteBalance`,example:JSON.stringify({mode:"auto"},null,2)}),l.push({method:"PUT",path:`${o}/settings/whiteBalance`,example:JSON.stringify({mode:"manual",temperature:5600},null,2)}),(p.type==="obsbot_tail2"||p.type==="sony_fx30")&&l.push({method:"PUT",path:`${o}/settings/exposure`,example:JSON.stringify({mode:"auto"},null,2)}),(p.type==="blackmagic"||p.type==="sony_fx30")&&l.push({method:"PUT",path:`${o}/settings/iso`,example:JSON.stringify({value:400},null,2)}),(p.type==="blackmagic"||p.type==="sony_fx30")&&l.push({method:"PUT",path:`${o}/settings/shutter`,example:JSON.stringify({value:.0167},null,2)}),p.type==="blackmagic"&&(l.push({method:"PUT",path:`${o}/settings/iris`,example:JSON.stringify({mode:"auto"},null,2)}),l.push({method:"PUT",path:`${o}/settings/gain`,example:JSON.stringify({value:0},null,2)})),(p.type==="obsbot_tail2"||p.type==="sony_fx30")&&(l.push({method:"PUT",path:`${o}/settings/ptz`,example:JSON.stringify({pan:.5,tilt:-.3,zoom:.2},null,2)}),l.push({method:"PUT",path:`${o}/settings/ptz/preset/1`,example:JSON.stringify({},null,2)})),l}function x(p){const o=`${B.value}/api/v1/cameras/${p.name}`,l=[];return l.push({label:"Focus Auto",example:`PUT ${o}/settings/focus
Content-Type: application/json

{"mode":"auto"}`}),l.push({label:"WB Auto",example:`PUT ${o}/settings/whiteBalance
Content-Type: application/json

{"mode":"auto"}`}),(p.type==="obsbot_tail2"||p.type==="sony_fx30")&&l.push({label:"PTZ Center",example:`PUT ${o}/settings/ptz
Content-Type: application/json

{"pan":0,"tilt":0,"zoom":0}`}),l}async function _(p){try{await navigator.clipboard.writeText(p)}catch(o){console.error("Failed to copy:",o)}}return K(()=>{f()}),(p,o)=>(c(),u("div",$e,[e("div",Te,[o[2]||(o[2]=e("h3",{class:"panel-title"},[e("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2","stroke-width":"2"}),e("path",{d:"M9 9h6v6H9z","stroke-width":"2"})]),W(" Bitfocus Companion Integration ")],-1)),e("button",{class:"info-btn",onClick:o[0]||(o[0]=l=>v.value=!v.value),"aria-label":v.value?"Hide help":"Show help"},[...o[1]||(o[1]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 16v-4M12 8h.01"})],-1)])],8,ze)]),v.value?(c(),u("div",Se,[e("p",Pe,[o[3]||(o[3]=W(" Control cameras via Bitfocus Companion using HTTP requests. Add an HTTP instance in Companion pointing to ",-1)),e("code",null,y(B.value),1),o[4]||(o[4]=W(" and use the endpoints below. ",-1))])])):w("",!0),e("div",Be,[(c(!0),u(j,null,H($(P),l=>(c(),u("div",{key:l.name,class:"camera-card"},[e("div",Ne,[e("div",Fe,[e("span",Me,y(l.name),1),e("span",Ie,y(N(l.type)),1),e("span",{class:S(["status-indicator",l.connected?"connected":"disconnected"])},y(l.connected?"● Connected":"○ Disconnected"),3)])]),e("div",Ue,[o[6]||(o[6]=e("h4",{class:"section-title"},"Available Endpoints",-1)),e("div",Ze,[(c(!0),u(j,null,H(r(l),h=>(c(),u("div",{class:"endpoint-item",key:h.method+h.path},[e("div",{class:S(["endpoint-method",h.method.toLowerCase()])},y(h.method),3),e("div",Ge,[e("code",null,y(h.path),1)]),e("button",{class:"copy-btn",onClick:F=>_(h.example),title:"Copy example to clipboard"},[...o[5]||(o[5]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1)])],8,Oe)]))),128))])]),e("div",Ee,[o[7]||(o[7]=e("h4",{class:"section-title"},"Quick Actions",-1)),e("div",Ve,[(c(!0),u(j,null,H(x(l),h=>(c(),u("button",{key:h.label,class:"action-btn",onClick:F=>_(h.example)},y(h.label),9,Ae))),128))])])]))),128))]),$(P).length===0?(c(),u("div",Le,[...o[8]||(o[8]=[e("svg",{class:"empty-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e("circle",{cx:"12",cy:"10",r:"3"})],-1),e("p",null,"No external cameras configured",-1),e("p",{class:"empty-hint"},[W("Add cameras in "),e("code",null,"config.yml"),W(" to enable Companion integration")],-1)])])):w("",!0)]))}}),De=Q(Je,[["__scopeId","data-v-34a9c8fa"]]),We={class:"flex items-center justify-between w-full"},je={class:"text-lg font-semibold text-preke-text"},Re={key:0,class:"text-sm text-preke-text-muted mt-1"},He={key:0,class:"py-8 text-center text-preke-text-muted"},qe={key:1,class:"py-8 text-center text-red-400"},Ke={key:2,class:"py-8 text-center text-preke-text-muted"},Qe={key:3,class:"camera-controls"},Xe={class:"tabs"},Ye={key:0,class:"tab-content"},et={key:0,class:"control-group"},tt={class:"control-row"},at={key:0,class:"control-slider"},nt={class:"slider-value"},ot=["disabled"],st={key:1,class:"control-group"},lt={class:"control-row"},it={key:0,class:"control-input"},rt=["disabled"],ct={key:2,class:"control-group"},ut={class:"control-row"},dt={key:0,class:"control-slider"},mt={class:"slider-value"},vt=["disabled"],pt={key:1,class:"tab-content"},bt={key:0,class:"control-group"},ft={class:"control-input"},gt=["disabled"],yt={key:1,class:"control-group"},_t={class:"control-input"},ht=["disabled"],Ct={key:2,class:"control-group"},xt={class:"control-row"},wt={key:0,class:"control-input"},kt=["disabled"],$t={key:3,class:"control-group"},Tt={class:"control-input"},zt=["disabled"],St={key:2,class:"tab-content"},Pt={class:"control-group"},Bt={class:"ptz-controls"},Nt={class:"ptz-axis"},Ft={class:"slider-value"},Mt={class:"ptz-axis"},It={class:"slider-value"},Ut={class:"ptz-axis"},Zt={class:"slider-value"},Gt={key:3,class:"tab-content"},Ot={key:4,class:"tab-content"},Et=q({__name:"CameraControlModal",props:{cameraName:{}},emits:["close"],setup(m,{expose:P,emit:f}){const v=m,B=f,N=g(null),{loading:r,error:x,supportsFeature:_,loadCameras:p,getCamera:o}=ne(),l=g("basic"),h=L(()=>v.cameraName?o.value(v.cameraName):null),F=g("auto"),M=g(.5),z=g("auto"),I=g(5600),k=g("auto"),i=g(.5),d=g(400),s=g(1/60),t=g("auto"),n=g(2.8),E=g(0),U=g(0),A=g(0),J=g(0),C=g(!1);K(async()=>{await p(),v.cameraName&&h.value&&await X()}),se(()=>v.cameraName,async T=>{T&&h.value&&await X()});async function X(){!v.cameraName||h.value}function oe(){var T;(T=N.value)==null||T.open()}function Y(){var T;(T=N.value)==null||T.close(),B("close")}const{setFocus:V,setWhiteBalance:R,setExposure:ee,setISO:te,setShutter:ue,setIris:de,setGain:me,setPTZ:ve}=ne();async function pe(){if(v.cameraName){C.value=!0;try{await V(v.cameraName,F.value,F.value==="manual"?M.value:void 0)}catch(T){alert(`Failed to set focus: ${T.message}`)}finally{C.value=!1}}}async function be(){if(v.cameraName){C.value=!0;try{await R(v.cameraName,z.value,z.value==="manual"?I.value:void 0)}catch(T){alert(`Failed to set white balance: ${T.message}`)}finally{C.value=!1}}}async function fe(){if(v.cameraName){C.value=!0;try{await ee(v.cameraName,k.value,k.value==="manual"?i.value:void 0)}catch(T){alert(`Failed to set exposure: ${T.message}`)}finally{C.value=!1}}}async function ge(){if(v.cameraName){C.value=!0;try{await te(v.cameraName,d.value)}catch(T){alert(`Failed to set ISO: ${T.message}`)}finally{C.value=!1}}}async function ye(){if(v.cameraName){C.value=!0;try{await ue(v.cameraName,s.value)}catch(T){alert(`Failed to set shutter: ${T.message}`)}finally{C.value=!1}}}async function _e(){if(v.cameraName){C.value=!0;try{await de(v.cameraName,t.value,t.value==="manual"?n.value:void 0)}catch(T){alert(`Failed to set iris: ${T.message}`)}finally{C.value=!1}}}async function he(){if(v.cameraName){C.value=!0;try{await me(v.cameraName,E.value)}catch(T){alert(`Failed to set gain: ${T.message}`)}finally{C.value=!1}}}async function Ce(){if(v.cameraName)try{await ve(v.cameraName,U.value,A.value,J.value)}catch(T){alert(`Failed to move PTZ: ${T.message}`)}}return P({open:oe,close:Y}),(T,a)=>(c(),xe(we,{ref_key:"modalRef",ref:N,title:"Camera Controls",size:"xl",onClose:a[23]||(a[23]=b=>B("close"))},{header:ie(()=>[e("div",We,[e("div",null,[e("h2",je,y(m.cameraName||"Camera Controls"),1),h.value?(c(),u("p",Re,[W(y(h.value.type==="blackmagic"?"Blackmagic Design":h.value.type==="sony_fx30"?"Sony FX30":"OBSbot Tail 2")+" ",1),e("span",{class:S([h.value.connected?"text-green-500":"text-red-500","ml-2"])},y(h.value.connected?"● Connected":"○ Disconnected"),3)])):w("",!0)])])]),default:ie(()=>[$(r)?(c(),u("div",He," Loading camera settings... ")):$(x)?(c(),u("div",qe,y($(x)),1)):h.value?(c(),u("div",Qe,[e("div",Xe,[$(_)(m.cameraName,"focus")||$(_)(m.cameraName,"whiteBalance")||$(_)(m.cameraName,"exposure")?(c(),u("button",{key:0,class:S(["tab",{"tab--active":l.value==="basic"}]),onClick:a[0]||(a[0]=b=>l.value="basic")}," Basic ",2)):w("",!0),$(_)(m.cameraName,"iso")||$(_)(m.cameraName,"shutter")||$(_)(m.cameraName,"iris")||$(_)(m.cameraName,"gain")?(c(),u("button",{key:1,class:S(["tab",{"tab--active":l.value==="advanced"}]),onClick:a[1]||(a[1]=b=>l.value="advanced")}," Advanced ",2)):w("",!0),$(_)(m.cameraName,"ptz")?(c(),u("button",{key:2,class:S(["tab",{"tab--active":l.value==="ptz"}]),onClick:a[2]||(a[2]=b=>l.value="ptz")}," PTZ ",2)):w("",!0),$(_)(m.cameraName,"colorCorrection")?(c(),u("button",{key:3,class:S(["tab",{"tab--active":l.value==="color"}]),onClick:a[3]||(a[3]=b=>l.value="color")}," Color ",2)):w("",!0),e("button",{class:S(["tab",{"tab--active":l.value==="companion"}]),onClick:a[4]||(a[4]=b=>l.value="companion")}," Companion ",2)]),l.value==="basic"?(c(),u("div",Ye,[$(_)(m.cameraName,"focus")?(c(),u("div",et,[a[24]||(a[24]=e("label",{class:"control-label"},"Focus",-1)),e("div",tt,[e("button",{class:S(["mode-btn",{"mode-btn--active":F.value==="auto"}]),onClick:a[5]||(a[5]=b=>F.value="auto")}," Auto ",2),e("button",{class:S(["mode-btn",{"mode-btn--active":F.value==="manual"}]),onClick:a[6]||(a[6]=b=>F.value="manual")}," Manual ",2)]),F.value==="manual"?(c(),u("div",at,[G(e("input",{"onUpdate:modelValue":a[7]||(a[7]=b=>M.value=b),type:"range",min:"0",max:"1",step:"0.01",class:"slider"},null,512),[[O,M.value,void 0,{number:!0}]]),e("span",nt,y(Math.round(M.value*100))+"%",1)])):w("",!0),e("button",{onClick:pe,disabled:C.value,class:"save-btn"},y(C.value?"Saving...":"Save Focus"),9,ot)])):w("",!0),$(_)(m.cameraName,"whiteBalance")?(c(),u("div",st,[a[26]||(a[26]=e("label",{class:"control-label"},"White Balance",-1)),e("div",lt,[e("button",{class:S(["mode-btn",{"mode-btn--active":z.value==="auto"}]),onClick:a[8]||(a[8]=b=>z.value="auto")}," Auto ",2),e("button",{class:S(["mode-btn",{"mode-btn--active":z.value==="manual"}]),onClick:a[9]||(a[9]=b=>z.value="manual")}," Manual ",2)]),z.value==="manual"?(c(),u("div",it,[G(e("input",{"onUpdate:modelValue":a[10]||(a[10]=b=>I.value=b),type:"number",min:"2000",max:"10000",step:"100",class:"input"},null,512),[[O,I.value,void 0,{number:!0}]]),a[25]||(a[25]=e("span",{class:"input-unit"},"K",-1))])):w("",!0),e("button",{onClick:be,disabled:C.value,class:"save-btn"},y(C.value?"Saving...":"Save White Balance"),9,rt)])):w("",!0),$(_)(m.cameraName,"exposure")?(c(),u("div",ct,[a[27]||(a[27]=e("label",{class:"control-label"},"Exposure",-1)),e("div",ut,[e("button",{class:S(["mode-btn",{"mode-btn--active":k.value==="auto"}]),onClick:a[11]||(a[11]=b=>k.value="auto")}," Auto ",2),e("button",{class:S(["mode-btn",{"mode-btn--active":k.value==="manual"}]),onClick:a[12]||(a[12]=b=>k.value="manual")}," Manual ",2)]),k.value==="manual"?(c(),u("div",dt,[G(e("input",{"onUpdate:modelValue":a[13]||(a[13]=b=>i.value=b),type:"range",min:"0",max:"1",step:"0.01",class:"slider"},null,512),[[O,i.value,void 0,{number:!0}]]),e("span",mt,y(Math.round(i.value*100))+"%",1)])):w("",!0),e("button",{onClick:fe,disabled:C.value,class:"save-btn"},y(C.value?"Saving...":"Save Exposure"),9,vt)])):w("",!0)])):w("",!0),l.value==="advanced"?(c(),u("div",pt,[$(_)(m.cameraName,"iso")?(c(),u("div",bt,[a[28]||(a[28]=e("label",{class:"control-label"},"ISO",-1)),e("div",ft,[G(e("input",{"onUpdate:modelValue":a[14]||(a[14]=b=>d.value=b),type:"number",min:"100",max:"25600",step:"100",class:"input"},null,512),[[O,d.value,void 0,{number:!0}]])]),e("button",{onClick:ge,disabled:C.value,class:"save-btn"},y(C.value?"Saving...":"Save ISO"),9,gt)])):w("",!0),$(_)(m.cameraName,"shutter")?(c(),u("div",yt,[a[30]||(a[30]=e("label",{class:"control-label"},"Shutter Speed",-1)),e("div",_t,[G(e("input",{"onUpdate:modelValue":a[15]||(a[15]=b=>s.value=b),type:"number",min:"0.0001",max:"1",step:"0.0001",class:"input"},null,512),[[O,s.value,void 0,{number:!0}]]),a[29]||(a[29]=e("span",{class:"input-unit"},"s",-1))]),e("button",{onClick:ye,disabled:C.value,class:"save-btn"},y(C.value?"Saving...":"Save Shutter"),9,ht)])):w("",!0),$(_)(m.cameraName,"iris")?(c(),u("div",Ct,[a[32]||(a[32]=e("label",{class:"control-label"},"Iris",-1)),e("div",xt,[e("button",{class:S(["mode-btn",{"mode-btn--active":t.value==="auto"}]),onClick:a[16]||(a[16]=b=>t.value="auto")}," Auto ",2),e("button",{class:S(["mode-btn",{"mode-btn--active":t.value==="manual"}]),onClick:a[17]||(a[17]=b=>t.value="manual")}," Manual ",2)]),t.value==="manual"?(c(),u("div",wt,[G(e("input",{"onUpdate:modelValue":a[18]||(a[18]=b=>n.value=b),type:"number",min:"1.4",max:"22",step:"0.1",class:"input"},null,512),[[O,n.value,void 0,{number:!0}]]),a[31]||(a[31]=e("span",{class:"input-unit"},"f/",-1))])):w("",!0),e("button",{onClick:_e,disabled:C.value,class:"save-btn"},y(C.value?"Saving...":"Save Iris"),9,kt)])):w("",!0),$(_)(m.cameraName,"gain")?(c(),u("div",$t,[a[34]||(a[34]=e("label",{class:"control-label"},"Gain",-1)),e("div",Tt,[G(e("input",{"onUpdate:modelValue":a[19]||(a[19]=b=>E.value=b),type:"number",min:"-12",max:"36",step:"0.1",class:"input"},null,512),[[O,E.value,void 0,{number:!0}]]),a[33]||(a[33]=e("span",{class:"input-unit"},"dB",-1))]),e("button",{onClick:he,disabled:C.value,class:"save-btn"},y(C.value?"Saving...":"Save Gain"),9,zt)])):w("",!0)])):w("",!0),l.value==="ptz"?(c(),u("div",St,[e("div",Pt,[a[38]||(a[38]=e("label",{class:"control-label"},"Pan/Tilt/Zoom",-1)),e("div",Bt,[e("div",Nt,[a[35]||(a[35]=e("label",null,"Pan",-1)),G(e("input",{"onUpdate:modelValue":a[20]||(a[20]=b=>U.value=b),type:"range",min:"-1",max:"1",step:"0.1",class:"slider"},null,512),[[O,U.value,void 0,{number:!0}]]),e("span",Ft,y(U.value.toFixed(1)),1)]),e("div",Mt,[a[36]||(a[36]=e("label",null,"Tilt",-1)),G(e("input",{"onUpdate:modelValue":a[21]||(a[21]=b=>A.value=b),type:"range",min:"-1",max:"1",step:"0.1",class:"slider"},null,512),[[O,A.value,void 0,{number:!0}]]),e("span",It,y(A.value.toFixed(1)),1)]),e("div",Ut,[a[37]||(a[37]=e("label",null,"Zoom",-1)),G(e("input",{"onUpdate:modelValue":a[22]||(a[22]=b=>J.value=b),type:"range",min:"-1",max:"1",step:"0.1",class:"slider"},null,512),[[O,J.value,void 0,{number:!0}]]),e("span",Zt,y(J.value.toFixed(1)),1)])]),e("button",{onClick:Ce,class:"save-btn"}," Move PTZ ")])])):w("",!0),l.value==="color"?(c(),u("div",Gt,[...a[39]||(a[39]=[e("div",{class:"control-group"},[e("p",{class:"text-preke-text-muted text-sm"}," Color correction controls coming soon ")],-1)])])):w("",!0),l.value==="companion"?(c(),u("div",Ot,[re(De)])):w("",!0)])):(c(),u("div",Ke," Camera not found "))]),_:1},512))}}),Pa=Q(Et,[["__scopeId","data-v-d317ac4a"]]);function Vt(m=null){const P=g(!1),f=g(!1),v=g(m),B=g(null),N=g(null);let r=null,x=null,_=0;const p=33;let o=null;async function l(){if((r==null?void 0:r.readyState)!==WebSocket.OPEN)try{const t=await Z.buildApiUrl("/api/v1/ptz-controller/ws");r=new WebSocket(t.replace("http","ws").replace("https","wss")),r.onopen=()=>{P.value=!0,v.value&&F(v.value)},r.onerror=n=>{console.error("[PTZController] WebSocket error:",n),P.value=!1},r.onclose=()=>{P.value=!1}}catch(t){console.error("[PTZController] Failed to connect:",t)}}function h(){r&&(r.close(),r=null),P.value=!1,I()}function F(t){v.value=t,(r==null?void 0:r.readyState)===WebSocket.OPEN&&r.send(JSON.stringify({type:"set_camera",camera_name:t}))}function M(t){if(!P.value||!v.value||!r)return;const n=Date.now();n-_<p||(_=n,r.send(JSON.stringify({type:"ptz_command",pan:t.pan,tilt:t.tilt,zoom:t.zoom,focus:t.focus,speed:t.speed||1})))}function z(t=0){if(x)return;B.value=t,f.value=!0;function n(){var ee,te;if(!f.value)return;const U=navigator.getGamepads()[B.value];if(!U){console.log("[PTZController] Gamepad disconnected during polling"),I(),i();return}(!N.value||N.value.index!==U.index)&&(N.value={id:U.id,index:U.index,mapping:U.mapping||"standard"});const A=Array.from(U.axes),J=Array.from(U.buttons),C=k(A[0]||0,.1),X=k(-(A[1]||0),.1),oe=k(A[2]||0,.1),Y=A[3]?k(A[3],.1):void 0;let V=.5;(ee=J[6])!=null&&ee.value&&(V+=J[6].value*.5),(te=J[7])!=null&&te.value&&(V+=J[7].value*.5),V=Math.min(1,V);const R={pan:C*V,tilt:X*V,zoom:oe*V,focus:Y?Y*V:void 0,speed:V};(Math.abs(R.pan)>.01||Math.abs(R.tilt)>.01||Math.abs(R.zoom)>.01)&&M(R),x=requestAnimationFrame(n)}n()}function I(){f.value=!1,B.value=null,x&&(cancelAnimationFrame(x),x=null)}function k(t,n){if(Math.abs(t)<n)return 0;const E=t>=0?1:-1,U=(Math.abs(t)-n)/(1-n);return E*U}function i(){o&&clearTimeout(o),o=window.setTimeout(()=>{const t=navigator.getGamepads();for(let n=0;n<t.length;n++)if(t[n]&&B.value===null){console.log("[PTZController] Gamepad reconnected:",t[n].id),z(n);break}o=null},1e3)}function d(t){const n=t.gamepad,E=n.id.toLowerCase().includes("bluetooth")||n.id.toLowerCase().includes("wireless")?"Bluetooth":"USB";console.log(`[PTZController] ${E} gamepad connected:`,n.id,{index:n.index,mapping:n.mapping||"standard",axes:n.axes.length,buttons:n.buttons.length}),B.value===null&&z(n.index)}function s(t){const n=t.gamepad,E=n.id.toLowerCase().includes("bluetooth")||n.id.toLowerCase().includes("wireless")?"Bluetooth":"USB";console.log(`[PTZController] ${E} gamepad disconnected:`,n.id),B.value===t.gamepad.index&&(I(),N.value=null,i())}return K(()=>{l(),window.addEventListener("gamepadconnected",d),window.addEventListener("gamepaddisconnected",s);const t=navigator.getGamepads();for(let n=0;n<t.length;n++)if(t[n]){z(n);break}}),le(()=>{h(),I(),o&&clearTimeout(o),window.removeEventListener("gamepadconnected",d),window.removeEventListener("gamepaddisconnected",s)}),{connected:P,active:f,currentCamera:v,gamepadIndex:B,gamepadInfo:N,connect:l,disconnect:h,setCamera:F,sendPTZCommand:M,startGamepad:z,stopGamepad:I}}const At={class:"ptz-controller-panel"},Lt={class:"ptz-controller-panel__header"},Jt={class:"ptz-controller-panel__content"},Dt={class:"ptz-controller-panel__section"},Wt=["value"],jt={class:"ptz-controller-panel__section"},Rt={class:"ptz-controller-panel__status"},Ht={class:"ptz-controller-panel__status-text"},qt={class:"ptz-controller-panel__buttons"},Kt=["disabled"],Qt=["disabled"],Xt={key:0,class:"ptz-controller-panel__section"},Yt={class:"ptz-controller-panel__status"},ea={class:"ptz-controller-panel__status-text"},ta={class:"ptz-controller-panel__section"},aa={class:"ptz-controller-panel__manual-controls"},na={class:"ptz-controller-panel__axis"},oa={class:"ptz-controller-panel__value"},sa={class:"ptz-controller-panel__axis"},la={class:"ptz-controller-panel__value"},ia={class:"ptz-controller-panel__axis"},ra={class:"ptz-controller-panel__value"},ca=["disabled"],ua={class:"ptz-controller-panel__section"},da={class:"ptz-controller-panel__buttons"},ma=["disabled"],va=["disabled"],pa=q({__name:"PTZControllerPanel",props:{cameraName:{}},emits:["close"],setup(m,{emit:P}){const f=m,v=P,{cameras:B,loadCameras:N}=ne(),r=Vt(f.cameraName||null),x=g(f.cameraName||null),_=L(()=>r.gamepadInfo.value!==null),p=L(()=>{var s;return((s=r.gamepadInfo.value)==null?void 0:s.id)||""}),o=L(()=>B.value.filter(s=>s.type==="obsbot_tail2"||s.name.toLowerCase().includes("obsbot")));async function l(){if(!x.value){D.error("Please select a camera first");return}await r.connect(),r.connected.value?(r.setCamera(x.value),D.success("PTZ Controller connected")):D.error("Failed to connect PTZ controller")}function h(){r.disconnect(),D.info("PTZ Controller disconnected")}function F(){const s=navigator.getGamepads();let t=null;for(let n=0;n<s.length;n++)if(s[n]){t=n;break}if(t===null){D.error("No gamepad detected. Please connect a gamepad/joystick first.");return}r.startGamepad(t),setTimeout(()=>{r.gamepadInfo.value&&D.success(`Gamepad connected: ${r.gamepadInfo.value.id}`)},100)}function M(){r.stopGamepad(),D.info("Gamepad disconnected")}const z=g(0),I=g(0),k=g(0);function i(){if(!x.value){D.error("Please select a camera first");return}if(!r.connected.value){D.error("PTZ Controller not connected");return}r.sendPTZCommand({pan:z.value,tilt:I.value,zoom:k.value})}function d(){x.value&&r.connected.value&&r.setCamera(x.value)}return K(async()=>{await N(),!x.value&&o.value.length>0&&(x.value=o.value[0].name)}),le(()=>{h(),M()}),se(()=>f.cameraName,s=>{s&&(x.value=s,r.connected.value&&r.setCamera(s))}),(s,t)=>(c(),u("div",At,[e("div",Lt,[t[6]||(t[6]=e("h3",{class:"ptz-controller-panel__title"},"PTZ Controller",-1)),e("button",{onClick:t[0]||(t[0]=n=>v("close")),class:"ptz-controller-panel__close",title:"Close"},[...t[5]||(t[5]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Jt,[e("div",Dt,[t[8]||(t[8]=e("label",{class:"ptz-controller-panel__label"},"Camera",-1)),G(e("select",{"onUpdate:modelValue":t[1]||(t[1]=n=>x.value=n),class:"ptz-controller-panel__select",onChange:d},[t[7]||(t[7]=e("option",{value:null},"Select camera...",-1)),(c(!0),u(j,null,H(o.value,n=>(c(),u("option",{key:n.name,value:n.name},y(n.name)+" ("+y(n.connected?"Connected":"Disconnected")+") ",9,Wt))),128))],544),[[ke,x.value]])]),e("div",jt,[e("div",Rt,[e("span",{class:S(["ptz-controller-panel__status-dot",{"ptz-controller-panel__status-dot--connected":$(r).connected.value,"ptz-controller-panel__status-dot--disconnected":!$(r).connected.value}])},null,2),e("span",Ht,y($(r).connected.value?"Connected":"Disconnected"),1)]),e("div",qt,[e("button",{onClick:l,disabled:!x.value||$(r).connected.value,class:"ptz-controller-panel__btn ptz-controller-panel__btn--primary"}," Connect ",8,Kt),e("button",{onClick:h,disabled:!$(r).connected.value,class:"ptz-controller-panel__btn"}," Disconnect ",8,Qt)])]),_.value?(c(),u("div",Xt,[e("div",Yt,[t[9]||(t[9]=e("span",{class:"ptz-controller-panel__status-dot ptz-controller-panel__status-dot--connected"},null,-1)),e("span",ea," Gamepad: "+y(p.value),1)])])):w("",!0),e("div",ta,[t[13]||(t[13]=e("label",{class:"ptz-controller-panel__label"},"Manual Control (Testing)",-1)),e("div",aa,[e("div",na,[t[10]||(t[10]=e("label",null,"Pan",-1)),G(e("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>z.value=n),type:"range",min:"-1",max:"1",step:"0.1",class:"ptz-controller-panel__slider"},null,512),[[O,z.value,void 0,{number:!0}]]),e("span",oa,y(z.value.toFixed(1)),1)]),e("div",sa,[t[11]||(t[11]=e("label",null,"Tilt",-1)),G(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>I.value=n),type:"range",min:"-1",max:"1",step:"0.1",class:"ptz-controller-panel__slider"},null,512),[[O,I.value,void 0,{number:!0}]]),e("span",la,y(I.value.toFixed(1)),1)]),e("div",ia,[t[12]||(t[12]=e("label",null,"Zoom",-1)),G(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>k.value=n),type:"range",min:"-1",max:"1",step:"0.1",class:"ptz-controller-panel__slider"},null,512),[[O,k.value,void 0,{number:!0}]]),e("span",ra,y(k.value.toFixed(1)),1)]),e("button",{onClick:i,disabled:!$(r).connected.value||!x.value,class:"ptz-controller-panel__btn ptz-controller-panel__btn--primary"}," Send Command ",8,ca)])]),e("div",ua,[e("div",da,[e("button",{onClick:F,disabled:_.value,class:"ptz-controller-panel__btn"}," Start Gamepad ",8,ma),e("button",{onClick:M,disabled:!_.value,class:"ptz-controller-panel__btn"}," Stop Gamepad ",8,va)]),t[14]||(t[14]=e("p",{class:"ptz-controller-panel__hint"}," Connect a gamepad/joystick and use left stick for pan/tilt, triggers for zoom ",-1))])])]))}}),Ba=Q(pa,[["__scopeId","data-v-ebf7148f"]]),ba={class:"animated-bg"},fa={key:0,class:"animated-bg__hex-grid"},ga={key:3,class:"animated-bg__circuits"},ya=q({__name:"AnimatedBackground",props:{accent:{},showBeams:{type:Boolean},showOrbs:{type:Boolean},showGrid:{type:Boolean},showCircuits:{type:Boolean}},setup(m){return(P,f)=>(c(),u("div",ba,[e("div",{class:S(["animated-bg__gradient",`animated-bg__gradient--${m.accent||"gold"}`])},null,2),m.showGrid!==!1?(c(),u("div",fa)):w("",!0),m.showOrbs!==!1?(c(),u(j,{key:1},[e("div",{class:S(["animated-bg__orb animated-bg__orb--1",`animated-bg__orb--${m.accent||"gold"}`])},null,2),e("div",{class:S(["animated-bg__orb animated-bg__orb--2",`animated-bg__orb--${m.accent||"gold"}`])},null,2),f[0]||(f[0]=e("div",{class:"animated-bg__orb animated-bg__orb--3"},null,-1))],64)):w("",!0),m.showBeams!==!1?(c(),u(j,{key:2},[f[1]||(f[1]=e("div",{class:"animated-bg__scan animated-bg__scan--h"},null,-1)),e("div",{class:S(["animated-bg__scan animated-bg__scan--v",`animated-bg__scan--${m.accent||"gold"}`])},null,2)],64)):w("",!0),m.showCircuits?(c(),u("div",ga,[...f[2]||(f[2]=[ce('<div class="circuit-line circuit-line--1" data-v-00c0a499></div><div class="circuit-line circuit-line--2" data-v-00c0a499></div><div class="circuit-line circuit-line--3" data-v-00c0a499></div><div class="circuit-node circuit-node--1" data-v-00c0a499></div><div class="circuit-node circuit-node--2" data-v-00c0a499></div>',5)])])):w("",!0),e("div",{class:S(["animated-bg__pulse",`animated-bg__pulse--${m.accent||"gold"}`])},null,2)]))}}),_a=Q(ya,[["__scopeId","data-v-00c0a499"]]),ha={class:"loading-screen"},Ca={class:"loading-content"},xa={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.8"},wa={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.8"},ka={class:"loading-text"},$a={class:"loading-tagline"},Ta={class:"loading-dots"},za=q({__name:"ModeLoadingScreen",props:{mode:{},minTime:{default:1500},maxTime:{default:8e3},contentReady:{type:Boolean,default:!1},showCancel:{type:Boolean,default:!1}},emits:["ready","cancel"],setup(m,{emit:P}){const f=m,v=P;function B(){v("cancel")}const N=g(!1);let r=null,x=null;function _(){N.value&&f.contentReady&&v("ready")}se(()=>f.contentReady,F=>{F&&_()});const p=L(()=>f.mode==="recorder"?"#d45a5a":"#7c3aed"),o=L(()=>f.mode==="recorder"?"Recorder":"Mixer"),l=L(()=>f.mode==="recorder"?"Multi-cam ISO Recording":"Live Switching & Streaming"),h=L(()=>f.mode==="recorder"?"red":"purple");return K(()=>{r=setTimeout(()=>{N.value=!0,_()},f.minTime),x=setTimeout(()=>{v("ready")},f.maxTime)}),le(()=>{r&&clearTimeout(r),x&&clearTimeout(x)}),(F,M)=>(c(),u("div",ha,[re(_a,{accent:h.value,"show-beams":!0,"show-pattern":!0},null,8,["accent"]),e("div",Ca,[e("div",{class:"loading-icon",style:ae({color:p.value})},[m.mode==="recorder"?(c(),u("svg",xa,[...M[0]||(M[0]=[e("rect",{x:"2",y:"5",width:"14",height:"12",rx:"2"},null,-1),e("path",{d:"M16 9l4-2v8l-4-2"},null,-1),e("circle",{cx:"6",cy:"8",r:"2",fill:"currentColor",stroke:"none"},null,-1)])])):(c(),u("svg",wa,[...M[1]||(M[1]=[ce('<rect x="2" y="2" width="9" height="6" rx="1" data-v-e506a0ca></rect><rect x="13" y="2" width="9" height="6" rx="1" data-v-e506a0ca></rect><rect x="2" y="10" width="9" height="6" rx="1" data-v-e506a0ca></rect><rect x="13" y="10" width="9" height="6" rx="1" data-v-e506a0ca></rect><circle cx="12" cy="20" r="2" fill="currentColor" data-v-e506a0ca></circle><path d="M9 19.5a4 4 0 0 1 6 0" stroke-linecap="round" data-v-e506a0ca></path>',6)])])),e("div",{class:"loading-icon__glow",style:ae({background:p.value})},null,4)],4),e("div",ka,[e("h2",{class:"loading-title",style:ae({color:p.value})},y(o.value),5),e("p",$a,y(l.value),1)]),e("div",Ta,[(c(),u(j,null,H(3,z=>e("div",{key:z,class:"loading-dot",style:ae({backgroundColor:p.value,animationDelay:`${(z-1)*.15}s`})},null,4)),64))]),m.showCancel?(c(),u("button",{key:0,onClick:B,class:"loading-cancel"},[...M[2]||(M[2]=[e("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"1.8"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),W(" Go back ",-1)])])):w("",!0)])]))}}),Na=Q(za,[["__scopeId","data-v-e506a0ca"]]);export{Pa as C,Na as M,Ba as P,ne as u};
