const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-2Z_IvDe_.js","assets/index-ta2WeRMF.css"])))=>i.map(i=>d[i]);
import{d as O,u as re,W as de,r as S,o as U,l as J,c as n,a as e,q as r,t as u,e as N,n as A,x as L,F as P,y as V,f as ce,b as ae,i as t,_ as ue,E as Q,w as M,S as ee,X as pe,Y as le,j as T,B as te,Z as G,k as ve,A as W,$ as me,I as q,m as se}from"./index-2Z_IvDe_.js";import{V as ne,a as xe}from"./vdoninja-CEXRmajt.js";const fe={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},be={class:"card"},ke={key:0,class:"text-preke-red"},_e={key:1,class:"space-y-3"},ge={class:"flex justify-between items-center"},ye={key:0,class:"skeleton w-24 h-5"},he={key:1,class:"font-medium"},we={class:"flex justify-between items-center"},$e={key:0,class:"skeleton w-16 h-5"},Se={key:1,class:"capitalize"},je={class:"flex justify-between items-center"},Ce={key:0,class:"skeleton w-12 h-5"},Ae={key:1},De={class:"flex justify-between items-center"},Re={key:0,class:"skeleton w-20 h-5"},Ne={key:1,class:"badge badge-success"},Pe={class:"card"},Te={class:"space-y-4"},Ve={class:"flex items-center justify-between"},Ee={key:0,class:"skeleton w-20 h-5 rounded-full"},Me={class:"flex gap-2"},Oe=["disabled"],Ue={key:0,class:"inline-block animate-spin mr-1"},Fe=["disabled"],Le={key:0,class:"inline-block animate-spin mr-1"},Ie={key:0,class:"text-sm text-preke-red"},Be={class:"card"},He={class:"space-y-3"},ze={class:"flex justify-between items-center"},Ge={key:0,class:"skeleton w-20 h-5 rounded-full"},We={class:"flex justify-between items-center"},qe={key:0,class:"skeleton w-20 h-5 rounded-full"},Je={class:"flex justify-between items-center"},Ke={key:0,class:"skeleton w-20 h-5 rounded-full"},Xe={key:1,class:"badge badge-success"},Ye={class:"flex justify-between items-center"},Ze={key:0,class:"skeleton w-20 h-5 rounded-full"},Qe={key:1,class:"badge badge-success"},et={class:"card md:col-span-2 lg:col-span-3"},tt={class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4"},st={class:"flex items-center justify-between mb-3"},nt={class:"flex items-center gap-2"},ot={class:"font-medium"},at={class:"space-y-1 text-sm text-preke-text-dim"},lt={class:"flex justify-between"},it={class:"text-preke-text"},rt={class:"flex justify-between"},dt={class:"text-preke-text"},ct={class:"flex justify-between"},ut={class:"text-preke-text font-mono text-xs"},pt={key:0,class:"col-span-full text-center text-preke-text-dim py-8"},vt=O({__name:"DeviceStatus",setup(E){const v=re(),{capabilities:a,loading:c,error:x}=de(v),k=S(!1),_=S(null);let m=null;async function p(j){if(!k.value){k.value=!0,_.value=null;try{const s=await fetch(ae(`/api/mode/${j}`),{method:"POST"});if(!s.ok){const o=await s.json().catch(()=>({}));throw new Error(o.detail||`Failed to switch to ${j} mode`)}await v.fetchCapabilities()}catch(s){_.value=s instanceof Error?s.message:"Failed to switch mode",console.error("Mode switch error:",s)}finally{k.value=!1}}}function d(j,s){if(!s)return"bg-preke-text-dim";switch(j){case"streaming":case"recording":return"bg-preke-green";case"preview":return"bg-preke-blue";case"idle":return"bg-preke-text-dim";case"error":return"bg-preke-red";default:return"bg-preke-text-dim"}}function R(j,s){if(!s)return"No Signal";switch(j){case"streaming":return"Streaming";case"recording":return"Recording";case"preview":return"Preview";case"idle":return"Idle";case"error":return"Error";default:return j}}return U(()=>{v.fetchCapabilities(),m=setInterval(()=>{v.fetchCapabilities()},1e4)}),J(()=>{m&&clearInterval(m)}),(j,s)=>{var o,$,I,B,H,F,z,l,i,f,y,h,C,g;return t(),n("div",fe,[e("div",be,[s[6]||(s[6]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Device Info",-1)),r(x)&&!r(a)?(t(),n("div",ke,u(r(x)),1)):(t(),n("div",_e,[e("div",ge,[s[2]||(s[2]=e("span",{class:"text-preke-text-dim"},"Device Name",-1)),r(c)&&!r(a)?(t(),n("div",ye)):(t(),n("span",he,u(((o=r(a))==null?void 0:o.device_name)||"R58 Device"),1))]),e("div",we,[s[3]||(s[3]=e("span",{class:"text-preke-text-dim"},"Platform",-1)),r(c)&&!r(a)?(t(),n("div",$e)):(t(),n("span",Se,u((($=r(a))==null?void 0:$.platform)||"-"),1))]),e("div",je,[s[4]||(s[4]=e("span",{class:"text-preke-text-dim"},"API Version",-1)),r(c)&&!r(a)?(t(),n("div",Ce)):(t(),n("span",Ae,u(((I=r(a))==null?void 0:I.api_version)||"-"),1))]),e("div",De,[s[5]||(s[5]=e("span",{class:"text-preke-text-dim"},"GStreamer",-1)),r(c)&&!r(a)?(t(),n("div",Re)):(t(),n("span",Ne,"Initialized"))])]))]),e("div",Pe,[s[10]||(s[10]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Operating Mode",-1)),e("div",Te,[e("div",Ve,[s[7]||(s[7]=e("span",{class:"text-preke-text-dim"},"Current Mode",-1)),r(c)&&!r(a)?(t(),n("div",Ee)):(t(),n("span",{key:1,class:A(["badge",((B=r(a))==null?void 0:B.current_mode)==="mixer"?"badge-info":"badge-success"])},u(((H=r(a))==null?void 0:H.current_mode)==="mixer"?"Mixer":"Recorder"),3))]),e("div",Me,[e("button",{class:A(["btn btn-sm flex-1",((F=r(a))==null?void 0:F.current_mode)==="recorder"?"btn-primary":"btn-secondary"]),disabled:k.value||((z=r(a))==null?void 0:z.current_mode)==="recorder"||r(c)&&!r(a),onClick:s[0]||(s[0]=b=>p("recorder"))},[k.value&&((l=r(a))==null?void 0:l.current_mode)!=="recorder"?(t(),n("span",Ue,"⟳")):N("",!0),s[8]||(s[8]=L(" Recorder ",-1))],10,Oe),e("button",{class:A(["btn btn-sm flex-1",((i=r(a))==null?void 0:i.current_mode)==="mixer"?"btn-primary":"btn-secondary"]),disabled:k.value||((f=r(a))==null?void 0:f.current_mode)==="mixer"||r(c)&&!r(a),onClick:s[1]||(s[1]=b=>p("mixer"))},[k.value&&((y=r(a))==null?void 0:y.current_mode)!=="mixer"?(t(),n("span",Le,"⟳")):N("",!0),s[9]||(s[9]=L(" Mixer ",-1))],10,Fe)]),_.value?(t(),n("div",Ie,u(_.value),1)):N("",!0)])]),e("div",Be,[s[15]||(s[15]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Available Features",-1)),e("div",He,[e("div",ze,[s[11]||(s[11]=e("div",null,[e("span",null,"Mixer"),e("span",{class:"text-xs text-preke-text-dim ml-1"},"(VDO.ninja)")],-1)),r(c)&&!r(a)?(t(),n("div",Ge)):(t(),n("span",{key:1,class:A(["badge",r(v).mixerEnabled?"badge-success":"badge-warning"])},u(r(v).mixerEnabled?"Available":"Disabled"),3))]),e("div",We,[s[12]||(s[12]=e("span",null,"Recorder",-1)),r(c)&&!r(a)?(t(),n("div",qe)):(t(),n("span",{key:1,class:A(["badge",r(v).recorderEnabled?"badge-success":"badge-warning"])},u(r(v).recorderEnabled?"Available":"Disabled"),3))]),e("div",Je,[s[13]||(s[13]=e("span",null,"Graphics Overlay",-1)),r(c)&&!r(a)?(t(),n("div",Ke)):(t(),n("span",Xe,"Available"))]),e("div",Ye,[s[14]||(s[14]=e("span",null,"WebRTC Preview",-1)),r(c)&&!r(a)?(t(),n("div",Ze)):(t(),n("span",Qe,"Available"))])])]),e("div",et,[s[20]||(s[20]=e("h3",{class:"text-sm font-semibold text-preke-text-dim uppercase tracking-wide mb-4"},"Hardware Inputs",-1)),e("div",tt,[r(c)&&!r(a)?(t(),n(P,{key:0},V(4,b=>e("div",{key:b,class:"p-4 rounded-lg bg-preke-bg-surface border border-preke-border"},[...s[16]||(s[16]=[ce('<div class="flex items-center justify-between mb-3" data-v-4100f3e3><div class="flex items-center gap-2" data-v-4100f3e3><div class="skeleton w-2 h-2 rounded-full" data-v-4100f3e3></div><div class="skeleton w-16 h-5" data-v-4100f3e3></div></div><div class="skeleton w-16 h-4 rounded-full" data-v-4100f3e3></div></div><div class="space-y-2" data-v-4100f3e3><div class="flex justify-between" data-v-4100f3e3><div class="skeleton w-8 h-4" data-v-4100f3e3></div><div class="skeleton w-12 h-4" data-v-4100f3e3></div></div><div class="flex justify-between" data-v-4100f3e3><div class="skeleton w-16 h-4" data-v-4100f3e3></div><div class="skeleton w-20 h-4" data-v-4100f3e3></div></div><div class="flex justify-between" data-v-4100f3e3><div class="skeleton w-10 h-4" data-v-4100f3e3></div><div class="skeleton w-14 h-4" data-v-4100f3e3></div></div></div>',2)])])),64)):(t(),n(P,{key:1},[(t(!0),n(P,null,V(((h=r(a))==null?void 0:h.inputs)||[],b=>{var D;return t(),n("div",{key:b.id,class:A(["p-4 rounded-lg bg-preke-bg-surface border border-preke-border",{"border-preke-green/50":b.has_signal}])},[e("div",st,[e("div",nt,[e("span",{class:A(["w-2 h-2 rounded-full animate-pulse",d(b.status,b.has_signal)])},null,2),e("span",ot,u(b.label),1)]),e("span",{class:A(["text-xs px-2 py-0.5 rounded-full",{"bg-preke-green/20 text-preke-green":b.has_signal&&(b.status==="streaming"||b.status==="recording"),"bg-preke-blue/20 text-preke-blue":b.has_signal&&b.status==="preview","bg-preke-bg-surface text-preke-text-dim":!b.has_signal||b.status==="idle"}])},u(R(b.status,b.has_signal)),3)]),e("div",at,[e("div",lt,[s[17]||(s[17]=e("span",null,"Type",-1)),e("span",it,u(b.type.toUpperCase()),1)]),e("div",rt,[s[18]||(s[18]=e("span",null,"Resolution",-1)),e("span",dt,u(b.max_resolution||"N/A"),1)]),e("div",ct,[s[19]||(s[19]=e("span",null,"Device",-1)),e("span",ut,u(((D=b.device_path)==null?void 0:D.split("/").pop())||"N/A"),1)])])],2)}),128)),(g=(C=r(a))==null?void 0:C.inputs)!=null&&g.length?N("",!0):(t(),n("div",pt," No inputs detected "))],64))])])])}}}),mt=ue(vt,[["__scopeId","data-v-4100f3e3"]]),xt={class:"space-y-4"},ft={class:"flex items-center gap-4 flex-wrap"},bt=["value"],kt={class:"flex items-center gap-2 cursor-pointer"},_t=["disabled"],gt={key:0},yt={key:1},ht={class:"bg-preke-bg-base rounded-lg p-4 font-mono text-sm text-preke-text-dim h-[500px] overflow-auto whitespace-pre-wrap"},wt=O({__name:"LogViewer",props:{service:{}},setup(E){const v=E,a=S(""),c=S(!1),x=S(v.service||"preke-recorder"),k=S(100),_=S(!1),m=[{id:"preke-recorder",label:"Preke Recorder"},{id:"mediamtx",label:"MediaMTX"}];let p=null;async function d(){c.value=!0;try{const o=await(await fetch(ae(`/api/system/logs?service=${x.value}&lines=${k.value}`))).json();a.value=o.logs||"No logs available"}catch(s){a.value=`Error fetching logs: ${s}`}finally{c.value=!1}}function R(){p&&clearInterval(p),p=window.setInterval(d,5e3)}function j(){p&&(clearInterval(p),p=null)}return Q(_,s=>{s?R():j()}),Q([x,k],()=>{d()}),U(()=>{d()}),J(()=>{j()}),(s,o)=>(t(),n("div",xt,[e("div",ft,[M(e("select",{"onUpdate:modelValue":o[0]||(o[0]=$=>x.value=$),class:"input"},[(t(),n(P,null,V(m,$=>e("option",{key:$.id,value:$.id},u($.label),9,bt)),64))],512),[[ee,x.value]]),M(e("select",{"onUpdate:modelValue":o[1]||(o[1]=$=>k.value=$),class:"input"},[...o[3]||(o[3]=[e("option",{value:50},"50 lines",-1),e("option",{value:100},"100 lines",-1),e("option",{value:250},"250 lines",-1),e("option",{value:500},"500 lines",-1)])],512),[[ee,k.value]]),e("label",kt,[M(e("input",{type:"checkbox","onUpdate:modelValue":o[2]||(o[2]=$=>_.value=$),class:"w-4 h-4 rounded"},null,512),[[pe,_.value]]),o[4]||(o[4]=e("span",{class:"text-sm"},"Auto-refresh",-1))]),e("button",{onClick:d,disabled:c.value,class:"btn"},[c.value?(t(),n("span",gt,"Loading...")):(t(),n("span",yt,"Refresh"))],8,_t)]),e("pre",ht,u(a.value||"No logs available"),1)]))}}),$t={class:"space-y-6"},St={class:"flex items-center justify-between"},jt=["disabled"],Ct={key:0},At={key:1},Dt={key:0,class:"flex items-center justify-center py-12"},Rt={key:1,class:"text-center py-12 text-preke-text-dim"},Nt={key:2,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Pt=["onClick"],Tt={class:"flex items-start justify-between mb-4"},Vt={class:"font-semibold"},Et={class:"text-sm text-preke-text-dim"},Mt={class:"space-y-2 text-sm"},Ot={class:"flex justify-between"},Ut={class:"font-mono"},Ft={class:"flex justify-between"},Lt=O({__name:"FleetOverview",setup(E){const v=S([]),a=S(!0),c=S(!1);async function x(){a.value=!0;try{const m=await fetch("/api/v1/lan-devices");if(m.ok){const p=await m.json();v.value=p.map(d=>({id:d.id,name:d.name,ip:d.ip,status:d.status,lastSeen:d.last_seen,version:d.api_version||"unknown"}))}}catch(m){console.error("Failed to fetch LAN devices:",m)}finally{a.value=!1}}U(x);async function k(){c.value=!0;try{const m=await fetch("/api/v1/lan-devices/scan",{method:"POST"});if(m.ok){const p=await m.json();for(const d of p)v.value.find(j=>j.id===d.id)||v.value.push({id:d.id,name:d.name,ip:d.ip,status:d.status,lastSeen:d.last_seen,version:d.api_version||"unknown"})}}catch(m){console.error("LAN network scan failed:",m)}finally{c.value=!1}}async function _(m){try{const d=await(await fetch(`/api/v1/lan-devices/${m.id}/connect`,{method:"POST"})).json();d.connected?window.open(`http://${m.ip}:8000`,"_blank"):alert(`Failed to connect: ${d.error||"Unknown error"}`)}catch(p){console.error("Failed to connect to device:",p)}}return(m,p)=>(t(),n("div",$t,[e("div",St,[p[0]||(p[0]=e("h2",{class:"text-lg font-semibold"},"LAN Devices",-1)),e("button",{onClick:k,disabled:c.value,class:"btn"},[c.value?(t(),n("span",Ct,"Scanning...")):(t(),n("span",At,"Scan Network"))],8,jt)]),a.value?(t(),n("div",Dt,[...p[1]||(p[1]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-preke-gold border-t-transparent rounded-full"},null,-1)])])):v.value.length===0?(t(),n("div",Rt,[...p[2]||(p[2]=[e("p",null,"No devices found",-1),e("p",{class:"text-sm mt-2"},'Click "Scan Network" to discover R58 devices',-1)])])):(t(),n("div",Nt,[(t(!0),n(P,null,V(v.value,d=>(t(),n("div",{key:d.id,class:"card hover:border-preke-gold/50 transition-colors cursor-pointer",onClick:R=>_(d)},[e("div",Tt,[e("div",null,[e("h3",Vt,u(d.name),1),e("p",Et,u(d.id),1)]),e("span",{class:A(["badge",{"badge-success":d.status==="online","badge-danger":d.status==="offline","badge-warning":d.status==="unknown"}])},u(d.status),3)]),e("div",Mt,[e("div",Ot,[p[3]||(p[3]=e("span",{class:"text-preke-text-dim"},"IP Address",-1)),e("span",Ut,u(d.ip),1)]),e("div",Ft,[p[4]||(p[4]=e("span",{class:"text-preke-text-dim"},"Version",-1)),e("span",null,u(d.version),1)])])],8,Pt))),128))]))]))}}),It={class:"space-y-6"},Bt={key:0,class:"flex items-center justify-center py-12"},Ht={key:1,class:"glass-card p-4 bg-preke-red/10 border border-preke-red/30 rounded-xl"},zt={class:"text-preke-red"},Gt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},Wt={class:"glass-card p-4 rounded-xl"},qt={key:0,class:"space-y-3"},Jt={class:"relative w-full h-3 bg-preke-bg rounded-full overflow-hidden"},Kt={class:"flex justify-between text-sm"},Xt={class:"font-mono text-preke-text"},Yt={key:1,class:"flex items-center justify-center py-4"},Zt={class:"glass-card p-4 rounded-xl"},Qt={key:0,class:"space-y-3"},es={class:"relative w-full h-3 bg-preke-bg rounded-full overflow-hidden"},ts={class:"flex justify-between text-sm"},ss={class:"text-preke-text"},ns={key:1,class:"flex items-center justify-center py-4"},os={class:"glass-card p-4 rounded-xl"},as={class:"flex items-center justify-center py-2"},ls={key:1,class:"text-preke-text-muted"},is={key:0,class:"text-center text-xs text-preke-text-muted"},rs={class:"glass-card p-4 rounded-xl"},ds={class:"flex items-center justify-center py-2"},cs={key:0,class:"text-3xl font-bold text-preke-gold"},us={key:1,class:"text-preke-text-muted"},ps={class:"text-center text-xs text-preke-text-muted"},vs={class:"glass-card p-4 rounded-xl"},ms={class:"flex items-center justify-between mb-4"},xs={class:"flex gap-2"},fs={class:"grid gap-3 sm:grid-cols-3"},bs={class:"flex items-center gap-3"},ks={class:"font-medium text-preke-text"},_s={class:"text-xs text-preke-text-muted"},gs={key:0},ys=["onClick"],hs={key:1,class:"text-xs text-preke-text-muted"},ws={class:"glass-card p-4 rounded-xl"},$s={class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},Ss={class:"ml-2 text-preke-gold"},js={key:0,class:"text-center py-8 text-preke-text-muted"},Cs={key:1,class:"space-y-2"},As={class:"flex items-center gap-4"},Ds={class:"font-mono text-sm text-preke-text"},Rs={class:"text-xs text-preke-text-muted"},Ns={key:0},Ps={class:"flex items-center gap-3"},Ts=["onClick"],Vs=O({__name:"SystemMonitor",setup(E){const v=le(),a=S(!0),c=S(null),x=S(null),k=S(null),_=T(()=>{var f,y,h;const l=((h=(y=(f=x.value)==null?void 0:f.info)==null?void 0:y.load_average)==null?void 0:h[0])??0;return Math.min(100,l/8*100)}),m=T(()=>{var i,f;const l=(f=(i=x.value)==null?void 0:i.info)==null?void 0:f.memory_percent;return l!==void 0?l:0}),p=T(()=>{var f,y;const l=((y=(f=x.value)==null?void 0:f.info)==null?void 0:y.temperatures)??[];return l.length===0?null:l.find(h=>{var C;return(C=h.type)==null?void 0:C.toLowerCase().includes("cpu")})??l[0]}),d=T(()=>{var h,C;const l=((C=(h=x.value)==null?void 0:h.info)==null?void 0:C.uptime_seconds)??0,i=Math.floor(l/86400),f=Math.floor(l%86400/3600),y=Math.floor(l%3600/60);return i>0?`${i}d ${f}h`:f>0?`${f}h ${y}m`:`${y}m`}),R=T(()=>{var l;return((l=x.value)==null?void 0:l.services)??[]}),j=T(()=>{var l;return((l=x.value)==null?void 0:l.pipelines)??[]});async function s(){try{const{buildApiUrl:l}=await G(async()=>{const{buildApiUrl:b}=await import("./index-2Z_IvDe_.js").then(D=>D.a2);return{buildApiUrl:b}},__vite__mapDeps([0,1])),[i,f,y]=await Promise.all([fetch(l("/health")),fetch(l("/api/ingest/status")),fetch(l("/api/system/info"))]),h=i.ok?await i.json():{status:"unknown"},C=f.ok?await f.json():{cameras:{}},g=y.ok?await y.json():null;x.value={info:{hostname:(g==null?void 0:g.hostname)||"R58 Device",platform:h.platform||"R58",gstreamer:h.gstreamer,load_average:(g==null?void 0:g.load_average)||[0,0,0],memory_percent:(g==null?void 0:g.memory_percent)||0,memory_total_mb:(g==null?void 0:g.memory_total_mb)||0,memory_used_mb:(g==null?void 0:g.memory_used_mb)||0,uptime_seconds:(g==null?void 0:g.uptime_seconds)||0,temperatures:(g==null?void 0:g.temperatures)||[]},services:[{name:"r58-recorder",active:h.status==="healthy",status:h.status},{name:"mediamtx",active:!0,status:"running"},{name:"vdo.ninja",active:!0,status:"running",note:"r58-vdo.itagenten.no"}],pipelines:Object.entries(C.cameras||{}).map(([b,D])=>({pipeline_id:b,pipeline_type:"ingest",device:D.device,state:D.status==="streaming"?"running":D.status}))},c.value=null}catch(l){c.value=l.message,console.error("Failed to fetch system status:",l)}finally{a.value=!1}}async function o(l){try{const{buildApiUrl:i}=await G(async()=>{const{buildApiUrl:h}=await import("./index-2Z_IvDe_.js").then(C=>C.a2);return{buildApiUrl:h}},__vite__mapDeps([0,1])),y=await(await fetch(i(`/api/system/restart-service/${l}`),{method:"POST"})).json();y.success?(v.success(y.message||`Service ${l} restarted`),setTimeout(s,2e3)):v.error(y.message||`Failed to restart ${l}`)}catch(i){v.error(`Restart failed: ${i.message}`)}}async function $(){if(confirm("Are you sure you want to reboot the device? This will interrupt all recordings and streams."))try{const{buildApiUrl:l}=await G(async()=>{const{buildApiUrl:y}=await import("./index-2Z_IvDe_.js").then(h=>h.a2);return{buildApiUrl:y}},__vite__mapDeps([0,1])),f=await(await fetch(l("/api/system/reboot"),{method:"POST"})).json();f.success?v.success("Device is rebooting..."):v.error(f.message||"Failed to reboot device")}catch(l){v.error(`Reboot failed: ${l.message}`)}}async function I(l){try{const{buildApiUrl:i}=await G(async()=>{const{buildApiUrl:h}=await import("./index-2Z_IvDe_.js").then(C=>C.a2);return{buildApiUrl:h}},__vite__mapDeps([0,1])),f=await fetch(i(`/api/ingest/stop/${l}`),{method:"POST"}),y=await f.json();f.ok?(v.success(`Stopped pipeline: ${l}`),await s()):v.error(y.detail||"Stop failed")}catch(i){v.error(`Stop failed: ${i.message}`)}}function B(l){return l.active?"bg-preke-green":"bg-preke-red"}function H(l){switch(l){case"running":return"text-preke-green";case"starting":return"text-preke-gold";case"stopping":return"text-preke-gold";default:return"text-preke-text-muted"}}function F(l){return l>90?"bg-preke-red":l>70?"bg-preke-gold":"bg-preke-green"}function z(l){return l>80?"text-preke-red":l>65?"text-preke-gold":"text-preke-green"}return U(()=>{s(),k.value=window.setInterval(s,1e4)}),J(()=>{k.value&&clearInterval(k.value)}),(l,i)=>{var f,y,h,C,g,b,D,K,X,Y,Z;return t(),n("div",It,[a.value?(t(),n("div",Bt,[...i[1]||(i[1]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-preke-gold border-t-transparent rounded-full"},null,-1)])])):c.value?(t(),n("div",Ht,[e("p",zt,"Error loading system status: "+u(c.value),1),e("button",{onClick:s,class:"btn-v2 btn-v2--secondary mt-4"},"Retry")])):(t(),n(P,{key:2},[e("div",Gt,[e("div",Wt,[i[4]||(i[4]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"CPU Load",-1)),(h=(y=(f=x.value)==null?void 0:f.info)==null?void 0:y.load_average)!=null&&h.some(w=>w>0)?(t(),n("div",qt,[e("div",Jt,[e("div",{class:A(["absolute left-0 top-0 h-full rounded-full transition-all duration-500",F(_.value)]),style:te({width:`${_.value}%`})},null,6)]),e("div",Kt,[i[2]||(i[2]=e("span",{class:"text-preke-text-muted"},"Load Average",-1)),e("span",Xt,u((b=(g=(C=x.value)==null?void 0:C.info)==null?void 0:g.load_average)==null?void 0:b.map(w=>w.toFixed(2)).join(" / ")),1)])])):(t(),n("div",Yt,[...i[3]||(i[3]=[e("span",{class:"text-preke-text-muted"},"N/A",-1)])]))]),e("div",Zt,[i[7]||(i[7]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Memory",-1)),m.value>0?(t(),n("div",Qt,[e("div",es,[e("div",{class:A(["absolute left-0 top-0 h-full rounded-full transition-all duration-500",F(m.value)]),style:te({width:`${m.value}%`})},null,6)]),e("div",ts,[i[5]||(i[5]=e("span",{class:"text-preke-text-muted"},"Used",-1)),e("span",ss,u(m.value.toFixed(1))+"%",1)])])):(t(),n("div",ns,[...i[6]||(i[6]=[e("span",{class:"text-preke-text-muted"},"N/A",-1)])]))]),e("div",os,[i[8]||(i[8]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Temperature",-1)),e("div",as,[p.value?(t(),n("span",{key:0,class:A(["text-3xl font-bold",z(p.value.temp_celsius)])},u(p.value.temp_celsius.toFixed(1))+"°C ",3)):(t(),n("span",ls,"N/A"))]),(D=p.value)!=null&&D.type?(t(),n("p",is,u(p.value.type),1)):N("",!0)]),e("div",rs,[i[9]||(i[9]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Uptime",-1)),e("div",ds,[((X=(K=x.value)==null?void 0:K.info)==null?void 0:X.uptime_seconds)>0?(t(),n("span",cs,u(d.value),1)):(t(),n("span",us,"N/A"))]),e("p",ps,u(((Z=(Y=x.value)==null?void 0:Y.info)==null?void 0:Z.hostname)||"R58 Device"),1)])]),e("div",vs,[e("div",ms,[i[10]||(i[10]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide"},"Services",-1)),e("div",xs,[e("button",{onClick:i[0]||(i[0]=w=>o("preke-recorder")),class:"btn-v2 btn-v2--secondary text-sm",title:"Restart the main service"}," Restart Service "),e("button",{onClick:$,class:"btn-v2 btn-v2--danger text-sm",title:"Reboot the device"}," Reboot Device ")])]),e("div",fs,[(t(!0),n(P,null,V(R.value,w=>(t(),n("div",{key:w.name,class:"flex items-center justify-between p-3 rounded-lg bg-preke-surface border border-preke-surface-border"},[e("div",bs,[e("span",{class:A(["w-2.5 h-2.5 rounded-full",B(w)])},null,2),e("div",null,[e("p",ks,u(w.name),1),e("p",_s,[L(u(w.status)+" ",1),w.memory_mb?(t(),n("span",gs," · "+u(w.memory_mb.toFixed(0))+" MB",1)):N("",!0)])])]),w.name!=="vdo.ninja"?(t(),n("button",{key:0,onClick:ie=>o(w.name),class:"text-preke-text-muted hover:text-preke-gold transition-colors",title:"Restart service"},[...i[11]||(i[11]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])],8,ys)):(t(),n("span",hs,"External"))]))),128))])]),e("div",ws,[e("h3",$s,[i[12]||(i[12]=L(" Active Pipelines ",-1)),e("span",Ss,"("+u(j.value.length)+")",1)]),j.value.length===0?(t(),n("div",js," No active pipelines ")):(t(),n("div",Cs,[(t(!0),n(P,null,V(j.value,w=>(t(),n("div",{key:w.pipeline_id,class:"flex items-center justify-between p-3 rounded-lg bg-preke-surface border border-preke-surface-border"},[e("div",As,[e("div",null,[e("p",Ds,u(w.pipeline_id),1),e("p",Rs,[L(" Type: "+u(w.pipeline_type)+" ",1),w.device?(t(),n("span",Ns," · "+u(w.device),1)):N("",!0)])])]),e("div",Ps,[e("span",{class:A(["text-sm font-medium capitalize",H(w.state)])},u(w.state),3),w.state==="running"?(t(),n("button",{key:0,onClick:ie=>I(w.pipeline_id),class:"btn-v2 btn-v2--danger text-sm",title:"Stop pipeline"}," Stop ",8,Ts)):N("",!0)])]))),128))]))])],64))])}}}),Es={class:"space-y-6"},Ms={class:"glass-card p-4 rounded-xl"},Os={class:"space-y-4"},Us={class:"glass-card p-4 rounded-xl"},Fs={class:"space-y-4"},Ls=["value"],Is={class:"glass-card p-4 rounded-xl"},Bs={class:"space-y-4"},Hs=["value"],zs={class:"flex items-center justify-between"},Gs={key:0},Ws={class:"glass-card p-4 rounded-xl bg-preke-surface/30"},qs={class:"space-y-2 text-sm"},Js={class:"flex justify-between"},Ks={class:"text-preke-text"},oe="preke-settings",Xs=O({__name:"SettingsPanel",setup(E){const v=le(),a=S("Preke Device"),c=S(ne),x=S(xe()),k=S("/opt/r58/recordings"),_=S(!1),m=S(30),p=T(()=>ve());function d(){try{const s=localStorage.getItem(oe);if(s){const o=JSON.parse(s);a.value=o.deviceName||a.value,c.value=o.vdoRoom||c.value,_.value=o.autoCleanup||!1,m.value=o.cleanupDays||30}}catch{}}function R(){try{const s={deviceName:a.value,vdoRoom:c.value,autoCleanup:_.value,cleanupDays:m.value};localStorage.setItem(oe,JSON.stringify(s)),v.success("Settings saved")}catch(s){v.error("Failed to save settings"),console.error("Failed to save settings:",s)}}function j(){a.value="Preke Device",c.value=ne,_.value=!1,m.value=30,R(),v.info("Settings reset to defaults")}return U(()=>{d()}),(s,o)=>(t(),n("div",Es,[e("div",Ms,[o[6]||(o[6]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Device",-1)),e("div",Os,[e("div",null,[o[4]||(o[4]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Device Name",-1)),M(e("input",{"onUpdate:modelValue":o[0]||(o[0]=$=>a.value=$),type:"text",class:"input w-full",placeholder:"My Preke Device"},null,512),[[W,a.value]]),o[5]||(o[5]=e("p",{class:"text-xs text-preke-text-muted mt-1"},"Display name for this device in the app",-1))])])]),e("div",Us,[o[11]||(o[11]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"VDO.ninja / Mixer",-1)),e("div",Fs,[e("div",null,[o[7]||(o[7]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Room Name",-1)),M(e("input",{"onUpdate:modelValue":o[1]||(o[1]=$=>c.value=$),type:"text",class:"input w-full",placeholder:"r58studio"},null,512),[[W,c.value]]),o[8]||(o[8]=e("p",{class:"text-xs text-preke-text-muted mt-1"},"VDO.ninja room for video mixing",-1))]),e("div",null,[o[9]||(o[9]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"VDO Host",-1)),e("input",{value:x.value,type:"text",class:"input w-full bg-preke-surface opacity-60",readonly:"",disabled:""},null,8,Ls),o[10]||(o[10]=e("p",{class:"text-xs text-preke-text-muted mt-1"},"VDO.ninja server (read-only)",-1))])])]),e("div",Is,[o[16]||(o[16]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"Storage",-1)),e("div",Bs,[e("div",null,[o[12]||(o[12]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Recording Path",-1)),e("input",{value:k.value,type:"text",class:"input w-full bg-preke-surface opacity-60",readonly:"",disabled:""},null,8,Hs),o[13]||(o[13]=e("p",{class:"text-xs text-preke-text-muted mt-1"}," Configured in config.yml on R58 device. Default: /opt/r58/recordings/ ",-1))]),e("div",zs,[o[14]||(o[14]=e("div",null,[e("label",{class:"block text-sm font-medium text-preke-text"},"Auto-cleanup old recordings"),e("p",{class:"text-xs text-preke-text-muted"},"Automatically delete recordings older than specified days")],-1)),e("button",{onClick:o[2]||(o[2]=$=>_.value=!_.value),class:A(["relative inline-flex h-6 w-11 items-center rounded-full transition-colors",_.value?"bg-preke-gold":"bg-preke-surface-elevated"])},[e("span",{class:A(["inline-block h-4 w-4 transform rounded-full bg-white transition-transform",_.value?"translate-x-6":"translate-x-1"])},null,2)],2)]),_.value?(t(),n("div",Gs,[o[15]||(o[15]=e("label",{class:"block text-sm font-medium text-preke-text mb-2"},"Keep recordings for (days)",-1)),M(e("input",{"onUpdate:modelValue":o[3]||(o[3]=$=>m.value=$),type:"number",min:"1",max:"365",class:"input w-24"},null,512),[[W,m.value,void 0,{number:!0}]])])):N("",!0)])]),e("div",{class:"flex items-center justify-between"},[e("button",{onClick:j,class:"btn-v2 btn-v2--secondary"}," Reset to Defaults "),e("button",{onClick:R,class:"btn-v2 btn-v2--primary"}," Save Settings ")]),e("div",Ws,[o[19]||(o[19]=e("h3",{class:"text-xs font-semibold text-preke-text-muted uppercase tracking-wide mb-4"},"About",-1)),e("div",qs,[o[18]||(o[18]=e("div",{class:"flex justify-between"},[e("span",{class:"text-preke-text-muted"},"App Version"),e("span",{class:"text-preke-text"},"2.0.0")],-1)),e("div",Js,[o[17]||(o[17]=e("span",{class:"text-preke-text-muted"},"Platform",-1)),e("span",Ks,u(p.value?"Desktop (Electron)":"Web Browser"),1)])])])]))}}),Ys={class:"h-full flex flex-col bg-preke-bg"},Zs={class:"px-6 py-4 border-b border-preke-surface-border bg-preke-surface/50 backdrop-blur-sm"},Qs={class:"flex gap-1"},en=["onClick"],tn={class:"flex-1 p-6 overflow-y-auto"},sn={key:2,class:"glass-card p-6 rounded-xl"},nn={key:3,class:"glass-card p-6 rounded-xl"},ln=O({__name:"AdminView",setup(E){const v=me(),a=S("system"),c=[{id:"system",label:"System"},{id:"status",label:"Device Status"},{id:"logs",label:"Logs"},{id:"fleet",label:"Fleet"},{id:"settings",label:"Settings"}];return U(()=>{const x=v.query.tab;x&&c.some(k=>k.id===x)&&(a.value=x)}),(x,k)=>(t(),n("div",Ys,[e("header",Zs,[k[0]||(k[0]=e("h1",{class:"text-xl font-semibold text-preke-text mb-4"},"Settings",-1)),e("div",Qs,[(t(),n(P,null,V(c,_=>e("button",{key:_.id,onClick:m=>a.value=_.id,class:A(["px-4 py-2 rounded-lg transition-all duration-200 font-medium text-sm",[a.value===_.id?"bg-preke-gold/20 text-preke-gold border border-preke-gold/30":"text-preke-text-muted hover:text-preke-text hover:bg-preke-surface"]])},u(_.label),11,en)),64))])]),e("div",tn,[a.value==="system"?(t(),q(Vs,{key:0})):a.value==="status"?(t(),q(mt,{key:1})):a.value==="logs"?(t(),n("div",sn,[k[1]||(k[1]=e("h2",{class:"text-lg font-semibold text-preke-text mb-4"},"System Logs",-1)),se(wt)])):a.value==="fleet"?(t(),n("div",nn,[se(Lt)])):a.value==="settings"?(t(),q(Xs,{key:4})):N("",!0)])]))}});export{ln as default};
