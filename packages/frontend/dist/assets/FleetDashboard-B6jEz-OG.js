import{d as I,r as p,l as w,o as R,p as S,c as o,e,f as u,F as C,z as M,q as $,B as z,t as a,I as N,n as d,y as D,i as V,k as n,_ as E}from"./index-Bbhuntdo.js";const H={class:"fleet-dashboard"},A={class:"flex items-center justify-between mb-6"},U={class:"flex items-center gap-3"},q=["disabled"],P={key:0},G={key:1},J={class:"grid grid-cols-5 gap-4 mb-6"},K=["onClick"],Q={class:"flex items-center gap-2"},O={class:"text-sm text-preke-text-dim capitalize"},W={class:"text-2xl font-semibold text-preke-text mt-1"},X={class:"flex items-center gap-4 mb-6"},Y={class:"flex-1 relative"},Z={key:0,class:"p-4 bg-preke-red/20 border border-preke-red rounded-lg text-preke-red mb-6"},ee={key:1,class:"text-center py-12"},te={key:2,class:"text-center py-12"},se={class:"text-preke-text-dim"},re={key:3,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},oe=["onClick"],ne={class:"flex items-start justify-between mb-3"},ae={class:"font-medium text-preke-text group-hover:text-preke-gold transition-colors"},le={class:"text-sm text-preke-text-dim font-mono"},ie={class:"flex items-center gap-2"},de={key:0,class:"badge badge-warning"},ue={class:"flex items-center gap-2 text-sm text-preke-text-dim mb-3"},ce={key:0,class:"text-preke-amber"},pe={key:0,class:"grid grid-cols-4 gap-2 text-center"},me={class:"p-2 bg-preke-bg-surface rounded"},xe={class:"p-2 bg-preke-bg-surface rounded"},fe={class:"p-2 bg-preke-bg-surface rounded"},ge={class:"p-2 bg-preke-bg-surface rounded"},ke={key:1,class:"flex items-center gap-2 mt-3"},_e={key:0,class:"badge badge-danger flex items-center gap-1"},ve={key:1,class:"badge badge-success"},be={class:"flex items-center justify-between mt-3 pt-3 border-t border-preke-bg-surface text-xs text-preke-text-dim"},he={key:0},ye={key:1},we=I({__name:"FleetDashboard",setup(Ce){const F=V(),f=p([]),g=p(!0),k=p(null),m=p(""),x=p(""),_=p(null),h=w(()=>{let r=f.value;if(x.value&&(r=r.filter(s=>s.status===x.value)),m.value){const s=m.value.toLowerCase();r=r.filter(t=>{var l;return t.device_id.toLowerCase().includes(s)||t.name.toLowerCase().includes(s)||((l=t.location)==null?void 0:l.toLowerCase().includes(s))})}return r}),j=w(()=>{const r={online:0,offline:0,updating:0,error:0,maintenance:0};return f.value.forEach(s=>{s.status in r&&r[s.status]++}),r});async function v(){var r;try{const s=await((r=N.fleet)==null?void 0:r.devices())||{items:[]};f.value=s.items||[],k.value=null}catch(s){k.value="Failed to load devices",console.error("Fleet fetch error:",s)}finally{g.value=!1}}function y(r){return{online:"bg-preke-green",offline:"bg-preke-text-muted",updating:"bg-preke-amber",error:"bg-preke-red",maintenance:"bg-preke-gold"}[r]||"bg-preke-text-muted"}function L(r){return{online:"text-preke-green",offline:"text-preke-text-muted",updating:"text-preke-amber",error:"text-preke-red",maintenance:"text-preke-gold"}[r]||"text-preke-text-muted"}function T(r){if(!r)return"Never";const s=new Date(r),l=new Date().getTime()-s.getTime(),i=Math.floor(l/6e4);if(i<1)return"Just now";if(i<60)return`${i}m ago`;const c=Math.floor(i/60);return c<24?`${c}h ago`:`${Math.floor(c/24)}d ago`}function B(r){F.push(`/fleet/devices/${r}`)}return R(()=>{v(),_.value=window.setInterval(v,3e4)}),S(()=>{_.value&&clearInterval(_.value)}),(r,s)=>(n(),o("div",H,[e("div",A,[s[2]||(s[2]=e("div",null,[e("h1",{class:"text-2xl font-semibold text-preke-text"},"Fleet Dashboard"),e("p",{class:"text-sm text-preke-text-dim mt-1"},"Manage and monitor all R58 devices")],-1)),e("div",U,[e("button",{onClick:v,class:"btn",disabled:g.value},[g.value?(n(),o("span",P,"Refreshing...")):(n(),o("span",G,"Refresh"))],8,q),s[1]||(s[1]=e("button",{class:"btn btn-success"}," + Add Device ",-1))])]),e("div",J,[(n(!0),o(C,null,M(j.value,(t,l)=>(n(),o("button",{key:l,onClick:i=>x.value=x.value===l?"":l,class:d(["p-4 rounded-r58 border transition-colors",x.value===l?"bg-preke-bg-surface border-preke-gold":"bg-preke-bg-elevated border-preke-bg-surface hover:border-preke-text-dim"])},[e("div",Q,[e("div",{class:d(["w-2 h-2 rounded-full",y(l)])},null,2),e("span",O,a(l),1)]),e("div",W,a(t),1)],10,K))),128))]),e("div",X,[e("div",Y,[$(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t),type:"text",placeholder:"Search devices...",class:"input w-full pl-10"},null,512),[[z,m.value]]),s[3]||(s[3]=e("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-preke-text-dim",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),k.value?(n(),o("div",Z,a(k.value),1)):u("",!0),g.value&&f.value.length===0?(n(),o("div",ee,[...s[4]||(s[4]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-preke-bg-surface border-t-preke-gold rounded-full mx-auto"},null,-1),e("p",{class:"text-preke-text-dim mt-4"},"Loading devices...",-1)])])):h.value.length===0?(n(),o("div",te,[s[5]||(s[5]=e("div",{class:"w-16 h-16 bg-preke-bg-elevated rounded-full flex items-center justify-center mx-auto mb-4"},[e("svg",{class:"w-8 h-8 text-preke-text-dim",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2z"})])],-1)),s[6]||(s[6]=e("h3",{class:"text-lg font-medium text-preke-text mb-2"},"No devices found",-1)),e("p",se,a(m.value?"Try adjusting your search or filters":"Register your first device to get started"),1)])):(n(),o("div",re,[(n(!0),o(C,null,M(h.value,t=>{var l,i,c,b;return n(),o("div",{key:t.id,onClick:Me=>B(t.device_id),class:"card hover:border-preke-text-dim cursor-pointer transition-all group"},[e("div",ne,[e("div",null,[e("h3",ae,a(t.name),1),e("p",le,a(t.device_id),1)]),e("div",ie,[t.pending_commands&&t.pending_commands>0?(n(),o("span",de,a(t.pending_commands)+" pending ",1)):u("",!0),e("span",{class:d(["flex items-center gap-1 text-xs",L(t.status)])},[e("span",{class:d(["w-1.5 h-1.5 rounded-full",y(t.status)])},null,2),D(" "+a(t.status),1)],2)])]),e("div",ue,[e("span",null,"v"+a(t.current_version||"unknown"),1),t.target_version?(n(),o("span",ce," → v"+a(t.target_version),1)):u("",!0)]),t.status==="online"?(n(),o("div",pe,[e("div",me,[s[7]||(s[7]=e("div",{class:"text-xs text-preke-text-dim"},"CPU",-1)),e("div",{class:d(["text-sm font-medium",t.cpu_percent&&t.cpu_percent>80?"text-preke-red":"text-preke-text"])},a(((l=t.cpu_percent)==null?void 0:l.toFixed(0))||"-")+"% ",3)]),e("div",xe,[s[8]||(s[8]=e("div",{class:"text-xs text-preke-text-dim"},"MEM",-1)),e("div",{class:d(["text-sm font-medium",t.mem_percent&&t.mem_percent>80?"text-preke-red":"text-preke-text"])},a(((i=t.mem_percent)==null?void 0:i.toFixed(0))||"-")+"% ",3)]),e("div",fe,[s[9]||(s[9]=e("div",{class:"text-xs text-preke-text-dim"},"DISK",-1)),e("div",{class:d(["text-sm font-medium",t.disk_free_gb&&t.disk_free_gb<2?"text-preke-red":"text-preke-text"])},a(((c=t.disk_free_gb)==null?void 0:c.toFixed(1))||"-")+"G ",3)]),e("div",ge,[s[10]||(s[10]=e("div",{class:"text-xs text-preke-text-dim"},"TEMP",-1)),e("div",{class:d(["text-sm font-medium",t.temperature_c&&t.temperature_c>70?"text-preke-red":"text-preke-text"])},a(((b=t.temperature_c)==null?void 0:b.toFixed(0))||"-")+"° ",3)])])):u("",!0),t.recording_active||t.mixer_active?(n(),o("div",ke,[t.recording_active?(n(),o("span",_e,[...s[11]||(s[11]=[e("span",{class:"w-1.5 h-1.5 bg-current rounded-full animate-pulse"},null,-1),D(" Recording ",-1)])])):u("",!0),t.mixer_active?(n(),o("span",ve," Mixer Active ")):u("",!0)])):u("",!0),e("div",be,[t.location?(n(),o("span",he,a(t.location),1)):(n(),o("span",ye,"-")),e("span",null,a(T(t.last_heartbeat)),1)])],8,oe)}),128))]))]))}}),Fe=E(we,[["__scopeId","data-v-92441c7d"]]);export{Fe as default};
