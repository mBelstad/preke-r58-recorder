import{d as p,u as g,r as _,o as x,b as m,c as d,a as t,e as y,n as f,t as h,f as k,g as C,h as S,i as a,_ as M}from"./index-DTbMnc0K.js";const B={class:"studio"},V={class:"studio__content"},A={class:"studio__modes"},E=["disabled"],z={class:"studio__mode-icon"},$={key:0,class:"animate-spin",fill:"none",viewBox:"0 0 24 24",width:"32",height:"32"},F={key:1,fill:"currentColor",viewBox:"0 0 24 24",width:"32",height:"32"},N={class:"studio__mode-info"},O={class:"studio__mode-desc"},P=["disabled"],H={class:"studio__mode-icon"},I={key:0,class:"animate-spin",fill:"none",viewBox:"0 0 24 24",width:"32",height:"32"},R={key:1,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"32",height:"32","stroke-width":"1.8"},T={class:"studio__mode-info"},j={class:"studio__mode-desc"},D={key:0,class:"studio__error"},L=p({__name:"StudioView",setup(U){const w=C(),b=g(),r=_(null),o=_(!1),c=_(null);let l=null;x(async()=>{try{(await fetch(m("/api/mode/idle"),{method:"POST"})).ok&&(console.log("[Studio] Switched to idle mode"),await b.fetchCapabilities())}catch(s){console.warn("[Studio] Failed to switch to idle mode:",s)}});async function v(s){if(o.value)return;l&&l.abort(),l=new AbortController;const e=l,n=e.signal;r.value=s,o.value=!0,c.value=null;try{const i=await fetch(m(`/api/mode/${s}`),{method:"POST",signal:n});if(n.aborted)return;if(!i.ok){const u=await i.json().catch(()=>({}));throw new Error(u.detail||`Failed to switch to ${s} mode`)}if(n.aborted)return;w.push(`/${s}`)}catch(i){if(i instanceof Error&&i.name==="AbortError"){console.log("[Studio] Mode switch cancelled by user");return}const u=i instanceof Error?i.message:"Failed to switch mode";c.value=u,S.error(u),console.error("Mode switch error:",i)}finally{l===e&&(o.value=!1,l=null)}}return(s,e)=>(a(),d("div",B,[e[10]||(e[10]=t("div",{class:"studio__bg"},[t("div",{class:"studio__orb studio__orb--1"}),t("div",{class:"studio__orb studio__orb--2"}),t("div",{class:"studio__orb studio__orb--3"})],-1)),t("div",V,[e[8]||(e[8]=t("h1",{class:"studio__title"},"Preke Studio",-1)),e[9]||(e[9]=t("p",{class:"studio__subtitle"},"Select a mode to begin",-1)),t("div",A,[t("button",{onClick:e[0]||(e[0]=n=>v("recorder")),disabled:o.value,class:f(["studio__mode studio__mode--recorder",{"studio__mode--selected":r.value==="recorder"}])},[t("div",z,[o.value&&r.value==="recorder"?(a(),d("svg",$,[...e[2]||(e[2]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(a(),d("svg",F,[...e[3]||(e[3]=[t("circle",{cx:"12",cy:"12",r:"8"},null,-1)])]))]),t("div",N,[e[4]||(e[4]=t("h3",{class:"studio__mode-title"},"Recorder",-1)),t("p",O,h(o.value&&r.value==="recorder"?"Starting recorder...":"Multi-cam ISO recording"),1)])],10,E),t("button",{onClick:e[1]||(e[1]=n=>v("mixer")),disabled:o.value,class:f(["studio__mode studio__mode--mixer",{"studio__mode--selected":r.value==="mixer"}])},[t("div",H,[o.value&&r.value==="mixer"?(a(),d("svg",I,[...e[5]||(e[5]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(a(),d("svg",R,[...e[6]||(e[6]=[k('<rect x="2" y="2" width="9" height="6" rx="1" data-v-b158fe88></rect><rect x="13" y="2" width="9" height="6" rx="1" data-v-b158fe88></rect><rect x="2" y="10" width="9" height="6" rx="1" data-v-b158fe88></rect><rect x="13" y="10" width="9" height="6" rx="1" data-v-b158fe88></rect><circle cx="12" cy="20" r="2" fill="currentColor" data-v-b158fe88></circle><path d="M9 19.5a4 4 0 0 1 6 0" stroke-linecap="round" data-v-b158fe88></path>',6)])]))]),t("div",T,[e[7]||(e[7]=t("h3",{class:"studio__mode-title"},"Mixer",-1)),t("p",j,h(o.value&&r.value==="mixer"?"Starting mixer...":"Live switching & streaming"),1)])],10,P)]),c.value?(a(),d("div",D,h(c.value),1)):y("",!0)])]))}}),G=M(L,[["__scopeId","data-v-b158fe88"]]);export{G as default};
