const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D5--Wwk3.js","assets/index-_akB68C_.css"])))=>i.map(i=>d[i]);
import{N as i}from"./index-D5--Wwk3.js";let c=null;async function u(){if(c)return c;try{const{getDeviceUrl:r}=await i(async()=>{const{getDeviceUrl:e}=await import("./index-D5--Wwk3.js").then(o=>o.a3);return{getDeviceUrl:e}},__vite__mapDeps([0,1])),a=r();if(a){const e=new AbortController,o=setTimeout(()=>e.abort(),3e3),n=await fetch(`${a}/api/config`,{signal:e.signal,mode:"cors",cache:"no-cache"});if(clearTimeout(o),n.ok){const s=await n.json();if(s.vdo_host||s.vdoninja_host)return c=s.vdo_host||s.vdoninja_host,c}}}catch{console.log("[VDO.ninja] Device does not provide VDO.ninja host configuration")}const t="r58-vdo.itagenten.no";return c=t,console.log(`[VDO.ninja] Using default host: ${t}`),t}function l(){return"https"}const d="studio",h="preke-r58-2024";function m(){var r,a;const t=`
/* R58 VDO.ninja Theme - Colors Only */
:root {
  --r58-bg: #0f172a;
  --r58-bg2: #1e293b;
  --r58-bg3: #334155;
  --r58-text: #f8fafc;
  --r58-muted: #94a3b8;
  --r58-blue: #3b82f6;
  --r58-green: #22c55e;
  --r58-gold: #f59e0b;
  --r58-border: #475569;
}
body { background: var(--r58-bg); color: var(--r58-text); }
#mainmenu, .controlButtons, #guestFeatures { background: var(--r58-bg2); }
button, .button { background: var(--r58-bg3); color: var(--r58-text); border-color: var(--r58-border); }
button:hover { background: var(--r58-blue); }
input, select, textarea { background: var(--r58-bg3); color: var(--r58-text); border-color: var(--r58-border); }
a { color: var(--r58-blue); }
.vidcon { background: var(--r58-bg2); border-color: var(--r58-border); border-radius: 8px; }
video { border-radius: 6px; }
`;if(typeof window<"u"&&((a=(r=window.location)==null?void 0:r.origin)!=null&&a.startsWith("file://")))return"";try{return"b64:"+btoa(unescape(encodeURIComponent(t)))}catch{return""}}async function b(t){const r=await u();if(!r)return null;const a=l(),e=new URL(`${a}://${r}/`);return e.searchParams.set("scene",""),e.searchParams.set("room",d),e.searchParams.set("cover",""),e.searchParams.set("quality","0"),e.searchParams.set("width","1280"),e.searchParams.set("height","720"),e.searchParams.set("cleanoutput",""),e.searchParams.set("hideheader",""),e.searchParams.set("nologo",""),e.searchParams.set("whipout",t),e.searchParams.set("autostart",""),e.searchParams.set("videodevice","0"),e.searchParams.set("audiodevice","0"),e.searchParams.set("css",m()),e.toString()}async function f(){var t;try{const{getDeviceUrl:r}=await i(async()=>{const{getDeviceUrl:e}=await import("./index-D5--Wwk3.js").then(o=>o.a3);return{getDeviceUrl:e}},__vite__mapDeps([0,1])),a=r();if(a){const e=new AbortController,o=setTimeout(()=>e.abort(),3e3),n=await fetch(`${a}/api/config`,{signal:e.signal,mode:"cors",cache:"no-cache"});if(clearTimeout(o),n.ok){const s=await n.json();if((t=s.vdo_ninja)!=null&&t.api_key)return s.vdo_ninja.api_key}}}catch{console.log("[VDO.ninja] Could not fetch API key from config")}return"preke-r58-2024-secure-key"}async function O(t={}){const r=await u();if(!r)return null;const a=l(),e=new URL(`${a}://${r}/mixer.html`),o=t.room||d;e.searchParams.set("room",o),e.searchParams.set("password",h);const n=await f();return n&&e.searchParams.set("api",n),t.mediamtxHost?e.searchParams.set("mediamtx",t.mediamtxHost):e.searchParams.set("p2p",""),e.searchParams.set("css",m()),e.toString()}function g(){if(typeof window>"u")return!1;const t=new URLSearchParams(window.location.search);if(t.has("p2p"))return t.get("p2p")!=="false";try{const r=localStorage.getItem("preke-settings");if(r&&JSON.parse(r).mixerP2P===!0)return!0}catch{}return!1}async function v(){if(g())return console.log("[VDO.ninja] P2P mode enabled - skipping MediaMTX relay"),null;if(typeof window<"u"){const t=window.location.hostname,r=window.location.port;if((t==="localhost"||t==="127.0.0.1"||t==="192.168.1.81"||t==="192.168.68.53"||t==="100.107.248.29")&&(!r||r==="80"||r===""))return console.log("[VDO.ninja] Pi kiosk detected - using app.itagenten.no for MediaMTX"),"app.itagenten.no"}try{const{getDeviceUrl:t,getFrpUrl:r}=await i(async()=>{const{getDeviceUrl:e,getFrpUrl:o}=await import("./index-D5--Wwk3.js").then(n=>n.a3);return{getDeviceUrl:e,getFrpUrl:o}},__vite__mapDeps([0,1])),a=await r();if(a)try{const e=new URL(a);return e.hostname.includes("itagenten.no")?"app.itagenten.no":e.hostname.replace("api","mediamtx")}catch{console.warn("[VDO.ninja] Failed to construct MediaMTX host from FRP URL")}}catch{}return null}async function p(t,r={}){const a=await u();if(!a)return null;const e=l(),o=new URL(`${e}://${a}/`);t===0?o.searchParams.set("scene",""):o.searchParams.set("scene",t.toString()),o.searchParams.set("room",r.room||d),o.searchParams.set("password",h),o.searchParams.set("cover",""),o.searchParams.set("cleanoutput",""),o.searchParams.set("hideheader",""),o.searchParams.set("nologo",""),o.searchParams.set("quality",(r.quality??2).toString()),r.muted&&o.searchParams.set("muted","");const n=m();return n&&o.searchParams.set("css",n),o.toString()}async function P(t=1,r){return p(t,{muted:!1,quality:2,room:r})}async function _(t=1){const r=await P(t);if(!r)return console.warn("[VDO.ninja] Cannot open popup - VDO.ninja not configured"),null;const e=window.open(r,"R58_Program_Output","width=1280,height=720,menubar=no,toolbar=no,location=no,status=no");return e||console.warn("[VDO.ninja] Popup blocked - please allow popups for this site"),e}export{d as V,p as a,b,v as c,O as d,l as e,h as f,u as g,_ as o};
