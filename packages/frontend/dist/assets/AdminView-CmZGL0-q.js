import{C as E,r as g,h,d as k,G as L,e as $,c,a as e,t as d,A as b,n as w,D as F,F as S,B as j,o as r,w as D,s as C,H as P,I,J as N,j as R,p as U,k as A}from"./index-DGUZYfnK.js";const V=E("capabilities",()=>{const f=g(null),i=g(!1),o=g(null),v=h(()=>{var s;return((s=f.value)==null?void 0:s.mixer_available)??!1}),t=h(()=>{var s;return((s=f.value)==null?void 0:s.recorder_available)??!0}),u=h(()=>{var s;return((s=f.value)==null?void 0:s.vdoninja.enabled)??!1}),l=h(()=>{if(!f.value)return 0;const s=f.value.storage_total_gb-f.value.storage_available_gb;return Math.round(s/f.value.storage_total_gb*100)});async function a(){i.value=!0,o.value=null;try{const s=await fetch("/api/v1/capabilities");if(!s.ok)throw new Error("Failed to fetch capabilities");f.value=await s.json()}catch(s){o.value=s instanceof Error?s.message:"Unknown error",console.error("Failed to fetch capabilities:",s)}finally{i.value=!1}}return{capabilities:f,loading:i,error:o,mixerEnabled:v,recorderEnabled:t,vdoNinjaEnabled:u,storagePercent:l,fetchCapabilities:a}}),B={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},M={class:"card"},T={class:"space-y-3"},O={class:"flex justify-between"},z={class:"font-mono text-sm"},G={class:"flex justify-between"},H={class:"capitalize"},q={class:"flex justify-between"},J={class:"card"},X={class:"space-y-3"},Y={class:"flex justify-between items-center"},Z={class:"flex justify-between items-center"},K={class:"card"},Q={class:"space-y-4"},W={class:"flex justify-between text-sm mb-2"},ee={class:"w-full h-3 bg-r58-bg-tertiary rounded-full overflow-hidden"},se={class:"flex justify-between text-sm"},te={class:"flex justify-between text-sm"},ne={class:"card md:col-span-2 lg:col-span-3"},ae={class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4"},oe={class:"flex items-center gap-2 mb-2"},le={class:"font-medium"},ie={class:"space-y-1 text-sm text-r58-text-secondary"},re=k({__name:"DeviceStatus",setup(f){const i=V(),{capabilities:o}=L(i);return $(()=>{i.fetchCapabilities()}),(v,t)=>{var u,l,a,s,n,_,y,x;return r(),c("div",B,[e("div",M,[t[3]||(t[3]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Device Info",-1)),e("div",T,[e("div",O,[t[0]||(t[0]=e("span",{class:"text-r58-text-secondary"},"Device ID",-1)),e("span",z,d(((u=b(o))==null?void 0:u.device_id)||"Loading..."),1)]),e("div",G,[t[1]||(t[1]=e("span",{class:"text-r58-text-secondary"},"Platform",-1)),e("span",H,d(((l=b(o))==null?void 0:l.platform)||"-"),1)]),e("div",q,[t[2]||(t[2]=e("span",{class:"text-r58-text-secondary"},"API Version",-1)),e("span",null,d(((a=b(o))==null?void 0:a.api_version)||"-"),1)])])]),e("div",J,[t[6]||(t[6]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Features",-1)),e("div",X,[e("div",Y,[t[4]||(t[4]=e("div",null,[e("span",null,"Mixer"),e("span",{class:"text-xs text-r58-text-secondary ml-1"},"(VDO.ninja)")],-1)),e("span",{class:w(["badge",b(i).mixerEnabled?"badge-success":"badge-warning"])},d(b(i).mixerEnabled?"Enabled":"Disabled"),3)]),e("div",Z,[t[5]||(t[5]=e("span",null,"Recorder",-1)),e("span",{class:w(["badge",b(i).recorderEnabled?"badge-success":"badge-warning"])},d(b(i).recorderEnabled?"Enabled":"Disabled"),3)])])]),e("div",K,[t[10]||(t[10]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Storage",-1)),e("div",Q,[e("div",null,[e("div",W,[t[7]||(t[7]=e("span",{class:"text-r58-text-secondary"},"Used",-1)),e("span",null,d(b(i).storagePercent)+"%",1)]),e("div",ee,[e("div",{class:w(["h-full rounded-full transition-all",[b(i).storagePercent>90?"bg-r58-accent-danger":b(i).storagePercent>70?"bg-r58-accent-warning":"bg-r58-accent-success"]]),style:F({width:`${b(i).storagePercent}%`})},null,6)])]),e("div",se,[t[8]||(t[8]=e("span",{class:"text-r58-text-secondary"},"Available",-1)),e("span",null,d(((n=(s=b(o))==null?void 0:s.storage_available_gb)==null?void 0:n.toFixed(1))||"0")+" GB",1)]),e("div",te,[t[9]||(t[9]=e("span",{class:"text-r58-text-secondary"},"Total",-1)),e("span",null,d(((y=(_=b(o))==null?void 0:_.storage_total_gb)==null?void 0:y.toFixed(1))||"0")+" GB",1)])])]),e("div",ne,[t[12]||(t[12]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-4"},"Hardware Inputs",-1)),e("div",ae,[(r(!0),c(S,null,j(((x=b(o))==null?void 0:x.inputs)||[],p=>(r(),c("div",{key:p.id,class:"p-4 rounded-lg bg-r58-bg-tertiary"},[e("div",oe,[t[11]||(t[11]=e("span",{class:"w-2 h-2 rounded-full bg-r58-accent-success"},null,-1)),e("span",le,d(p.label),1)]),e("div",ie,[e("p",null,"Type: "+d(p.type.toUpperCase()),1),e("p",null,"Max: "+d(p.max_resolution),1),e("p",null,"Audio: "+d(p.supports_audio?"Yes":"No"),1)])]))),128))])])])}}}),de={class:"space-y-4"},ce={class:"flex items-center gap-4 flex-wrap"},ue=["value"],pe={class:"flex items-center gap-2 cursor-pointer"},ve=["disabled"],fe={key:0},be={key:1},ge={class:"bg-r58-bg-primary rounded-lg p-4 font-mono text-sm text-r58-text-secondary h-[500px] overflow-auto whitespace-pre-wrap"},me=k({__name:"LogViewer",props:{service:{}},setup(f){const i=f,o=g(""),v=g(!1),t=g(i.service||"r58-api"),u=g(100),l=g(!1),a=[{id:"r58-api",label:"R58 API"},{id:"r58-pipeline",label:"Pipeline Manager"},{id:"mediamtx",label:"MediaMTX"}];let s=null;async function n(){v.value=!0;try{const p=await(await fetch(`/api/v1/support/logs?service=${t.value}&lines=${u.value}`)).json();o.value=p.logs||""}catch(x){o.value=`Error fetching logs: ${x}`}finally{v.value=!1}}function _(){s&&clearInterval(s),s=window.setInterval(n,5e3)}function y(){s&&(clearInterval(s),s=null)}return D(l,x=>{x?_():y()}),D([t,u],()=>{n()}),$(()=>{n()}),(x,p)=>(r(),c("div",de,[e("div",ce,[C(e("select",{"onUpdate:modelValue":p[0]||(p[0]=m=>t.value=m),class:"input"},[(r(),c(S,null,j(a,m=>e("option",{key:m.id,value:m.id},d(m.label),9,ue)),64))],512),[[P,t.value]]),C(e("select",{"onUpdate:modelValue":p[1]||(p[1]=m=>u.value=m),class:"input"},[...p[3]||(p[3]=[e("option",{value:50},"50 lines",-1),e("option",{value:100},"100 lines",-1),e("option",{value:250},"250 lines",-1),e("option",{value:500},"500 lines",-1)])],512),[[P,u.value]]),e("label",pe,[C(e("input",{type:"checkbox","onUpdate:modelValue":p[2]||(p[2]=m=>l.value=m),class:"w-4 h-4 rounded"},null,512),[[I,l.value]]),p[4]||(p[4]=e("span",{class:"text-sm"},"Auto-refresh",-1))]),e("button",{onClick:n,disabled:v.value,class:"btn"},[v.value?(r(),c("span",fe,"Loading...")):(r(),c("span",be,"Refresh"))],8,ve)]),e("pre",ge,d(o.value||"No logs available"),1)]))}}),xe={class:"space-y-6"},_e={class:"flex items-center justify-between"},ye=["disabled"],we={key:0},he={key:1},ke={key:0,class:"flex items-center justify-center py-12"},$e={key:1,class:"text-center py-12 text-r58-text-secondary"},Se={key:2,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},je=["onClick"],Ce={class:"flex items-start justify-between mb-4"},De={class:"font-semibold"},Pe={class:"text-sm text-r58-text-secondary"},Ae={class:"space-y-2 text-sm"},Ee={class:"flex justify-between"},Le={class:"font-mono"},Fe={class:"flex justify-between"},Ie=k({__name:"FleetOverview",setup(f){const i=g([]),o=g(!0),v=g(!1);async function t(){o.value=!0;try{const a=await fetch("/api/v1/lan-devices");if(a.ok){const s=await a.json();i.value=s.map(n=>({id:n.id,name:n.name,ip:n.ip,status:n.status,lastSeen:n.last_seen,version:n.api_version||"unknown"}))}}catch(a){console.error("Failed to fetch LAN devices:",a)}finally{o.value=!1}}$(t);async function u(){v.value=!0;try{const a=await fetch("/api/v1/lan-devices/scan",{method:"POST"});if(a.ok){const s=await a.json();for(const n of s)i.value.find(y=>y.id===n.id)||i.value.push({id:n.id,name:n.name,ip:n.ip,status:n.status,lastSeen:n.last_seen,version:n.api_version||"unknown"})}}catch(a){console.error("LAN network scan failed:",a)}finally{v.value=!1}}async function l(a){try{const n=await(await fetch(`/api/v1/lan-devices/${a.id}/connect`,{method:"POST"})).json();n.connected?window.open(`http://${a.ip}:8000`,"_blank"):alert(`Failed to connect: ${n.error||"Unknown error"}`)}catch(s){console.error("Failed to connect to device:",s)}}return(a,s)=>(r(),c("div",xe,[e("div",_e,[s[0]||(s[0]=e("h2",{class:"text-lg font-semibold"},"LAN Devices",-1)),e("button",{onClick:u,disabled:v.value,class:"btn"},[v.value?(r(),c("span",we,"Scanning...")):(r(),c("span",he,"Scan Network"))],8,ye)]),o.value?(r(),c("div",ke,[...s[1]||(s[1]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full"},null,-1)])])):i.value.length===0?(r(),c("div",$e,[...s[2]||(s[2]=[e("p",null,"No devices found",-1),e("p",{class:"text-sm mt-2"},'Click "Scan Network" to discover R58 devices',-1)])])):(r(),c("div",Se,[(r(!0),c(S,null,j(i.value,n=>(r(),c("div",{key:n.id,class:"card hover:border-r58-accent-primary/50 transition-colors cursor-pointer",onClick:_=>l(n)},[e("div",Ce,[e("div",null,[e("h3",De,d(n.name),1),e("p",Pe,d(n.id),1)]),e("span",{class:w(["badge",{"badge-success":n.status==="online","badge-danger":n.status==="offline","badge-warning":n.status==="unknown"}])},d(n.status),3)]),e("div",Ae,[e("div",Ee,[s[3]||(s[3]=e("span",{class:"text-r58-text-secondary"},"IP Address",-1)),e("span",Le,d(n.ip),1)]),e("div",Fe,[s[4]||(s[4]=e("span",{class:"text-r58-text-secondary"},"Version",-1)),e("span",null,d(n.version),1)])])],8,je))),128))]))]))}}),Ne={class:"h-full flex flex-col"},Re={class:"px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},Ue={class:"flex gap-2"},Ve=["onClick"],Be={class:"flex-1 p-6 overflow-y-auto"},Me={key:1,class:"card"},Te={key:2,class:"card"},Oe={key:3,class:"card space-y-6"},Ge=k({__name:"AdminView",setup(f){const i=N(),o=g("status"),v=[{id:"status",label:"Device Status"},{id:"logs",label:"Logs"},{id:"fleet",label:"Fleet"},{id:"settings",label:"Settings"}];$(()=>{const u=i.query.tab;u&&v.some(l=>l.id===u)&&(o.value=u)});async function t(){try{const l=await(await fetch("/api/v1/support/bundle",{method:"POST"})).blob(),a=URL.createObjectURL(l),s=document.createElement("a");s.href=a,s.download=`r58-support-bundle-${new Date().toISOString().slice(0,10)}.zip`,s.click(),URL.revokeObjectURL(a)}catch(u){console.error("Failed to download support bundle:",u)}}return(u,l)=>(r(),c("div",Ne,[e("header",Re,[l[0]||(l[0]=e("h1",{class:"text-xl font-semibold mb-4"},"Admin",-1)),e("div",Ue,[(r(),c(S,null,j(v,a=>e("button",{key:a.id,onClick:s=>o.value=a.id,class:w(["px-4 py-2 rounded-t-lg transition-colors",[o.value===a.id?"bg-r58-bg-primary text-r58-text-primary":"text-r58-text-secondary hover:text-r58-text-primary"]])},d(a.label),11,Ve)),64))])]),e("div",Be,[o.value==="status"?(r(),R(re,{key:0})):o.value==="logs"?(r(),c("div",Me,[l[1]||(l[1]=e("h2",{class:"text-lg font-semibold mb-4"},"System Logs",-1)),A(me)])):o.value==="fleet"?(r(),c("div",Te,[A(Ie)])):o.value==="settings"?(r(),c("div",Oe,[l[4]||(l[4]=e("div",null,[e("h2",{class:"text-lg font-semibold mb-4"},"Settings"),e("p",{class:"text-r58-text-secondary"},"Settings configuration coming soon.")],-1)),e("div",{class:"pt-4 border-t border-r58-bg-tertiary"},[l[2]||(l[2]=e("h3",{class:"font-medium mb-3"},"Support",-1)),e("button",{onClick:t,class:"btn"}," Download Support Bundle "),l[3]||(l[3]=e("p",{class:"text-sm text-r58-text-secondary mt-2"}," Downloads a ZIP file containing logs, configuration, and diagnostic information. ",-1))])])):U("",!0)])]))}});export{Ge as default};
