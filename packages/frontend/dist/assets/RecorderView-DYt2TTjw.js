import{A as L,B as M,j as V,k as ee,C as we,r as h,h as y,D as ke,d as D,E as ie,l as B,T as te,m as ne,G as Se,c as p,b as R,a as e,w as $e,x as Re,t as k,s as Ce,o as g,_ as se,H as Ie,g as P,F as G,n as w,p as q,I as ce,J as _,f as Te,e as Be,q as ue,u as Ae}from"./index-Do8M2DpQ.js";import{M as Ee}from"./ModeLoadingScreen-BcSeRWkk.js";const j=h(!1),U=h(!1);let F=null;function Me(){const b=L();M(()=>b.status,r=>{j.value=r==="recording"},{immediate:!0});function i(r){if(j.value)return r.preventDefault(),r.returnValue="Recording in progress. Are you sure you want to leave?",r.returnValue}V(()=>{window.addEventListener("beforeunload",i)}),ee(()=>{window.removeEventListener("beforeunload",i)}),we((r,o,l)=>{j.value?(F=()=>l(),U.value=!0,l(!1)):l()});function c(){U.value=!1,j.value=!1,b.stopRecording().finally(()=>{F&&(F(),F=null)})}function m(){U.value=!1,F=null}return{isGuardActive:j,showLeaveConfirmation:U,confirmLeave:c,cancelLeave:m}}const $=h(null),Q=h(!1),oe=h(null),Y=h(null),Le=10,J=2,De=25;function Ne(){const b=y(()=>$.value?$.value.available_gb<J?"critical":$.value.available_gb<Le?"warning":"ok":"unknown"),i=y(()=>$.value?$.value.available_gb>=J:!0),c=y(()=>{if(!$.value)return null;const u=$.value.available_gb*1024*1024*1024,f=De*1024*1024,s=u/f,t=Math.floor(s/3600),n=Math.floor(s%3600/60);return t>24?`${Math.floor(t/24)}d ${t%24}h`:t>0?`${t}h ${n}m`:`${n}m`}),m=y(()=>{switch(b.value){case"ok":return"emerald";case"warning":return"amber";case"critical":return"red";default:return"zinc"}}),r=y(()=>$.value?b.value==="critical"?`Disk space critically low (${$.value.available_gb.toFixed(1)} GB). Cannot start recording.`:b.value==="warning"?`Low disk space (${$.value.available_gb.toFixed(1)} GB). Estimated recording time: ${c.value}`:null:null);async function o(){Q.value=!0,Y.value=null;try{const u=await ke.getDegradation();if(u.resources&&u.resources.disk_free_gb!==void 0){const f=u.resources.disk_free_gb,s=f*3;$.value={available_gb:f,total_gb:s,used_percent:100-f/s*100,recording_path:"/opt/r58-app/shared/recordings"}}return oe.value=new Date,$.value}catch(u){return Y.value=u.message||"Failed to check disk space",console.error("Failed to check disk space:",u),null}finally{Q.value=!1}}async function l(){return await o(),$.value?b.value==="critical"?{ok:!1,message:`Insufficient disk space (${$.value.available_gb.toFixed(1)} GB). Need at least ${J} GB to start recording.`}:b.value==="warning"?{ok:!0,message:`Low disk space warning: ${$.value.available_gb.toFixed(1)} GB available. Estimated recording time: ${c.value}`}:{ok:!0}:{ok:!0,message:"Could not verify disk space. Proceeding with caution."}}return{diskSpace:$,isLoading:Q,lastCheck:oe,error:Y,status:b,statusColor:m,canStartRecording:i,estimatedRecordingTime:c,warningMessage:r,checkDiskSpace:o,preflightCheck:l}}const A=h(localStorage.getItem("r58_audio_feedback")!=="false");let X=null;function Pe(){return X||(X=new(window.AudioContext||window.webkitAudioContext)),X}function T(b,i,c="sine",m=.3){if(A.value)try{const r=Pe();r.state==="suspended"&&r.resume();const o=r.createOscillator(),l=r.createGain();o.connect(l),l.connect(r.destination),o.type=c,o.frequency.value=b;const u=r.currentTime;l.gain.setValueAtTime(0,u),l.gain.linearRampToValueAtTime(m,u+.01),l.gain.linearRampToValueAtTime(0,u+i),o.start(u),o.stop(u+i)}catch(r){console.warn("Audio feedback failed:",r)}}function je(){A.value&&(T(440,.1,"sine",.2),setTimeout(()=>T(554,.1,"sine",.2),100),setTimeout(()=>T(659,.15,"sine",.25),200))}function Fe(){A.value&&(T(880,.08,"sine",.3),setTimeout(()=>T(880,.15,"sine",.3),120))}function Ge(){A.value&&(T(659,.1,"sine",.25),setTimeout(()=>T(554,.1,"sine",.2),100),setTimeout(()=>T(440,.15,"sine",.2),200))}function Ve(){A.value&&(T(200,.15,"square",.15),setTimeout(()=>T(180,.2,"square",.15),180))}function We(){A.value&&(T(1e3,.08,"sine",.2),setTimeout(()=>T(1e3,.08,"sine",.2),150))}function le(){A.value&&T(1200,.03,"sine",.1)}function He(b=50){if(A.value&&"vibrate"in navigator)try{navigator.vibrate(b)}catch{}}function de(){function b(c){A.value=c,localStorage.setItem("r58_audio_feedback",String(c))}function i(){b(!A.value),A.value&&le()}return{enabled:A,setEnabled:b,toggle:i,playSuccess:je,playError:Ve,playWarning:We,playClick:le,playRecordStart:Fe,playRecordStop:Ge,vibrate:He}}const Ue={class:"bg-r58-bg-secondary rounded-lg shadow-xl max-w-md w-full p-6"},ze=["placeholder"],qe={class:"text-xs text-r58-text-secondary mt-2"},Oe=D({__name:"SessionNameDialog",props:{open:{type:Boolean},suggestedName:{}},emits:["confirm","cancel","skip"],setup(b,{emit:i}){const c=b,m=i,r=h(""),o=h(null),l=y(()=>{const d=new Date,a=d.toLocaleDateString("en-CA"),v=d.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}).replace(":","");return`Recording_${a}_${v}`}),u=y(()=>c.suggestedName||l.value);M(()=>c.open,d=>{d&&(r.value=u.value,setTimeout(()=>{var a,v;(a=o.value)==null||a.focus(),(v=o.value)==null||v.select()},100))});function f(){m("confirm",r.value.trim()||u.value)}function s(){m("skip")}function t(){m("cancel")}function n(d){d.key==="Enter"?f():d.key==="Escape"&&t()}return(d,a)=>(g(),ie(Se,{to:"body"},[B(te,{name:"fade"},{default:ne(()=>[b.open?(g(),p("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:Ce(t,["self"]),onKeydown:n},[e("div",Ue,[a[1]||(a[1]=e("h2",{class:"text-lg font-semibold mb-2"},"Name This Recording",-1)),a[2]||(a[2]=e("p",{class:"text-r58-text-secondary text-sm mb-4"}," Give your recording a name to find it easily later (optional). ",-1)),$e(e("input",{ref_key:"inputRef",ref:o,"onUpdate:modelValue":a[0]||(a[0]=v=>r.value=v),type:"text",placeholder:u.value,class:"w-full px-4 py-2 bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg text-r58-text-primary placeholder-r58-text-secondary focus:outline-none focus:ring-2 focus:ring-r58-accent-primary"},null,8,ze),[[Re,r.value]]),e("p",qe," Suggested: "+k(u.value),1),e("div",{class:"flex justify-between mt-6"},[e("button",{onClick:s,class:"text-sm text-r58-text-secondary hover:text-r58-text-primary transition-colors"}," Skip (use default) "),e("div",{class:"flex gap-3"},[e("button",{onClick:t,class:"btn"}," Cancel "),e("button",{onClick:f,class:"btn btn-primary"}," Start Recording ")])])])],32)):R("",!0)]),_:1})]))}}),Ke=se(Oe,[["__scopeId","data-v-df8c0a50"]]),Qe={class:"flex items-center gap-4"},Ye={key:0,class:"font-mono text-xl text-r58-accent-danger"},Je=["disabled","title"],Xe={key:0,class:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"},Ze={key:0,class:"w-3 h-3 bg-white rounded-sm"},et={key:1,class:"w-3 h-3 bg-white rounded-full"},tt={class:"text-xs text-r58-text-secondary hidden md:inline"},nt=D({__name:"RecorderControls",setup(b){const i=L(),{register:c}=Ie(),{preflightCheck:m,status:r,canStartRecording:o}=Ne(),{playRecordStart:l,playRecordStop:u,playError:f,playWarning:s,vibrate:t}=de(),n=h(null),d=h(!1),a=h(!1),v=h(!1),x=h(!1),E=h(void 0),S=y(()=>i.status==="recording"),N=y(()=>i.status==="starting"),W=y(()=>i.status==="stopping"),O=y(()=>i.formattedDuration),ge=y(()=>N.value||W.value||a.value),ve=y(()=>N.value?"Starting recording...":W.value?"Stopping recording...":a.value?"Checking disk space...":!S.value&&!o.value?"Insufficient disk space":"");let K=null;V(()=>{K=c({key:" ",description:"Toggle Recording",action:pe,context:"recorder",enabled:()=>!N.value&&!W.value})}),ee(()=>{K&&K()});async function pe(){S.value?re():await H()}async function H(C){a.value=!0;try{const I=await m();if(!I.ok){f(),t(200),P.error("Cannot start recording",I.message||"Preflight check failed");return}if(I.message&&r.value==="warning"&&(s(),P.warning("Low disk space",I.message)),x.value&&!C){E.value=void 0,v.value=!0;return}await ae(C||E.value)}finally{a.value=!1}}async function ae(C){try{await i.startRecording(C);const I=C||i.sessionId;l(),t([50,30,50]),P.success("Recording started",`Session: ${I}`)}catch(I){f(),t(200),P.error("Failed to start recording",I.message||"Unknown error",{label:"Retry",onClick:()=>H(C)})}}function me(C){v.value=!1,E.value=C,H(C)}function be(){v.value=!1,E.value=void 0,H()}function he(){v.value=!1,a.value=!1}async function ye(){try{await i.stopRecording(),u(),t(100),P.success("Recording stopped",`Duration: ${O.value}`)}catch(C){f(),t(200),P.error("Failed to stop recording",C.message||"Unknown error")}}function re(){var C;d.value=!1,(C=n.value)==null||C.open(),setTimeout(()=>{d.value=!0},500)}function xe(){d.value&&ye()}async function _e(){S.value?re():await ae()}return(C,I)=>(g(),p(G,null,[e("div",Qe,[S.value?(g(),p("div",Ye,k(O.value),1)):R("",!0),e("button",{onClick:_e,disabled:ge.value,class:w(["flex items-center gap-2 px-6 py-2 rounded-lg font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed",[S.value?"bg-r58-accent-danger hover:bg-red-600 text-white":"bg-r58-accent-success hover:bg-green-600 text-white"]]),title:ve.value||(S.value?"Stop Recording (Space)":"Start Recording (Space)")},[N.value||W.value||a.value?(g(),p("span",Xe)):(g(),p(G,{key:1},[S.value?(g(),p("span",Ze)):(g(),p("span",et))],64)),e("span",null,k(a.value?"Checking...":S.value?"Stop":"Start Recording"),1)],10,Je),e("span",tt,[I[0]||(I[0]=q(" Press ",-1)),I[1]||(I[1]=e("kbd",{class:"px-1 py-0.5 bg-r58-bg-tertiary rounded text-xs font-mono"},"Space",-1)),q(" to "+k(S.value?"stop":"start"),1)])]),B(ce,{ref_key:"stopConfirmDialog",ref:n,title:"Stop Recording?",message:`You have been recording for ${O.value}. This will finalize all files.`,"confirm-text":"Stop Recording","cancel-text":"Keep Recording",danger:!0,onConfirm:xe},null,8,["message"]),B(Ke,{open:v.value,onConfirm:me,onSkip:be,onCancel:he},null,8,["open"])],64))}}),z=h(localStorage.getItem("r58_performance_mode")==="true"),Z=h(localStorage.getItem("r58_performance_mode_auto")!=="false"),st=3,at=100,rt=500;function fe(){const b=L(),i=y(()=>z.value?!0:Z.value&&b.isRecording?b.inputs.filter(n=>n.isRecording).length>=st:!1),c=y(()=>i.value?rt:at);M(i,t=>{t?document.body.classList.add("performance-mode"):document.body.classList.remove("performance-mode")},{immediate:!0});function m(t){z.value=t,localStorage.setItem("r58_performance_mode",String(t))}function r(t){Z.value=t,localStorage.setItem("r58_performance_mode_auto",String(t))}function o(){m(!z.value)}function l(t,n){let d=0,a=null;return(...v)=>{const x=Date.now(),E=n??c.value,S=x-d;S>=E?(d=x,t(...v)):a||(a=window.setTimeout(()=>{d=Date.now(),a=null,t(...v)},E-S))}}function u(t,n){let d=null;return(...a)=>{d&&clearTimeout(d),d=window.setTimeout(()=>{t(...a),d=null},n??c.value)}}function f(t){return i.value?window.setTimeout(()=>t(performance.now()),c.value):requestAnimationFrame(t)}function s(t){i.value?clearTimeout(t):cancelAnimationFrame(t)}return{enabled:z,autoEnable:Z,isActive:i,updateInterval:c,setEnabled:m,setAutoEnable:r,toggle:o,throttle:l,debounce:u,requestFrame:f,cancelFrame:s}}const ot=["title"],lt={class:"flex items-center gap-1.5 text-sm"},it={key:0,class:"flex items-center gap-1.5 text-sm"},ct={key:1,class:"flex items-center gap-1.5 text-sm text-red-400"},ut={class:"font-mono"},dt=D({__name:"RecordingHealth",setup(b,{expose:i}){const c=L(),{isActive:m}=fe(),r=h({}),o=h(0),l=h(0),u=h(0);let f=null;function s(){const v={};let x=0;c.inputs.forEach(S=>{v[S.id]=S.bytesWritten;const N=r.value[S.id]||0;x+=S.bytesWritten-N});const E=m.value?2:1;o.value=Math.round(x/(1024*1024)/E*10)/10,r.value=v}M(()=>c.isRecording,v=>{if(v){r.value={},o.value=0,l.value=0,u.value=0;const x=m.value?2e3:1e3;f=window.setInterval(s,x)}else f&&(clearInterval(f),f=null)},{immediate:!0}),M(m,v=>{if(c.isRecording&&f){clearInterval(f);const x=v?2e3:1e3;f=window.setInterval(s,x)}}),ee(()=>{f&&clearInterval(f)});const t=y(()=>c.isRecording?u.value>0||l.value>90?"critical":o.value<1||l.value>70?"warning":"healthy":"idle"),n=y(()=>{switch(t.value){case"healthy":return"emerald";case"warning":return"amber";case"critical":return"red";default:return"zinc"}});y(()=>{switch(t.value){case"healthy":return"Healthy";case"warning":return"Warning";case"critical":return"Critical";default:return"Idle"}});const d=y(()=>{if(!c.isRecording)return"Not recording";const v=[`Write speed: ${o.value} MB/s`,`Buffer: ${l.value}%`];return u.value>0&&v.push(`Frames dropped: ${u.value}`),v.join(`
`)});function a(v){v.buffer_percent!==void 0&&(l.value=v.buffer_percent),v.frames_dropped!==void 0&&(u.value=v.frames_dropped)}return i({updateFromMetrics:a}),(v,x)=>_(c).isRecording?(g(),p("div",{key:0,class:w(["flex items-center gap-3 px-3 py-1.5 rounded-lg transition-colors cursor-help",{"bg-emerald-500/10":n.value==="emerald","bg-amber-500/10":n.value==="amber","bg-red-500/10":n.value==="red"}]),title:d.value},[e("span",{class:w(["w-2 h-2 rounded-full",n.value==="emerald"?"bg-emerald-500":"",n.value==="amber"?"bg-amber-500 animate-pulse":"",n.value==="red"?"bg-red-500 animate-pulse":""])},null,2),e("div",lt,[x[0]||(x[0]=e("svg",{class:"w-3.5 h-3.5 text-r58-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1)),e("span",{class:w(["font-mono",n.value==="emerald"?"text-emerald-400":"",n.value==="amber"?"text-amber-400":"",n.value==="red"?"text-red-400":""])},k(o.value)+" MB/s ",3)]),l.value>0?(g(),p("div",it,[x[1]||(x[1]=e("span",{class:"text-r58-text-secondary"},"Buf:",-1)),e("span",{class:w(["font-mono",l.value<50?"text-emerald-400":"",l.value>=50&&l.value<80?"text-amber-400":"",l.value>=80?"text-red-400":""])},k(l.value)+"% ",3)])):R("",!0),u.value>0?(g(),p("div",ct,[x[2]||(x[2]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),e("span",ut,k(u.value)+" dropped",1)])):R("",!0)],10,ot)):R("",!0)}}),ft={class:"relative w-full h-full bg-black"},gt={key:0,class:"absolute inset-0 flex items-center justify-center bg-black/50"},vt={key:1,class:"absolute inset-0 flex items-center justify-center bg-black/80"},pt={class:"text-center text-r58-text-secondary"},mt={class:"text-sm"},bt=D({__name:"InputPreview",props:{inputId:{},protocol:{}},setup(b){const i=b,c=L(),m=y(()=>c.status==="recording"),r=h(null),o=h(!0),l=h(null);function u(){return Te(`/${i.inputId}/whep`)}let f=null;async function s(){if(r.value){f&&(f.close(),f=null),o.value=!0,l.value=null;try{const t=u(),n=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]});f=n,n.ontrack=x=>{r.value&&x.streams[0]&&(r.value.srcObject=x.streams[0],o.value=!1)},n.oniceconnectionstatechange=()=>{(n.iceConnectionState==="failed"||n.iceConnectionState==="disconnected")&&(l.value="Connection lost")},n.addTransceiver("video",{direction:"recvonly"}),n.addTransceiver("audio",{direction:"recvonly"});const d=await n.createOffer();await n.setLocalDescription(d);const a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/sdp"},body:d.sdp});if(!a.ok)throw new Error(`WHEP request failed: ${a.status}`);const v=await a.text();await n.setRemoteDescription({type:"answer",sdp:v})}catch(t){console.error("WHEP playback error:",t),l.value=t instanceof Error?t.message:"Failed to connect",o.value=!1}}}return V(()=>{s()}),M(()=>i.inputId,()=>{s()}),M(m,(t,n)=>{n&&!t&&l.value?(console.log("[InputPreview] Recording stopped, reconnecting preview..."),s()):!n&&t&&(console.log("[InputPreview] Recording started, will try to reconnect preview after delay..."),setTimeout(()=>{m.value&&(console.log("[InputPreview] Attempting to reconnect preview during recording..."),s())},2e3))}),(t,n)=>(g(),p("div",ft,[e("video",{ref_key:"videoRef",ref:r,autoplay:"",muted:"",playsinline:"",class:"w-full h-full object-contain"},null,512),o.value?(g(),p("div",gt,[...n[0]||(n[0]=[e("div",{class:"animate-spin w-6 h-6 border-2 border-white border-t-transparent rounded-full"},null,-1)])])):R("",!0),l.value?(g(),p("div",vt,[e("div",pt,[e("p",mt,k(l.value),1),e("button",{onClick:s,class:"mt-2 text-xs text-r58-accent-primary hover:underline"}," Retry ")])])):R("",!0)]))}}),ht={key:0,class:"h-full flex items-center justify-center"},yt={key:1,class:"h-full flex flex-col gap-2"},xt={key:0,class:"flex items-center gap-2 px-3 py-1.5 bg-amber-500/10 border border-amber-500/30 rounded-lg text-amber-400 text-sm"},_t=["title"],wt={class:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/80 to-transparent p-4"},kt={class:"flex items-center justify-between"},St={class:"flex items-center gap-2"},$t={class:"font-medium"},Rt={key:0,class:"flex items-center gap-2 text-sm"},Ct={class:"text-r58-text-secondary"},It={key:0,class:"mt-2 flex items-center justify-between"},Tt={class:"text-sm font-mono text-r58-text-secondary"},Bt=D({__name:"InputGrid",setup(b){const i=L(),c=y(()=>i.inputs.filter(s=>s.hasSignal)),m=y(()=>i.framerateMismatch);function r(s){return s.isRecording?"border-r58-accent-danger ring-2 ring-r58-accent-danger/20":s.hasSignal?"border-emerald-500/50 hover:border-emerald-500":"border-r58-bg-tertiary/50 opacity-60"}function o(s){return s.hasSignal?s.framerate>=29?"excellent":s.framerate>=24?"good":"unstable":"none"}function l(s){switch(o(s)){case"excellent":return"text-emerald-400";case"good":return"text-emerald-400";case"unstable":return"text-amber-400";case"none":return"text-r58-text-secondary"}}function u(s){if(s===0)return"0 B";const t=1024,n=["B","KB","MB","GB"],d=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,d)).toFixed(1))+" "+n[d]}function f(s){if(!s.hasSignal)return`${s.label}: No signal detected`;const t=[`${s.label}`,`Resolution: ${s.resolution}`,`Framerate: ${s.framerate} fps`,`Quality: ${o(s)}`];return s.isRecording&&t.push(`Written: ${u(s.bytesWritten)}`),t.join(`
`)}return(s,t)=>c.value.length===0?(g(),p("div",ht,[...t[0]||(t[0]=[Be('<div class="text-center text-r58-text-secondary"><svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg><p class="text-lg font-medium">No Video Sources Connected</p><p class="text-sm mt-2">Connect HDMI cables to begin recording</p></div>',1)])])):(g(),p("div",yt,[m.value?(g(),p("div",xt,[t[1]||(t[1]=e("svg",{class:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),e("span",null,k(m.value),1)])):R("",!0),e("div",{class:w(["flex-1 grid gap-4",c.value.length===1?"grid-cols-1":"grid-cols-2"])},[(g(!0),p(G,null,ue(c.value,n=>(g(),p("div",{key:n.id,class:w(["relative rounded-lg overflow-hidden border-2 transition-all cursor-pointer aspect-video bg-black",r(n)]),title:f(n)},[B(bt,{"input-id":n.id,class:"w-full h-full"},null,8,["input-id"]),e("div",wt,[e("div",kt,[e("div",St,[e("span",{class:w(["w-2 h-2 rounded-full transition-colors",{"bg-emerald-500":o(n)==="excellent"||o(n)==="good","bg-amber-500 animate-pulse":o(n)==="unstable","bg-r58-text-secondary":o(n)==="none"}])},null,2),e("span",$t,k(n.label),1)]),n.hasSignal?(g(),p("div",Rt,[e("span",Ct,k(n.resolution),1),e("span",{class:w(l(n))},k(n.framerate)+"fps",3)])):R("",!0)]),n.isRecording?(g(),p("div",It,[t[2]||(t[2]=e("div",{class:"flex items-center gap-2 text-r58-accent-danger"},[e("span",{class:"w-2 h-2 rounded-full bg-r58-accent-danger animate-recording"}),e("span",{class:"text-sm font-medium"},"REC")],-1)),e("span",Tt,k(u(n.bytesWritten)),1)])):R("",!0)])],10,_t))),128))],2)]))}}),At={class:"space-y-4"},Et={class:"flex items-center justify-between py-2 cursor-pointer"},Mt=["aria-checked"],Lt={class:"flex items-center justify-between py-2 cursor-pointer"},Dt=["aria-checked"],Nt={class:"flex items-center justify-between py-2 cursor-pointer"},Pt={class:"text-xs text-r58-text-secondary"},jt={key:0,class:"text-amber-400"},Ft=["aria-checked"],Gt={class:"flex items-center justify-between py-2 pl-4 cursor-pointer opacity-80"},Vt=["aria-checked"],Wt=D({__name:"SettingsPanel",setup(b){const{enabled:i,toggle:c,playClick:m}=de(),{enabled:r,autoEnable:o,isActive:l,setEnabled:u,setAutoEnable:f}=fe(),s=h(!1);function t(){s.value=!s.value,s.value?(document.body.classList.add("touch-mode"),localStorage.setItem("r58_touch_mode","true")):(document.body.classList.remove("touch-mode"),localStorage.setItem("r58_touch_mode","false"))}V(()=>{const d=localStorage.getItem("r58_touch_mode")==="true";s.value=d,d&&document.body.classList.add("touch-mode")});function n(){c(),i.value&&m()}return(d,a)=>(g(),p("div",At,[a[7]||(a[7]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide"}," Interface Settings ",-1)),e("label",Et,[a[2]||(a[2]=e("div",null,[e("span",{class:"text-r58-text-primary"},"Audio Feedback"),e("p",{class:"text-xs text-r58-text-secondary"},"Play sounds for recording start/stop")],-1)),e("button",{onClick:n,class:w(["relative w-12 h-7 rounded-full transition-colors",_(i)?"bg-r58-accent-primary":"bg-r58-bg-tertiary"]),role:"switch","aria-checked":_(i)},[e("span",{class:w(["absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform",_(i)?"translate-x-6":"translate-x-1"])},null,2)],10,Mt)]),e("label",Lt,[a[3]||(a[3]=e("div",null,[e("span",{class:"text-r58-text-primary"},"Touch Mode"),e("p",{class:"text-xs text-r58-text-secondary"},"Larger buttons for touchscreen")],-1)),e("button",{onClick:t,class:w(["relative w-12 h-7 rounded-full transition-colors",s.value?"bg-r58-accent-primary":"bg-r58-bg-tertiary"]),role:"switch","aria-checked":s.value},[e("span",{class:w(["absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform",s.value?"translate-x-6":"translate-x-1"])},null,2)],10,Dt)]),e("label",Nt,[e("div",null,[a[5]||(a[5]=e("span",{class:"text-r58-text-primary"},"Performance Mode",-1)),e("p",Pt,[a[4]||(a[4]=q(" Reduce UI updates during recording ",-1)),_(l)&&!_(r)?(g(),p("span",jt,"(auto-enabled)")):R("",!0)])]),e("button",{onClick:a[0]||(a[0]=v=>_(u)(!_(r))),class:w(["relative w-12 h-7 rounded-full transition-colors",_(r)?"bg-r58-accent-primary":"bg-r58-bg-tertiary"]),role:"switch","aria-checked":_(r)},[e("span",{class:w(["absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform",_(r)?"translate-x-6":"translate-x-1"])},null,2)],10,Ft)]),e("label",Gt,[a[6]||(a[6]=e("div",null,[e("span",{class:"text-sm text-r58-text-primary"},"Auto-enable when recording 3+ inputs")],-1)),e("button",{onClick:a[1]||(a[1]=v=>_(f)(!_(o))),class:w(["relative w-10 h-6 rounded-full transition-colors",_(o)?"bg-r58-accent-primary":"bg-r58-bg-tertiary"]),role:"switch","aria-checked":_(o)},[e("span",{class:w(["absolute top-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform",_(o)?"translate-x-4":"translate-x-0.5"])},null,2)],10,Vt)])]))}}),Ht={class:"space-y-6"},Ut={key:0,class:"card"},zt={class:"space-y-2"},qt={class:"flex justify-between"},Ot={class:"flex justify-between"},Kt={class:"font-mono"},Qt={class:"flex justify-between"},Yt={class:"card"},Jt={class:"space-y-3"},Xt={class:"flex items-center gap-2"},Zt={key:0,class:"text-sm text-r58-text-secondary"},en={key:0,class:"text-r58-accent-danger"},tn={key:1},nn={key:1,class:"text-sm text-r58-text-secondary"},sn={class:"card"},an={class:"space-y-2"},rn=["disabled","title"],on={key:0,class:"absolute -top-8 left-1/2 -translate-x-1/2 px-2 py-1 bg-r58-bg-tertiary text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none"},ln={key:0,class:"card"},cn=D({__name:"SessionInfo",setup(b){const i=Ae(),c=L(),m=y(()=>c.currentSession),r=y(()=>c.activeInputs),o=y(()=>c.isRecording),l=h(!1);function u(s){if(s===0)return"0 B";const t=1024,n=["B","KB","MB","GB","TB"],d=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,d)).toFixed(2))+" "+n[d]}function f(){i.push({name:"admin",query:{tab:"settings"}})}return(s,t)=>(g(),p("div",Ht,[m.value?(g(),p("div",Ut,[t[4]||(t[4]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Current Session",-1)),e("div",zt,[e("div",qt,[t[1]||(t[1]=e("span",{class:"text-r58-text-secondary"},"Started",-1)),e("span",null,k(m.value.startedAt.toLocaleTimeString()),1)]),e("div",Ot,[t[2]||(t[2]=e("span",{class:"text-r58-text-secondary"},"Duration",-1)),e("span",Kt,k(_(c).formattedDuration),1)]),e("div",Qt,[t[3]||(t[3]=e("span",{class:"text-r58-text-secondary"},"Inputs",-1)),e("span",null,k(r.value.length)+" active",1)])])])):R("",!0),e("div",Yt,[t[5]||(t[5]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Input Status",-1)),e("div",Jt,[(g(!0),p(G,null,ue(_(c).inputs,n=>(g(),p("div",{key:n.id,class:"flex items-center justify-between py-2 border-b border-r58-bg-tertiary last:border-0"},[e("div",Xt,[e("span",{class:w(["w-2 h-2 rounded-full",n.hasSignal?"bg-r58-accent-success":"bg-r58-text-secondary"])},null,2),e("span",{class:w(n.hasSignal?"":"text-r58-text-secondary")},k(n.label),3)]),n.hasSignal?(g(),p("div",Zt,[n.isRecording?(g(),p("span",en,k(u(n.bytesWritten)),1)):(g(),p("span",tn,k(n.resolution),1))])):(g(),p("span",nn,"No signal"))]))),128))])]),e("div",sn,[t[7]||(t[7]=e("h3",{class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},"Quick Actions",-1)),e("div",an,[e("button",{onClick:f,class:"btn w-full justify-center disabled:opacity-50 disabled:cursor-not-allowed group relative",disabled:o.value,title:o.value?"Cannot configure while recording":"Open input configuration"},[t[6]||(t[6]=q(" Configure Inputs ",-1)),o.value?(g(),p("span",on," Stop recording first ")):R("",!0)],8,rn),e("button",{onClick:t[0]||(t[0]=n=>l.value=!l.value),class:"btn w-full justify-center"},k(l.value?"Hide Settings":"Interface Settings"),1)])]),B(te,{name:"slide-fade"},{default:ne(()=>[l.value?(g(),p("div",ln,[B(Wt)])):R("",!0)]),_:1})]))}}),un=se(cn,[["__scopeId","data-v-8910ebdc"]]),dn={class:"h-full flex flex-col"},fn={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},gn={class:"flex items-center gap-4"},vn={class:"flex items-center gap-2"},pn={key:0,class:"badge badge-danger"},mn={class:"flex-1 flex overflow-hidden"},bn={class:"flex-1 p-4"},hn={class:"w-80 border-l border-r58-bg-tertiary bg-r58-bg-secondary p-4 overflow-y-auto"},yn=D({__name:"RecorderView",setup(b){const i=L(),{showLeaveConfirmation:c,confirmLeave:m,cancelLeave:r}=Me(),o=y(()=>i.status==="recording"),l=y(()=>i.formattedDuration),u=h(!0),f=h(!1);function s(){u.value=!1}V(async()=>{await i.fetchInputs(),await i.fetchStatus(),f.value=!0});const t=h(null);return M(c,n=>{var d,a;n?(d=t.value)==null||d.open():(a=t.value)==null||a.close()}),(n,d)=>(g(),p(G,null,[B(te,{name:"fade"},{default:ne(()=>[u.value?(g(),ie(Ee,{key:0,mode:"recorder","content-ready":f.value,"min-time":1500,"max-time":6e3,onReady:s},null,8,["content-ready"])):R("",!0)]),_:1}),e("div",dn,[e("header",fn,[e("div",gn,[e("div",vn,[e("span",{class:w(["w-3 h-3 rounded-full",o.value?"bg-r58-accent-danger animate-recording":"bg-r58-bg-tertiary"])},null,2),d[0]||(d[0]=e("span",{class:"text-xl font-semibold"},"Recorder",-1))]),o.value?(g(),p("span",pn,"RECORDING")):R("",!0),B(dt)]),B(nt)]),e("div",mn,[e("div",bn,[B(Bt)]),e("aside",hn,[B(un)])]),B(ce,{ref_key:"leaveDialog",ref:t,title:"Recording in Progress",message:`You are currently recording (${l.value}). Leaving will stop the recording and save all files.`,"confirm-text":"Leave and Stop Recording","cancel-text":"Stay",danger:!0,onConfirm:_(m),onCancel:_(r)},null,8,["message","onConfirm","onCancel"])])],64))}}),wn=se(yn,[["__scopeId","data-v-3d0e61bc"]]);export{wn as default};
