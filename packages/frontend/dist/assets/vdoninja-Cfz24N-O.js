const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CSAxumLz.js","assets/index-Domh98PJ.css"])))=>i.map(i=>d[i]);
import{a5 as O}from"./index-CSAxumLz.js";let w=null;async function m(){if(w)return w;try{const{getDeviceUrl:r}=await O(async()=>{const{getDeviceUrl:n}=await import("./index-CSAxumLz.js").then(t=>t.ad);return{getDeviceUrl:n}},__vite__mapDeps([0,1])),o=r();if(o){const n=new AbortController,t=setTimeout(()=>n.abort(),3e3),a=await fetch(`${o}/api/config`,{signal:n.signal,mode:"cors",cache:"no-cache"});if(clearTimeout(t),a.ok){const c=await a.json();if(c.vdo_host||c.vdoninja_host)return w=c.vdo_host||c.vdoninja_host,w}}}catch{console.log("[VDO.ninja] Device does not provide VDO.ninja host configuration")}const e="app.itagenten.no";return w=e,console.log(`[VDO.ninja] Using default host: ${e}`),e}function p(){return"https"}async function P(){return await m()==="app.itagenten.no"?"/vdo":""}const h="studio",d="preke-r58-2024";function b(){var r,o;const e=`
/* R58 VDO.ninja Theme - Colors Only */
:root {
  --r58-bg: #0f172a;
  --r58-bg2: #1e293b;
  --r58-bg3: #334155;
  --r58-text: #f8fafc;
  --r58-muted: #94a3b8;
  --r58-blue: #3b82f6;
  --r58-green: #22c55e;
  --r58-gold: #f59e0b;
  --r58-border: #475569;
}
body { background: var(--r58-bg); color: var(--r58-text); }
#mainmenu, .controlButtons, #guestFeatures { background: var(--r58-bg2); }
button, .button { background: var(--r58-bg3); color: var(--r58-text); border-color: var(--r58-border); }
button:hover { background: var(--r58-blue); }
input, select, textarea { background: var(--r58-bg3); color: var(--r58-text); border-color: var(--r58-border); }
a { color: var(--r58-blue); }
.vidcon { background: var(--r58-bg2); border-color: var(--r58-border); border-radius: 8px; }
video { border-radius: 6px; }
`;if(typeof window<"u"&&((o=(r=window.location)==null?void 0:r.origin)!=null&&o.startsWith("file://")))return"";try{return btoa(unescape(encodeURIComponent(e)))}catch{return""}}async function R(e,r){const o=await m();if(!o)return null;const n=p(),t=await P(),a=new URL(`${n}://${o}${t}/`);return a.searchParams.set("room",h),a.searchParams.set("push",e.toLowerCase().replace(/\s+/g,"-")),a.searchParams.set("label",e),a.searchParams.set("webcam",""),a.searchParams.set("mic",""),a.searchParams.set("quality","1"),a.toString()}async function L(e,r,o,n={}){const t=await m();if(!t)return null;const a=p(),c=await P(),i=new URL(`${a}://${t}${c}/`);if(i.searchParams.set("whepplay",r),i.searchParams.set("push",e),i.searchParams.set("room",h),i.searchParams.set("password",d),i.searchParams.set("label",o),i.searchParams.set("autostart","true"),i.searchParams.set("stereo","2"),i.searchParams.set("whepwait","2000"),n.useMediamtx!==!1){const s=await v();s&&i.searchParams.set("mediamtx",s)}const u=b();u&&i.searchParams.set("b64css",u);const f=i.toString();return console.log(`[VDO.ninja] Camera contribution URL for ${e}: room=${h}, password=${d.substring(0,4)}...`),f}async function x(e){const r=await m();if(!r)return null;const o=p(),n=await P(),t=new URL(`${o}://${r}${n}/`);t.searchParams.set("scene",""),t.searchParams.set("room",h),t.searchParams.set("cover",""),t.searchParams.set("quality","0"),t.searchParams.set("width","1280"),t.searchParams.set("height","720"),t.searchParams.set("cleanoutput",""),t.searchParams.set("hideheader",""),t.searchParams.set("nologo",""),t.searchParams.set("whipout",e),t.searchParams.set("autostart",""),t.searchParams.set("videodevice","0"),t.searchParams.set("audiodevice","0");const a=b();return a&&t.searchParams.set("b64css",a),t.toString()}async function T(e){const r=await m();if(!r)return null;const o=p(),n=await P(),t=new URL(`${o}://${r}${n}/`);t.searchParams.set("scene","0"),t.searchParams.set("layout",""),t.searchParams.set("remote",""),t.searchParams.set("room",h),t.searchParams.set("password",d),t.searchParams.set("cleanviewer",""),t.searchParams.set("chroma","000"),t.searchParams.set("ssar","landscape"),t.searchParams.set("nosettings",""),t.searchParams.set("showlabels",""),t.searchParams.set("prefercurrenttab",""),t.searchParams.set("selfbrowsersurface","include"),t.searchParams.set("displaysurface","browser"),t.searchParams.set("np",""),t.searchParams.set("publish",""),t.searchParams.set("quality","1"),t.searchParams.set("screenshareaspectratio","1.7777777777777777"),t.searchParams.set("locked","1.7777777777777777"),t.searchParams.set("maxvideobitrate","2500"),t.searchParams.set("totalroombitrate","6000");const a=await v()||"app.itagenten.no";{let i=a;if(!a.includes("://")){const u=a==="localhost"||a==="127.0.0.1"||a.startsWith("192.168.")||a.startsWith("10.")||a.startsWith("172.")?"http":"https";i=a.includes(":")?`${u}://${a}`:`${u}://${a}:8889`}t.searchParams.set("mediamtx",i)}const c=b();return c&&t.searchParams.set("b64css",c),t.toString()}async function y(){var e;try{const{getDeviceUrl:r}=await O(async()=>{const{getDeviceUrl:n}=await import("./index-CSAxumLz.js").then(t=>t.ad);return{getDeviceUrl:n}},__vite__mapDeps([0,1])),o=r();if(o){const n=new AbortController,t=setTimeout(()=>n.abort(),3e3),a=await fetch(`${o}/api/config`,{signal:n.signal,mode:"cors",cache:"no-cache"});if(clearTimeout(t),a.ok){const c=await a.json();if((e=c.vdo_ninja)!=null&&e.api_key)return c.vdo_ninja.api_key}}}catch{console.log("[VDO.ninja] Could not fetch API key from config")}return"preke-r58-2024-secure-key"}async function j(e={}){const r=await m();if(!r)return null;const o=p(),n=await P(),t=new URL(`${o}://${r}${n}/mixer.html`),a=e.room||h;t.searchParams.set("room",a),t.searchParams.set("director",a),t.searchParams.set("password",d);const c=await y();c&&t.searchParams.set("api",c),e.useMediamtx!==!1&&e.mediamtxHost&&t.searchParams.set("mediamtx",e.mediamtxHost),t.searchParams.set("totalroombitrate","6000"),t.searchParams.set("maxvideobitrate","2000");const i=b();i&&t.searchParams.set("b64css",i);const l=t.toString();return console.log(`[VDO.ninja] Mixer URL: room=${a}, director=${a}, password=${d.substring(0,4)}...`),l}async function v(){try{const{getFrpUrl:e}=await O(async()=>{const{getFrpUrl:o}=await import("./index-CSAxumLz.js").then(n=>n.ad);return{getFrpUrl:o}},__vite__mapDeps([0,1])),r=await e();if(r)try{const o=new URL(r);return o.hostname.includes("itagenten.no")?"app.itagenten.no":o.hostname.replace("api","mediamtx")}catch{console.warn("[VDO.ninja] Failed to construct MediaMTX host from FRP URL")}}catch{}return null}async function H(e){const{getDeviceUrl:r,getFallbackUrl:o,getFrpUrl:n}=await O(async()=>{const{getDeviceUrl:s,getFallbackUrl:g,getFrpUrl:U}=await import("./index-CSAxumLz.js").then(_=>_.ad);return{getDeviceUrl:s,getFallbackUrl:g,getFrpUrl:U}},__vite__mapDeps([0,1])),t=s=>`${s.replace(/\/+$/,"")}/${e}/whep`,a=s=>`http://${s}:8889/${e}/whep`,c=s=>{if(s==="localhost"||s==="127.0.0.1"||s.endsWith(".local")||s.startsWith("192.168.")||s.startsWith("10."))return!0;if(s.startsWith("172.")){const g=Number(s.split(".")[1]);return g>=16&&g<=31}return!1},i=s=>s.startsWith("100.")||s.endsWith(".ts.net"),l=r();if(l)try{const s=new URL(l);if(c(s.hostname))return console.log(`[VDO.ninja] Using LAN WHEP for ${e}`),a(s.hostname)}catch{}if(l)try{const s=new URL(l);if(i(s.hostname))return console.log(`[VDO.ninja] Using Tailscale WHEP for ${e}`),a(s.hostname)}catch{}const u=o();if(u)try{const s=new URL(u);if(i(s.hostname))return console.log(`[VDO.ninja] Using Tailscale fallback WHEP for ${e}`),a(s.hostname)}catch{}const f=await n();if(f)try{const s=new URL(f);return s.hostname.includes("itagenten.no")?`https://app.itagenten.no/${e}/whep`:t(s.toString())}catch{console.warn("[VDO.ninja] Failed to construct MediaMTX WHEP URL")}if(l)try{const s=new URL(l);if(s.hostname.includes("itagenten.no"))return console.log(`[VDO.ninja] Using device URL as WHEP proxy for ${e}`),`https://app.itagenten.no/${e}/whep`;if(!c(s.hostname)&&!i(s.hostname))return console.log(`[VDO.ninja] Using public device URL for ${e}`),t(s.toString())}catch{}return console.log(`[VDO.ninja] Using hardcoded app.itagenten.no for ${e}`),`https://app.itagenten.no/${e}/whep`}async function D(e,r={}){const o=await m();if(!o)return null;const n=p(),t=await P(),a=new URL(`${n}://${o}${t}/`);e===0?a.searchParams.set("scene",""):a.searchParams.set("scene",e.toString()),a.searchParams.set("room",r.room||h),a.searchParams.set("password",d),a.searchParams.set("cover",""),a.searchParams.set("cleanoutput",""),a.searchParams.set("hideheader",""),a.searchParams.set("nologo",""),a.searchParams.set("quality",(r.quality??2).toString()),r.muted&&a.searchParams.set("muted","");const c=b();return c&&a.searchParams.set("b64css",c),a.toString()}async function $(e=0,r){return D(e,{muted:!1,quality:2,room:r})}async function C(e=1){const r=await $(e);if(!r)return console.warn("[VDO.ninja] Cannot open popup - VDO.ninja not configured"),null;const n=window.open(r,"R58_Program_Output","width=1280,height=720,menubar=no,toolbar=no,location=no,status=no");return n||console.warn("[VDO.ninja] Popup blocked - please allow popups for this site"),n}export{h as V,x as a,T as b,D as c,H as d,L as e,d as f,m as g,v as h,j as i,p as j,R as k,C as o};
