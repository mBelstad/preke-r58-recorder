import{K as Ue,r as R,h as N,L as oe,M as ue,A as pe,B as se,j as ve,V as He,d as Z,c as o,b as P,a as e,F as W,q as J,n as H,w as X,x as ne,N as Me,t as $,J as G,y as ge,o as t,_ as le,O as Se,e as be,E as me,p as Q,G as ye,g as B,v as fe,l as te,k as xe,P as Ie,Q as Re,s as we,H as Le,R as Ne,m as Be,T as ze}from"./index-Du1Po2dy.js";import{b as Fe,a as Ge,g as Ke,c as We,d as Ee,e as Ye,f as Je,h as qe,V as De}from"./vdoninja-BQjZGN5S.js";import{M as Xe}from"./ModeLoadingScreen-BaYSB_om.js";const ce=[{id:"youtube",name:"YouTube Live",icon:"â–¶ï¸",rtmpBaseUrl:"rtmp://a.rtmp.youtube.com/live2/",streamKeyPlaceholder:"xxxx-xxxx-xxxx-xxxx-xxxx",helpUrl:"https://support.google.com/youtube/answer/2907883"},{id:"twitch",name:"Twitch",icon:"ðŸ“º",rtmpBaseUrl:"rtmp://live.twitch.tv/app/",streamKeyPlaceholder:"live_xxxxxxxxxx_xxxxxxxxxxxxxx",helpUrl:"https://help.twitch.tv/s/article/twitch-stream-key-faq"},{id:"facebook",name:"Facebook Live",icon:"ðŸ“˜",rtmpBaseUrl:"rtmps://live-api-s.facebook.com:443/rtmp/",streamKeyPlaceholder:"FB-xxxxxxxxxx-x",helpUrl:"https://www.facebook.com/help/587160588142067"},{id:"restream",name:"Restream",icon:"ðŸ”„",rtmpBaseUrl:"rtmp://live.restream.io/live/",streamKeyPlaceholder:"re_xxxxxx_xxxxxxxxxx",helpUrl:"https://support.restream.io/en/"},{id:"custom",name:"Custom RTMP",icon:"âš™ï¸",rtmpBaseUrl:"",streamKeyPlaceholder:"your-stream-key"}],he=Ue("streaming",()=>{const I=R([]),r=R(!1),s=R(null),m=R({enabled:!1,host:"",port:8890,streamId:"mixer_program"}),i=N(()=>I.value.find(v=>v.id===s.value)),p=N(()=>I.value.filter(v=>v.enabled)),C=N(()=>ce),a=N(()=>{const v=window.location.hostname,U=v==="localhost"||v==="127.0.0.1"?"localhost":v.replace("r58-api","r58-mediamtx");return{rtmp:`rtmp://${U}:1935/mixer_program`,rtsp:`rtsp://${U}:8554/mixer_program`,srt:`srt://${U}:8890?streamid=read:mixer_program`,hls:`https://${v}/hls/mixer_program/index.m3u8`,whep:`${window.location.origin}/api/v1/whep/mixer_program/whep`}});function c(v,d){const U=ce.find(l=>l.id===v);if(!U)throw new Error(`Unknown platform: ${v}`);const _={id:`dest-${Date.now()}`,platformId:v,name:d||U.name,streamKey:"",enabled:!1};return I.value.push(_),_}function b(v,d){const U=I.value.findIndex(_=>_.id===v);U!==-1&&(I.value[U]={...I.value[U],...d})}function S(v){const d=I.value.findIndex(U=>U.id===v);d!==-1&&I.value.splice(d,1),s.value===v&&(s.value=null)}function u(v){s.value=v}function j(v){m.value.enabled=v}function f(v){m.value={...m.value,...v}}function M(){r.value=!0}function w(){r.value=!1}function x(v){const d=ce.find(U=>U.id===v.platformId);return d?v.platformId==="custom"?`${v.name}${v.streamKey}`:`${d.rtmpBaseUrl}${v.streamKey}`:""}function L(){const v=window.location.hostname;return`srt://${v==="localhost"||v==="127.0.0.1"?"localhost":v.replace("r58-api","r58-mediamtx")}:${m.value.port}?streamid=read:${m.value.streamId}`}function T(){try{const v=localStorage.getItem("r58-streaming-destinations");if(v){const d=JSON.parse(v);I.value=d.destinations||[],d.srtOutput&&(m.value={...m.value,...d.srtOutput})}}catch(v){console.warn("Failed to load saved streaming destinations:",v)}}function n(){try{localStorage.setItem("r58-streaming-destinations",JSON.stringify({destinations:I.value,srtOutput:m.value}))}catch(v){console.warn("Failed to save streaming destinations:",v)}}return T(),{destinations:I,isStreaming:r,activeDestinationId:s,srtOutput:m,activeDestination:i,enabledDestinations:p,platforms:C,programOutputUrls:a,addDestination:c,updateDestination:b,removeDestination:S,setActiveDestination:u,toggleSrtOutput:j,updateSrtConfig:f,startStreaming:M,stopStreaming:w,buildRtmpUrl:x,getSrtOutputUrl:L,saveDestinations:n,loadSavedDestinations:T}});function Qe(I){const r=oe(),s=ue();pe();const m=R(!1),i=R(!1),p=R(null),C=R(new Map);function a(){return I.value}function c(){var h,E;const g=a();return g?((h=g.isReady)==null?void 0:h.value)===!0||((E=g.connectionState)==null?void 0:E.value)==="connected"?!0:i.value:!1}function b(g){return g.slots.filter(h=>h.sourceId).map(h=>h.sourceId)}function S(g){const h=a();if(!h){console.warn("[MixerController] VDO.ninja embed not available");return}c()||console.log("[MixerController] VDO.ninja may not be fully ready, attempting anyway"),console.log("[MixerController] Applying scene to VDO:",g.name,"- VDO Scene:",g.vdoSceneNumber,"- Layout:",He[g.layoutPreset]||g.layoutPreset);try{h.setLayout(g.layoutPreset);const E=b(g);for(const y of E)h.addToScene(y,g.vdoSceneNumber);p.value=g.id,console.log("[MixerController] Scene applied successfully:",g.name,"- Sources:",E.length)}catch(E){console.error("[MixerController] Error applying scene to VDO:",E)}}function u(g){const h=s.getScene(g);h&&S(h)}async function j(){const g=r.previewSceneId;if(!g)return;const h=s.getScene(g);h&&(S(h),await r.take())}function f(){const g=r.previewSceneId;if(!g)return;const h=s.getScene(g);h&&(S(h),r.cut())}function M(g,h){const E=a();if(!E||!c())return;const y=r.previewSceneId?s.getScene(r.previewSceneId):null,D=(y==null?void 0:y.vdoSceneNumber)||1;if(E.addToScene(g,D),r.previewSceneId&&y){const V=h??y.slots.findIndex(A=>!A.sourceId);if(V>=0&&V<y.slots.length){const A=y.slots[V].id;s.updateSlot(r.previewSceneId,A,{sourceId:g})}}}function w(g){const h=a();!h||!c()||h.removeFromScene(g)}function x(g){const h=a();!h||!c()||h.setProgram(g)}function L(g,h){const E=a();E&&c()&&E.setMute(g,h),r.setSourceMute(g,h)}function T(g){const h=a();h&&c()&&h.toggleMute(g);const E=r.sources.find(y=>y.id===g);E&&r.setSourceMute(g,!E.muted)}function n(g,h){const E=a();E&&c()&&E.setVolume(g,h*2),r.setSourceVolume(g,h)}function v(g,h){const E=a();E&&c()&&h&&E.sendCommand("soloChat",g),r.setSourceSolo(g,h)}function d(g){const h=a();h&&c()&&h.kickGuest(g),r.removeSource(g)}function U(g,h){const E=a();E&&c()&&E.sendCommand("sendChat",g,h)}function _(g){const h=a();if(h&&c()){const E=r.previewSceneId?s.getScene(r.previewSceneId):null,y=(E==null?void 0:E.vdoSceneNumber)||1;h.addToScene(g,y)}r.admitFromGreenroom(g)}function l(){const g=a();g&&c()&&g.startRecording()}function k(){const g=a();g&&c()&&g.stopRecording()}function z(g,h,E){const y=a();y&&c()&&y.sendCommand(g,h,E)}return se(()=>{var g,h;return(h=(g=I.value)==null?void 0:g.isReady)==null?void 0:h.value},g=>{if(m.value=g===!0,g){if(console.log("[MixerController] VDO.ninja connected"),r.setVdoConnected(!0),i.value=!0,r.programSceneId){const h=s.getScene(r.programSceneId);h&&h.id!==p.value&&S(h)}}else r.setVdoConnected(!1)},{immediate:!0}),se(()=>{var g,h;return(h=(g=I.value)==null?void 0:g.sourcesVersion)==null?void 0:h.value},()=>{var E,y;const g=(y=(E=I.value)==null?void 0:E.sources)==null?void 0:y.value;if(!g||g.size===0)return;const h=a();if(h){for(const[D,V]of g)if(!C.value.has(D)){console.log(`[MixerController] Auto-adding source ${D} (${V.label}) to scene 1`);try{h.addToScene(D,1),C.value.set(D,1),console.log(`[MixerController] Successfully added ${D} to scene 1`)}catch(A){console.error(`[MixerController] Failed to add ${D} to scene:`,A)}}for(const[D]of C.value)g.has(D)||(console.log(`[MixerController] Source ${D} disconnected, removing from tracking`),C.value.delete(D))}},{immediate:!0}),ve(()=>{setTimeout(()=>{!i.value&&I.value&&(console.log("[MixerController] Fallback initialization (timeout)"),i.value=!0,m.value=!0,r.setVdoConnected(!0))},6e3)}),se(()=>r.programSceneId,g=>{if(g&&g!==p.value){const h=s.getScene(g);h&&c()&&S(h)}}),se(()=>{var g,h;return(h=(g=I.value)==null?void 0:g.lastError)==null?void 0:h.value},g=>{g&&r.setLastError(g)}),{isConnected:m,isInitialized:i,applySceneToVdo:S,switchToScene:u,takeToProgram:j,cutToProgram:f,addSourceToScene:M,removeSourceFromScene:w,setSourceAsProgram:x,setMute:L,toggleMute:T,setVolume:n,setSolo:v,kickGuest:d,sendMessage:U,admitFromGreenroom:_,startRecording:l,stopRecording:k,sendDirectorCommand:z}}const Ze={class:"source-panel space-y-4","data-testid":"source-panel"},et={key:0,class:"px-3 py-2 bg-amber-500/10 border border-amber-500/30 rounded-lg text-xs text-amber-400"},tt={key:1,class:"text-center py-6 text-r58-text-secondary"},ot={key:2,class:"space-y-2"},nt={class:"flex items-center gap-3"},st={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},rt={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},it={key:2,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},at={key:3,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},lt={class:"flex-1 min-w-0"},dt={key:0,class:"flex items-center gap-1"},ct=["onDblclick"],ut={class:"flex items-center gap-2 text-xs text-r58-text-secondary"},vt={key:0,class:"text-red-400 font-bold"},mt={key:1,class:"text-amber-400"},pt={class:"flex items-center gap-1 flex-shrink-0"},gt=["onClick"],xt=["onClick","title"],ft={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},bt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},yt={key:0,class:"mt-2"},ht={class:"h-1 bg-r58-bg-primary rounded-full overflow-hidden"},je="preke-source-names",wt=Z({__name:"SourcePanel",props:{vdoEmbed:{},controller:{}},setup(I){function r(){try{const _=localStorage.getItem(je);return _?JSON.parse(_):{}}catch{return{}}}function s(_,l){const k=r();k[_]=l,localStorage.setItem(je,JSON.stringify(k))}const m=R(r()),i=R(null),p=R(""),C=I,a=oe(),c=ue(),b=pe(),S={cam0:{name:"HDMI 1",subtitle:"Connected to device"},cam1:{name:"HDMI 2",subtitle:"Connected to device"},cam2:{name:"HDMI 3",subtitle:"Connected to device"},cam3:{name:"HDMI 4",subtitle:"Connected to device"}},u=N(()=>a.sources.map(_=>{let l=_.label,k="VDO.ninja";const z=_.id.match(/cam(\d+)/i)||_.id.match(/hdmi[_-]?(\d+)/i);return z?(l=`HDMI ${parseInt(z[1])+1}`,k="Connected to device"):_.type==="guest"?(k="Remote guest",(!_.label||_.label.length>20||_.label.match(/^[a-z0-9]{8,}$/i))&&(l="Guest")):_.type==="screen"&&(k="Screen share"),{..._,label:l,subtitle:k}})),j=N(()=>b.inputs.filter(_=>_.hasSignal).map(_=>{const l=S[_.id]||{name:_.label,subtitle:"HDMI Input"};return{id:_.id,label:l.name,subtitle:l.subtitle,type:"camera",hasVideo:!0,hasAudio:!0,muted:!1,audioLevel:0}})),f=N(()=>{const _=new Map;for(const l of j.value)_.set(l.id,l);for(const l of u.value){const k=_.get(l.id);k?_.set(l.id,{...k,...l,subtitle:l.subtitle||k.subtitle}):_.set(l.id,l)}return Array.from(_.values())}),M=N(()=>u.value.length===0&&j.value.length>0);function w(_){const l=c.getScene(a.previewSceneId||"");return(l==null?void 0:l.slots.some(k=>k.sourceId===_))||!1}function x(_){return a.liveSourceIds.includes(_)}function L(_){var l,k;C.controller?C.controller.toggleMute(_.id):(C.vdoEmbed&&((k=(l=C.vdoEmbed).toggleMute)==null||k.call(l,_.id)),a.setSourceMute(_.id,!_.muted))}function T(_){const l=c.getScene(a.previewSceneId||"");if(!l)return;C.controller&&C.controller.addSourceToScene(_.id);const k=l.slots.find(z=>!z.sourceId);k&&c.assignSourceToSlot(l.id,k.id,_.id)}function n(_){return m.value[_.id]||_.label}function v(_){i.value=_.id,p.value=m.value[_.id]||_.label}function d(){i.value&&p.value.trim()&&(s(i.value,p.value.trim()),m.value=r()),i.value=null}function U(){i.value=null,p.value=""}return(_,l)=>(t(),o("div",Ze,[M.value?(t(),o("div",et," Showing HDMI cameras. VDO.ninja sources will appear when connected. ")):P("",!0),f.value.length===0?(t(),o("div",tt,[...l[1]||(l[1]=[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),e("p",{class:"text-sm"},"No sources connected",-1),e("p",{class:"text-xs mt-1 opacity-75"},"Connect HDMI or invite guests",-1)])])):(t(),o("div",ot,[(t(!0),o(W,null,J(f.value,k=>(t(),o("div",{key:k.id,class:H(["source-card p-3 rounded-lg transition-all",[x(k.id)?"bg-red-500/10 border border-red-500/30":w(k.id)?"bg-amber-500/10 border border-amber-500/30":"bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 border border-transparent"]])},[e("div",nt,[e("div",{class:H(["w-10 h-10 rounded-lg bg-r58-bg-primary flex items-center justify-center flex-shrink-0",{"ring-2 ring-red-500":x(k.id),"ring-2 ring-amber-500":w(k.id)&&!x(k.id)}])},[k.type==="camera"?(t(),o("svg",st,[...l[2]||(l[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])):k.type==="guest"?(t(),o("svg",rt,[...l[3]||(l[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])])):k.type==="screen"?(t(),o("svg",it,[...l[4]||(l[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},null,-1)])])):(t(),o("svg",at,[...l[5]||(l[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"},null,-1)])]))],2),e("div",lt,[i.value===k.id?(t(),o("div",dt,[X(e("input",{"onUpdate:modelValue":l[0]||(l[0]=z=>p.value=z),onKeyup:[Me(d,["enter"]),Me(U,["escape"])],onBlur:d,class:"input text-sm py-0.5 px-1 w-full",autofocus:""},null,544),[[ne,p.value]])])):(t(),o("p",{key:1,onDblclick:z=>v(k),class:"font-medium text-sm truncate cursor-pointer hover:text-r58-accent-primary",title:"Double-click to rename"},$(n(k)),41,ct)),e("div",ut,[e("span",null,$(k.subtitle),1),x(k.id)?(t(),o("span",vt,"LIVE")):w(k.id)?(t(),o("span",mt,"PVW")):P("",!0)])]),e("div",pt,[G(a).previewSceneId&&!w(k.id)?(t(),o("button",{key:0,onClick:z=>T(k),class:"p-1.5 rounded hover:bg-r58-bg-primary transition-colors text-r58-text-secondary hover:text-r58-accent-primary",title:"Add to preview scene"},[...l[6]||(l[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,gt)):P("",!0),k.hasAudio?(t(),o("button",{key:1,onClick:z=>L(k),class:H(["p-1.5 rounded transition-colors",k.muted?"bg-red-500/20 text-red-400":"hover:bg-r58-bg-primary text-r58-text-secondary"]),title:k.muted?"Unmute":"Mute"},[k.muted?(t(),o("svg",ft,[...l[7]||(l[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(t(),o("svg",bt,[...l[8]||(l[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],10,xt)):P("",!0)])]),k.hasAudio?(t(),o("div",yt,[e("div",ht,[e("div",{class:H(["h-full transition-all duration-75 rounded-full",k.muted?"bg-r58-bg-tertiary":k.audioLevel>80?"bg-red-500":k.audioLevel>60?"bg-amber-500":"bg-emerald-500"]),style:ge({width:`${k.audioLevel||0}%`})},null,6)])])):P("",!0)],2))),128))]))]))}}),kt=le(wt,[["__scopeId","data-v-bdd0be29"]]),St={class:"preview-program-view h-full flex flex-col","data-testid":"preview-program-view"},_t={class:"flex-1 flex gap-4 min-h-0"},$t={class:"flex-1 flex flex-col min-w-0"},Ct={class:"flex items-center justify-between mb-2"},Mt={key:0,class:"text-xs text-r58-text-secondary"},It=["src"],Rt={key:1,class:"absolute bottom-2 left-2 right-2 flex items-center justify-between pointer-events-none"},Et={class:"px-2 py-1 bg-black/70 rounded text-xs text-white"},Dt={class:"px-2 py-1 bg-black/70 rounded text-xs text-amber-400"},jt={key:2,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary"},Vt={key:3,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},Tt={class:"flex flex-col items-center justify-center gap-3 px-2"},Lt=["disabled"],Pt={key:0,class:"animate-pulse"},Ot={key:1},At=["disabled"],Ut={class:"flex flex-col gap-1 mt-2"},Ht=["value"],Nt=["value"],Bt={class:"flex-1 flex flex-col min-w-0"},zt={class:"flex items-center justify-between mb-2"},Ft={class:"flex items-center gap-2"},Gt={key:0,class:"px-2 py-0.5 bg-red-600 text-white text-xs font-bold rounded animate-pulse"},Kt={key:0,class:"text-xs text-r58-text-secondary"},Wt=["src"],Yt={key:1,class:"absolute bottom-2 left-2 right-2 flex items-center justify-between pointer-events-none"},Jt={class:"px-2 py-1 bg-black/70 rounded text-xs text-white"},qt={key:0,class:"px-2 py-1 bg-red-600/90 rounded text-xs text-white font-bold"},Xt={key:2,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary"},Qt={key:3,class:"absolute top-2 left-2 flex items-center gap-2 pointer-events-none"},Zt={key:4,class:"absolute inset-0 flex items-center justify-center text-r58-text-secondary"},eo=Z({__name:"PreviewProgramView",props:{vdoEmbed:{},controller:{}},emits:["take","cut"],setup(I,{emit:r}){const s=I,m=r,i=oe(),p=ue(),C=R(i.transition.type),a=R(i.transition.duration),c=R(!1),b=R(!1),S=N(()=>p.getScene(i.previewSceneId||"")),u=N(()=>p.getScene(i.programSceneId||"")),j=N(()=>i.previewSceneId!==null&&i.previewSceneId!==i.programSceneId&&!i.isTransitioning),f=N(()=>i.isLive),M=N(()=>S.value?Fe(S.value.vdoSceneNumber):null),w=N(()=>Ge(0));se([C,a],([v,d])=>{i.setTransition({type:v,duration:d})});function x(){j.value&&(s.controller?s.controller.takeToProgram():i.take(),m("take"))}function L(){i.previewSceneId&&(s.controller?s.controller.cutToProgram():i.cut(),m("cut"))}const T=[{value:"cut",label:"CUT"},{value:"fade",label:"FADE"},{value:"wipe-left",label:"WIPE L"},{value:"wipe-right",label:"WIPE R"}],n=[{value:100,label:"0.1s"},{value:300,label:"0.3s"},{value:500,label:"0.5s"},{value:1e3,label:"1.0s"}];return(v,d)=>(t(),o("div",St,[e("div",_t,[e("div",$t,[e("div",Ct,[d[4]||(d[4]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-xs font-bold uppercase tracking-wider text-amber-400"},"PVW"),e("span",{class:"text-xs text-r58-text-secondary"},"Preview")],-1)),S.value?(t(),o("span",Mt,$(S.value.name),1)):P("",!0)]),e("div",{class:H(["flex-1 bg-black rounded-lg overflow-hidden border-2 transition-colors relative",S.value?"border-amber-500/50":"border-r58-bg-tertiary"])},[M.value?(t(),o("iframe",{key:0,src:M.value,class:H(["absolute inset-0 w-full h-full border-0",{"opacity-0":!c.value}]),allow:"autoplay; fullscreen",onLoad:d[0]||(d[0]=U=>c.value=!0)},null,42,It)):P("",!0),S.value?(t(),o("div",Rt,[e("span",Et," Scene "+$(S.value.vdoSceneNumber)+": "+$(S.value.name),1),e("span",Dt,$(S.value.slots.filter(U=>U.sourceId).length)+"/"+$(S.value.slots.length)+" sources ",1)])):P("",!0),S.value&&!c.value?(t(),o("div",jt,[...d[5]||(d[5]=[e("div",{class:"animate-spin w-6 h-6 border-2 border-amber-400 border-t-transparent rounded-full"},null,-1)])])):P("",!0),S.value?P("",!0):(t(),o("div",Vt,[...d[6]||(d[6]=[e("div",{class:"text-center"},[e("svg",{class:"w-8 h-8 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]),e("p",{class:"text-sm"},"Select a scene to preview")],-1)])]))],2)]),e("div",Tt,[e("button",{onClick:x,disabled:!j.value,class:H(["take-button w-20 h-16 rounded-lg font-bold text-lg transition-all",j.value?"bg-red-600 hover:bg-red-500 text-white shadow-lg shadow-red-500/30":"bg-r58-bg-tertiary text-r58-text-secondary cursor-not-allowed"]),"data-testid":"take-button"},[G(i).isTransitioning?(t(),o("span",Pt,"...")):(t(),o("span",Ot,"TAKE"))],10,Lt),e("button",{onClick:L,disabled:!G(i).previewSceneId,class:H(["w-20 h-10 rounded-lg font-bold text-sm transition-all",G(i).previewSceneId?"bg-r58-bg-tertiary hover:bg-r58-accent-primary text-r58-text-primary":"bg-r58-bg-tertiary/50 text-r58-text-secondary cursor-not-allowed"]),"data-testid":"cut-button"}," CUT ",10,At),e("div",Ut,[X(e("select",{"onUpdate:modelValue":d[1]||(d[1]=U=>C.value=U),class:"w-20 px-2 py-1 text-xs bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-center"},[(t(),o(W,null,J(T,U=>e("option",{key:U.value,value:U.value},$(U.label),9,Ht)),64))],512),[[Se,C.value]]),X(e("select",{"onUpdate:modelValue":d[2]||(d[2]=U=>a.value=U),class:"w-20 px-2 py-1 text-xs bg-r58-bg-tertiary border border-r58-bg-tertiary rounded text-center"},[(t(),o(W,null,J(n,U=>e("option",{key:U.value,value:U.value},$(U.label),9,Nt)),64))],512),[[Se,a.value,void 0,{number:!0}]])])]),e("div",Bt,[e("div",zt,[e("div",Ft,[e("span",{class:H(["text-xs font-bold uppercase tracking-wider",f.value?"text-red-500":"text-r58-text-secondary"])}," PGM ",2),d[7]||(d[7]=e("span",{class:"text-xs text-r58-text-secondary"},"Program",-1)),f.value?(t(),o("span",Gt," LIVE ")):P("",!0)]),u.value?(t(),o("span",Kt,$(u.value.name),1)):P("",!0)]),e("div",{class:H(["flex-1 bg-black rounded-lg overflow-hidden border-2 transition-colors relative",f.value?"border-red-500":u.value?"border-emerald-500/50":"border-r58-bg-tertiary"])},[w.value?(t(),o("iframe",{key:0,src:w.value,class:H(["absolute inset-0 w-full h-full border-0",{"opacity-0":!b.value}]),allow:"autoplay; fullscreen",onLoad:d[3]||(d[3]=U=>b.value=!0)},null,42,Wt)):P("",!0),u.value?(t(),o("div",Yt,[e("span",Jt,$(u.value.name),1),f.value?(t(),o("span",qt," ON AIR ")):P("",!0)])):P("",!0),b.value?P("",!0):(t(),o("div",Xt,[...d[8]||(d[8]=[e("div",{class:"animate-spin w-6 h-6 border-2 border-emerald-400 border-t-transparent rounded-full"},null,-1)])])),f.value?(t(),o("div",Qt,[...d[9]||(d[9]=[e("div",{class:"w-3 h-3 rounded-full bg-red-500 animate-recording"},null,-1)])])):P("",!0),!u.value&&!b.value?(t(),o("div",Zt,[...d[10]||(d[10]=[be('<div class="text-center" data-v-003871a7><svg class="w-8 h-8 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-003871a7><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" data-v-003871a7></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-003871a7></path></svg><p class="text-sm" data-v-003871a7>Waiting for program...</p></div>',1)])])):P("",!0)],2)])])]))}}),to=le(eo,[["__scopeId","data-v-003871a7"]]),oo={class:"scene-strip","data-testid":"scene-strip"},no={class:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin"},so=["onClick","onDblclick","onContextmenu","data-testid"],ro={class:"relative aspect-video bg-r58-bg-tertiary rounded-lg overflow-hidden"},io={class:"absolute inset-0"},ao={key:0,class:"absolute top-1 left-1 w-5 h-5 flex items-center justify-center bg-r58-bg-primary/80 rounded text-xs font-mono font-bold"},lo={key:1,class:"absolute top-1 right-1 flex items-center gap-1 px-1.5 py-0.5 bg-red-600 rounded text-xs font-bold"},co={key:2,class:"absolute top-1 right-1 px-1.5 py-0.5 bg-amber-500 rounded text-xs font-bold text-black"},uo={class:"mt-1 text-xs text-center truncate text-r58-text-secondary"},vo=["disabled"],mo=Z({__name:"SceneStrip",emits:["edit-scene","add-scene"],setup(I,{emit:r}){const s=r,m=ue(),i=oe(),p=R(null),C=R({x:0,y:0}),a=R(!1),c=N(()=>m.scenes),b=N(()=>i.previewSceneId),S=N(()=>i.programSceneId);function u(T){i.mode==="simple"?i.setProgramScene(T.id):i.setPreviewScene(T.id)}function j(T){i.setProgramScene(T.id),B.info(`Scene: ${T.name}`)}function f(T,n){T.preventDefault(),p.value=n,C.value={x:T.clientX,y:T.clientY},a.value=!0;const v=()=>{a.value=!1,document.removeEventListener("click",v)};setTimeout(()=>document.addEventListener("click",v),0)}function M(T){a.value=!1,s("edit-scene",T)}function w(T){a.value=!1;const n=m.duplicateScene(T.id);n&&B.success(`Duplicated: ${n.name}`)}function x(T){if(a.value=!1,c.value.length<=1){B.error("Cannot delete the last scene");return}if(T.id===S.value){B.error("Cannot delete scene that is on program");return}m.deleteScene(T.id),B.info(`Deleted: ${T.name}`)}function L(T){return T.id===S.value?"ring-2 ring-red-500 ring-offset-2 ring-offset-r58-bg-primary":T.id===b.value?"ring-2 ring-amber-500 ring-offset-1 ring-offset-r58-bg-primary":"hover:ring-2 hover:ring-r58-accent-primary/50"}return(T,n)=>{var v;return t(),o("div",oo,[e("div",no,[(t(!0),o(W,null,J(c.value,(d,U)=>(t(),o("div",{key:d.id,class:H(["scene-thumbnail flex-shrink-0 w-28 cursor-pointer transition-all",L(d)]),onClick:_=>u(d),onDblclick:_=>j(d),onContextmenu:_=>f(_,d),"data-testid":`scene-${d.id}`},[e("div",ro,[e("div",io,[(t(!0),o(W,null,J(d.slots,_=>(t(),o("div",{key:_.id,class:"absolute bg-r58-bg-secondary border border-r58-bg-tertiary/30",style:ge({left:`${_.position.x}%`,top:`${_.position.y}%`,width:`${_.position.w}%`,height:`${_.position.h}%`})},null,4))),128))]),U<8?(t(),o("div",ao,$(U+1),1)):P("",!0),d.id===S.value?(t(),o("div",lo,[...n[4]||(n[4]=[e("div",{class:"w-1.5 h-1.5 rounded-full bg-white animate-pulse"},null,-1),Q(" PGM ",-1)])])):d.id===b.value?(t(),o("div",co," PVW ")):P("",!0)]),e("p",uo,$(d.name),1)],42,so))),128)),e("button",{onClick:n[0]||(n[0]=d=>s("add-scene")),class:"flex-shrink-0 w-28 aspect-video bg-r58-bg-tertiary/50 hover:bg-r58-bg-tertiary rounded-lg border-2 border-dashed border-r58-bg-tertiary hover:border-r58-accent-primary/50 flex items-center justify-center transition-colors","data-testid":"add-scene-button"},[...n[5]||(n[5]=[e("div",{class:"text-center text-r58-text-secondary"},[e("svg",{class:"w-6 h-6 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs"},"Add Scene")],-1)])])]),(t(),me(ye,{to:"body"},[a.value&&p.value?(t(),o("div",{key:0,class:"fixed z-50 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg shadow-xl py-1 min-w-[140px]",style:ge({left:`${C.value.x}px`,top:`${C.value.y}px`})},[e("button",{onClick:n[1]||(n[1]=d=>M(p.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-r58-bg-tertiary flex items-center gap-2"},[...n[6]||(n[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),Q(" Edit ",-1)])]),e("button",{onClick:n[2]||(n[2]=d=>w(p.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-r58-bg-tertiary flex items-center gap-2"},[...n[7]||(n[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),Q(" Duplicate ",-1)])]),n[9]||(n[9]=e("div",{class:"border-t border-r58-bg-tertiary my-1"},null,-1)),e("button",{onClick:n[3]||(n[3]=d=>x(p.value)),class:"w-full px-3 py-2 text-left text-sm hover:bg-red-500/20 text-red-400 flex items-center gap-2",disabled:((v=p.value)==null?void 0:v.id)===S.value},[...n[8]||(n[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Q(" Delete ",-1)])],8,vo)],4)):P("",!0)]))])}}}),po=le(mo,[["__scopeId","data-v-627912a1"]]),go={class:"mixer-workspace h-full flex flex-col","data-testid":"mixer-workspace"},xo={class:"flex-1 flex gap-4 min-h-0 p-4"},fo={key:0,class:"text-sm font-medium"},bo={class:"h-[calc(100%-48px)] overflow-y-auto scrollbar-thin"},yo={class:"space-y-2"},ho=["title"],wo={class:"flex-1 flex flex-col min-w-0"},ko={class:"flex-1 min-h-0"},So={class:"mt-4 pt-4 border-t border-r58-bg-tertiary"},_o=Z({__name:"MixerWorkspace",props:{vdoEmbed:{},controller:{}},emits:["edit-scene","add-scene"],setup(I,{emit:r}){const s=r,m=oe();ue();const i=R(!1);function p(){i.value=!i.value}function C(S){s("edit-scene",S)}function a(){s("add-scene")}function c(){console.log("[Workspace] Take executed")}function b(){console.log("[Workspace] Cut executed")}return(S,u)=>(t(),o("div",go,[e("div",xo,[e("aside",{class:H(["sources-panel flex-shrink-0 transition-all duration-300 overflow-hidden",i.value?"w-12":"w-64"])},[e("button",{onClick:p,class:"w-full mb-3 flex items-center justify-between px-3 py-2 bg-r58-bg-tertiary rounded-lg hover:bg-r58-bg-tertiary/80 transition-colors"},[i.value?P("",!0):(t(),o("span",fo,"Sources")),(t(),o("svg",{class:H(["w-4 h-4 transition-transform",{"rotate-180":i.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...u[0]||(u[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"},null,-1)])],2))]),X(e("div",bo,[te(kt,{"vdo-embed":I.vdoEmbed,controller:I.controller},null,8,["vdo-embed","controller"])],512),[[fe,!i.value]]),X(e("div",yo,[(t(!0),o(W,null,J(G(m).connectedSources.slice(0,6),j=>(t(),o("div",{key:j.id,class:"w-8 h-8 mx-auto rounded bg-r58-bg-tertiary flex items-center justify-center text-xs",title:j.label},$(j.label.charAt(0)),9,ho))),128))],512),[[fe,i.value]])],2),e("div",wo,[e("div",ko,[te(to,{"vdo-embed":I.vdoEmbed,controller:I.controller,onTake:c,onCut:b},null,8,["vdo-embed","controller"])]),e("div",So,[u[1]||(u[1]=be('<div class="flex items-center justify-between mb-2" data-v-87ccc636><h3 class="text-sm font-medium text-r58-text-secondary" data-v-87ccc636>Scenes</h3><div class="flex items-center gap-2 text-xs text-r58-text-secondary" data-v-87ccc636><span data-v-87ccc636>Click = Preview</span><span class="opacity-50" data-v-87ccc636>|</span><span data-v-87ccc636>Double-click = Live</span><span class="opacity-50" data-v-87ccc636>|</span><span data-v-87ccc636>Right-click = Menu</span></div></div>',1)),te(po,{onEditScene:C,onAddScene:a})])])])]))}}),$o=le(_o,[["__scopeId","data-v-87ccc636"]]),_e="vdo-debug",Co=500,re=[];let $e=typeof localStorage<"u"&&localStorage.getItem(_e)==="true";function Ve(I){$e=I,typeof localStorage<"u"&&(I?localStorage.setItem(_e,"true"):localStorage.removeItem(_e)),console.log(`[VDO.ninja Debug] ${I?"Enabled":"Disabled"}`)}function ke(I){if(re.push(I),re.length>Co&&re.shift(),$e){const r=new Date(I.timestamp).toISOString().split("T")[1].slice(0,-1),s=I.direction==="outgoing"?"âž¡ï¸ OUT":"â¬…ï¸ IN",m=I.direction==="outgoing"?"color: #3b82f6; font-weight: bold":"color: #22c55e; font-weight: bold";console.groupCollapsed(`%c[VDO.ninja ${s}] %c${I.type}`,m,"color: inherit"),console.log("Time:",r),I.target&&console.log("Target:",I.target),console.log("Data:",I.data),I.raw&&I.raw!==I.data&&console.log("Raw:",I.raw),console.groupEnd()}}function Pe(){return[...re]}function Mo(){re.length=0,console.log("[VDO.ninja Debug] Event history cleared")}function Oe(){const I={total:re.length,incoming:0,outgoing:0,byType:{},lastActivity:re.length>0?re[re.length-1].timestamp:null};for(const r of re)r.direction==="incoming"?I.incoming++:I.outgoing++,I.byType[r.type]=(I.byType[r.type]||0)+1;return I}typeof window<"u"&&(window.__VDO_DEBUG__={getHistory:Pe,clearHistory:Mo,getStats:Oe,enable:()=>Ve(!0),disable:()=>Ve(!1),isEnabled:()=>$e});function Io(I){const r=R(!1),s=R(new Map),m=R(0),i=R(null),p=R(!1),C=R("disconnected"),a=R(null),c=Ke();function b(O,F,K,ae){var Y;if(!((Y=I.value)!=null&&Y.contentWindow)){console.warn("[VDO.ninja] Cannot send command - iframe not ready"),a.value="iframe not ready";return}const q={action:O};F&&(q.target=F),K!==void 0&&(q.value=K),ae!==void 0&&(q.value2=ae),ke({timestamp:Date.now(),direction:"outgoing",type:O,target:F,data:{action:O,target:F,value:K,value2:ae},raw:q});try{I.value.contentWindow.postMessage(q,"*")}catch(ee){console.error("[VDO.ninja] Failed to send command:",ee),a.value=String(ee)}}function S(O,F){var ae;if(!((ae=I.value)!=null&&ae.contentWindow)){console.warn("[VDO.ninja] Cannot send DOM command - iframe not ready");return}const K={action:"",target:O,...F};ke({timestamp:Date.now(),direction:"outgoing",type:"dom-manipulation",target:O,data:F,raw:K});try{I.value.contentWindow.postMessage(K,"*")}catch(q){console.error("[VDO.ninja] Failed to send DOM command:",q)}}function u(O,F=1){b("addScene",O,F),i.value=F}function j(O,F=1){b("addScene",O,0)}function f(O){S(O,{replace:!0})}function M(O){S(O,{add:!0})}function w(O){S(O,{remove:!0})}function x(O,F){b("mic",O,!F);const K=s.value.get(O);K&&(K.muted=F)}function L(O){b("mic",O,"toggle");const F=s.value.get(O);F&&(F.muted=!F.muted)}function T(O,F){b("volume",O,Math.max(0,Math.min(200,F)))}function n(O){b("soloChat",O)}function v(O){b("soloChatBidirectional",O)}function d(O,F){b("sendChat",O,F)}function U(O,F){b("sendDirectorChat",O,F)}function _(O){b("hangup",O),s.value.delete(O)}function l(O){O?b("togglescreenshare",O):b("togglescreenshare")}function k(O,F){b("forward",O,F)}function z(O="guests"){b("getGuestList",void 0,void 0)}function g(){b("record",void 0,!0),p.value=!0}function h(){b("record",void 0,!1),p.value=!1}function E(O){b("layout",void 0,O)}function y(O){O?b("reload",O):b("reload")}function D(O,F){b("mixorder",O,F==="up"?-1:1)}function V(O){b("camera",void 0,O)}function A(O,F){b("camera",O,F)}function ie(O,F=!1){F?b("zoom",void 0,O,"abs"):b("zoom",void 0,O)}function de(O){b("pan",void 0,O)}function Ae(O){b("tilt",void 0,O)}function Ce(O){const F=O.origin;if(!F.includes(c.split(":")[0])&&!F.includes("vdo.ninja")&&!F.includes("vdo.itagenten")&&!F.includes("localhost"))return;const K=O.data;if(!K||typeof K!="object")return;const ae=K.type||K.action||"unknown",q=K.streamID||K.UUID||K.streamId;switch(ke({timestamp:Date.now(),direction:"incoming",type:ae,target:q,data:K.data||K.value,raw:K}),ae){case"director-ready":case"loaded":case"ready":case"started":case"director":case"joined-room-complete":case"seeding-started":r.value=!0,C.value="connected",a.value=null;break;case"new-guest":case"guest-connected":case"push":case"view":case"joined":case"new-push-connection":case"push-connection":case"new-view-connection":case"view-connection":{if(q){const Y=K.data,ee={id:q,label:(Y==null?void 0:Y.label)||K.label||q,type:(Y==null?void 0:Y.type)||"guest",hasVideo:(Y==null?void 0:Y.video)!==!1,hasAudio:(Y==null?void 0:Y.audio)!==!1,muted:!1,audioLevel:0};s.value.set(q,ee),m.value++,console.log(`[VDO.ninja] Source added: ${q} (${ee.label})`)}break}case"guest-left":case"guest-disconnected":case"left":case"disconnect":q&&(s.value.delete(q),m.value++);break;case"audio-level":case"loudness":{if(q){const Y=s.value.get(q);if(Y){const ee=K.data;Y.audioLevel=(ee==null?void 0:ee.level)||K.value||0}}break}case"mute-state":case"muted":{if(q){const Y=s.value.get(q);if(Y){const ee=K.data;Y.muted=(ee==null?void 0:ee.muted)??K.value??!1}}break}case"scene-changed":case"scene":{const Y=K.data,ee=(Y==null?void 0:Y.scene)||K.value;i.value=typeof ee=="number"?ee:null;break}case"recording-started":p.value=!0;break;case"recording-stopped":p.value=!1;break;case"error":console.error("[VDO.ninja Error]",K.data),a.value=String(K.data);break}}return ve(()=>{C.value="connecting",window.addEventListener("message",Ce),setTimeout(()=>{!r.value&&I.value&&(r.value=!0,C.value="connected")},5e3)}),xe(()=>{window.removeEventListener("message",Ce),C.value="disconnected"}),{isReady:r,sources:s,sourcesVersion:m,activeScene:i,isRecording:p,connectionState:C,lastError:a,addToScene:u,removeFromScene:j,setProgram:f,addSource:M,removeSource:w,setLayout:E,changeMixOrder:D,setMute:x,toggleMute:L,setVolume:T,soloAudio:n,soloChatBidirectional:v,sendToGuest:d,sendDirectorMessage:U,kickGuest:_,toggleScreenShare:l,transferGuest:k,getGuestList:z,refreshSource:y,setCamera:V,setGuestCamera:A,zoom:ie,pan:de,tilt:Ae,startRecording:g,stopRecording:h,sendCommand:b,sendDomCommand:S,getEventHistory:Pe,getEventStats:Oe}}const Ro={key:0,class:"absolute inset-0 flex items-center justify-center bg-r58-bg-secondary z-10","data-testid":"vdo-loading"},Eo={class:"text-center"},Do={class:"text-xs text-r58-text-secondary mt-2"},jo={key:1,class:"absolute bottom-4 left-4 right-4 bg-red-500/90 text-white px-4 py-2 rounded-lg text-sm z-20"},Vo=["src","title"],To=Z({__name:"VdoNinjaEmbed",props:{profile:{},sources:{},room:{},password:{}},setup(I,{expose:r}){const s=I,m=R(null),i=oe(),p=Io(m),{isReady:C,sources:a,sourcesVersion:c,addToScene:b,removeFromScene:S,setMute:u,toggleMute:j,setVolume:f,sendCommand:M,sendDomCommand:w,isRecording:x,connectionState:L,lastError:T,startRecording:n,stopRecording:v,kickGuest:d,toggleScreenShare:U,setLayout:_,setProgram:l,addSource:k,removeSource:z,getEventHistory:g,getEventStats:h}=p,E=N(()=>{const V={};return s.sources&&(V.source_ids=s.sources.join(",")),s.room&&(V.room=s.room),s.password&&(V.password=s.password),We(s.profile,V)}),y=N(()=>s.profile==="mixer"),D=new Set;return se(c,()=>{i.updateSourcesFromVdo(Array.from(a.value.values()));for(const[V,A]of a.value)D.has(V)||(console.log(`[VdoNinjaEmbed] Auto-adding source ${V} (${A.label}) to scene 1`),b(V,1),D.add(V));for(const V of D)a.value.has(V)||(console.log(`[VdoNinjaEmbed] Source ${V} disconnected, removing from tracking`),D.delete(V))},{immediate:!0}),r({isReady:C,isRecording:x,connectionState:L,lastError:T,sources:a,sourcesVersion:c,addToScene:b,removeFromScene:S,setLayout:_,setProgram:l,addSource:k,removeSource:z,setMute:u,toggleMute:j,setVolume:f,startRecording:n,stopRecording:v,kickGuest:d,toggleScreenShare:U,sendCommand:M,sendDomCommand:w,getEventHistory:g,getEventStats:h}),(V,A)=>(t(),o("div",{class:H(["vdo-embed-container relative w-full h-full bg-black rounded-lg overflow-hidden",{"mixer-mode":y.value}]),"data-testid":"vdo-embed-container"},[G(C)?P("",!0):(t(),o("div",Ro,[e("div",Eo,[A[0]||(A[0]=e("div",{class:"animate-spin w-8 h-8 border-2 border-r58-accent-primary border-t-transparent rounded-full mx-auto mb-4"},null,-1)),A[1]||(A[1]=e("p",{class:"text-r58-text-secondary"},"Connecting to VDO.ninja...",-1)),e("p",Do,$(y.value?"Loading mixer controls...":"Local mixer on R58"),1)])])),G(T)?(t(),o("div",jo,[A[2]||(A[2]=e("strong",null,"Error:",-1)),Q(" "+$(G(T)),1)])):P("",!0),e("iframe",{ref_key:"iframeRef",ref:m,src:E.value,class:H(["w-full h-full border-0",{"opacity-0":!G(C)}]),allow:"camera; microphone; display-capture; autoplay; clipboard-write",allowfullscreen:"","data-testid":"vdo-iframe",title:y.value?"VDO.ninja Mixer":"VDO.ninja"},null,10,Vo)],2))}}),Lo=le(To,[["__scopeId","data-v-07757dd6"]]),Po={class:"camera-push-bar border-t border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"camera-push-bar"},Oo={class:"flex items-center gap-2"},Ao={class:"text-r58-text-secondary"},Uo={key:0,class:"px-4 pb-3"},Ho={key:0,class:"flex gap-3 flex-wrap"},No={class:"text-sm font-medium"},Bo={class:"text-xs text-r58-text-secondary"},zo=["onClick"],Fo={key:1,class:"text-sm text-r58-text-secondary py-2"},Go={class:"hidden"},Ko=["src","onLoad","onError"],Wo=Z({__name:"CameraPushBar",setup(I){const r=pe(),s=R(new Map),m=R(!0),i=N(()=>r.inputs.filter(u=>u.hasSignal));function p(u){return Ye(u)}se(i,u=>{for(const f of u)if(!s.value.has(f.id)){const M=p(f.id),w=Ee(f.id,M,f.label);s.value.set(f.id,{cameraId:f.id,label:f.label,status:"connecting",iframeSrc:w})}const j=new Set(u.map(f=>f.id));for(const[f]of s.value)j.has(f)||s.value.delete(f)},{immediate:!0});function C(u){const j=s.value.get(u);j&&(j.status="connected",console.log(`[CameraPush] ${u} connected to VDO.ninja`))}function a(u){const j=s.value.get(u);j&&(j.status="error",console.error(`[CameraPush] ${u} failed to connect`))}function c(u){const j=r.inputs.find(w=>w.id===u);if(!j||!j.hasSignal)return;const f=p(u),M=Ee(u,f,j.label);s.value.set(u,{cameraId:u,label:j.label,status:"connecting",iframeSrc:M+`&_t=${Date.now()}`})}function b(u){switch(u){case"connected":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function S(u){switch(u){case"connected":return"Live in VDO.ninja";case"connecting":return"Connecting...";case"error":return"Failed to connect";default:return"Idle"}}return(u,j)=>(t(),o("div",Po,[e("button",{onClick:j[0]||(j[0]=f=>m.value=!m.value),class:"w-full px-4 py-2 flex items-center justify-between text-sm hover:bg-r58-bg-tertiary/50 transition-colors","data-testid":"camera-push-toggle","aria-expanded":"expanded"},[e("div",Oo,[j[1]||(j[1]=e("span",{class:"font-medium"},"Camera Sources",-1)),e("span",Ao,"("+$(i.value.length)+" active)",1)]),(t(),o("svg",{class:H(["w-4 h-4 transition-transform",{"rotate-180":m.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...j[2]||(j[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),m.value?(t(),o("div",Uo,[s.value.size>0?(t(),o("div",Ho,[(t(!0),o(W,null,J(s.value,([f,M])=>(t(),o("div",{key:f,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},[e("span",{class:H(["w-2 h-2 rounded-full",b(M.status)])},null,2),e("span",No,$(M.label),1),e("span",Bo,$(S(M.status)),1),M.status==="error"?(t(),o("button",{key:0,onClick:w=>c(f),class:"ml-2 text-xs text-r58-accent-primary hover:underline"}," Retry ",8,zo)):P("",!0)]))),128))])):(t(),o("div",Fo," No cameras connected. Connect HDMI sources to push them to the mixer. "))])):P("",!0),e("div",Go,[(t(!0),o(W,null,J(s.value,([f,M])=>(t(),o("iframe",{key:f,src:M.iframeSrc,onLoad:w=>C(f),onError:w=>a(f),allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,Ko))),128))])]))}}),Yo={class:"program-output space-y-3","data-testid":"program-output"},Jo={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary rounded-lg","data-testid":"program-output-status"},qo={class:"text-sm font-medium","data-testid":"program-output-text"},Xo={key:0,class:"space-y-2"},Qo={class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},Zo={class:"flex-1 text-xs truncate text-r58-text-secondary"},en={key:0,class:"flex items-center gap-2 px-3 py-2 bg-r58-bg-tertiary/50 rounded-lg"},tn={class:"text-xs text-r58-text-secondary"},on={key:1,class:"text-xs text-r58-text-secondary px-3"},nn={class:"hidden"},sn=["src"],rn=Z({__name:"ProgramOutput",setup(I){const r=oe(),s=he(),m=R(!1),i=R("idle"),p=R("");function C(){return`${window.location.origin}/api/v1/whip/program/whip`}function a(){m.value||(i.value="connecting",p.value=Je(C()),m.value=!0,console.log("[ProgramOutput] Starting WHIP push to MediaMTX"))}function c(){m.value&&(m.value=!1,p.value="",i.value="idle",console.log("[ProgramOutput] Stopped WHIP push"))}function b(){m.value&&(i.value="live",console.log("[ProgramOutput] WHIP push connected"))}function S(){i.value="error",console.error("[ProgramOutput] WHIP push failed")}function u(){c(),setTimeout(()=>a(),500)}se(()=>r.isLive,w=>{w?a():c()});function j(){switch(i.value){case"live":return"bg-emerald-500";case"connecting":return"bg-amber-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}}function f(){switch(i.value){case"live":return"MediaMTX connected";case"connecting":return"Connecting...";case"error":return"Connection failed";default:return"Inactive"}}function M(){const w=s.programOutputUrls.srt;navigator.clipboard.writeText(w),B.success("SRT URL copied")}return(w,x)=>(t(),o("div",Yo,[e("div",Jo,[e("span",{class:H(["w-2 h-2 rounded-full",j()]),"data-testid":"program-output-indicator"},null,2),e("span",qo,$(f()),1),i.value==="error"?(t(),o("button",{key:0,onClick:x[0]||(x[0]=L=>u()),class:"ml-auto text-xs text-r58-accent-primary hover:underline"}," Retry ")):P("",!0)]),i.value==="live"?(t(),o("div",Xo,[e("div",Qo,[x[1]||(x[1]=e("span",{class:"text-xs text-r58-text-secondary"},"ðŸ”´ SRT:",-1)),e("code",Zo,$(G(s).programOutputUrls.srt),1),e("button",{onClick:M,class:"text-xs text-r58-accent-primary hover:underline"},"Copy")]),G(s).enabledDestinations.length>0?(t(),o("div",en,[x[2]||(x[2]=e("span",{class:"w-2 h-2 rounded-full bg-emerald-500"},null,-1)),e("span",tn,$(G(s).enabledDestinations.length)+" streaming destination"+$(G(s).enabledDestinations.length>1?"s":"")+" active ",1)])):P("",!0)])):P("",!0),i.value==="idle"?(t(),o("p",on," Program output will start automatically when you go live. ")):P("",!0),e("div",nn,[m.value&&p.value?(t(),o("iframe",{key:0,src:p.value,onLoad:b,onError:S,allow:"camera; microphone; autoplay",class:"w-0 h-0"},null,40,sn)):P("",!0)])]))}}),an={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},ln={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl"},dn={class:"p-6 overflow-y-auto max-h-[60vh]"},cn={class:"mb-8"},un={class:"flex items-center justify-between mb-4"},vn={key:0,class:"mb-4 p-4 bg-r58-bg-tertiary rounded-lg"},mn={class:"grid grid-cols-2 gap-2"},pn=["onClick"],gn={class:"text-xl"},xn={key:1,class:"space-y-3"},fn=["onClick"],bn={class:"text-xl"},yn={class:"flex-1"},hn={class:"font-medium"},wn={class:"text-xs text-r58-text-secondary"},kn=["onClick"],Sn=["onClick"],_n={key:2,class:"text-r58-text-secondary text-sm"},$n={key:0,class:"mb-8 p-4 bg-r58-bg-tertiary rounded-lg"},Cn={class:"text-lg font-medium mb-4"},Mn={class:"space-y-4"},In=["placeholder"],Rn={key:0},En={class:"flex gap-2"},Dn={class:"mb-8"},jn={class:"space-y-3"},Vn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Tn={class:"flex items-center justify-between mb-1"},Ln={class:"text-xs text-r58-text-secondary break-all"},Pn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},On={class:"flex items-center justify-between mb-1"},An={class:"text-xs text-r58-text-secondary break-all"},Un={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Hn={class:"flex items-center justify-between mb-1"},Nn={class:"text-xs text-r58-text-secondary break-all"},Bn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},zn={class:"flex items-center justify-between mb-1"},Fn={class:"text-xs text-r58-text-secondary break-all"},Gn={class:"p-3 bg-r58-bg-tertiary rounded-lg"},Kn={class:"flex items-center justify-between mb-1"},Wn={class:"text-xs text-r58-text-secondary break-all"},Yn={class:"p-4 bg-r58-bg-tertiary rounded-lg"},Jn={class:"flex items-center gap-3 mb-4"},qn=Z({__name:"StreamingSettings",setup(I,{expose:r}){const s=he(),m=R(!1),i=R(null),p=R(!1);R(""),R("");const C=N(()=>s.destinations),a=N(()=>ce),c=N(()=>s.programOutputUrls);function b(){m.value=!0}function S(){m.value=!1,i.value=null,p.value=!1}function u(T){const n=s.addDestination(T);i.value=n,p.value=!1,s.saveDestinations()}function j(){i.value&&(s.updateDestination(i.value.id,i.value),s.saveDestinations(),i.value=null,B.success("Streaming destination saved"))}function f(T){s.removeDestination(T),s.saveDestinations(),B.info("Destination removed")}function M(T){s.updateDestination(T.id,{enabled:!T.enabled}),s.saveDestinations()}function w(T,n){navigator.clipboard.writeText(T),B.success(`${n} copied to clipboard`)}function x(T){const n=ce.find(v=>v.id===T);return(n==null?void 0:n.icon)||"ðŸ“¡"}function L(T){const n=ce.find(v=>v.id===T);return(n==null?void 0:n.name)||"Unknown"}return r({open:b}),(T,n)=>{var v;return t(),me(ye,{to:"body"},[m.value?(t(),o("div",an,[e("div",{class:"absolute inset-0 bg-black/60",onClick:S}),e("div",ln,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[n[11]||(n[11]=e("h2",{class:"text-xl font-semibold"},"Streaming Settings",-1)),e("button",{onClick:S,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",dn,[e("section",cn,[e("div",un,[n[12]||(n[12]=e("h3",{class:"text-lg font-medium"},"Streaming Destinations",-1)),e("button",{onClick:n[0]||(n[0]=d=>p.value=!p.value),class:"btn btn-sm btn-primary"}," + Add Platform ")]),p.value?(t(),o("div",vn,[n[13]||(n[13]=e("p",{class:"text-sm text-r58-text-secondary mb-3"},"Select a streaming platform:",-1)),e("div",mn,[(t(!0),o(W,null,J(a.value,d=>(t(),o("button",{key:d.id,onClick:U=>u(d.id),class:"flex items-center gap-2 p-3 bg-r58-bg-secondary hover:bg-r58-accent-primary/20 rounded-lg transition-colors text-left"},[e("span",gn,$(d.icon),1),e("span",null,$(d.name),1)],8,pn))),128))])])):P("",!0),C.value.length>0?(t(),o("div",xn,[(t(!0),o(W,null,J(C.value,d=>(t(),o("div",{key:d.id,class:"flex items-center gap-3 p-3 bg-r58-bg-tertiary rounded-lg"},[e("button",{onClick:U=>M(d),class:H(["w-10 h-6 rounded-full transition-colors relative",d.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:H(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",d.enabled?"left-5":"left-1"])},null,2)],10,fn),e("span",bn,$(x(d.platformId)),1),e("div",yn,[e("div",hn,$(d.name),1),e("div",wn,$(d.streamKey?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"+d.streamKey.slice(-4):"No stream key"),1)]),e("button",{onClick:U=>i.value={...d},class:"text-r58-accent-primary hover:underline text-sm"}," Edit ",8,kn),e("button",{onClick:U=>f(d.id),class:"text-r58-accent-danger hover:underline text-sm"}," Remove ",8,Sn)]))),128))])):(t(),o("p",_n," No streaming destinations configured. Add a platform above. "))]),i.value?(t(),o("section",$n,[e("h3",Cn," Edit "+$(L(i.value.platformId)),1),e("div",Mn,[e("div",null,[n[14]||(n[14]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Display Name",-1)),X(e("input",{"onUpdate:modelValue":n[1]||(n[1]=d=>i.value.name=d),type:"text",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ne,i.value.name]])]),e("div",null,[n[15]||(n[15]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Stream Key",-1)),X(e("input",{"onUpdate:modelValue":n[2]||(n[2]=d=>i.value.streamKey=d),type:"password",placeholder:(v=G(ce).find(d=>d.id===i.value.platformId))==null?void 0:v.streamKeyPlaceholder,class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,8,In),[[ne,i.value.streamKey]]),n[16]||(n[16]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Your stream key is stored locally and never sent to our servers. ",-1))]),i.value.platformId==="custom"?(t(),o("div",Rn,[n[17]||(n[17]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"RTMP URL",-1)),X(e("input",{"onUpdate:modelValue":n[3]||(n[3]=d=>i.value.name=d),type:"text",placeholder:"rtmp://your-server.com/live/",class:"w-full px-3 py-2 bg-r58-bg-secondary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none font-mono"},null,512),[[ne,i.value.name]])])):P("",!0),e("div",En,[e("button",{onClick:j,class:"btn btn-primary"}," Save "),e("button",{onClick:n[4]||(n[4]=d=>i.value=null),class:"btn"}," Cancel ")])])])):P("",!0),e("section",Dn,[n[26]||(n[26]=e("h3",{class:"text-lg font-medium mb-4"},"Program Output URLs",-1)),n[27]||(n[27]=e("p",{class:"text-sm text-r58-text-secondary mb-4"}," Use these URLs to consume the program feed from MediaMTX: ",-1)),e("div",jn,[e("div",Vn,[e("div",Tn,[n[18]||(n[18]=e("span",{class:"font-medium"},"ðŸ”´ SRT Output",-1)),e("button",{onClick:n[5]||(n[5]=d=>w(c.value.srt,"SRT URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Ln,$(c.value.srt),1),n[19]||(n[19]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Low-latency, reliable transport. Ideal for remote production. ",-1))]),e("div",Pn,[e("div",On,[n[20]||(n[20]=e("span",{class:"font-medium"},"ðŸ“º RTMP Output",-1)),e("button",{onClick:n[6]||(n[6]=d=>w(c.value.rtmp,"RTMP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",An,$(c.value.rtmp),1)]),e("div",Un,[e("div",Hn,[n[21]||(n[21]=e("span",{class:"font-medium"},"ðŸŽ¬ RTSP Output",-1)),e("button",{onClick:n[7]||(n[7]=d=>w(c.value.rtsp,"RTSP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Nn,$(c.value.rtsp),1)]),e("div",Bn,[e("div",zn,[n[22]||(n[22]=e("span",{class:"font-medium"},"ðŸŒ HLS Output",-1)),e("button",{onClick:n[8]||(n[8]=d=>w(c.value.hls,"HLS URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Fn,$(c.value.hls),1),n[23]||(n[23]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Browser-compatible streaming. Higher latency. ",-1))]),e("div",Gn,[e("div",Kn,[n[24]||(n[24]=e("span",{class:"font-medium"},"âš¡ WebRTC (WHEP)",-1)),e("button",{onClick:n[9]||(n[9]=d=>w(c.value.whep,"WHEP URL")),class:"text-xs text-r58-accent-primary hover:underline"}," Copy ")]),e("code",Wn,$(c.value.whep),1),n[25]||(n[25]=e("p",{class:"text-xs text-r58-text-secondary mt-1"}," Ultra-low latency WebRTC. Best for interactive use. ",-1))])])]),e("section",null,[n[30]||(n[30]=e("h3",{class:"text-lg font-medium mb-4"},"SRT Configuration",-1)),e("div",Yn,[e("div",Jn,[e("button",{onClick:n[10]||(n[10]=d=>G(s).toggleSrtOutput(!G(s).srtOutput.enabled)),class:H(["w-10 h-6 rounded-full transition-colors relative",G(s).srtOutput.enabled?"bg-r58-accent-success":"bg-r58-bg-secondary"])},[e("span",{class:H(["absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",G(s).srtOutput.enabled?"left-5":"left-1"])},null,2)],2),n[28]||(n[28]=e("span",null,"Enable SRT Output",-1))]),n[29]||(n[29]=e("div",{class:"text-sm text-r58-text-secondary"},[e("p",{class:"mb-2"},"SRT (Secure Reliable Transport) provides:"),e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Low latency (typically 1-2 seconds)"),e("li",null,"Error correction for unreliable networks"),e("li",null,"AES encryption support"),e("li",null,"Compatible with OBS, vMix, and professional equipment")])],-1))])])]),e("div",{class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},[e("button",{onClick:S,class:"btn"},"Close")])])])):P("",!0)])}}}),Xn={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Qn={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-3xl max-h-[80vh] overflow-hidden shadow-2xl","data-testid":"hotkey-settings-modal"},Zn={class:"flex border-b border-r58-bg-tertiary"},es=["onClick"],ts={class:"p-6 overflow-y-auto max-h-[55vh]"},os={key:0,class:"text-center py-12 text-r58-text-secondary"},ns={key:1,class:"space-y-6"},ss={class:"text-sm font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"},rs={class:"space-y-2"},is={class:"flex-1"},as={class:"text-sm"},ls={key:0,class:"ml-2 text-xs text-r58-accent-primary"},ds={class:"flex items-center gap-2"},cs={key:0,class:"flex items-center gap-2"},us={key:0,class:"px-3 py-1 bg-r58-accent-primary text-white rounded text-sm font-mono"},vs={key:1,class:"text-sm text-r58-text-secondary animate-pulse"},ms={class:"px-3 py-1 bg-r58-bg-secondary border border-r58-bg-tertiary rounded text-sm font-mono"},ps=["onClick"],gs=["onClick"],Te="r58-hotkey-customizations",xs=Z({__name:"HotkeySettings",setup(I,{expose:r}){const s=[{id:"help",key:"?",modifiers:["shift"],description:"Show keyboard shortcuts",context:"global",category:"Navigation",editable:!1},{id:"goto-recorder",key:"r",modifiers:["alt"],description:"Go to Recorder",context:"global",category:"Navigation",editable:!0},{id:"goto-mixer",key:"m",modifiers:["alt"],description:"Go to Mixer",context:"global",category:"Navigation",editable:!0},{id:"escape",key:"Escape",description:"Close modal / Cancel",context:"global",category:"Navigation",editable:!1},{id:"scene-1",key:"1",description:"Select Scene 1 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-2",key:"2",description:"Select Scene 2 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-3",key:"3",description:"Select Scene 3 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-4",key:"4",description:"Select Scene 4 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-5",key:"5",description:"Select Scene 5 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-6",key:"6",description:"Select Scene 6 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-7",key:"7",description:"Select Scene 7 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"scene-8",key:"8",description:"Select Scene 8 for preview",context:"mixer",category:"Scenes",editable:!0},{id:"take",key:" ",description:"TAKE - Transition preview to program",context:"mixer",category:"Transitions",editable:!1},{id:"cut",key:"Escape",description:"CUT - Immediate switch to preview",context:"mixer",category:"Transitions",editable:!1},{id:"transition-cut",key:"t",description:"Set transition: Cut",context:"mixer",category:"Transitions",editable:!0},{id:"transition-fade",key:"f",description:"Set transition: Fade",context:"mixer",category:"Transitions",editable:!0},{id:"go-live",key:"g",description:"Toggle Go Live",context:"mixer",category:"Control",editable:!0},{id:"toggle-recording",key:"r",description:"Toggle recording",context:"mixer",category:"Control",editable:!0},{id:"mute-all",key:"m",modifiers:["ctrl"],description:"Mute all sources",context:"mixer",category:"Control",editable:!0},{id:"toggle-sidebar",key:"s",modifiers:["ctrl"],description:"Toggle sidebar",context:"mixer",category:"Control",editable:!0},{id:"mute-1",key:"F1",description:"Toggle mute: Source 1",context:"mixer",category:"Audio",editable:!0},{id:"mute-2",key:"F2",description:"Toggle mute: Source 2",context:"mixer",category:"Audio",editable:!0},{id:"mute-3",key:"F3",description:"Toggle mute: Source 3",context:"mixer",category:"Audio",editable:!0},{id:"mute-4",key:"F4",description:"Toggle mute: Source 4",context:"mixer",category:"Audio",editable:!0},{id:"start-stop-recording",key:" ",description:"Start/Stop recording",context:"recorder",category:"Recording",editable:!0},{id:"mark-chapter",key:"c",description:"Mark chapter point",context:"recorder",category:"Recording",editable:!0},{id:"select-all",key:"a",modifiers:["ctrl"],description:"Select all cameras",context:"recorder",category:"Recording",editable:!0}],m=R(!1),i=R("mixer"),p=R({}),C=R(null),a=R(null);function c(){try{const l=localStorage.getItem(Te);l&&(p.value=JSON.parse(l))}catch(l){console.warn("[HotkeySettings] Failed to load customizations:",l)}}function b(){try{localStorage.setItem(Te,JSON.stringify(p.value))}catch(l){console.warn("[HotkeySettings] Failed to save customizations:",l)}}function S(l){const k=p.value[l.id];return k?{...l,key:k.key,modifiers:k.modifiers}:l}const u=N(()=>{const l={global:{},mixer:{},recorder:{}};for(const k of s){const z=S(k);l[k.context][z.category]||(l[k.context][z.category]=[]),l[k.context][z.category].push(z)}return l}),j=N(()=>u.value[i.value]||{});function f(l){return Ie(l.key,l.modifiers)}function M(l){return!!p.value[l]}function w(l){const k=s.find(z=>z.id===l);k!=null&&k.editable&&(C.value=l,a.value=null,document.addEventListener("keydown",x))}function x(l){if(l.preventDefault(),l.stopPropagation(),["Control","Alt","Shift","Meta"].includes(l.key))return;const k=[];l.ctrlKey&&k.push("ctrl"),l.altKey&&k.push("alt"),l.shiftKey&&k.push("shift"),l.metaKey&&k.push("meta"),a.value={key:l.key,modifiers:k},document.removeEventListener("keydown",x)}function L(){!C.value||!a.value||(p.value[C.value]={key:a.value.key,modifiers:a.value.modifiers.length>0?a.value.modifiers:void 0},b(),B.success("Hotkey updated"),C.value=null,a.value=null)}function T(){C.value=null,a.value=null,document.removeEventListener("keydown",x)}function n(l){delete p.value[l],b(),B.info("Hotkey reset to default")}function v(){confirm("Reset all hotkeys to defaults?")&&(p.value={},b(),B.info("All hotkeys reset to defaults"))}function d(){c(),m.value=!0}function U(){T(),m.value=!1}ve(()=>{c()});function _(){return{...p.value}}return r({open:d,getCustomBindings:_}),(l,k)=>(t(),me(ye,{to:"body"},[m.value?(t(),o("div",Xn,[e("div",{class:"absolute inset-0 bg-black/60",onClick:U}),e("div",Qn,[e("div",{class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},[k[0]||(k[0]=e("h2",{class:"text-xl font-semibold"},"Keyboard Shortcuts",-1)),e("div",{class:"flex items-center gap-4"},[e("button",{onClick:v,class:"text-sm text-r58-text-secondary hover:text-r58-text-primary"}," Reset All "),e("button",{onClick:U,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")])]),e("div",Zn,[(t(),o(W,null,J(["mixer","global","recorder"],z=>e("button",{key:z,onClick:g=>i.value=z,class:H(["px-6 py-3 text-sm font-medium capitalize transition-colors",i.value===z?"text-r58-accent-primary border-b-2 border-r58-accent-primary":"text-r58-text-secondary hover:text-r58-text-primary"])},$(z),11,es)),64))]),e("div",ts,[Object.keys(j.value).length===0?(t(),o("div",os," No shortcuts defined for this context. ")):(t(),o("div",ns,[(t(!0),o(W,null,J(j.value,(z,g)=>(t(),o("div",{key:g},[e("h3",ss,$(g),1),e("div",rs,[(t(!0),o(W,null,J(z,h=>(t(),o("div",{key:h.id,class:H(["flex items-center justify-between p-3 bg-r58-bg-tertiary rounded-lg",{"ring-2 ring-r58-accent-primary":C.value===h.id}])},[e("div",is,[e("span",as,$(h.description),1),M(h.id)?(t(),o("span",ls,"(customized)")):P("",!0)]),e("div",ds,[C.value===h.id?(t(),o("div",cs,[a.value?(t(),o("kbd",us,$(G(Ie)(a.value.key,a.value.modifiers)),1)):(t(),o("span",vs," Press a key... ")),a.value?(t(),o("button",{key:2,onClick:L,class:"btn btn-sm btn-primary"}," Save ")):P("",!0),e("button",{onClick:T,class:"btn btn-sm"}," Cancel ")])):(t(),o(W,{key:1},[e("kbd",ms,$(f(h)),1),h.editable?(t(),o("button",{key:0,onClick:E=>w(h.id),class:"text-xs text-r58-accent-primary hover:underline"}," Edit ",8,ps)):P("",!0),M(h.id)?(t(),o("button",{key:1,onClick:E=>n(h.id),class:"text-xs text-r58-text-secondary hover:text-r58-accent-danger"}," Reset ",8,gs)):P("",!0)],64))])],2))),128))])]))),128))]))]),e("div",{class:"flex items-center justify-between px-6 py-4 border-t border-r58-bg-tertiary"},[k[1]||(k[1]=e("div",{class:"text-sm text-r58-text-secondary"},' Click "Edit" to customize a shortcut. Press any key combination to set. ',-1)),e("button",{onClick:U,class:"btn"},"Close")])])])):P("",!0)]))}}),fs={class:"connection-status","data-testid":"connection-status"},bs={class:"text-xs text-r58-text-secondary"},ys={key:0,class:"text-xs text-r58-accent-danger",title:"Click for details"},hs={key:0,class:"mt-2 p-3 bg-r58-bg-tertiary rounded-lg text-xs space-y-2"},ws={class:"grid grid-cols-2 gap-2"},ks={class:"ml-1 font-medium"},Ss={class:"ml-1"},_s={class:"ml-1"},$s={key:0,class:"p-2 bg-r58-accent-danger/10 border border-r58-accent-danger/30 rounded text-r58-accent-danger"},Cs={class:"flex gap-2 pt-2 border-t border-r58-bg-tertiary"},Ms=["disabled"],Is={key:1,class:"text-r58-text-secondary text-center"},Rs=Z({__name:"ConnectionStatus",props:{vdoEmbed:{}},setup(I){const r=I;oe();const s=R(!1),m=R("never"),i=R(0),p=R(!1),C=R(0),a=N(()=>{var n,v;return((v=(n=r.vdoEmbed)==null?void 0:n.connectionState)==null?void 0:v.value)||"disconnected"}),c=N(()=>{var n,v;return((v=(n=r.vdoEmbed)==null?void 0:n.isReady)==null?void 0:v.value)||!1}),b=N(()=>{var n,v;return((v=(n=r.vdoEmbed)==null?void 0:n.lastError)==null?void 0:v.value)||null}),S=N(()=>{var _,l,k,z;C.value;const n=(l=(_=window.__VDO_DEBUG__)==null?void 0:_.getStats)==null?void 0:l.call(_);if((n==null?void 0:n.lastActivity)&&Date.now()-n.lastActivity<3e4)return"healthy";const d=(z=(k=r.vdoEmbed)==null?void 0:k.getEventStats)==null?void 0:z.call(k);return(d==null?void 0:d.lastActivity)&&Date.now()-d.lastActivity<3e4?"healthy":a.value==="disconnected"||!c.value?"disconnected":b.value?"error":a.value==="connecting"?"degraded":"healthy"}),u=N(()=>{switch(S.value){case"healthy":return"bg-r58-accent-success";case"degraded":return"bg-amber-500";case"error":return"bg-r58-accent-danger";case"disconnected":return"bg-r58-text-secondary";default:return"bg-r58-text-secondary"}}),j=N(()=>{switch(S.value){case"healthy":return"Connected";case"degraded":return"Connecting...";case"error":return"Error";case"disconnected":return"Disconnected";default:return"Unknown"}});let f=null;function M(){if(C.value++,r.vdoEmbed){const n=r.vdoEmbed.getEventStats();if(n.lastActivity){const v=Date.now()-n.lastActivity;v<1e3?m.value="just now":v<6e4?m.value=`${Math.floor(v/1e3)}s ago`:v<36e5?m.value=`${Math.floor(v/6e4)}m ago`:m.value="over 1h ago"}}}ve(()=>{M(),f=window.setInterval(M,1e3)}),xe(()=>{f&&clearInterval(f)});async function w(){if(!p.value){p.value=!0,i.value++,B.info("Attempting to reconnect...");try{r.vdoEmbed&&r.vdoEmbed.sendCommand("ping"),await new Promise(n=>setTimeout(n,2e3)),c.value&&!b.value?(B.success("Reconnected successfully"),i.value=0):B.error("Reconnection failed. Try refreshing the page.")}catch(n){B.error("Reconnection error"),console.error("[ConnectionStatus] Reconnect error:",n)}finally{p.value=!1}}}function x(){confirm("This will refresh the page and may interrupt active streams. Continue?")&&window.location.reload()}function L(){s.value=!s.value}const T=N(()=>r.vdoEmbed?r.vdoEmbed.getEventStats():{total:0,incoming:0,outgoing:0,lastActivity:null});return(n,v)=>(t(),o("div",fs,[e("div",{class:"flex items-center gap-2 cursor-pointer",onClick:L},[e("span",{class:H(["w-2 h-2 rounded-full",[u.value,{"animate-pulse":S.value==="degraded"}]]),"data-testid":"status-indicator"},null,2),e("span",bs,$(j.value),1),b.value?(t(),o("span",ys," âš ï¸ ")):P("",!0),(t(),o("svg",{class:H(["w-3 h-3 text-r58-text-secondary transition-transform",{"rotate-180":s.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...v[0]||(v[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),s.value?(t(),o("div",hs,[e("div",ws,[e("div",null,[v[1]||(v[1]=e("span",{class:"text-r58-text-secondary"},"VDO.ninja:",-1)),e("span",{class:H(["ml-1 font-medium",c.value?"text-r58-accent-success":"text-r58-accent-danger"])},$(c.value?"Ready":"Not Ready"),3)]),e("div",null,[v[2]||(v[2]=e("span",{class:"text-r58-text-secondary"},"State:",-1)),e("span",ks,$(a.value),1)]),e("div",null,[v[3]||(v[3]=e("span",{class:"text-r58-text-secondary"},"Last activity:",-1)),e("span",Ss,$(m.value),1)]),e("div",null,[v[4]||(v[4]=e("span",{class:"text-r58-text-secondary"},"Events:",-1)),e("span",_s,$(T.value.total),1)])]),b.value?(t(),o("div",$s,[v[5]||(v[5]=e("strong",null,"Error:",-1)),Q(" "+$(b.value),1)])):P("",!0),e("div",Cs,[e("button",{onClick:w,disabled:p.value,class:H(["btn btn-sm flex-1",{"opacity-50":p.value}])},$(p.value?"Reconnecting...":"ðŸ”„ Reconnect"),11,Ms),e("button",{onClick:x,class:"btn btn-sm",title:"Refresh the page (last resort)"}," ðŸ”ƒ Refresh ")]),i.value>0?(t(),o("div",Is," Reconnect attempts: "+$(i.value),1)):P("",!0)])):P("",!0)]))}}),Es={class:"recording-controls space-y-3","data-testid":"recording-controls"},Ds={class:"flex items-center gap-3 px-3 py-2 bg-r58-bg-tertiary rounded-lg"},js={class:"text-sm font-medium flex-1","data-testid":"recording-status"},Vs={key:0,class:"text-lg font-mono font-bold text-r58-accent-danger","data-testid":"recording-duration"},Ts=["disabled"],Ls={key:0,class:"px-3 py-2 bg-r58-accent-success/10 border border-r58-accent-success/30 rounded-lg"},Ps={class:"flex items-center justify-between"},Os=["href"],As=Z({__name:"RecordingControls",props:{vdoEmbed:{}},setup(I){const r=I,s=R(!1),m=R(null),i=R(0),p=R(null),C=R(!1);se(()=>{var x,L;return(L=(x=r.vdoEmbed)==null?void 0:x.isRecording)==null?void 0:L.value},x=>{x!==void 0&&(s.value=x,x&&!m.value?m.value=Date.now():!x&&m.value&&(m.value=null))});let a=null;function c(){a&&clearInterval(a),a=window.setInterval(()=>{m.value&&(i.value=Date.now()-m.value)},100)}function b(){a&&(clearInterval(a),a=null)}ve(()=>{c()}),xe(()=>{b()});const S=N(()=>{const x=Math.floor(i.value/1e3),L=Math.floor(x/3600),T=Math.floor(x%3600/60),n=x%60;return L>0?`${L}:${T.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`:`${T}:${n.toString().padStart(2,"0")}`});async function u(){if(!r.vdoEmbed){B.error("VDO.ninja not connected");return}C.value=!0;try{r.vdoEmbed.startRecording(),s.value=!0,m.value=Date.now(),i.value=0,p.value=null,B.success("Recording started")}catch(x){B.error("Failed to start recording"),console.error("[RecordingControls] Start recording error:",x)}finally{C.value=!1}}async function j(){if(!r.vdoEmbed){B.error("VDO.ninja not connected");return}C.value=!0;try{r.vdoEmbed.stopRecording(),s.value=!1,m.value=null,B.success(`Recording stopped (${S.value})`)}catch(x){B.error("Failed to stop recording"),console.error("[RecordingControls] Stop recording error:",x)}finally{C.value=!1}}function f(){s.value?j():u()}function M(){return s.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"}function w(){return C.value?"Processing...":s.value?`Recording â€¢ ${S.value}`:"Ready to record"}return(x,L)=>(t(),o("div",Es,[e("div",Ds,[e("span",{class:H(["w-3 h-3 rounded-full",M()]),"data-testid":"recording-indicator"},null,2),e("span",js,$(w()),1),s.value?(t(),o("span",Vs,$(S.value),1)):P("",!0)]),e("div",null,[e("button",{onClick:f,disabled:C.value,class:H(["btn w-full justify-center",s.value?"btn-danger":"btn-primary"]),"data-testid":"recording-toggle-button"},[C.value?(t(),o(W,{key:0},[L[0]||(L[0]=e("svg",{class:"animate-spin w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),L[1]||(L[1]=Q(" Processing... ",-1))],64)):s.value?(t(),o(W,{key:1},[L[2]||(L[2]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("rect",{x:"6",y:"6",width:"12",height:"12",rx:"1"})],-1)),L[3]||(L[3]=Q(" Stop Recording ",-1))],64)):(t(),o(W,{key:2},[L[4]||(L[4]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("circle",{cx:"12",cy:"12",r:"8"})],-1)),L[5]||(L[5]=Q(" Start Recording ",-1))],64))],10,Ts)]),p.value?(t(),o("div",Ls,[e("div",Ps,[L[6]||(L[6]=e("span",{class:"text-sm text-r58-accent-success"},"Recording ready!",-1)),e("a",{href:p.value,download:"",class:"text-sm text-r58-accent-primary hover:underline"}," Download ",8,Os)])])):P("",!0),L[7]||(L[7]=e("p",{class:"text-xs text-r58-text-secondary px-1"}," Records the mixed output locally in your browser. Recording is saved when stopped. ",-1))]))}}),Us=le(As,[["__scopeId","data-v-14707e66"]]),Hs={class:"audio-mixer space-y-4","data-testid":"audio-mixer"},Ns={class:"master-volume p-3 bg-r58-bg-tertiary rounded-lg"},Bs={class:"flex items-center justify-between mb-2"},zs={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Fs={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Gs=["value"],Ks={class:"text-xs text-r58-text-secondary text-center mt-1"},Ws={key:0,class:"space-y-2"},Ys={class:"flex items-center gap-2 mb-2"},Js={class:"text-xs font-medium truncate flex-1"},qs=["onClick"],Xs=["onClick"],Qs={class:"h-1.5 bg-r58-bg-secondary rounded-full overflow-hidden mb-2"},Zs=["value","onInput","disabled"],er={key:1,class:"text-center py-4 text-r58-text-secondary"},tr=Z({__name:"AudioMixer",props:{vdoEmbed:{},controller:{}},setup(I){const r=I,s=oe(),m=pe(),i={cam0:"HDMI 1",cam1:"HDMI 2",cam2:"HDMI 3",cam3:"HDMI 4"},p=N(()=>m.inputs.filter(f=>f.hasSignal).map(f=>({id:f.id,label:i[f.id]||f.label,type:"camera",hasVideo:!0,hasAudio:!0,muted:!1,audioLevel:0,volume:100,solo:!1}))),C=N(()=>{const f=new Map;for(const M of p.value)f.set(M.id,M);for(const M of s.connectedSources)if(M.hasAudio){const w=f.get(M.id);w?f.set(M.id,{...w,...M}):f.set(M.id,M)}return Array.from(f.values())});function a(f,M){var w,x;if(r.controller)r.controller.setVolume(f.id,M);else if(s.setSourceVolume(f.id,M),r.vdoEmbed){const L=Math.round(M*2);(x=(w=r.vdoEmbed).setVolume)==null||x.call(w,f.id,L)}}function c(f){var M,w;if(r.controller)r.controller.toggleMute(f.id);else{const x=!f.muted;s.setSourceMute(f.id,x),r.vdoEmbed&&((w=(M=r.vdoEmbed).setMute)==null||w.call(M,f.id,x))}}function b(f){var M,w;if(r.controller)r.controller.setSolo(f.id,!f.solo);else{const x=!f.solo;s.setSourceSolo(f.id,x),r.vdoEmbed&&x&&((w=(M=r.vdoEmbed).sendCommand)==null||w.call(M,"soloChat",f.id))}}function S(){s.setMasterMuted(!s.masterMuted)}function u(f){s.setMasterVolume(f)}function j(f){return f>80?"bg-red-500":f>60?"bg-amber-500":"bg-emerald-500"}return(f,M)=>(t(),o("div",Hs,[e("div",Ns,[e("div",Bs,[M[3]||(M[3]=e("span",{class:"text-xs font-medium"},"Master",-1)),e("button",{onClick:S,class:H(["p-1 rounded hover:bg-r58-bg-secondary transition-colors",{"text-red-400":G(s).masterMuted}])},[G(s).masterMuted?(t(),o("svg",zs,[...M[1]||(M[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"},null,-1)])])):(t(),o("svg",Fs,[...M[2]||(M[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"},null,-1)])]))],2)]),e("input",{type:"range",value:G(s).masterVolume,onInput:M[0]||(M[0]=w=>u(w.target.valueAsNumber)),min:"0",max:"100",class:"w-full h-2 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary"},null,40,Gs),e("div",Ks,$(G(s).masterVolume)+"% ",1)]),C.value.length>0?(t(),o("div",Ws,[(t(!0),o(W,null,J(C.value,w=>(t(),o("div",{key:w.id,class:"source-channel p-2 bg-r58-bg-tertiary/50 rounded-lg"},[e("div",Ys,[e("span",Js,$(w.label),1),e("button",{onClick:x=>b(w),class:H(["w-6 h-6 text-xs font-bold rounded transition-colors",w.solo?"bg-amber-500 text-black":"bg-r58-bg-secondary text-r58-text-secondary hover:text-r58-text-primary"]),title:"Solo"}," S ",10,qs),e("button",{onClick:x=>c(w),class:H(["w-6 h-6 text-xs font-bold rounded transition-colors",w.muted?"bg-red-500 text-white":"bg-r58-bg-secondary text-r58-text-secondary hover:text-r58-text-primary"]),title:"Mute"}," M ",10,Xs)]),e("div",Qs,[e("div",{class:H(["h-full transition-all duration-75 rounded-full",w.muted?"bg-r58-bg-tertiary":j(w.audioLevel)]),style:ge({width:`${w.audioLevel}%`})},null,6)]),e("input",{type:"range",value:w.volume||100,onInput:x=>a(w,x.target.valueAsNumber),min:"0",max:"100",disabled:w.muted,class:"w-full h-1.5 bg-r58-bg-secondary rounded-lg appearance-none cursor-pointer accent-r58-accent-primary disabled:opacity-50"},null,40,Zs)]))),128))])):(t(),o("div",er,[...M[4]||(M[4]=[e("svg",{class:"w-6 h-6 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})],-1),e("p",{class:"text-xs"},"No audio sources",-1)])]))]))}}),or=le(tr,[["__scopeId","data-v-9f608237"]]),nr={class:"transition-settings space-y-3","data-testid":"transition-settings"},sr={class:"grid grid-cols-3 gap-1"},rr=["onClick"],ir={class:"block text-sm mb-0.5"},ar=["disabled"],lr=["value"],dr={class:"p-3 bg-r58-bg-tertiary rounded-lg"},cr={class:"flex items-center justify-between text-xs"},ur={class:"font-mono"},vr={key:0},mr=Z({__name:"TransitionSettings",setup(I){const r=oe(),s=N({get:()=>r.transition.type,set:a=>r.setTransition({type:a})}),m=N({get:()=>r.transition.duration,set:a=>r.setTransition({duration:a})}),i=[{value:"cut",label:"Cut",icon:"âš¡"},{value:"fade",label:"Fade",icon:"ðŸŒ«ï¸"},{value:"wipe-left",label:"Wipe L",icon:"â—€"},{value:"wipe-right",label:"Wipe R",icon:"â–¶"},{value:"wipe-up",label:"Wipe Up",icon:"â–²"},{value:"wipe-down",label:"Wipe Down",icon:"â–¼"}],p=[{value:0,label:"0ms"},{value:100,label:"100ms"},{value:300,label:"300ms"},{value:500,label:"500ms"},{value:750,label:"750ms"},{value:1e3,label:"1s"},{value:2e3,label:"2s"}];function C(a){r.setTransition({type:a})}return(a,c)=>{var b;return t(),o("div",nr,[e("div",sr,[(t(),o(W,null,J(i,S=>e("button",{key:S.value,onClick:u=>C(S.value),class:H(["px-2 py-2 text-xs rounded transition-colors text-center",s.value===S.value?"bg-r58-accent-primary text-white":"bg-r58-bg-tertiary hover:bg-r58-bg-tertiary/80 text-r58-text-secondary"])},[e("span",ir,$(S.icon),1),Q(" "+$(S.label),1)],10,rr)),64))]),e("div",null,[c[1]||(c[1]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Duration",-1)),X(e("select",{"onUpdate:modelValue":c[0]||(c[0]=S=>m.value=S),class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none",disabled:s.value==="cut"},[(t(),o(W,null,J(p,S=>e("option",{key:S.value,value:S.value},$(S.label),9,lr)),64))],8,ar),[[Se,m.value,void 0,{number:!0}]])]),e("div",dr,[e("div",cr,[c[2]||(c[2]=e("span",{class:"text-r58-text-secondary"},"Current:",-1)),e("span",ur,[Q($((b=i.find(S=>S.value===s.value))==null?void 0:b.label)+" ",1),s.value!=="cut"?(t(),o("span",vr," ("+$(m.value)+"ms)",1)):P("",!0)])])]),c[3]||(c[3]=e("p",{class:"text-xs text-r58-text-secondary"},[Q(" Press "),e("kbd",{class:"px-1 py-0.5 bg-r58-bg-tertiary rounded"},"Space"),Q(" to Take with transition ")],-1))])}}}),pr={class:"invite-links space-y-3","data-testid":"invite-links"},gr={key:0,class:"space-y-2"},xr={class:"p-2 bg-r58-bg-tertiary rounded-lg"},fr={class:"text-xs text-r58-text-secondary break-all block"},br={key:1,class:"space-y-2 p-3 bg-r58-bg-tertiary rounded-lg"},yr={class:"flex items-center gap-2 text-xs"},hr={class:"flex items-center gap-2 text-xs"},wr={key:2,class:"text-center"},kr={key:0,class:"mt-2 flex justify-center"},Sr=["src"],_r={class:"text-xs text-r58-text-secondary text-center"},$r={class:"font-mono"},Cr=Z({__name:"InviteLinks",setup(I){const r=R(""),s=R(!1),m=R(!0),i=R(!0),p=N(()=>r.value.trim()?qe(r.value.trim()):"");function C(){if(!p.value){B.error("Enter a guest name first");return}navigator.clipboard.writeText(p.value),B.success("Invite link copied!")}function a(){if(!p.value){B.error("Enter a guest name first");return}window.open(p.value,"_blank")}async function c(){if(!p.value){B.error("Enter a guest name first");return}if(navigator.share)try{await navigator.share({title:`Join ${De} as ${r.value}`,text:`Click to join the video call as ${r.value}`,url:p.value})}catch(S){S.name!=="AbortError"&&C()}else C()}const b=N(()=>p.value?`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(p.value)}`:"");return(S,u)=>(t(),o("div",pr,[e("div",null,[u[5]||(u[5]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Guest Name",-1)),X(e("input",{"onUpdate:modelValue":u[0]||(u[0]=j=>r.value=j),type:"text",placeholder:"e.g., John Smith",class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ne,r.value]])]),p.value?(t(),o("div",gr,[e("div",xr,[e("code",fr,$(p.value),1)]),e("div",{class:"flex gap-2"},[e("button",{onClick:C,class:"flex-1 btn btn-sm btn-primary"},[...u[6]||(u[6]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})],-1),Q(" Copy ",-1)])]),e("button",{onClick:c,class:"btn btn-sm",title:"Share"},[...u[7]||(u[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})],-1)])]),e("button",{onClick:a,class:"btn btn-sm",title:"Open in new tab"},[...u[8]||(u[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)])])])])):P("",!0),e("button",{onClick:u[1]||(u[1]=j=>s.value=!s.value),class:"w-full text-xs text-r58-text-secondary hover:text-r58-text-primary flex items-center justify-center gap-1"},[e("span",null,$(s.value?"Hide":"Show")+" options",1),(t(),o("svg",{class:H(["w-3 h-3 transition-transform",{"rotate-180":s.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...u[9]||(u[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),s.value?(t(),o("div",br,[e("label",yr,[X(e("input",{type:"checkbox","onUpdate:modelValue":u[2]||(u[2]=j=>m.value=j),class:"rounded"},null,512),[[Re,m.value]]),u[10]||(u[10]=e("span",null,"Enable video",-1))]),e("label",hr,[X(e("input",{type:"checkbox","onUpdate:modelValue":u[3]||(u[3]=j=>i.value=j),class:"rounded"},null,512),[[Re,i.value]]),u[11]||(u[11]=e("span",null,"Enable audio",-1))])])):P("",!0),p.value&&b.value?(t(),o("div",wr,[e("button",{onClick:u[4]||(u[4]=j=>s.value=!s.value),class:"text-xs text-r58-text-secondary hover:text-r58-text-primary"}," Show QR Code "),s.value?(t(),o("div",kr,[e("img",{src:b.value,alt:"QR Code",class:"w-32 h-32 bg-white p-2 rounded"},null,8,Sr)])):P("",!0)])):P("",!0),e("div",_r,[u[12]||(u[12]=Q(" Room: ",-1)),e("span",$r,$(G(De)),1)])]))}}),Mr={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Ir={class:"relative bg-r58-bg-secondary border border-r58-bg-tertiary rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-2xl"},Rr={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary"},Er={class:"text-xl font-semibold"},Dr={class:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},jr={class:"flex gap-6"},Vr={class:"flex-1"},Tr={class:"mb-4"},Lr={class:"mb-4"},Pr={class:"flex gap-2 flex-wrap"},Or=["onClick"],Ar={class:"mb-4"},Ur={id:"scene-canvas",class:"relative aspect-video bg-black rounded-lg overflow-hidden border border-r58-bg-tertiary"},Hr=["onMousedown","onClick"],Nr={class:"absolute inset-0 flex items-center justify-center text-xs text-r58-text-secondary"},Br=["onMousedown"],zr=["onClick"],Fr={class:"w-64 flex-shrink-0"},Gr={key:0,class:"space-y-4"},Kr=["value"],Wr=["value"],Yr={class:"grid grid-cols-2 gap-2"},Jr={key:1,class:"text-sm text-r58-text-secondary p-4 bg-r58-bg-tertiary rounded-lg"},qr={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-r58-bg-tertiary"},Xr=Z({__name:"SceneEditor",setup(I,{expose:r}){const s=ue(),m=oe(),i=R(!1),p=R(null),C=R(!1),a=R(""),c=R([]),b=R(null),S=R(!1),u=R(null),j=R({x:0,y:0}),f=R("move"),M=N(()=>m.connectedSources),w=[{id:"solo",name:"Solo",slots:[{x:0,y:0,w:100,h:100}]},{id:"split",name:"Split",slots:[{x:0,y:0,w:50,h:100},{x:50,y:0,w:50,h:100}]},{id:"pip",name:"PiP",slots:[{x:0,y:0,w:100,h:100},{x:65,y:60,w:30,h:35}]},{id:"quad",name:"Quad",slots:[{x:0,y:0,w:50,h:50},{x:50,y:0,w:50,h:50},{x:0,y:50,w:50,h:50},{x:50,y:50,w:50,h:50}]},{id:"three-up",name:"3-Up",slots:[{x:0,y:0,w:50,h:100},{x:50,y:0,w:50,h:50},{x:50,y:50,w:50,h:50}]}];function x(E){p.value=E,C.value=!1,a.value=E.name,c.value=JSON.parse(JSON.stringify(E.slots)),b.value=null,i.value=!0}function L(){p.value=null,C.value=!0,a.value="New Scene",c.value=[{id:"slot-1",sourceId:null,position:{x:0,y:0,w:100,h:100},zIndex:0}],b.value=null,i.value=!0}function T(){i.value=!1,p.value=null}function n(){if(!a.value.trim()){B.error("Scene name is required");return}if(C.value){const E=s.createScene({name:a.value.trim(),resolution:{width:1920,height:1080},slots:c.value});B.success(`Created: ${E.name}`)}else p.value&&(s.updateScene(p.value.id,{name:a.value.trim(),slots:c.value}),B.success(`Updated: ${a.value}`));T()}function v(E){c.value=E.slots.map((y,D)=>{var V;return{id:`slot-${D+1}`,sourceId:((V=c.value[D])==null?void 0:V.sourceId)||null,position:{x:y.x,y:y.y,w:y.w,h:y.h},zIndex:D}}),B.info(`Applied: ${E.name}`)}function d(){const E={id:`slot-${Date.now()}`,sourceId:null,position:{x:10,y:10,w:30,h:30},zIndex:c.value.length};c.value.push(E),b.value=E.id}function U(E){const y=c.value.findIndex(D=>D.id===E);y!==-1&&(c.value.splice(y,1),b.value===E&&(b.value=null))}function _(E){b.value=E}const l=N(()=>c.value.find(E=>E.id===b.value));function k(E){if(!b.value)return;const y=c.value.find(D=>D.id===b.value);y&&(y.sourceId=E)}function z(E,y,D="move"){E.preventDefault(),S.value=!0,u.value=y,f.value=D,j.value={x:E.clientX,y:E.clientY},window.addEventListener("mousemove",g),window.addEventListener("mouseup",h)}function g(E){if(!S.value||!u.value)return;const y=c.value.find(de=>de.id===u.value);if(!y)return;const D=document.getElementById("scene-canvas");if(!D)return;const V=D.getBoundingClientRect(),A=(E.clientX-j.value.x)/V.width*100,ie=(E.clientY-j.value.y)/V.height*100;f.value==="move"?(y.position.x=Math.max(0,Math.min(100-y.position.w,y.position.x+A)),y.position.y=Math.max(0,Math.min(100-y.position.h,y.position.y+ie))):(y.position.w=Math.max(10,Math.min(100-y.position.x,y.position.w+A)),y.position.h=Math.max(10,Math.min(100-y.position.y,y.position.h+ie))),j.value={x:E.clientX,y:E.clientY}}function h(){S.value=!1,u.value=null,window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",h)}return r({open:x,openNew:L}),(E,y)=>(t(),me(ye,{to:"body"},[i.value?(t(),o("div",Mr,[e("div",{class:"absolute inset-0 bg-black/70",onClick:T}),e("div",Ir,[e("div",Rr,[e("h2",Er,$(C.value?"Create Scene":"Edit Scene"),1),e("button",{onClick:T,class:"text-r58-text-secondary hover:text-r58-text-primary text-2xl"}," Ã— ")]),e("div",Dr,[e("div",jr,[e("div",Vr,[e("div",Tr,[y[7]||(y[7]=e("label",{class:"block text-sm text-r58-text-secondary mb-1"},"Scene Name",-1)),X(e("input",{"onUpdate:modelValue":y[0]||(y[0]=D=>a.value=D),type:"text",class:"w-full px-3 py-2 bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg focus:border-r58-accent-primary focus:outline-none"},null,512),[[ne,a.value]])]),e("div",Lr,[y[8]||(y[8]=e("label",{class:"block text-sm text-r58-text-secondary mb-2"},"Quick Layouts",-1)),e("div",Pr,[(t(),o(W,null,J(w,D=>e("button",{key:D.id,onClick:V=>v(D),class:"px-3 py-1 text-xs bg-r58-bg-tertiary hover:bg-r58-accent-primary/20 rounded transition-colors"},$(D.name),9,Or)),64))])]),e("div",Ar,[y[9]||(y[9]=e("label",{class:"block text-sm text-r58-text-secondary mb-2"},"Layout",-1)),e("div",Ur,[(t(!0),o(W,null,J(c.value,D=>(t(),o("div",{key:D.id,onMousedown:V=>z(V,D.id,"move"),onClick:we(V=>_(D.id),["stop"]),class:H(["absolute cursor-move transition-colors",[b.value===D.id?"border-2 border-r58-accent-primary":"border border-r58-bg-tertiary hover:border-r58-accent-primary/50"]]),style:ge({left:`${D.position.x}%`,top:`${D.position.y}%`,width:`${D.position.w}%`,height:`${D.position.h}%`,zIndex:D.zIndex,backgroundColor:D.sourceId?"var(--r58-bg-tertiary)":"var(--r58-bg-secondary)"})},[e("div",Nr,$(D.sourceId||"Empty"),1),b.value===D.id?(t(),o("div",{key:0,onMousedown:we(V=>z(V,D.id,"resize"),["stop"]),class:"absolute bottom-0 right-0 w-4 h-4 bg-r58-accent-primary cursor-se-resize"},null,40,Br)):P("",!0),b.value===D.id&&c.value.length>1?(t(),o("button",{key:1,onClick:we(V=>U(D.id),["stop"]),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center hover:bg-red-400"}," Ã— ",8,zr)):P("",!0)],46,Hr))),128))])]),e("button",{onClick:d,class:"btn btn-sm"}," + Add Slot ")]),e("div",Fr,[y[17]||(y[17]=e("h3",{class:"text-sm font-medium mb-3"},"Slot Properties",-1)),l.value?(t(),o("div",Gr,[e("div",null,[y[11]||(y[11]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Source",-1)),e("select",{value:l.value.sourceId||"",onChange:y[1]||(y[1]=D=>k(D.target.value||null)),class:"w-full px-3 py-2 text-sm bg-r58-bg-tertiary border border-r58-bg-tertiary rounded-lg"},[y[10]||(y[10]=e("option",{value:""},"None (Empty)",-1)),(t(!0),o(W,null,J(M.value,D=>(t(),o("option",{key:D.id,value:D.id},$(D.label),9,Wr))),128))],40,Kr)]),e("div",Yr,[e("div",null,[y[12]||(y[12]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"X %",-1)),X(e("input",{"onUpdate:modelValue":y[2]||(y[2]=D=>l.value.position.x=D),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,l.value.position.x,void 0,{number:!0}]])]),e("div",null,[y[13]||(y[13]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Y %",-1)),X(e("input",{"onUpdate:modelValue":y[3]||(y[3]=D=>l.value.position.y=D),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,l.value.position.y,void 0,{number:!0}]])]),e("div",null,[y[14]||(y[14]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Width %",-1)),X(e("input",{"onUpdate:modelValue":y[4]||(y[4]=D=>l.value.position.w=D),type:"number",min:"1",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,l.value.position.w,void 0,{number:!0}]])]),e("div",null,[y[15]||(y[15]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Height %",-1)),X(e("input",{"onUpdate:modelValue":y[5]||(y[5]=D=>l.value.position.h=D),type:"number",min:"1",max:"100",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,l.value.position.h,void 0,{number:!0}]])])]),e("div",null,[y[16]||(y[16]=e("label",{class:"block text-xs text-r58-text-secondary mb-1"},"Layer (z-index)",-1)),X(e("input",{"onUpdate:modelValue":y[6]||(y[6]=D=>l.value.zIndex=D),type:"number",min:"0",max:"10",class:"w-full px-2 py-1 text-sm bg-r58-bg-tertiary rounded"},null,512),[[ne,l.value.zIndex,void 0,{number:!0}]])])])):(t(),o("div",Jr," Click a slot to edit its properties "))])])]),e("div",qr,[e("button",{onClick:T,class:"btn"},"Cancel"),e("button",{onClick:n,class:"btn btn-primary"},$(C.value?"Create Scene":"Save Changes"),1)])])])):P("",!0)]))}}),Qr={class:"h-full flex flex-col bg-r58-bg-primary"},Zr={class:"flex items-center justify-between px-6 py-4 border-b border-r58-bg-tertiary bg-r58-bg-secondary"},ei={class:"flex items-center gap-4"},ti={class:"flex items-center gap-2"},oi={key:0,class:"badge badge-danger"},ni={class:"flex items-center gap-4"},si={class:"flex-1 p-6 overflow-auto"},ri={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ii={class:"card p-6"},ai={class:"grid grid-cols-4 gap-3"},li=["onClick"],di={class:"card p-6"},ci={class:"text-lg font-semibold mb-4"},ui={class:"text-sm font-normal text-r58-text-secondary"},vi={class:"space-y-3"},mi={class:"flex items-center gap-3"},pi={class:"font-medium"},gi={key:0,class:"text-xs text-r58-text-secondary ml-2"},xi={key:0,class:"text-sm text-r58-text-secondary"},fi={class:"card p-6"},bi={class:"flex items-center gap-4"},yi={key:0,class:"w-2 h-2 rounded-full bg-white animate-pulse mr-2"},hi={key:0,class:"mt-3 text-sm text-r58-text-secondary"},wi={class:"card p-6"},ki={class:"grid grid-cols-2 gap-4"},Si={class:"text-2xl font-bold text-r58-text-primary"},_i=Z({__name:"MixerLiteView",emits:["enable-full-mode"],setup(I,{emit:r}){const s=r,m=pe(),i=oe(),p=he(),{register:C}=Le(),a=N(()=>i.isLive),c=N(()=>m.inputs),b=N(()=>c.value.filter(w=>w.hasSignal));let S=null;ve(()=>{m.fetchInputs(),S=window.setInterval(()=>{m.fetchInputs()},5e3);for(let w=1;w<=4;w++)C({key:String(w),description:`Switch to scene ${w}`,action:()=>u(w),context:"mixer-lite"})}),xe(()=>{S&&clearInterval(S)});function u(w){i.setScene(`scene-${w}`),B.info(`Scene ${w}`)}function j(){i.isLive?(i.toggleLive(),p.stopStreaming(),B.info("Session ended")):(i.toggleLive(),p.startStreaming(),B.success("Going live!"))}async function f(){try{m.isRecording?(await m.stopRecording(),B.info("Recording stopped")):(await m.startRecording(),B.success("Recording started"))}catch{B.error("Recording action failed")}}function M(){confirm("Full Mixer mode loads VDO.ninja which uses significant CPU/GPU resources. This may cause lag on the device. Continue?")&&s("enable-full-mode")}return(w,x)=>(t(),o("div",Qr,[e("header",Zr,[e("div",ei,[e("div",ti,[e("span",{class:H(["w-3 h-3 rounded-full",a.value?"bg-r58-accent-danger animate-pulse":"bg-r58-bg-tertiary"])},null,2),x[0]||(x[0]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1)),x[1]||(x[1]=e("span",{class:"text-xs px-2 py-0.5 rounded bg-amber-500/20 text-amber-400 font-medium"}," LITE MODE ",-1))]),a.value?(t(),o("span",oi,"ON AIR")):P("",!0)]),e("div",ni,[e("button",{class:"btn btn-sm btn-secondary",onClick:M,title:"Enable full VDO.ninja mixer (high CPU usage)"},[...x[2]||(x[2]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1),Q(" Full Mode ",-1)])]),e("button",{class:H(["btn",a.value?"btn-danger":"btn-primary"]),onClick:j},$(a.value?"End Session":"Go Live"),3)])]),e("main",si,[x[10]||(x[10]=be('<div class="mb-6 p-4 rounded-lg bg-amber-500/10 border border-amber-500/30" data-v-6d9e9096><div class="flex items-start gap-3" data-v-6d9e9096><svg class="w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-6d9e9096><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-6d9e9096></path></svg><div data-v-6d9e9096><h3 class="font-medium text-amber-400" data-v-6d9e9096>Local Device Mode</h3><p class="text-sm text-r58-text-secondary mt-1" data-v-6d9e9096> VDO.ninja previews are disabled to save CPU. Scene switching and guest management should be done from a remote browser or the Electron app. </p></div></div></div>',1)),e("div",ri,[e("div",ii,[x[3]||(x[3]=e("h2",{class:"text-lg font-semibold mb-4"},"Scene Control",-1)),e("div",ai,[(t(),o(W,null,J(4,L=>e("button",{key:L,class:H(["aspect-video flex items-center justify-center text-2xl font-bold rounded-lg transition-all",G(i).currentScene===`scene-${L}`?"bg-r58-mixer text-white ring-2 ring-r58-mixer ring-offset-2 ring-offset-r58-bg-primary":"bg-r58-bg-tertiary hover:bg-r58-bg-secondary text-r58-text-primary"]),onClick:T=>u(L)},$(L),11,li)),64))]),x[4]||(x[4]=e("p",{class:"text-xs text-r58-text-secondary mt-3"}," Press 1-4 to switch scenes. Full transitions require VDO.ninja (Full Mode). ",-1))]),e("div",di,[e("h2",ci,[x[5]||(x[5]=Q(" Inputs ",-1)),e("span",ui,"("+$(b.value.length)+"/"+$(c.value.length)+" active)",1)]),e("div",vi,[(t(!0),o(W,null,J(c.value,L=>(t(),o("div",{key:L.id,class:H(["flex items-center justify-between p-3 rounded-lg",L.hasSignal?"bg-r58-bg-tertiary":"bg-r58-bg-secondary opacity-50"])},[e("div",mi,[e("div",{class:H(["w-2 h-2 rounded-full",L.hasSignal?"bg-green-500":"bg-gray-500"])},null,2),e("div",null,[e("span",pi,$(L.name),1),L.resolution?(t(),o("span",gi,$(L.resolution),1)):P("",!0)])]),L.framerate?(t(),o("div",xi,$(L.framerate.toFixed(1))+" fps ",1)):P("",!0)],2))),128))])]),e("div",fi,[x[6]||(x[6]=e("h2",{class:"text-lg font-semibold mb-4"},"Device Recording",-1)),e("div",bi,[e("button",{class:H(["btn flex-1",G(m).isRecording?"btn-danger":"btn-primary"]),onClick:f},[G(m).isRecording?(t(),o("span",yi)):P("",!0),Q(" "+$(G(m).isRecording?"Stop Recording":"Start Recording"),1)],2)]),G(m).isRecording?(t(),o("div",hi," Duration: "+$(G(m).formattedDuration),1)):P("",!0)]),e("div",wi,[x[9]||(x[9]=e("h2",{class:"text-lg font-semibold mb-4"},"System Status",-1)),e("div",ki,[e("div",null,[e("div",Si,$(b.value.length),1),x[7]||(x[7]=e("div",{class:"text-sm text-r58-text-secondary"},"Active Inputs",-1))]),e("div",null,[e("div",{class:H(["text-2xl font-bold",a.value?"text-red-500":"text-r58-text-primary"])},$(a.value?"LIVE":"Offline"),3),x[8]||(x[8]=e("div",{class:"text-sm text-r58-text-secondary"},"Stream Status",-1))])])])])])]))}}),$i=le(_i,[["__scopeId","data-v-6d9e9096"]]),Ci={class:"h-full flex flex-col bg-r58-bg-primary"},Mi={class:"flex items-center justify-between px-6 py-3 border-b border-r58-bg-tertiary bg-r58-bg-secondary","data-testid":"mixer-header"},Ii={class:"flex items-center gap-4"},Ri={class:"flex items-center gap-2"},Ei={key:0,class:"px-3 py-1 bg-red-600 text-white text-xs font-bold uppercase tracking-wider rounded"},Di={class:"text-sm text-r58-text-secondary"},ji={key:1,class:"text-xs text-r58-text-secondary"},Vi={class:"flex items-center gap-3"},Ti={class:"flex items-center gap-1 bg-r58-bg-tertiary rounded-lg p-1"},Li={class:"flex-1 flex overflow-hidden"},Pi={class:"flex-1 min-w-0"},Oi={key:0,class:"text-sm font-medium"},Ai={class:"p-4 space-y-6"},Ui={class:"p-2 space-y-4"},Hi={class:"fixed -left-[9999px] -top-[9999px] w-[1px] h-[1px] overflow-hidden"},Ni=Z({__name:"MixerView",setup(I){const r=oe(),s=ue(),m=pe(),i=he(),{register:p}=Le(),{isLiteMode:C}=Ne(),a=R(null),c=Qe(a),b=R(null),S=R(null),u=R(null),j=R(!1),f=N(()=>!C.value||j.value),M=R(!0),w=R(!1),x=R(!1),L=N(()=>r.isLive),T=N(()=>i.enabledDestinations.length),n=N(()=>{const V=s.getScene(r.programSceneId||"");return(V==null?void 0:V.name)||"No Scene"});function v(){M.value=!1}se(()=>{var V,A;return(A=(V=a.value)==null?void 0:V.isReady)==null?void 0:A.value},V=>{V&&(console.log("[Mixer] VDO.ninja ready"),w.value=!0)},{immediate:!0});let d=null;function U(){return m.isRecording?1e4:3e4}function _(){d&&clearInterval(d),d=window.setInterval(()=>{m.fetchInputs()},U())}se(()=>m.isRecording,()=>{_()});const l=[];ve(async()=>{await m.fetchInputs(),_();for(let V=1;V<=8;V++){const A=V-1,ie=p({key:String(V),description:`Select scene ${V} for preview`,action:()=>{const de=s.scenes[A];de&&(r.setPreviewScene(de.id),B.info(`Preview: ${de.name}`))},context:"mixer"});l.push(ie)}l.push(p({key:" ",description:"Take (transition preview to program)",action:()=>{r.previewSceneId&&r.previewSceneId!==r.programSceneId&&(c.takeToProgram(),B.success("Take!"))},context:"mixer"})),l.push(p({key:"Escape",description:"Cut (immediate switch)",action:()=>{r.previewSceneId&&(c.cutToProgram(),B.info("Cut"))},context:"mixer"})),l.push(p({key:"g",description:"Toggle Go Live",action:k,context:"mixer"})),l.push(p({key:"r",description:"Toggle recording",action:z,context:"mixer"}))}),xe(()=>{l.forEach(V=>V()),d&&(clearInterval(d),d=null)});function k(){if(r.isLive)r.toggleLive(),i.stopStreaming(),B.info("Session ended");else{r.toggleLive(),i.startStreaming();const V=i.enabledDestinations.length;V>0?B.success(`Live! Streaming to ${V} destination${V>1?"s":""}`):B.info("Live! (No streaming destinations configured)")}}function z(){var V,A;if(!c.isConnected.value){B.error("VDO.ninja not connected");return}(A=(V=a.value)==null?void 0:V.isRecording)!=null&&A.value?(c.stopRecording(),B.info("Recording stopped")):(c.startRecording(),B.success("Recording started"))}function g(){var V;(V=b.value)==null||V.open()}function h(){var V;(V=S.value)==null||V.open()}function E(V){var A;(A=u.value)==null||A.open(V)}function y(){var V;(V=u.value)==null||V.openNew()}function D(){x.value=!x.value}return(V,A)=>f.value?(t(),o(W,{key:1},[te(ze,{name:"fade"},{default:Be(()=>[M.value?(t(),me(Xe,{key:0,mode:"mixer","content-ready":w.value,"min-time":2e3,"max-time":15e3,onReady:v},null,8,["content-ready"])):P("",!0)]),_:1}),e("div",Ci,[e("header",Mi,[e("div",Ii,[e("div",Ri,[e("span",{class:H(["w-3 h-3 rounded-full transition-colors",L.value?"bg-red-500 animate-pulse":"bg-r58-bg-tertiary"])},null,2),A[3]||(A[3]=e("span",{class:"text-xl font-semibold text-r58-mixer"},"Mixer",-1))]),L.value?(t(),o("span",Ei," ON AIR ")):P("",!0),e("span",Di,$(n.value),1),L.value&&T.value>0?(t(),o("span",ji," â†’ "+$(T.value)+" platform"+$(T.value>1?"s":""),1)):P("",!0),te(Rs,{"vdo-embed":a.value},null,8,["vdo-embed"])]),e("div",Vi,[e("div",Ti,[e("button",{onClick:A[1]||(A[1]=ie=>G(r).setMode("simple")),class:H(["px-3 py-1 text-xs rounded transition-colors",G(r).mode==="simple"?"bg-r58-accent-primary text-white":"text-r58-text-secondary hover:text-r58-text-primary"])}," Simple ",2),e("button",{onClick:A[2]||(A[2]=ie=>G(r).setMode("pvw-pgm")),class:H(["px-3 py-1 text-xs rounded transition-colors",G(r).mode==="pvw-pgm"?"bg-r58-accent-primary text-white":"text-r58-text-secondary hover:text-r58-text-primary"])}," PVW/PGM ",2)]),e("button",{class:"btn btn-sm",onClick:h,title:"Keyboard Shortcuts (Shift+?)"},[...A[4]||(A[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})],-1)])]),e("button",{class:"btn btn-sm",onClick:g,title:"Streaming Settings"},[...A[5]||(A[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])]),e("button",{class:H(["btn px-6",L.value?"btn-danger":"btn-primary"]),onClick:k},$(L.value?"End Session":"Go Live"),3)])]),e("div",Li,[e("div",Pi,[te($o,{"vdo-embed":a.value,controller:G(c),onEditScene:E,onAddScene:y},null,8,["vdo-embed","controller"])]),e("aside",{class:H(["flex-shrink-0 border-l border-r58-bg-tertiary bg-r58-bg-secondary overflow-y-auto transition-all duration-300",x.value?"w-12":"w-72"])},[e("button",{onClick:D,class:"w-full p-3 flex items-center justify-between border-b border-r58-bg-tertiary hover:bg-r58-bg-tertiary/50 transition-colors"},[x.value?P("",!0):(t(),o("span",Oi,"Controls")),(t(),o("svg",{class:H(["w-4 h-4 transition-transform",{"rotate-180":x.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...A[6]||(A[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))]),X(e("div",Ai,[e("section",null,[A[7]||(A[7]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Transitions ",-1)),te(mr)]),e("section",null,[A[8]||(A[8]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Audio ",-1)),te(or,{"vdo-embed":a.value,controller:G(c)},null,8,["vdo-embed","controller"])]),e("section",null,[A[9]||(A[9]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Program Output ",-1)),te(rn)]),e("section",null,[A[10]||(A[10]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Recording ",-1)),te(Us,{"vdo-embed":a.value},null,8,["vdo-embed"])]),e("section",null,[A[11]||(A[11]=e("h3",{class:"text-xs font-semibold text-r58-text-secondary uppercase tracking-wide mb-3"}," Invite Guests ",-1)),te(Cr)])],512),[[fe,!x.value]]),X(e("div",Ui,[...A[12]||(A[12]=[be('<button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Transitions" data-v-c03e6b15><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c03e6b15><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" data-v-c03e6b15></path></svg></button><button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Audio" data-v-c03e6b15><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c03e6b15><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" data-v-c03e6b15></path></svg></button><button class="w-8 h-8 mx-auto flex items-center justify-center rounded hover:bg-r58-bg-tertiary" title="Recording" data-v-c03e6b15><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c03e6b15><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" data-v-c03e6b15></path></svg></button>',3)])],512),[[fe,x.value]])],2)]),te(Wo),e("div",Hi,[te(Lo,{ref_key:"vdoEmbedRef",ref:a,profile:"director"},null,512)]),te(qn,{ref_key:"streamingSettingsRef",ref:b},null,512),te(xs,{ref_key:"hotkeySettingsRef",ref:S},null,512),te(Xr,{ref_key:"sceneEditorRef",ref:u},null,512)])],64)):(t(),me($i,{key:0,onEnableFullMode:A[0]||(A[0]=ie=>j.value=!0)}))}}),Gi=le(Ni,[["__scopeId","data-v-c03e6b15"]]);export{Gi as default};
